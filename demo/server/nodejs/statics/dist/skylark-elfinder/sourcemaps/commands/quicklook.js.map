{"version":3,"sources":["commands/quicklook.js"],"names":["define","elFinder","prototype","commands","quicklook","width","height","prevStyle","parent","cwd","cwdHash","dockHeight","getSize","dockedNode","selectTm","self","this","fm","state","evUpdate","Element","update","navicon","fullscreen","infocls","navtrigger","code","$","document","trigger","Event","keyCode","ctrlKey","shiftKey","altKey","metaKey","closedCss","node","target","elf","getUI","offset","base","find","length","baseOffset","top","left","opacity","mediaNode","support","codec","name","substr","indexOf","media","createElement","value","canPlayType","e","platformWin","window","navigator","platform","dockEnabled","navdrag","navmove","navtm","leftKey","ui","LEFT","rightKey","RIGHT","coverEv","title","icon","info","cover","fsicon","on","win","full","hasClass","$window","resize","preview","stopPropagation","preventDefault","navStyle","navShow","toggleClass","css","data","off","navbar","display","removeAttr","type","setTimeout","UA","Mobile","fadeOut","show","is","coverHide","zIndex","attr","draggable","start","stop","requestAnimationFrame","collection","add","resizable","removeClass","updateOnSel","ts","files","selectedFiles","cnt","docked","each","i","f","t","parseInt","hash","Date","i18n","mime","size","spinner","map","clearTimeout","removeData","hide","prev","next","append","titleClose","titleDock","init","flags","_show","namespace","addClass","autoPlay","opened","options","html","tmb","file","tpl","getSizeHashes","Object","keys","_hash","reject","forceUpdate","escape","i18","read","stopImmediatePropagation","children","remove","cwdId2Hash","replace","mime2kind","formatSize","formatDate","done","formated","fail","always","mime2class","getIconStyle","csscls","appendTo","className","url","delay","fadeIn","Touch","toFront","handle","clcss","open","status","change","storage","cwdHash2Elm","split","animate","contain","dialogContained","w","Math","min","h","scrollTop","scrollLeft","openedCss","dfd","close","winhide","toHide","resolve","click","box","opts","boxSizing","paddingBottom","Deferred","outerHeight","alwaysEnabled","handlers","select","d","cancelAnimationFrame","selected","error","searchshow searchhide","navbarshow","destroy","shortcuts","pattern","audio","ogg","webm","mp3","wav","m4a","flac","amr","video","mp4","mkv","3gp","m3u8","mpd","closed","addIntegration","assign","cmd","cwdDispInlineRegex","o","one","ESCAPE","handles","minWidth","minHeight","serach","searchStatus","mixed","match","mimeRegexNotEmptyCheck","dispInlineRegex","optionsByHashes","RegExp","option","isRoot","phash","plugins","plugin","dock","Number","exec","bind","changed","getstate","enabled","hideinfo","forceLoad"],"mappings":"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","file":"../../commands/quicklook.js","sourcesContent":["define([\n\t\"../elFinder\"\n],function(elFinder){\n\t/**\n\t * @class  elFinder command \"quicklook\"\n\t * Fast preview for some files types\n\t *\n\t * @author Dmitry (dio) Levashov\n\t **/\n\t(elFinder.prototype.commands.quicklook = function() {\n\t\t\"use strict\";\n\t\tvar self       = this,\n\t\t\tfm         = self.fm,\n\t\t\t/**\n\t\t\t * window closed state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\tclosed     = 0,\n\t\t\t/**\n\t\t\t * window animated state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\tanimated   = 1,\n\t\t\t/**\n\t\t\t * window opened state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\topened     = 2,\n\t\t\t/**\n\t\t\t * window docked state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\tdocked     = 3,\n\t\t\t/**\n\t\t\t * window docked and hidden state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\tdockedhidden = 4,\n\t\t\t/**\n\t\t\t * window state\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\tstate      = closed,\n\t\t\t/**\n\t\t\t * Event name of update\n\t\t\t * for fix conflicts with Prototype.JS\n\t\t\t * \n\t\t\t * `@see https://github.com/Studio-42/elFinder/pull/2346\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tevUpdate = Element.update? 'quicklookupdate' : 'update',\n\t\t\t/**\n\t\t\t * navbar icon class\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tnavicon    = 'elfinder-quicklook-navbar-icon',\n\t\t\t/**\n\t\t\t * navbar \"fullscreen\" icon class\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tfullscreen = 'elfinder-quicklook-fullscreen',\n\t\t\t/**\n\t\t\t * info wrapper class\n\t\t\t * \n\t\t\t * @type String\n\t\t\t */\n\t\t\tinfocls    = 'elfinder-quicklook-info-wrapper',\n\t\t\t/**\n\t\t\t * Triger keydown/keypress event with left/right arrow key code\n\t\t\t *\n\t\t\t * @param  Number  left/right arrow key code\n\t\t\t * @return void\n\t\t\t **/\n\t\t\tnavtrigger = function(code) {\n\t\t\t\t$(document).trigger($.Event('keydown', { keyCode: code, ctrlKey : false, shiftKey : false, altKey : false, metaKey : false }));\n\t\t\t},\n\t\t\t/**\n\t\t\t * Return css for closed window\n\t\t\t *\n\t\t\t * @param  jQuery  file node in cwd\n\t\t\t * @return void\n\t\t\t **/\n\t\t\tclosedCss = function(node) {\n\t\t\t\tvar elf = fm.getUI().offset(),\n\t\t\t\t\tbase = (function() {\n\t\t\t\t\t\tvar target = node.find('.elfinder-cwd-file-wrapper');\n\t\t\t\t\t\treturn target.length? target : node;\n\t\t\t\t\t})(),\n\t\t\t\t\tbaseOffset = base.offset() || { top: 0, left: 0 };\n\t\t\t\treturn {\n\t\t\t\t\topacity : 0,\n\t\t\t\t\twidth   : base.width(),\n\t\t\t\t\theight  : base.height() - 30,\n\t\t\t\t\ttop     : baseOffset.top - elf.top,\n\t\t\t\t\tleft    : baseOffset.left  - elf.left\n\t\t\t\t};\n\t\t\t},\n\t\t\t/**\n\t\t\t * Return css for opened window\n\t\t\t *\n\t\t\t * @return void\n\t\t\t **/\n\t\t\topenedCss = function() {\n\t\t\t\tvar contain = self.options.contain || fm.options.dialogContained,\n\t\t\t\t\twin = contain? fm.getUI() : $(window),\n\t\t\t\t\telf = fm.getUI().offset(),\n\t\t\t\t\tw = Math.min(width, win.width()-10),\n\t\t\t\t\th = Math.min(height, win.height()-80);\n\t\t\t\treturn {\n\t\t\t\t\topacity : 1,\n\t\t\t\t\twidth  : w,\n\t\t\t\t\theight : h,\n\t\t\t\t\ttop    : parseInt((win.height() - h - 60) / 2 + (contain? 0 : win.scrollTop() - elf.top)),\n\t\t\t\t\tleft   : parseInt((win.width() - w) / 2 + (contain? 0 : win.scrollLeft() - elf.left))\n\t\t\t\t};\n\t\t\t},\n\t\t\t\n\t\t\tmediaNode = {},\n\t\t\tsupport = function(codec, name) {\n\t\t\t\tvar node  = name || codec.substr(0, codec.indexOf('/')),\n\t\t\t\t\tmedia = mediaNode[node]? mediaNode[node] : (mediaNode[node] = document.createElement(node)),\n\t\t\t\t\tvalue = false;\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tvalue = media.canPlayType && media.canPlayType(codec);\n\t\t\t\t} catch(e) {}\n\t\t\t\t\n\t\t\t\treturn (value && value !== '' && value != 'no')? true : false;\n\t\t\t},\n\t\t\t\n\t\t\tplatformWin = (window.navigator.platform.indexOf('Win') != -1),\n\t\t\t\n\t\t\t/**\n\t\t\t * Opened window width (from config)\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\twidth, \n\t\t\t/**\n\t\t\t * Opened window height (from config)\n\t\t\t *\n\t\t\t * @type Number\n\t\t\t **/\n\t\t\theight, \n\t\t\t/**\n\t\t\t * Previous style before docked\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tprevStyle,\n\t\t\t/**\n\t\t\t * elFinder node\n\t\t\t *\n\t\t\t * @type jQuery\n\t\t\t **/\n\t\t\tparent, \n\t\t\t/**\n\t\t\t * elFinder current directory node\n\t\t\t *\n\t\t\t * @type jQuery\n\t\t\t **/\n\t\t\tcwd, \n\t\t\t/**\n\t\t\t * Current directory hash\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tcwdHash,\n\t\t\tdockEnabled = false,\n\t\t\tnavdrag = false,\n\t\t\tnavmove = false,\n\t\t\tnavtm   = null,\n\t\t\tleftKey = $.ui.keyCode.LEFT,\n\t\t\trightKey = $.ui.keyCode.RIGHT,\n\t\t\tcoverEv = 'mousemove touchstart ' + ('onwheel' in document? 'wheel' : 'onmousewheel' in document? 'mousewheel' : 'DOMMouseScroll'),\n\t\t\ttitle   = $('<span class=\"elfinder-dialog-title elfinder-quicklook-title\"/>'),\n\t\t\ticon    = $('<div/>'),\n\t\t\tinfo    = $('<div class=\"elfinder-quicklook-info\"/>'),//.hide(),\n\t\t\tcover   = $('<div class=\"ui-front elfinder-quicklook-cover\"/>'),\n\t\t\tfsicon  = $('<div class=\"'+navicon+' '+navicon+'-fullscreen\"/>')\n\t\t\t\t.on('click touchstart', function(e) {\n\t\t\t\t\tif (navmove) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar win     = self.window,\n\t\t\t\t\t\tfull    = win.hasClass(fullscreen),\n\t\t\t\t\t\t$window = $(window),\n\t\t\t\t\t\tresize  = function() { self.preview.trigger('changesize'); };\n\t\t\t\t\t\t\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\n\t\t\t\t\tif (full) {\n\t\t\t\t\t\tnavStyle = '';\n\t\t\t\t\t\tnavShow();\n\t\t\t\t\t\twin.toggleClass(fullscreen)\n\t\t\t\t\t\t.css(win.data('position'));\n\t\t\t\t\t\t$window.trigger(self.resize).off(self.resize, resize);\n\t\t\t\t\t\tnavbar.off('mouseenter mouseleave');\n\t\t\t\t\t\tcover.off(coverEv);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twin.toggleClass(fullscreen)\n\t\t\t\t\t\t.data('position', {\n\t\t\t\t\t\t\tleft   : win.css('left'), \n\t\t\t\t\t\t\ttop    : win.css('top'), \n\t\t\t\t\t\t\twidth  : win.width(), \n\t\t\t\t\t\t\theight : win.height(),\n\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.removeAttr('style');\n\n\t\t\t\t\t\t$(window).on(self.resize, resize)\n\t\t\t\t\t\t.trigger(self.resize);\n\n\t\t\t\t\t\tcover.on(coverEv, function(e) {\n\t\t\t\t\t\t\tif (! navdrag) {\n\t\t\t\t\t\t\t\tif (e.type === 'mousemove' || e.type === 'touchstart') {\n\t\t\t\t\t\t\t\t\tnavShow();\n\t\t\t\t\t\t\t\t\tnavtm = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tif (fm.UA.Mobile || navbar.parent().find('.elfinder-quicklook-navbar:hover').length < 1) {\n\t\t\t\t\t\t\t\t\t\t\tnavbar.fadeOut('slow', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tcover.show();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, 3000);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (cover.is(':visible')) {\n\t\t\t\t\t\t\t\t\tcoverHide();\n\t\t\t\t\t\t\t\t\tcover.data('tm', setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tcover.show();\n\t\t\t\t\t\t\t\t\t}, 3000));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).show().trigger('mousemove');\n\t\t\t\t\t\t\n\t\t\t\t\t\tnavbar.on('mouseenter mouseleave', function(e) {\n\t\t\t\t\t\t\tif (! navdrag) {\n\t\t\t\t\t\t\t\tif (e.type === 'mouseenter') {\n\t\t\t\t\t\t\t\t\tnavShow();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcover.trigger('mousemove');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (fm.zIndex) {\n\t\t\t\t\t\twin.css('z-index', fm.zIndex + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (fm.UA.Mobile) {\n\t\t\t\t\t\tnavbar.attr('style', navStyle);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavbar.attr('style', navStyle).draggable(full ? 'destroy' : {\n\t\t\t\t\t\t\tstart: function() {\n\t\t\t\t\t\t\t\tnavdrag = true;\n\t\t\t\t\t\t\t\tnavmove = true;\n\t\t\t\t\t\t\t\tcover.show();\n\t\t\t\t\t\t\t\tnavShow();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstop: function() {\n\t\t\t\t\t\t\t\tnavdrag = false;\n\t\t\t\t\t\t\t\tnavStyle = self.navbar.attr('style');\n\t\t\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t\tnavmove = false;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$(this).toggleClass(navicon+'-fullscreen-off');\n\t\t\t\t\tvar collection = win;\n\t\t\t\t\tif (parent.is('.ui-resizable')) {\n\t\t\t\t\t\tcollection = collection.add(parent);\n\t\t\t\t\t}\n\t\t\t\t\tcollection.resizable(full ? 'enable' : 'disable').removeClass('ui-state-disabled');\n\n\t\t\t\t\twin.trigger('viewchange');\n\t\t\t\t}\n\t\t\t),\n\t\t\t\n\t\t\tupdateOnSel = function() {\n\t\t\t\tself.update(void(0), (function() {\n\t\t\t\t\tvar fm = self.fm,\n\t\t\t\t\t\tfiles = fm.selectedFiles(),\n\t\t\t\t\t\tcnt = files.length,\n\t\t\t\t\t\tinDock = self.docked(),\n\t\t\t\t\t\tgetInfo = function() {\n\t\t\t\t\t\t\tvar ts = 0;\n\t\t\t\t\t\t\t$.each(files, function(i, f) {\n\t\t\t\t\t\t\t\tvar t = parseInt(f.ts);\n\t\t\t\t\t\t\t\tif (ts >= 0) {\n\t\t\t\t\t\t\t\t\tif (t > ts) {\n\t\t\t\t\t\t\t\t\t\tts = t;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tts = 'unknown';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\thash : files[0].hash  + '/' + (+new Date()),\n\t\t\t\t\t\t\t\tname : fm.i18n('items') + ': ' + cnt,\n\t\t\t\t\t\t\t\tmime : 'group',\n\t\t\t\t\t\t\t\tsize : spinner,\n\t\t\t\t\t\t\t\tts   : ts,\n\t\t\t\t\t\t\t\tfiles : $.map(files, function(f) { return f.hash; }),\n\t\t\t\t\t\t\t\tgetSize : true\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t};\n\t\t\t\t\tif (! cnt) {\n\t\t\t\t\t\tcnt = 1;\n\t\t\t\t\t\tfiles = [fm.cwd()];\n\t\t\t\t\t}\n\t\t\t\t\treturn (cnt === 1)? files[0] : getInfo();\n\t\t\t\t})());\n\t\t\t},\n\t\t\t\n\t\t\tnavShow = function() {\n\t\t\t\tif (self.window.hasClass(fullscreen)) {\n\t\t\t\t\tnavtm && clearTimeout(navtm);\n\t\t\t\t\tnavtm = null;\n\t\t\t\t\t// if use `show()` it make infinite loop with old jQuery (jQuery/jQuery UI: 1.8.0/1.9.0)\n\t\t\t\t\t// see #1478 https://github.com/Studio-42/elFinder/issues/1478\n\t\t\t\t\tnavbar.stop(true, true).css('display', 'block');\n\t\t\t\t\tcoverHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\tcoverHide = function() {\n\t\t\t\tcover.data('tm') && clearTimeout(cover.data('tm'));\n\t\t\t\tcover.removeData('tm');\n\t\t\t\tcover.hide();\n\t\t\t},\n\t\t\t\t\n\t\t\tprev = $('<div class=\"'+navicon+' '+navicon+'-prev\"/>').on('click touchstart', function(e) { ! navmove && navtrigger(leftKey); return false; }),\n\t\t\tnext = $('<div class=\"'+navicon+' '+navicon+'-next\"/>').on('click touchstart', function(e) { ! navmove && navtrigger(rightKey); return false; }),\n\t\t\tnavbar  = $('<div class=\"elfinder-quicklook-navbar\"/>')\n\t\t\t\t.append(prev)\n\t\t\t\t.append(fsicon)\n\t\t\t\t.append(next)\n\t\t\t\t.append('<div class=\"elfinder-quicklook-navbar-separator\"/>')\n\t\t\t\t.append($('<div class=\"'+navicon+' '+navicon+'-close\"/>').on('click touchstart', function(e) { ! navmove && self.window.trigger('close'); return false; }))\n\t\t\t,\n\t\t\ttitleClose = $('<span class=\"ui-front ui-icon elfinder-icon-close ui-icon-closethick\"/>').on('mousedown', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tself.window.trigger('close');\n\t\t\t}),\n\t\t\ttitleDock = $('<span class=\"ui-front ui-icon elfinder-icon-minimize ui-icon-minusthick\"/>').on('mousedown', function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tif (! self.docked()) {\n\t\t\t\t\tself.window.trigger('navdockin');\n\t\t\t\t} else {\n\t\t\t\t\tself.window.trigger('navdockout');\n\t\t\t\t}\n\t\t\t}),\n\t\t\tspinner = '<span class=\"elfinder-spinner-text\">' + fm.i18n('calc') + '</span>' + '<span class=\"elfinder-spinner\"/>',\n\t\t\tnavStyle = '',\n\t\t\tinit = true,\n\t\t\tdockHeight,\tgetSize, tm4cwd, dockedNode, selectTm;\n\n\t\t/**\n\t\t * Any flags for each plugin\n\t\t */\n\t\tthis.flags = {};\n\t\t\n\t\tthis.cover = cover;\n\t\tthis.evUpdate = evUpdate;\n\t\t(this.navbar = navbar)._show = navShow;\n\t\tthis.resize = 'resize.'+fm.namespace;\n\t\tthis.info = $('<div/>').addClass(infocls)\n\t\t\t.append(icon)\n\t\t\t.append(info);\n\t\tthis.autoPlay = function() {\n\t\t\tif (self.opened()) {\n\t\t\t\treturn !! self.options[self.docked()? 'dockAutoplay' : 'autoplay'];\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis.preview = $('<div class=\"elfinder-quicklook-preview ui-helper-clearfix\"/>')\n\t\t\t// clean info/icon\n\t\t\t.on('change', function() {\n\t\t\t\tnavShow();\n\t\t\t\tnavbar.attr('style', navStyle);\n\t\t\t\tself.docked() && navbar.hide();\n\t\t\t\tself.preview.attr('style', '').removeClass('elfinder-overflow-auto');\n\t\t\t\tself.info.attr('style', '').hide();\n\t\t\t\tself.cover.removeClass('elfinder-quicklook-coverbg');\n\t\t\t\ticon.removeAttr('class').attr('style', '');\n\t\t\t\tinfo.html('');\n\t\t\t})\n\t\t\t// update info/icon\n\t\t\t.on(evUpdate, function(e) {\n\t\t\t\tvar preview = self.preview,\n\t\t\t\t\tfile    = e.file,\n\t\t\t\t\ttpl     = '<div class=\"elfinder-quicklook-info-data\">{value}</div>',\n\t\t\t\t\tupdate  = function() {\n\t\t\t\t\t\tvar win = self.window.css('overflow', 'hidden');\n\t\t\t\t\t\tname = fm.escape(file.i18 || file.name);\n\t\t\t\t\t\t!file.read && e.stopImmediatePropagation();\n\t\t\t\t\t\tself.window.data('hash', file.hash);\n\t\t\t\t\t\tself.preview.off('changesize').trigger('change').children().remove();\n\t\t\t\t\t\ttitle.html(name);\n\t\t\t\t\t\t\n\t\t\t\t\t\tprev.css('visibility', '');\n\t\t\t\t\t\tnext.css('visibility', '');\n\t\t\t\t\t\tif (file.hash === fm.cwdId2Hash(cwd.find('[id]:not(.elfinder-cwd-parent):first').attr('id'))) {\n\t\t\t\t\t\t\tprev.css('visibility', 'hidden');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (file.hash === fm.cwdId2Hash(cwd.find('[id]:last').attr('id'))) {\n\t\t\t\t\t\t\tnext.css('visibility', 'hidden');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (file.mime === 'directory') {\n\t\t\t\t\t\t\tgetSizeHashes = [ file.hash ];\n\t\t\t\t\t\t} else if (file.mime === 'group' && file.getSize) {\n\t\t\t\t\t\t\tgetSizeHashes = file.files;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tinfo.html(\n\t\t\t\t\t\t\ttpl.replace(/\\{value\\}/, name)\n\t\t\t\t\t\t\t+ tpl.replace(/\\{value\\}/, fm.mime2kind(file))\n\t\t\t\t\t\t\t+ tpl.replace(/\\{value\\}/, getSizeHashes.length ? spinner : fm.formatSize(file.size))\n\t\t\t\t\t\t\t+ tpl.replace(/\\{value\\}/, fm.i18n('modify')+': '+ fm.formatDate(file))\n\t\t\t\t\t\t);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (getSizeHashes.length) {\n\t\t\t\t\t\t\tgetSize = fm.getSize(getSizeHashes).done(function(data) {\n\t\t\t\t\t\t\t\tinfo.find('span.elfinder-spinner').parent().html(data.formated);\n\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\tinfo.find('span.elfinder-spinner').parent().html(fm.i18n('unknown'));\n\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\tgetSize = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tgetSize._hash = file.hash;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\ticon.addClass('elfinder-cwd-icon ui-corner-all '+fm.mime2class(file.mime));\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (file.icon) {\n\t\t\t\t\t\t\ticon.css(fm.getIconStyle(file, true));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.info.attr('class', infocls);\n\t\t\t\t\t\tif (file.csscls) {\n\t\t\t\t\t\t\tself.info.addClass(file.csscls);\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\tif (file.read && (tmb = fm.tmb(file))) {\n\t\t\t\t\t\t\t$('<img/>')\n\t\t\t\t\t\t\t\t.hide()\n\t\t\t\t\t\t\t\t.appendTo(self.preview)\n\t\t\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\t\t\ticon.addClass(tmb.className).css('background-image', \"url('\"+tmb.url+\"')\");\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.attr('src', tmb.url);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.info.delay(100).fadeIn(10);\n\t\t\t\t\t\tif (self.window.hasClass(fullscreen)) {\n\t\t\t\t\t\t\tcover.trigger('mousemove');\n\t\t\t\t\t\t}\n\t\t\t\t\t\twin.css('overflow', '');\n\t\t\t\t\t},\n\t\t\t\t\ttmb, name, getSizeHashes = [];\n\n\t\t\t\tif (file && ! Object.keys(file).length) {\n\t\t\t\t\tfile = fm.cwd();\n\t\t\t\t}\n\t\t\t\tif (file && getSize && getSize.state() === 'pending' && getSize._hash !== file.hash) {\n\t\t\t\t\tgetSize.reject();\n\t\t\t\t}\n\t\t\t\tif (file && (e.forceUpdate || self.window.data('hash') !== file.hash)) {\n\t\t\t\t\tupdate();\n\t\t\t\t} else { \n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t});\n\n\t\tthis.window = $('<div class=\"ui-front ui-helper-reset ui-widget elfinder-quicklook touch-punch\" style=\"position:absolute\"/>')\n\t\t\t.hide()\n\t\t\t.addClass(fm.UA.Touch? 'elfinder-touch' : '')\n\t\t\t.on('click', function(e) {\n\t\t\t\tvar win = this;\n\t\t\t\te.stopPropagation();\n\t\t\t\tif (state === opened) {\n\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\tstate === opened && fm.toFront(win);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.append(\n\t\t\t\t$('<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-top ui-helper-clearfix elfinder-quicklook-titlebar\"/>')\n\t\t\t\t.append(\n\t\t\t\t\t$('<span class=\"ui-widget-header ui-dialog-titlebar-close ui-corner-all elfinder-titlebar-button elfinder-quicklook-titlebar-icon'+(platformWin? ' elfinder-titlebar-button-right' : '')+'\"/>').append(\n\t\t\t\t\t\ttitleClose, titleDock\n\t\t\t\t\t),\n\t\t\t\t\ttitle\n\t\t\t\t),\n\t\t\t\tthis.preview,\n\t\t\t\tself.info.hide(),\n\t\t\t\tcover.hide(),\n\t\t\t\tnavbar\n\t\t\t)\n\t\t\t.draggable({handle : 'div.elfinder-quicklook-titlebar'})\n\t\t\t.on('open', function(e, clcss) {\n\t\t\t\tvar win  = self.window, \n\t\t\t\t\tfile = self.value,\n\t\t\t\t\tnode = fm.getUI('cwd'),\n\t\t\t\t\topen = function(status) {\n\t\t\t\t\t\tstate = status;\n\t\t\t\t\t\tself.update(1, self.value);\n\t\t\t\t\t\tself.change();\n\t\t\t\t\t\twin.trigger('resize.' + fm.namespace);\n\t\t\t\t\t};\n\n\t\t\t\tif (!init && state === closed) {\n\t\t\t\t\tif (file && file.hash !== cwdHash) {\n\t\t\t\t\t\tnode = fm.cwdHash2Elm(file.hash.split('/', 2)[0]);\n\t\t\t\t\t}\n\t\t\t\t\tnavStyle = '';\n\t\t\t\t\tnavbar.attr('style', '');\n\t\t\t\t\tstate = animated;\n\t\t\t\t\tnode.trigger('scrolltoview');\n\t\t\t\t\tcoverHide();\n\t\t\t\t\twin.css(clcss || closedCss(node))\n\t\t\t\t\t\t.show()\n\t\t\t\t\t\t.animate(openedCss(), 550, function() {\n\t\t\t\t\t\t\topen(opened);\n\t\t\t\t\t\t\tnavShow();\n\t\t\t\t\t\t});\n\t\t\t\t\tfm.toFront(win);\n\t\t\t\t} else if (state === dockedhidden) {\n\t\t\t\t\tfm.getUI('navdock').data('addNode')(dockedNode);\n\t\t\t\t\topen(docked);\n\t\t\t\t\tself.preview.trigger('changesize');\n\t\t\t\t\tfm.storage('previewDocked', '1');\n\t\t\t\t\tif (fm.getUI('navdock').width() === 0) {\n\t\t\t\t\t\twin.trigger('navdockout');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('close', function(e, dfd) {\n\t\t\t\tvar win     = self.window,\n\t\t\t\t\tpreview = self.preview.trigger('change'),\n\t\t\t\t\tfile    = self.value,\n\t\t\t\t\thash    = (win.data('hash') || '').split('/', 2)[0],\n\t\t\t\t\tclose   = function(status, winhide) {\n\t\t\t\t\t\tstate = status;\n\t\t\t\t\t\twinhide && fm.toHide(win);\n\t\t\t\t\t\tpreview.children().remove();\n\t\t\t\t\t\tself.update(0, self.value);\n\t\t\t\t\t\twin.data('hash', '');\n\t\t\t\t\t\tdfd && dfd.resolve();\n\t\t\t\t\t},\n\t\t\t\t\tnode;\n\t\t\t\t\t\n\t\t\t\tif (self.opened()) {\n\t\t\t\t\tgetSize && getSize.state() === 'pending' && getSize.reject();\n\t\t\t\t\tif (! self.docked()) {\n\t\t\t\t\t\tstate = animated;\n\t\t\t\t\t\twin.hasClass(fullscreen) && fsicon.click();\n\t\t\t\t\t\t(hash && (node = cwd.find('#'+hash)).length)\n\t\t\t\t\t\t\t? win.animate(closedCss(node), 500, function() {\n\t\t\t\t\t\t\t\tpreview.off('changesize');\n\t\t\t\t\t\t\t\tclose(closed, true);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t: close(closed, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdockedNode = fm.getUI('navdock').data('removeNode')(self.window.attr('id'), 'detach');\n\t\t\t\t\t\tclose(dockedhidden);\n\t\t\t\t\t\tfm.storage('previewDocked', '2');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('navdockin', function(e, data) {\n\t\t\t\tvar w      = self.window,\n\t\t\t\t\tbox    = fm.getUI('navdock'),\n\t\t\t\t\theight = dockHeight || box.width(),\n\t\t\t\t\topts   = data || {};\n\t\t\t\t\n\t\t\t\tif (init) {\n\t\t\t\t\topts.init = true;\n\t\t\t\t}\n\t\t\t\tstate = docked;\n\t\t\t\tprevStyle = w.attr('style');\n\t\t\t\tw.toggleClass('ui-front').removeClass('ui-widget').draggable('disable').resizable('disable').removeAttr('style').css({\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\theight: height,\n\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t\tpaddingBottom: 0,\n\t\t\t\t\tzIndex: 'unset'\n\t\t\t\t});\n\t\t\t\tnavbar.hide();\n\t\t\t\ttitleDock.toggleClass('ui-icon-plusthick ui-icon-minusthick elfinder-icon-full elfinder-icon-minimize');\n\t\t\t\t\n\t\t\t\tfm.toHide(w, true);\n\t\t\t\tbox.data('addNode')(w, opts);\n\t\t\t\t\n\t\t\t\tself.preview.trigger('changesize');\n\t\t\t\t\n\t\t\t\tfm.storage('previewDocked', '1');\n\t\t\t})\n\t\t\t.on('navdockout', function(e) {\n\t\t\t\tvar w   = self.window,\n\t\t\t\t\tbox = fm.getUI('navdock'),\n\t\t\t\t\tdfd = $.Deferred(),\n\t\t\t\t\tclcss = closedCss(self.preview);\n\t\t\t\t\n\t\t\t\tdockHeight = w.outerHeight();\n\t\t\t\tbox.data('removeNode')(w.attr('id'), fm.getUI());\n\t\t\t\tw.toggleClass('ui-front').addClass('ui-widget').draggable('enable').resizable('enable').attr('style', prevStyle);\n\t\t\t\ttitleDock.toggleClass('ui-icon-plusthick ui-icon-minusthick elfinder-icon-full elfinder-icon-minimize');\n\t\t\t\t\n\t\t\t\tstate = closed;\n\t\t\t\tw.trigger('open', clcss);\n\t\t\t\t\n\t\t\t\tfm.storage('previewDocked', '0');\n\t\t\t})\n\t\t\t.on('resize.' + fm.namespace, function() {\n\t\t\t\tself.preview.trigger('changesize'); \n\t\t\t});\n\n\t\t/**\n\t\t * This command cannot be disable by backend\n\t\t *\n\t\t * @type Boolean\n\t\t **/\n\t\tthis.alwaysEnabled = true;\n\t\t\n\t\t/**\n\t\t * Selected file\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis.value = null;\n\t\t\n\t\tthis.handlers = {\n\t\t\t// save selected file\n\t\t\tselect : function(e, d) {\n\t\t\t\tselectTm && cancelAnimationFrame(selectTm);\n\t\t\t\tif (! e.data || ! e.data.selected || ! e.data.selected.length) {\n\t\t\t\t\tselectTm = requestAnimationFrame(function() {\n\t\t\t\t\t\tself.opened() && updateOnSel();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tself.opened() && updateOnSel();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror  : function() { self.window.is(':visible') && self.window.trigger('close'); },\n\t\t\t'searchshow searchhide' : function() { this.opened() && this.window.trigger('close'); },\n\t\t\tnavbarshow : function() {\n\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\tself.docked() && self.preview.trigger('changesize');\n\t\t\t\t});\n\t\t\t},\n\t\t\tdestroy : function() { self.window.remove(); }\n\t\t};\n\t\t\n\t\tthis.shortcuts = [{\n\t\t\tpattern     : 'space'\n\t\t}];\n\t\t\n\t\tthis.support = {\n\t\t\taudio : {\n\t\t\t\togg : support('audio/ogg;'),\n\t\t\t\twebm: support('audio/webm;'),\n\t\t\t\tmp3 : support('audio/mpeg;'),\n\t\t\t\twav : support('audio/wav;'),\n\t\t\t\tm4a : support('audio/mp4;') || support('audio/x-m4a;') || support('audio/aac;'),\n\t\t\t\tflac: support('audio/flac;'),\n\t\t\t\tamr : support('audio/amr;')\n\t\t\t},\n\t\t\tvideo : {\n\t\t\t\togg  : support('video/ogg;'),\n\t\t\t\twebm : support('video/webm;'),\n\t\t\t\tmp4  : support('video/mp4;'),\n\t\t\t\tmkv  : support('video/x-matroska;') || support('video/webm;'),\n\t\t\t\t'3gp': support('video/3gpp;') || support('video/mp4;'), // try as mp4\n\t\t\t\tm3u8 : support('application/x-mpegURL', 'video') || support('application/vnd.apple.mpegURL', 'video'),\n\t\t\t\tmpd  : support('application/dash+xml', 'video')\n\t\t\t}\n\t\t};\n\t\t// for GC\n\t\tmediaNode = {};\n\t\t\n\t\t/**\n\t\t * Return true if quickLoock window is hiddenReturn true if quickLoock window is visible and not animated\n\t\t *\n\t\t * @return Boolean\n\t\t **/\n\t\tthis.closed = function() {\n\t\t\treturn (state == closed || state == dockedhidden);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if quickLoock window is visible and not animated\n\t\t *\n\t\t * @return Boolean\n\t\t **/\n\t\tthis.opened = function() {\n\t\t\treturn state == opened || state == docked;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if quickLoock window is in NavDock\n\t\t *\n\t\t * @return Boolean\n\t\t **/\n\t\tthis.docked = function() {\n\t\t\treturn state == docked;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Adds an integration into help dialog.\n\t\t *\n\t\t * @param Object opts  options\n\t\t */\n\t\tthis.addIntegration = function(opts) {\n\t\t\trequestAnimationFrame(function() {\n\t\t\t\tfm.trigger('helpIntegration', Object.assign({cmd: 'quicklook'}, opts));\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Init command.\n\t\t * Add default plugins and init other plugins\n\t\t *\n\t\t * @return Object\n\t\t **/\n\t\tthis.init = function() {\n\t\t\tvar o       = this.options, \n\t\t\t\twin     = this.window,\n\t\t\t\tpreview = this.preview,\n\t\t\t\ti, p, cwdDispInlineRegex;\n\t\t\t\n\t\t\twidth  = o.width  > 0 ? parseInt(o.width)  : 450;\t\n\t\t\theight = o.height > 0 ? parseInt(o.height) : 300;\n\t\t\tif (o.dockHeight !== 'auto') {\n\t\t\t\tdockHeight = parseInt(o.dockHeight);\n\t\t\t\tif (! dockHeight) {\n\t\t\t\t\tdockHeight = void(0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfm.one('load', function() {\n\t\t\t\t\n\t\t\t\tdockEnabled = fm.getUI('navdock').data('dockEnabled');\n\t\t\t\t\n\t\t\t\t! dockEnabled && titleDock.hide();\n\t\t\t\t\n\t\t\t\tparent = fm.getUI();\n\t\t\t\tcwd    = fm.getUI('cwd');\n\n\t\t\t\tif (fm.zIndex) {\n\t\t\t\t\twin.css('z-index', fm.zIndex + 1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\twin.appendTo(parent);\n\t\t\t\t\n\t\t\t\t// close window on escape\n\t\t\t\t$(document).on('keydown.'+fm.namespace, function(e) {\n\t\t\t\t\te.keyCode == $.ui.keyCode.ESCAPE && self.opened() && ! self.docked() && win.hasClass('elfinder-frontmost') && win.trigger('close');\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\twin.resizable({ \n\t\t\t\t\thandles   : 'se', \n\t\t\t\t\tminWidth  : 350, \n\t\t\t\t\tminHeight : 120, \n\t\t\t\t\tresize    : function() { \n\t\t\t\t\t\t// use another event to avoid recursion in fullscreen mode\n\t\t\t\t\t\t// may be there is clever solution, but i cant find it :(\n\t\t\t\t\t\tpreview.trigger('changesize'); \n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tself.change(function() {\n\t\t\t\t\tif (self.opened()) {\n\t\t\t\t\t\tif (self.value) {\n\t\t\t\t\t\t\tif (self.value.tmb && self.value.tmb == 1) {\n\t\t\t\t\t\t\t\t// try re-get file object\n\t\t\t\t\t\t\t\tself.value = Object.assign({}, fm.file(self.value.hash));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpreview.trigger($.Event(evUpdate, {file : self.value}));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tpreview.on(evUpdate, function(e) {\n\t\t\t\t\tvar file, hash, serach;\n\t\t\t\t\t\n\t\t\t\t\tif (file = e.file) {\n\t\t\t\t\t\thash = file.hash;\n\t\t\t\t\t\tserach = (fm.searchStatus.mixed && fm.searchStatus.state > 1);\n\t\t\t\t\t\n\t\t\t\t\t\tif (file.mime !== 'directory') {\n\t\t\t\t\t\t\tif (parseInt(file.size) || file.mime.match(o.mimeRegexNotEmptyCheck)) {\n\t\t\t\t\t\t\t\t// set current dispInlineRegex\n\t\t\t\t\t\t\t\tself.dispInlineRegex = cwdDispInlineRegex;\n\t\t\t\t\t\t\t\tif (serach || fm.optionsByHashes[hash]) {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tself.dispInlineRegex = new RegExp(fm.option('dispInlineRegex', hash), 'i');\n\t\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tself.dispInlineRegex = new RegExp(!fm.isRoot(file)? fm.option('dispInlineRegex', file.phash) : fm.options.dispInlineRegex, 'i');\n\t\t\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\t\t\tself.dispInlineRegex = /^$/;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//  do not preview of file that size = 0\n\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.dispInlineRegex = /^$/;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.info.show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$.each(fm.commands.quicklook.plugins || [], function(i, plugin) {\n\t\t\t\t\tif (typeof(plugin) == 'function') {\n\t\t\t\t\t\tnew plugin(self);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}).one('open', function() {\n\t\t\t\tvar dock = Number(fm.storage('previewDocked') || o.docked),\n\t\t\t\t\twin;\n\t\t\t\tif (dockEnabled && dock >= 1) {\n\t\t\t\t\twin = self.window;\n\t\t\t\t\tself.exec();\n\t\t\t\t\twin.trigger('navdockin', { init : true });\n\t\t\t\t\tif (dock === 2) {\n\t\t\t\t\t\twin.trigger('close');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.update(void(0), fm.cwd());\n\t\t\t\t\t\tself.change();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinit = false;\n\t\t\t}).bind('open', function() {\n\t\t\t\tcwdHash = fm.cwd().hash;\n\t\t\t\tself.value = fm.cwd();\n\t\t\t\t// set current volume dispInlineRegex\n\t\t\t\ttry {\n\t\t\t\t\tcwdDispInlineRegex = new RegExp(fm.option('dispInlineRegex'), 'i');\n\t\t\t\t} catch(e) {\n\t\t\t\t\tcwdDispInlineRegex = /^$/;\n\t\t\t\t}\n\t\t\t}).bind('change', function(e) {\n\t\t\t\tif (e.data && e.data.changed && self.opened()) {\n\t\t\t\t\t$.each(e.data.changed, function() {\n\t\t\t\t\t\tif (self.window.data('hash') === this.hash) {\n\t\t\t\t\t\t\tself.window.data('hash', null);\n\t\t\t\t\t\t\tself.preview.trigger(evUpdate);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}).bind('navdockresizestart navdockresizestop', function(e) {\n\t\t\t\tcover[e.type === 'navdockresizestart'? 'show' : 'hide']();\n\t\t\t});\n\t\t};\n\t\t\n\t\tthis.getstate = function() {\n\t\t\treturn self.opened()? 1 : 0;\n\t\t};\n\t\t\n\t\tthis.exec = function() {\n\t\t\tself.closed() && updateOnSel();\n\t\t\tself.enabled() && self.window.trigger(self.opened() ? 'close' : 'open');\n\t\t\treturn $.Deferred().resolve();\n\t\t};\n\n\t\tthis.hideinfo = function() {\n\t\t\tthis.info.stop(true, true).hide();\n\t\t};\n\n\t}).prototype = { forceLoad : true }; // this is required command\n\n\treturn elFinder;\n\n});"]}