{"version":3,"sources":["commands/quicklook.plugins.js"],"names":["define","elFinder","prototype","commands","quicklook","plugins","ql","WebP","flipMime","mimes","getDimSize","fm","returnBytes","options","getDimThreshold","preview","Image","onload","onerror","height","push","src","$","each","navigator","mimeTypes","i","o","mime","type","indexOf","inArray","on","evUpdate","e","img","loading","prog","opDfd","file","showed","dimreq","setdim","dim","rfile","hash","width","show","elm","memSize","prop","state","reject","get","w","h","naturalWidth","removeAttr","naturalHeight","toFixed","pw","parseInt","ph","Math","floor","css","trigger","fadeIn","arrayFlip","dispInlineRegex","test","stopImmediatePropagation","i18n","appendTo","info","find","hide","remove","hideinfo","openUrl","url","attr","progressBar","one","size","request","data","cmd","target","preventDefault","done","split","window","Worker","Uint8Array","base","wk","err","terminate","debug","getContents","getWorker","onmessage","res","cv","co","id","document","createElement","getContext","createImageData","set","image","putImageData","append","postMessage","scripts","cdns","tiff","getWorkerUrl","PSD","load","replaceXhrSend","fromURL","then","psd","toBase64","requestAnimationFrame","restoreXhrSend","_define","_require","UA","ltIE10","require","loadScript","jqxhr","getSizeMax","addClass","conv","_t","ts","cache","doc","contentWindow","open","write","content","close","always","marked","error","tryRequire","fail","viewerjs","opts","win","navi","navbar","setNavi","hasClass","node","pdfNative","flags","off","active","urlhash","Safari","OS","iOS","IE","Firefox","plugin","pdfToolbar","cover","update","cwd","curHash","AMR","autoplay","audio/mpeg","audio/mpeg3","audio/mp3","audio/x-mpeg3","audio/x-mp3","audio/x-wav","audio/wav","audio/x-m4a","audio/aac","audio/mp4","audio/x-mp4","audio/ogg","audio/webm","audio/flac","audio/x-flac","audio/amr","controlsList","mediaControlsList","escape","getNode","stopPropagation","reset","play","player","playPromise","paused","parent","length","children","pause","empty","match","URL","revokeObjectURL","html5","_AMR","dfd","loader","support","audio","autoPlay","amr","Deferred","buffer","toWAV","resolve","createObjectURL","Blob","TextEncoder","cHls","cDash","pDash","cFlv","cVideojs","tm","video/mp4","video/x-m4v","video/quicktime","video/mpeg","video/ogg","application/ogg","video/webm","video/x-matroska","video/3gpp","application/vnd.apple.mpegurl","application/x-mpegurl","application/dash+xml","video/x-flv","video/x-msvideo","_show","render","canPlay","errTm","clearTimeout","setTimeout","addEventListener","convAbsUrl","loadHls","hls","loadSource","attachMedia","Events","MANIFEST_PARSED","loadDash","dashjs","MediaPlayer","create","getDebug","setLogLevel","Debug","LOG_LEVEL_FATAL","setLogToBrowserConsole","initialize","loadFlv","isSupported","createPlayer","ERROR","destroy","attachMediaElement","loadVideojs","showInfo","stock","toLowerCase","video","Hls","dash","flv","flvjs","videojs","loadCss","sizeMax","unzipMaxSize","Zlib","zlibUnzip","zlibGunzip","bzip2","DataView","isTar","isBzip2","isZlib","makeList","filenames","header","list","tsize","map","str","decodeRawString","sort","join","replace","m","s","formatSize","this","direction","originalEvent","_preventSwipeX","Error","files","bin","RAR","rar","archive","abort","_RAR","getList","xhrHeaders","customHeaders","xhrFields","entries","path","RarArchive","hasRequire","temporary","sharecadMimes","addIntegration","title","link","option","self","html","forceUpdate","after","encodeURIComponent","gMaps","loadMap","wGmfail","mapScr","application/vnd.google-earth.kml+xml","application/vnd.google-earth.kmz","googleMapsApiKey","lang","google","maps","mapsOpts","googleMapsOpts","forExternalUrl","KmlLayer","Object","assign","Map","kml","gm_authFailure","getLink","enable","googleDocsMimes","officeOnlineMimes","urls","g","navBottom","mLimits","xls","xlsb","xlsx","xlsm","other","ext","status","PR","_PR","textLines","textInitialLines","prettifyLines","prettifyMaxLines","prettify","PRcheck","wPR","exec","prettyPrint","encSelect","mimeIsText","encoding","part","more","lines","reg","RegExp","text","atob","substr","splice","toLocaleString","top","scrollTop","removeClass","toasts","Array","isArray","msg","toast","cmdEdit","sel","head","getCommand","value","getEncSelect","val"],"mappings":"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","file":"../../commands/quicklook.plugins.js","sourcesContent":["define([\n\t\"../elFinder\"\n],function(elFinder){\n\telFinder.prototype.commands.quicklook.plugins = [\n\t\t\n\t\t/**\n\t\t * Images preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar mimes   = ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml', 'image/x-ms-bmp'],\n\t\t\t\tgetDimSize = ql.fm.returnBytes((ql.options.getDimThreshold || 0)),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tWebP, flipMime;\n\t\t\t\n\t\t\t// webp support\n\t\t\tWebP = new Image();\n\t\t\tWebP.onload = WebP.onerror = function() {\n\t\t\t\tif (WebP.height == 2) {\n\t\t\t\t\tmimes.push('image/webp');\n\t\t\t\t}\n\t\t\t};\n\t\t\tWebP.src='data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';\n\t\t\t\n\t\t\t// what kind of images we can display\n\t\t\t$.each(navigator.mimeTypes, function(i, o) {\n\t\t\t\tvar mime = o.type;\n\t\t\t\t\n\t\t\t\tif (mime.indexOf('image/') === 0 && $.inArray(mime, mimes)) {\n\t\t\t\t\tmimes.push(mime);\n\t\t\t\t} \n\t\t\t});\n\t\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar fm   = ql.fm,\n\t\t\t\t\tfile = e.file,\n\t\t\t\t\tshowed = false,\n\t\t\t\t\tdimreq = null,\n\t\t\t\t\tsetdim  = function(dim) {\n\t\t\t\t\t\tvar rfile = fm.file(file.hash);\n\t\t\t\t\t\trfile.width = dim[0];\n\t\t\t\t\t\trfile.height = dim[1];\n\t\t\t\t\t},\n\t\t\t\t\tshow = function() {\n\t\t\t\t\t\tvar elm, varelm, memSize, width, height, prop;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdimreq && dimreq.state && dimreq.state() === 'pending' && dimreq.reject();\n\t\t\t\t\t\tif (showed) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tshowed = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\telm = img.get(0);\n\t\t\t\t\t\tmemSize = file.width && file.height? {w: file.width, h: file.height} : (elm.naturalWidth? null : {w: img.width(), h: img.height()});\n\t\t\t\t\t\n\t\t\t\t\t\tmemSize && img.removeAttr('width').removeAttr('height');\n\t\t\t\t\t\t\n\t\t\t\t\t\twidth  = file.width || elm.naturalWidth || elm.width || img.width();\n\t\t\t\t\t\theight = file.height || elm.naturalHeight || elm.height || img.height();\n\t\t\t\t\t\tif (!file.width || !file.height) {\n\t\t\t\t\t\t\tsetdim([width, height]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tmemSize && img.width(memSize.w).height(memSize.h);\n\n\t\t\t\t\t\tprop = (width/height).toFixed(2);\n\t\t\t\t\t\tpreview.on('changesize', function() {\n\t\t\t\t\t\t\tvar pw = parseInt(preview.width()),\n\t\t\t\t\t\t\t\tph = parseInt(preview.height()),\n\t\t\t\t\t\t\t\tw, h;\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (prop < (pw/ph).toFixed(2)) {\n\t\t\t\t\t\t\t\th = ph;\n\t\t\t\t\t\t\t\tw = Math.floor(h * prop);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tw = pw;\n\t\t\t\t\t\t\t\th = Math.floor(w/prop);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\timg.width(w).height(h).css('margin-top', h < ph ? Math.floor((ph - h)/2) : 0);\n\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.trigger('changesize');\n\t\t\t\t\t\t\n\t\t\t\t\t\t//show image\n\t\t\t\t\t\timg.fadeIn(100);\n\t\t\t\t\t},\n\t\t\t\t\thideInfo = function() {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t// hide info/icon\n\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t},\n\t\t\t\t\turl, img, loading, prog, m, opDfd;\n\n\t\t\t\tif (!flipMime) {\n\t\t\t\t\tflipMime = fm.arrayFlip(mimes);\n\t\t\t\t}\n\t\t\t\tif (flipMime[file.mime] && ql.dispInlineRegex.test(file.mime)) {\n\t\t\t\t\t// this is our file - stop event propagation\n\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\n\t\t\t\t\timg = $('<img/>')\n\t\t\t\t\t\t.hide()\n\t\t\t\t\t\t.appendTo(preview)\n\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\thideInfo();\n\t\t\t\t\t\t\tshow();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('error', function() {\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t});\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\timg.attr('src', url);\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\n\t\t\t\t\tif (file.width && file.height) {\n\t\t\t\t\t\tshow();\n\t\t\t\t\t} else if (file.size > getDimSize) {\n\t\t\t\t\t\tdimreq = fm.request({\n\t\t\t\t\t\t\tdata : {cmd : 'dim', target : file.hash},\n\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\tif (data.dim) {\n\t\t\t\t\t\t\t\tvar dim = data.dim.split('x');\n\t\t\t\t\t\t\t\tfile.width = dim[0];\n\t\t\t\t\t\t\t\tfile.height = dim[1];\n\t\t\t\t\t\t\t\tsetdim(dim);\n\t\t\t\t\t\t\t\tshow();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * TIFF image preview\n\t\t *\n\t\t * @param  object  ql  elFinder.commands.quicklook\n\t\t */\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm   = ql.fm,\n\t\t\t\tmime = 'image/tiff',\n\t\t\t\tpreview = ql.preview;\n\t\t\tif (window.Worker && window.Uint8Array) {\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file = e.file,\n\t\t\t\t\t\terr = function(e) {\n\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\tfm.debug('error', e);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsetdim = function(dim) {\n\t\t\t\t\t\t\tvar rfile = fm.file(file.hash);\n\t\t\t\t\t\t\trfile.width = dim[0];\n\t\t\t\t\t\t\trfile.height = dim[1];\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloading, prog, url, base, wk, opDfd;\n\t\t\t\t\tif (file.mime === mime) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\topDfd = fm.getContents(file.hash, 'arraybuffer', { progressBar: prog }).done(function(data) {\n\t\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\t\tbase = $('<div/>').css({width:'100%',height:'100%'}).hide().appendTo(preview);\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\twk = fm.getWorker();\n\t\t\t\t\t\t\t\t\twk.onmessage = function(res) {\n\t\t\t\t\t\t\t\t\t\tvar data = res.data,\n\t\t\t\t\t\t\t\t\t\t\tcv, co, id, prop;\n\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\tcv = document.createElement('canvas');\n\t\t\t\t\t\t\t\t\t\tco = cv.getContext('2d');\n\t\t\t\t\t\t\t\t\t\tcv.width = data.width;\n\t\t\t\t\t\t\t\t\t\tcv.height = data.height;\n\t\t\t\t\t\t\t\t\t\tid = co.createImageData(data.width, data.height);\n\t\t\t\t\t\t\t\t\t\t(id).data.set(new Uint8Array(data.image));\n\t\t\t\t\t\t\t\t\t\tco.putImageData(id, 0, 0);\n\t\t\t\t\t\t\t\t\t\tbase.append(cv).show();\n\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\tprop = (data.width/data.height).toFixed(2);\n\t\t\t\t\t\t\t\t\t\tpreview.on('changesize', function() {\n\t\t\t\t\t\t\t\t\t\t\tvar pw = parseInt(preview.width()),\n\t\t\t\t\t\t\t\t\t\t\t\tph = parseInt(preview.height()),\n\t\t\t\t\t\t\t\t\t\t\t\tw, h;\n\t\t\t\t\t\t\t\t\t\t\tif (prop < (pw/ph).toFixed(2)) {\n\t\t\t\t\t\t\t\t\t\t\t\th = ph;\n\t\t\t\t\t\t\t\t\t\t\t\tw = Math.floor(h * prop);\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tw = pw;\n\t\t\t\t\t\t\t\t\t\t\t\th = Math.floor(w/prop);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t$(cv).width(w).height(h).css('margin-top', h < ph ? Math.floor((ph - h)/2) : 0);\n\t\t\t\t\t\t\t\t\t\t}).trigger('changesize');\n\t\t\t\t\t\t\t\t\t\tif (!file.width || !file.height) {\n\t\t\t\t\t\t\t\t\t\t\tsetdim([data.width, data.height]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\twk.onerror = err;\n\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\tscripts: [fm.options.cdns.tiff, fm.getWorkerUrl('quicklook.tiff.js')],\n\t\t\t\t\t\t\t\t\t\tdata: { data: data }\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\terr(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\terr();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * PSD(Adobe Photoshop data) preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(['image/vnd.adobe.photoshop', 'image/x-photoshop']),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tload    = function(url, img, loading) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfm.replaceXhrSend();\n\t\t\t\t\t\tPSD.fromURL(url).then(function(psd) {\n\t\t\t\t\t\t\tvar prop;\n\t\t\t\t\t\t\timg.attr('src', psd.image.toBase64());\n\t\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\t\tprop = (img.width()/img.height()).toFixed(2);\n\t\t\t\t\t\t\t\tpreview.on('changesize', function() {\n\t\t\t\t\t\t\t\t\tvar pw = parseInt(preview.width()),\n\t\t\t\t\t\t\t\t\t\tph = parseInt(preview.height()),\n\t\t\t\t\t\t\t\t\t\tw, h;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (prop < (pw/ph).toFixed(2)) {\n\t\t\t\t\t\t\t\t\t\th = ph;\n\t\t\t\t\t\t\t\t\t\tw = Math.floor(h * prop);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tw = pw;\n\t\t\t\t\t\t\t\t\t\th = Math.floor(w/prop);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\timg.width(w).height(h).css('margin-top', h < ph ? Math.floor((ph - h)/2) : 0);\n\t\t\t\t\t\t\t\t}).trigger('changesize');\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t// hide info/icon\n\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t//show image\n\t\t\t\t\t\t\t\timg.fadeIn(100);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\timg.remove();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfm.restoreXhrSend();\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tfm.restoreXhrSend();\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\timg.remove();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tPSD;\n\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file,\n\t\t\t\t\turl, img, loading, prog, m,\n\t\t\t\t\t_define, _require, opDfd;\n\n\t\t\t\tif (mimes[file.mime] && fm.options.cdns.psd && ! fm.UA.ltIE10 && ql.dispInlineRegex.test(file.mime)) {\n\t\t\t\t\t// this is our file - stop event propagation\n\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\topDfd = fm.openUrl(file.hash, 'sameorigin', function(url) {\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\timg = $('<img/>').hide().appendTo(preview);\n\t\t\t\t\t\t\tif (PSD) {\n\t\t\t\t\t\t\t\tload(url, img, loading);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_define = window.define;\n\t\t\t\t\t\t\t\t_require = window.require;\n\t\t\t\t\t\t\t\twindow.require = null;\n\t\t\t\t\t\t\t\twindow.define = null;\n\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t[ fm.options.cdns.psd ],\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\tPSD = require('psd');\n\t\t\t\t\t\t\t\t\t\t_define? (window.define = _define) : (delete window.define);\n\t\t\t\t\t\t\t\t\t\t_require? (window.require = _require) : (delete window.require);\n\t\t\t\t\t\t\t\t\t\tload(url, img, loading);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * HTML preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(['text/html', 'application/xhtml+xml']),\n\t\t\t\tpreview = ql.preview;\n\t\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file, jqxhr, loading, prog;\n\t\t\t\t\n\t\t\t\tif (mimes[file.mime] && ql.dispInlineRegex.test(file.mime) && (!ql.options.getSizeMax || file.size <= ql.options.getSizeMax)) {\n\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\tjqxhr.state() == 'pending' && jqxhr.reject();\n\t\t\t\t\t}).addClass('elfinder-overflow-auto');\n\t\t\t\t\t\n\t\t\t\t\tjqxhr = fm.request({\n\t\t\t\t\t\tdata           : {cmd : 'get', target : file.hash, conv : 1, _t : file.ts},\n\t\t\t\t\t\toptions        : {type: 'get', cache : true},\n\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\tprogressBar    : prog\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\tvar doc = $('<iframe class=\"elfinder-quicklook-preview-html\"/>').appendTo(preview)[0].contentWindow.document;\n\t\t\t\t\t\tdoc.open();\n\t\t\t\t\t\tdoc.write(data.content);\n\t\t\t\t\t\tdoc.close();\n\t\t\t\t\t})\n\t\t\t\t\t.always(function() {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * MarkDown preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(['text/x-markdown']),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tmarked  = null,\n\t\t\t\tshow = function(data, loading) {\n\t\t\t\t\tql.hideinfo();\n\t\t\t\t\tvar doc = $('<iframe class=\"elfinder-quicklook-preview-html\"/>').appendTo(preview)[0].contentWindow.document;\n\t\t\t\t\tdoc.open();\n\t\t\t\t\tdoc.write(marked(data.content));\n\t\t\t\t\tdoc.close();\n\t\t\t\t\tloading.remove();\n\t\t\t\t},\n\t\t\t\terror = function(loading) {\n\t\t\t\t\tmarked = false;\n\t\t\t\t\tloading.remove();\n\t\t\t\t};\n\t\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file, jqxhr, loading, prog;\n\t\t\t\t\n\t\t\t\tif (mimes[file.mime] && fm.options.cdns.marked && marked !== false && ql.dispInlineRegex.test(file.mime) && (!ql.options.getSizeMax || file.size <= ql.options.getSizeMax)) {\n\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\tjqxhr.state() == 'pending' && jqxhr.reject();\n\t\t\t\t\t}).addClass('elfinder-overflow-auto');\n\t\t\t\t\t\n\t\t\t\t\tjqxhr = fm.request({\n\t\t\t\t\t\tdata           : {cmd : 'get', target : file.hash, conv : 1, _t : file.ts},\n\t\t\t\t\t\toptions        : {type: 'get', cache : true},\n\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\tprogressBar    : prog\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tif (marked || window.marked) {\n\t\t\t\t\t\t\tif (!marked) {\n\t\t\t\t\t\t\t\tmarked = window.marked;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tshow(data, loading);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfm.loadScript([fm.options.cdns.marked],\n\t\t\t\t\t\t\t\tfunction(res) { \n\t\t\t\t\t\t\t\t\tmarked = res || window.marked || false;\n\t\t\t\t\t\t\t\t\tdelete window.marked;\n\t\t\t\t\t\t\t\t\tif (marked) {\n\t\t\t\t\t\t\t\t\t\tshow(data, loading);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\terror(loading);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\t\t\t\terror(loading);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\terror(loading);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * PDF/ODT/ODS/ODP preview with ViewerJS\n\t\t * \n\t\t * @param elFinder.commands.quicklook\n\t\t */\n\t\t function(ql) {\n\t\t\tif (ql.options.viewerjs) {\n\t\t\t\tvar fm      = ql.fm,\n\t\t\t\t\tpreview = ql.preview,\n\t\t\t\t\topts    = ql.options.viewerjs,\n\t\t\t\t\tmimes   = opts.url? fm.arrayFlip(opts.mimes || []) : [],\n\t\t\t\t\twin     = ql.window,\n\t\t\t\t\tnavi    = ql.navbar,\n\t\t\t\t\tsetNavi = function() {\n\t\t\t\t\t\tnavi.css('bottom', win.hasClass('elfinder-quicklook-fullscreen')? '30px' : '');\n\t\t\t\t\t};\n\n\t\t\t\tif (opts.url) {\n\t\t\t\t\tpreview.on('update', function(e) {\n\t\t\t\t\t\tvar file = e.file, node, loading, prog, opDfd;\n\n\t\t\t\t\t\tif (mimes[file.mime] && (file.mime !== 'application/pdf' || !opts.pdfNative || !ql.flags.pdfNative)) {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t\topDfd = fm.openUrl(file.hash, 'sameorigin', function(url) {\n\t\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\t\tnode = $('<iframe class=\"elfinder-quicklook-preview-iframe\"/>')\n\t\t\t\t\t\t\t\t\t\t.css('background-color', 'transparent')\n\t\t\t\t\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\t\tnode.css('background-color', '#fff');\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.on('error', function() {\n\t\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.appendTo(preview)\n\t\t\t\t\t\t\t\t\t\t.attr('src', opts.url + '#' + url);\n\n\t\t\t\t\t\t\t\t\twin.on('viewchange.viewerjs', setNavi);\n\t\t\t\t\t\t\t\t\tsetNavi();\n\n\t\t\t\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\t\t\t\twin.off('viewchange.viewerjs');\n\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\tnode.off('load').remove();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * PDF preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmime    = 'application/pdf',\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tactive  = false,\n\t\t\t\turlhash = '',\n\t\t\t\tfirefox, toolbar;\n\t\t\t\t\n\t\t\tif ((fm.UA.Safari && fm.OS === 'mac' && !fm.UA.iOS) || fm.UA.IE || fm.UA.Firefox) {\n\t\t\t\tactive = true;\n\t\t\t} else {\n\t\t\t\t$.each(navigator.plugins, function(i, plugins) {\n\t\t\t\t\t$.each(plugins, function(i, plugin) {\n\t\t\t\t\t\tif (plugin.type === mime) {\n\t\t\t\t\t\t\treturn !(active = true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tql.flags.pdfNative = active;\n\t\t\tif (active) {\n\t\t\t\tif (typeof ql.options.pdfToolbar !== 'undefined' && !ql.options.pdfToolbar) {\n\t\t\t\t\turlhash = '#toolbar=0';\n\t\t\t\t}\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file = e.file,\n\t\t\t\t\t\topDfd;\n\t\t\t\t\t\n\t\t\t\t\tif (active && file.mime === mime && ql.dispInlineRegex.test(file.mime)) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\tql.cover.addClass('elfinder-quicklook-coverbg');\n\t\t\t\t\t\t\t\t$('<object class=\"elfinder-quicklook-preview-pdf\" data=\"'+url+urlhash+'\" type=\"application/pdf\" />')\n\t\t\t\t\t\t\t\t\t.on('error', function(e) {\n\t\t\t\t\t\t\t\t\t\tactive = false;\n\t\t\t\t\t\t\t\t\t\tql.update(void(0), fm.cwd());\n\t\t\t\t\t\t\t\t\t\tql.update(void(0), file);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Flash preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmime    = 'application/x-shockwave-flash',\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tactive  = false;\n\n\t\t\t$.each(navigator.plugins, function(i, plugins) {\n\t\t\t\t$.each(plugins, function(i, plugin) {\n\t\t\t\t\tif (plugin.type === mime) {\n\t\t\t\t\t\treturn !(active = true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tactive && preview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file,\n\t\t\t\t\tnode, opDfd;\n\t\t\t\t\t\n\t\t\t\tif (file.mime === mime && ql.dispInlineRegex.test(file.mime)) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\tnode = $('<embed class=\"elfinder-quicklook-preview-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" src=\"'+url+'\" quality=\"high\" type=\"application/x-shockwave-flash\" wmode=\"transparent\" />')\n\t\t\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t\n\t\t/**\n\t\t * HTML5 audio preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm       = ql.fm,\n\t\t\t\tpreview  = ql.preview,\n\t\t\t\tmimes    = {\n\t\t\t\t\t'audio/mpeg'    : 'mp3',\n\t\t\t\t\t'audio/mpeg3'   : 'mp3',\n\t\t\t\t\t'audio/mp3'     : 'mp3',\n\t\t\t\t\t'audio/x-mpeg3' : 'mp3',\n\t\t\t\t\t'audio/x-mp3'   : 'mp3',\n\t\t\t\t\t'audio/x-wav'   : 'wav',\n\t\t\t\t\t'audio/wav'     : 'wav',\n\t\t\t\t\t'audio/x-m4a'   : 'm4a',\n\t\t\t\t\t'audio/aac'     : 'm4a',\n\t\t\t\t\t'audio/mp4'     : 'm4a',\n\t\t\t\t\t'audio/x-mp4'   : 'm4a',\n\t\t\t\t\t'audio/ogg'     : 'ogg',\n\t\t\t\t\t'audio/webm'    : 'webm',\n\t\t\t\t\t'audio/flac'    : 'flac',\n\t\t\t\t\t'audio/x-flac'  : 'flac',\n\t\t\t\t\t'audio/amr'     : 'amr'\n\t\t\t\t},\n\t\t\t\tnode, curHash,\n\t\t\t\twin  = ql.window,\n\t\t\t\tnavi = ql.navbar,\n\t\t\t\tAMR, autoplay,\n\t\t\t\tcontrolsList = typeof ql.options.mediaControlsList === 'string' && ql.options.mediaControlsList? ' controlsList=\"' + fm.escape(ql.options.mediaControlsList) + '\"' : '',\n\t\t\t\tsetNavi = function() {\n\t\t\t\t\tnavi.css('bottom', win.hasClass('elfinder-quicklook-fullscreen')? '50px' : '');\n\t\t\t\t},\n\t\t\t\tgetNode = function(src, hash) {\n\t\t\t\t\treturn $('<audio class=\"elfinder-quicklook-preview-audio ui-front\" controls' + controlsList + ' preload=\"auto\" autobuffer><source src=\"'+src+'\" /></audio>')\n\t\t\t\t\t\t.on('change', function(e) {\n\t\t\t\t\t\t\t// Firefox fire change event on seek or volume change\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('error', function(e) {\n\t\t\t\t\t\t\tnode && node.data('hash') === hash && reset();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.data('hash', hash)\n\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t},\n\t\t\t\tamrToWavUrl = function(hash) {\n\t\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\t\tloader = $.Deferred().done(function() {\n\t\t\t\t\t\t\tvar opDfd;\n\t\t\t\t\t\t\topDfd = fm.getContents(hash, 'arraybuffer', { progressBar: prog }).done(function(data) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tvar buffer = AMR.toWAV(new Uint8Array(data));\n\t\t\t\t\t\t\t\t\tif (buffer) {\n\t\t\t\t\t\t\t\t\t\tdfd.resolve(URL.createObjectURL(new Blob([buffer], { type: 'audio/x-wav' })));\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\tAMR = false;\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t_AMR;\n\t\t\t\t\tif (window.TextEncoder && window.URL && URL.createObjectURL && typeof AMR === 'undefined') {\n\t\t\t\t\t\t// previous window.AMR\n\t\t\t\t\t\t_AMR = window.AMR;\n\t\t\t\t\t\tdelete window.AMR;\n\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t[ fm.options.cdns.amr ],\n\t\t\t\t\t\t\tfunction() { \n\t\t\t\t\t\t\t\tAMR = window.AMR? window.AMR : false;\n\t\t\t\t\t\t\t\t// restore previous window.AMR\n\t\t\t\t\t\t\t\twindow.AMR = _AMR;\n\t\t\t\t\t\t\t\tloader[AMR? 'resolve':'reject']();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\t\t\tloader.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tloader[AMR? 'resolve':'reject']();\n\t\t\t\t\t}\n\t\t\t\t\treturn dfd;\n\t\t\t\t},\n\t\t\t\tplay = function(player) {\n\t\t\t\t\tvar hash = node.data('hash'),\n\t\t\t\t\t\tplayPromise;\n\t\t\t\t\tautoplay && (playPromise = player.play());\n\t\t\t\t\t// uses \"playPromise['catch']\" instead \"playPromise.catch\" to support Old IE\n\t\t\t\t\tif (playPromise && playPromise['catch']) {\n\t\t\t\t\t\tplayPromise['catch'](function(e) {\n\t\t\t\t\t\t\tif (!player.paused) {\n\t\t\t\t\t\t\t\tnode && node.data('hash') === hash && reset();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\treset = function() {\n\t\t\t\t\tif (node && node.parent().length) {\n\t\t\t\t\t\tvar elm = node[0],\n\t\t\t\t\t\t\turl = node.children('source').attr('src');\n\t\t\t\t\t\twin.off('viewchange.audio');\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\telm.pause();\n\t\t\t\t\t\t\tnode.empty();\n\t\t\t\t\t\t\tif (url.match(/^blob:/)) {\n\t\t\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telm.src = '';\n\t\t\t\t\t\t\telm.load();\n\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\tnode = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tloading, prog;\n\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file,\n\t\t\t\t\ttype = mimes[file.mime],\n\t\t\t\t\thtml5, opDfd;\n\n\t\t\t\tif (mimes[file.mime] && ql.dispInlineRegex.test(file.mime) && ((html5 = ql.support.audio[type]) || (type === 'amr'))) {\n\t\t\t\t\tautoplay = ql.autoPlay();\n\t\t\t\t\tcurHash = file.hash;\n\t\t\t\t\tif (!html5) {\n\t\t\t\t\t\tif (fm.options.cdns.amr && type === 'amr' && AMR !== false) {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t\tnode = getNode('', curHash);\n\t\t\t\t\t\t\tamrToWavUrl(file.hash).done(function(url) {\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\tif (curHash === file.hash) {\n\t\t\t\t\t\t\t\t\tvar elm = node[0];\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tnode.children('source').attr('src', url);\n\t\t\t\t\t\t\t\t\t\telm.pause();\n\t\t\t\t\t\t\t\t\t\telm.load();\n\t\t\t\t\t\t\t\t\t\tplay(elm);\n\t\t\t\t\t\t\t\t\t\twin.on('viewchange.audio', setNavi);\n\t\t\t\t\t\t\t\t\t\tsetNavi();\n\t\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\topDfd = fm.openUrl(curHash, false, function(url) {\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\tnode = getNode(url, curHash);\n\t\t\t\t\t\t\t\tplay(node[0]);\n\t\t\t\t\t\t\t\twin.on('viewchange.audio', setNavi);\n\t\t\t\t\t\t\t\tsetNavi();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).one('change', reset);\n\t\t},\n\t\t\n\t\t/**\n\t\t * HTML5 video preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm       = ql.fm,\n\t\t\t\tpreview  = ql.preview,\n\t\t\t\tmimes    = {\n\t\t\t\t\t'video/mp4'       : 'mp4',\n\t\t\t\t\t'video/x-m4v'     : 'mp4',\n\t\t\t\t\t'video/quicktime' : 'mp4',\n\t\t\t\t\t'video/mpeg'      : 'mpeg',\n\t\t\t\t\t'video/ogg'       : 'ogg',\n\t\t\t\t\t'application/ogg' : 'ogg',\n\t\t\t\t\t'video/webm'      : 'webm',\n\t\t\t\t\t'video/x-matroska': 'mkv',\n\t\t\t\t\t'video/3gpp'      : '3gp',\n\t\t\t\t\t'application/vnd.apple.mpegurl' : 'm3u8',\n\t\t\t\t\t'application/x-mpegurl' : 'm3u8',\n\t\t\t\t\t'application/dash+xml'  : 'mpd',\n\t\t\t\t\t'video/x-flv'     : 'flv',\n\t\t\t\t\t'video/x-msvideo' : 'avi'\n\t\t\t\t},\n\t\t\t\tnode,\n\t\t\t\twin  = ql.window,\n\t\t\t\tnavi = ql.navbar,\n\t\t\t\tcHls, cDash, pDash, cFlv, cVideojs, autoplay, tm, loading, prog,\n\t\t\t\tcontrolsList = typeof ql.options.mediaControlsList === 'string' && ql.options.mediaControlsList? ' controlsList=\"' + fm.escape(ql.options.mediaControlsList) + '\"' : '',\n\t\t\t\tsetNavi = function() {\n\t\t\t\t\tif (fm.UA.iOS) {\n\t\t\t\t\t\tif (win.hasClass('elfinder-quicklook-fullscreen')) {\n\t\t\t\t\t\t\tpreview.css('height', '-webkit-calc(100% - 50px)');\n\t\t\t\t\t\t\tnavi._show();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpreview.css('height', '');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavi.css('bottom', win.hasClass('elfinder-quicklook-fullscreen')? '50px' : '');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trender = function(file, opts) {\n\t\t\t\t\tvar errTm = function(e) {\n\t\t\t\t\t\t\tif (err > 1) {\n\t\t\t\t\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\t\t\t\t\ttm = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t!canPlay && reset(true);\n\t\t\t\t\t\t\t\t}, 800);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terr = 0, \n\t\t\t\t\t\tcanPlay;\n\t\t\t\t\t//reset();\n\t\t\t\t\tpDash = null;\n\t\t\t\t\topts = opts || {};\n\t\t\t\t\tql.hideinfo();\n\t\t\t\t\tnode = $('<video class=\"elfinder-quicklook-preview-video\" controls' + controlsList + ' preload=\"auto\" autobuffer playsinline>'\n\t\t\t\t\t\t\t+'</video>')\n\t\t\t\t\t\t.on('change', function(e) {\n\t\t\t\t\t\t\t// Firefox fire change event on seek or volume change\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('timeupdate progress', errTm)\n\t\t\t\t\t\t.on('canplay', function() {\n\t\t\t\t\t\t\tcanPlay = true;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.data('hash', file.hash);\n\t\t\t\t\t// can not handling error event with jQuery `on` event handler\n\t\t\t\t\tnode[0].addEventListener('error', function(e) {\n\t\t\t\t\t\tif (opts.src && fm.convAbsUrl(opts.src) === fm.convAbsUrl(e.target.src)) {\n\t\t\t\t\t\t\t++err;\n\t\t\t\t\t\t\terrTm();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\n\t\t\t\t\tif (opts.src) {\n\t\t\t\t\t\tnode.append('<source src=\"'+opts.src+'\" type=\"'+file.mime+'\"/><source src=\"'+opts.src+'\"/>');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tnode.appendTo(preview);\n\n\t\t\t\t\twin.on('viewchange.video', setNavi);\n\t\t\t\t\tsetNavi();\n\t\t\t\t},\n\t\t\t\tloadHls = function(file) {\n\t\t\t\t\tvar hls, opDfd;\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\trender(file);\n\t\t\t\t\t\t\thls = new cHls();\n\t\t\t\t\t\t\thls.loadSource(url);\n\t\t\t\t\t\t\thls.attachMedia(node[0]);\n\t\t\t\t\t\t\tif (autoplay) {\n\t\t\t\t\t\t\t\thls.on(cHls.Events.MANIFEST_PARSED, function() {\n\t\t\t\t\t\t\t\t\tplay(node[0]);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tloadDash = function(file) {\n\t\t\t\t\tvar opDfd;\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tvar debug;\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\trender(file);\n\t\t\t\t\t\t\tpDash = window.dashjs.MediaPlayer().create();\n\t\t\t\t\t\t\tdebug = pDash.getDebug();\n\t\t\t\t\t\t\tif (debug.setLogLevel) {\n\t\t\t\t\t\t\t\tdebug.setLogLevel(dashjs.Debug.LOG_LEVEL_FATAL);\n\t\t\t\t\t\t\t} else if (debug.setLogToBrowserConsole) {\n\t\t\t\t\t\t\t\tdebug.setLogToBrowserConsole(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpDash.initialize(node[0], url, autoplay);\n\t\t\t\t\t\t\tpDash.on('error', function(e) {\n\t\t\t\t\t\t\t\treset(true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tloadFlv = function(file) {\n\t\t\t\t\tvar opDfd\n\t\t\t\t\tif (!cFlv.isSupported()) {\n\t\t\t\t\t\tcFlv = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\tvar player = cFlv.createPlayer({\n\t\t\t\t\t\t\t\ttype: 'flv',\n\t\t\t\t\t\t\t\turl: url\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\trender(file);\n\t\t\t\t\t\t\tplayer.on(cFlv.Events.ERROR, function() {\n\t\t\t\t\t\t\t\tplayer.destroy();\n\t\t\t\t\t\t\t\treset(true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tplayer.attachMediaElement(node[0]);\n\t\t\t\t\t\t\tplayer.load();\n\t\t\t\t\t\t\tplay(player);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tloadVideojs = function(file) {\n\t\t\t\t\tvar opDfd;\n\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\trender(file);\n\t\t\t\t\t\t\tnode[0].src = url;\n\t\t\t\t\t\t\tcVideojs(node[0], {\n\t\t\t\t\t\t\t\tsrc: url\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tplay = function(player) {\n\t\t\t\t\tvar hash = node.data('hash'),\n\t\t\t\t\t\tplayPromise;\n\t\t\t\t\tautoplay && (playPromise = player.play());\n\t\t\t\t\t// uses \"playPromise['catch']\" instead \"playPromise.catch\" to support Old IE\n\t\t\t\t\tif (playPromise && playPromise['catch']) {\n\t\t\t\t\t\tplayPromise['catch'](function(e) {\n\t\t\t\t\t\t\tif (!player.paused) {\n\t\t\t\t\t\t\t\tnode && node.data('hash') === hash && reset(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\treset = function(showInfo) {\n\t\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\t\tif (node && node.parent().length) {\n\t\t\t\t\t\tvar elm = node[0];\n\t\t\t\t\t\twin.off('viewchange.video');\n\t\t\t\t\t\tpDash && pDash.reset();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\telm.pause();\n\t\t\t\t\t\t\tnode.empty();\n\t\t\t\t\t\t\telm.src = '';\n\t\t\t\t\t\t\telm.load();\n\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\tnode = null;\n\t\t\t\t\t}\n\t\t\t\t\tshowInfo && ql.info.show();\n\t\t\t\t};\n\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file,\n\t\t\t\t\tmime = file.mime.toLowerCase(),\n\t\t\t\t\ttype = mimes[mime],\n\t\t\t\t\tstock, playPromise, opDfd;\n\t\t\t\t\n\t\t\t\tif (mimes[mime] && ql.dispInlineRegex.test(file.mime) /*&& (((type === 'm3u8' || (type === 'mpd' && !fm.UA.iOS) || type === 'flv') && !fm.UA.ltIE10) || ql.support.video[type])*/) {\n\t\t\t\t\tautoplay = ql.autoPlay();\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>');\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\tif (ql.support.video[type] && (type !== 'm3u8' || fm.UA.Safari)) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\tloading.appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\topDfd = fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\trender(file, { src: url });\n\t\t\t\t\t\t\t\tplay(node[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cHls !== false && fm.options.cdns.hls && type === 'm3u8') {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading.appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tif (cHls) {\n\t\t\t\t\t\t\t\tloadHls(file);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstock = window.Hls;\n\t\t\t\t\t\t\t\tdelete window.Hls;\n\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t[ fm.options.cdns.hls ],\n\t\t\t\t\t\t\t\t\tfunction(res) { \n\t\t\t\t\t\t\t\t\t\tcHls = res || window.Hls || false;\n\t\t\t\t\t\t\t\t\t\twindow.Hls = stock;\n\t\t\t\t\t\t\t\t\t\tcHls && loadHls(file);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\t\terror : function() {\n\t\t\t\t\t\t\t\t\t\t\tcHls = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (cDash !== false && fm.options.cdns.dash && type === 'mpd') {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading.appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tif (cDash) {\n\t\t\t\t\t\t\t\tloadDash(file);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t[ fm.options.cdns.dash ],\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t// dashjs require window.dashjs in global scope\n\t\t\t\t\t\t\t\t\t\tcDash = window.dashjs? true : false;\n\t\t\t\t\t\t\t\t\t\tcDash && loadDash(file);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\t\terror : function() {\n\t\t\t\t\t\t\t\t\t\t\tcDash = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (cFlv !== false && fm.options.cdns.flv && type === 'flv') {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading.appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tif (cFlv) {\n\t\t\t\t\t\t\t\tloadFlv(file);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstock = window.flvjs;\n\t\t\t\t\t\t\t\tdelete window.flvjs;\n\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t[ fm.options.cdns.flv ],\n\t\t\t\t\t\t\t\t\tfunction(res) { \n\t\t\t\t\t\t\t\t\t\tcFlv = res || window.flvjs || false;\n\t\t\t\t\t\t\t\t\t\twindow.flvjs = stock;\n\t\t\t\t\t\t\t\t\t\tcFlv && loadFlv(file);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\t\terror : function() {\n\t\t\t\t\t\t\t\t\t\t\tcFlv = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (fm.options.cdns.videojs) {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tloading.appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tif (cVideojs) {\n\t\t\t\t\t\t\t\tloadVideojs(file);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t[ fm.options.cdns.videojs + '/video.min.js' ],\n\t\t\t\t\t\t\t\t\tfunction(res) { \n\t\t\t\t\t\t\t\t\t\tcVideojs = res || window.videojs || false;\n\t\t\t\t\t\t\t\t\t\t//window.flvjs = stock;\n\t\t\t\t\t\t\t\t\t\tcVideojs && loadVideojs(file);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\t\terror : function() {\n\t\t\t\t\t\t\t\t\t\t\tcVideojs = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t).loadCss([fm.options.cdns.videojs + '/video-js.min.css']);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).one('change', reset);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Audio/video preview plugin using browser plugins\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar preview = ql.preview,\n\t\t\t\tmimes   = [],\n\t\t\t\tnode,\n\t\t\t\twin  = ql.window,\n\t\t\t\tnavi = ql.navbar;\n\t\t\t\t\n\t\t\t$.each(navigator.plugins, function(i, plugins) {\n\t\t\t\t$.each(plugins, function(i, plugin) {\n\t\t\t\t\t(plugin.type.indexOf('audio/') === 0 || plugin.type.indexOf('video/') === 0) && mimes.push(plugin.type);\n\t\t\t\t});\n\t\t\t});\n\t\t\tmimes = ql.fm.arrayFlip(mimes);\n\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file  = e.file,\n\t\t\t\t\tmime  = file.mime,\n\t\t\t\t\tvideo, opDfd, loading, prog,\n\t\t\t\t\tsetNavi = function() {\n\t\t\t\t\t\tnavi.css('bottom', win.hasClass('elfinder-quicklook-fullscreen')? '50px' : '');\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif (mimes[file.mime] && ql.dispInlineRegex.test(file.mime)) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\topDfd = ql.fm.openUrl(file.hash, false, function(url) {\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t(video = mime.indexOf('video/') === 0) && ql.hideinfo();\n\t\t\t\t\t\t\tnode = $('<embed src=\"'+url+'\" type=\"'+mime+'\" class=\"elfinder-quicklook-preview-'+(video ? 'video' : 'audio')+'\"/>')\n\t\t\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\twin.on('viewchange.embed', setNavi);\n\t\t\t\t\t\t\tsetNavi();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { progressBar: prog });\n\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}).one('change', function() {\n\t\t\t\tif (node && node.parent().length) {\n\t\t\t\t\twin.off('viewchange.embed');\n\t\t\t\t\tnode.remove();\n\t\t\t\t\tnode= null;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t},\n\n\t\t/**\n\t\t * Archive(zip|gzip|tar|bz2) preview plugin using https://github.com/imaya/zlib.js\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(['application/zip', 'application/x-gzip', 'application/x-tar', 'application/x-bzip2']),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tsizeMax = fm.returnBytes(ql.options.unzipMaxSize || 0),\n\t\t\t\tZlib    = (fm.options.cdns.zlibUnzip && fm.options.cdns.zlibGunzip)? true : false,\n\t\t\t\tbzip2   = fm.options.cdns.bzip2? true : false;\n\n\t\t\tif (window.Worker && window.Uint8Array && window.DataView) {\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file  = e.file,\n\t\t\t\t\t\tisTar = (file.mime === 'application/x-tar'),\n\t\t\t\t\t\tisBzip2 = (file.mime === 'application/x-bzip2'),\n\t\t\t\t\t\tisZlib = (file.mime === 'application/zip' || file.mime === 'application/x-gzip');\n\t\t\t\t\tif (mimes[file.mime] && (!sizeMax || file.size <= sizeMax) && (\n\t\t\t\t\t\t\tisTar\n\t\t\t\t\t\t\t|| (isBzip2 && bzip2)\n\t\t\t\t\t\t\t|| (isZlib && Zlib)\n\t\t\t\t\t\t)) {\n\t\t\t\t\t\tvar jqxhr, wk, loading, prog, url,\n\t\t\t\t\t\t\treq = function() {\n\t\t\t\t\t\t\t\tjqxhr = fm.getContents(file.hash, 'arraybuffer', { progressBar: prog })\n\t\t\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\tvar unzip, filenames,\n\t\t\t\t\t\t\t\t\t\terr = function(e) {\n\t\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\t\tif (isZlib) {\n\t\t\t\t\t\t\t\t\t\t\t\tZlib = false;\n\t\t\t\t\t\t\t\t\t\t\t} else if (isBzip2) {\n\t\t\t\t\t\t\t\t\t\t\t\tbzip2 = false;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfm.debug('error', e);\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\twk = fm.getWorker();\n\t\t\t\t\t\t\t\t\t\twk.onmessage = function(res) {\n\t\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\t\tif (!res.data || res.data.error) {\n\t\t\t\t\t\t\t\t\t\t\t\tnew Error(res.data && res.data.error? res.data.error : '');\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tmakeList(res.data.files);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\twk.onerror = err;\n\t\t\t\t\t\t\t\t\t\tif (file.mime === 'application/x-tar') {\n\t\t\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\t\t\tscripts: [fm.getWorkerUrl('quicklook.unzip.js')],\n\t\t\t\t\t\t\t\t\t\t\t\tdata: { type: 'tar', bin: data }\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t} else if (file.mime === 'application/zip') {\n\t\t\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\t\t\tscripts: [fm.options.cdns.zlibUnzip, fm.getWorkerUrl('quicklook.unzip.js')],\n\t\t\t\t\t\t\t\t\t\t\t\tdata: { type: 'zip', bin: data }\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t} else if (file.mime === 'application/x-gzip') {\n\t\t\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\t\t\tscripts: [fm.options.cdns.zlibGunzip, fm.getWorkerUrl('quicklook.unzip.js')],\n\t\t\t\t\t\t\t\t\t\t\t\tdata: { type: 'gzip', bin: data }\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t} else if (file.mime === 'application/x-bzip2') {\n\t\t\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\t\t\tscripts: [fm.options.cdns.bzip2, fm.getWorkerUrl('quicklook.unzip.js')],\n\t\t\t\t\t\t\t\t\t\t\t\tdata: { type: 'bzip2', bin: data }\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t\terr(e);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmakeList = function(filenames) {\n\t\t\t\t\t\t\t\tvar header, list, doc, tsize = 0;\n\t\t\t\t\t\t\t\tif (filenames && filenames.length) {\n\t\t\t\t\t\t\t\t\tfilenames = $.map(filenames, function(str) {\n\t\t\t\t\t\t\t\t\t\treturn fm.decodeRawString(str);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tfilenames.sort();\n\t\t\t\t\t\t\t\t\tlist = fm.escape(filenames.join(\"\\n\").replace(/\\{formatSize\\((\\d+)\\)\\}/g, function(m, s) {\n\t\t\t\t\t\t\t\t\t\ttsize += parseInt(s);\n\t\t\t\t\t\t\t\t\t\treturn fm.formatSize(s);\n\t\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t\t\theader = '<strong>'+fm.escape(file.mime)+'</strong> ('+fm.formatSize(file.size)+' / '+fm.formatSize(tsize)+')'+'<hr/>';\n\t\t\t\t\t\t\t\t\tdoc = $('<div class=\"elfinder-quicklook-preview-archive-wrapper\">'+header+'<pre class=\"elfinder-quicklook-preview-text\">'+list+'</pre></div>')\n\t\t\t\t\t\t\t\t\t\t.on('touchstart', function(e) {\n\t\t\t\t\t\t\t\t\t\t\tif ($(this)['scroll' + (fm.direction === 'ltr'? 'Right' : 'Left')]() > 5) {\n\t\t\t\t\t\t\t\t\t\t\t\te.originalEvent._preventSwipeX = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// this is our file - stop event propagation\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\tjqxhr.state() === 'pending' && jqxhr.reject();\n\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\treq();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * RAR Archive preview plugin using https://github.com/43081j/rar.js\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(['application/x-rar']),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tRAR;\n\n\t\t\tif (window.DataView) {\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file = e.file;\n\t\t\t\t\tif (mimes[file.mime] && fm.options.cdns.rar && RAR !== false) {\n\t\t\t\t\t\tvar loading, prog, url, archive, abort,\n\t\t\t\t\t\t\tgetList = function(url) {\n\t\t\t\t\t\t\t\tif (abort) {\n\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tarchive = RAR({\n\t\t\t\t\t\t\t\t\t\tfile: url,\n\t\t\t\t\t\t\t\t\t\ttype: 2,\n\t\t\t\t\t\t\t\t\t\txhrHeaders: fm.customHeaders,\n\t\t\t\t\t\t\t\t\t\txhrFields: fm.xhrFields\n\t\t\t\t\t\t\t\t\t}, function(err) {\n\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\tvar filenames = [],\n\t\t\t\t\t\t\t\t\t\t\theader, doc;\n\t\t\t\t\t\t\t\t\t\tif (abort || err) {\n\t\t\t\t\t\t\t\t\t\t\t// An error occurred (not a rar, read error, etc)\n\t\t\t\t\t\t\t\t\t\t\terr && fm.debug('error', err);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t$.each(archive.entries, function() {\n\t\t\t\t\t\t\t\t\t\t\tfilenames.push(this.path + (this.size? ' (' + fm.formatSize(this.size) + ')' : ''));\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tif (filenames.length) {\n\t\t\t\t\t\t\t\t\t\t\tfilenames = $.map(filenames, function(str) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn fm.decodeRawString(str);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tfilenames.sort();\n\t\t\t\t\t\t\t\t\t\t\theader = '<strong>'+fm.escape(file.mime)+'</strong> ('+fm.formatSize(file.size)+')'+'<hr/>';\n\t\t\t\t\t\t\t\t\t\t\tdoc = $('<div class=\"elfinder-quicklook-preview-archive-wrapper\">'+header+'<pre class=\"elfinder-quicklook-preview-text\">'+fm.escape(filenames.join(\"\\n\"))+'</pre></div>')\n\t\t\t\t\t\t\t\t\t\t\t\t.on('touchstart', function(e) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ($(this)['scroll' + (fm.direction === 'ltr'? 'Right' : 'Left')]() > 5) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.originalEvent._preventSwipeX = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t.appendTo(preview);\n\t\t\t\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror = function() {\n\t\t\t\t\t\t\t\tRAR = false;\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t_RAR, opDfd;\n\n\t\t\t\t\t\t// this is our file - stop event propagation\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\tarchive && (archive.abort = true);\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\tabort = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\topDfd = fm.openUrl(file.hash, 'sameorigin', function(url) {\n\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\tif (RAR) {\n\t\t\t\t\t\t\t\t\tgetList(url);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (window.RarArchive) {\n\t\t\t\t\t\t\t\t\t\t_RAR = window.RarArchive;\n\t\t\t\t\t\t\t\t\t\tdelete window.RarArchive;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfm.loadScript(\n\t\t\t\t\t\t\t\t\t\t[ fm.options.cdns.rar ],\n\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\tif (fm.hasRequire) {\n\t\t\t\t\t\t\t\t\t\t\t\trequire(['rar'], function(RarArchive) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tRAR = RarArchive;\n\t\t\t\t\t\t\t\t\t\t\t\t\tgetList(url);\n\t\t\t\t\t\t\t\t\t\t\t\t}, error);\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tif (RAR = window.RarArchive) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (_RAR) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twindow.RarArchive = _RAR;\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdelete window.RarArchive;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tgetList(url);\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\terror();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\t\t\t\terror : error\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, { progressBar: prog, temporary: true });\n\t\t\t\t\t\t// stop loading on change file if not loaded yet\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\topDfd && opDfd.state && opDfd.state() === 'pending' && opDfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * CAD-Files and 3D-Models online viewer on sharecad.org\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = fm.arrayFlip(ql.options.sharecadMimes || []),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\twin     = ql.window,\n\t\t\t\tnode;\n\t\t\t\t\n\t\t\tif (ql.options.sharecadMimes.length) {\n\t\t\t\tql.addIntegration({\n\t\t\t\t\ttitle: 'ShareCAD.org CAD and 3D-Models viewer',\n\t\t\t\t\tlink: 'https://sharecad.org/DWGOnlinePlugin'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file;\n\t\t\t\tif (mimes[file.mime.toLowerCase()] && !fm.option('onetimeUrl', file.hash)) {\n\t\t\t\t\tvar win     = ql.window,\n\t\t\t\t\t\tloading, prog, url;\n\t\t\t\t\t\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tif (file.url == '1') {\n\t\t\t\t\t\tpreview.hide();\n\t\t\t\t\t\t$('<div class=\"elfinder-quicklook-info-data\"><button class=\"elfinder-info-button\">'+fm.i18n('getLink')+'</button></div>').appendTo(ql.info.find('.elfinder-quicklook-info'))\n\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\tvar self = $(this);\n\t\t\t\t\t\t\tself.html('<span class=\"elfinder-spinner\">');\n\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\tdata : {cmd : 'url', target : file.hash},\n\t\t\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\t\t\tprogressBar : prog\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\t\tself.html('');\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\tvar rfile = fm.file(file.hash);\n\t\t\t\t\t\t\t\tfile.url = rfile.url = data.url || '';\n\t\t\t\t\t\t\t\tif (file.url) {\n\t\t\t\t\t\t\t\t\tpreview.trigger({\n\t\t\t\t\t\t\t\t\t\ttype: ql.evUpdate,\n\t\t\t\t\t\t\t\t\t\tfile: file,\n\t\t\t\t\t\t\t\t\t\tforceUpdate: true\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (file.url !== '' && file.url != '1') {\n\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\tnode.off('load').remove();\n\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t}).addClass('elfinder-overflow-auto');\n\t\t\t\t\t\t\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\t\n\t\t\t\t\t\turl = fm.convAbsUrl(fm.url(file.hash));\n\t\t\t\t\t\tnode = $('<iframe class=\"elfinder-quicklook-preview-iframe\" scrolling=\"no\"/>')\n\t\t\t\t\t\t\t.css('background-color', 'transparent')\n\t\t\t\t\t\t\t.appendTo(preview)\n\t\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\tql.preview.after(ql.info);\n\t\t\t\t\t\t\t\t$(this).css('background-color', '#fff').show();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.on('error', function() {\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\tql.preview.after(ql.info);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.attr('src', '//sharecad.org/cadframe/load?url=' + encodeURIComponent(url));\n\t\t\t\t\t\t\n\t\t\t\t\t\tql.info.after(ql.preview);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * KML preview with GoogleMaps API\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t */\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = {\n\t\t\t\t\t'application/vnd.google-earth.kml+xml' : true,\n\t\t\t\t\t'application/vnd.google-earth.kmz' : true\n\t\t\t\t},\n\t\t\t\tpreview = ql.preview,\n\t\t\t\tgMaps, loadMap, wGmfail, fail, mapScr;\n\n\t\t\tif (ql.options.googleMapsApiKey) {\n\t\t\t\tql.addIntegration({\n\t\t\t\t\ttitle: 'Google Maps',\n\t\t\t\t\tlink: 'https://www.google.com/intl/' + fm.lang.replace('_', '-') + '/help/terms_maps.html'\n\t\t\t\t});\n\t\t\t\tgMaps = (window.google && google.maps);\n\t\t\t\t// start load maps\n\t\t\t\tloadMap = function(file, node, prog) {\n\t\t\t\t\tvar mapsOpts = ql.options.googleMapsOpts.maps;\n\t\t\t\t\tfm.forExternalUrl(file.hash, { progressBar: prog }).done(function(url) {\n\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tnew gMaps.KmlLayer(url, Object.assign({\n\t\t\t\t\t\t\t\t\tmap: new gMaps.Map(node.get(0), mapsOpts)\n\t\t\t\t\t\t\t\t}, ql.options.googleMapsOpts.kml));\n\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\tfail();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfail();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\t// keep stored error handler if exists\n\t\t\t\twGmfail = window.gm_authFailure;\n\t\t\t\t// on error function\n\t\t\t\tfail = function() {\n\t\t\t\t\tmapScr = null;\n\t\t\t\t};\n\t\t\t\t// API script url\n\t\t\t\tmapScr = 'https://maps.googleapis.com/maps/api/js?key=' + ql.options.googleMapsApiKey;\n\t\t\t\t// error handler\n\t\t\t\twindow.gm_authFailure = function() {\n\t\t\t\t\tfail();\n\t\t\t\t\twGmfail && wGmfail();\n\t\t\t\t};\n\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file = e.file;\n\t\t\t\t\tif (mapScr && mimes[file.mime.toLowerCase()]) {\n\t\t\t\t\t\tvar win     = ql.window,\n\t\t\t\t\t\t\tgetLink = (file.url == '1' && !fm.option('onetimeUrl', file.hash)),\n\t\t\t\t\t\t\tloading, prog, url, node;\n\t\t\t\t\t\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\t\t\t\t\t\tif (getLink) {\n\t\t\t\t\t\t\tpreview.hide();\n\t\t\t\t\t\t\t$('<div class=\"elfinder-quicklook-info-data\"><button class=\"elfinder-info-button\">'+fm.i18n('getLink')+'</button></div>').appendTo(ql.info.find('.elfinder-quicklook-info'))\n\t\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t\tvar self = $(this);\n\t\t\t\t\t\t\t\tself.html('<span class=\"elfinder-spinner\">');\n\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\tdata : {cmd : 'url', target : file.hash},\n\t\t\t\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\t\t\t\tprogressBar : prog\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\tself.html('');\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\tvar rfile = fm.file(file.hash);\n\t\t\t\t\t\t\t\t\tfile.url = rfile.url = data.url || '';\n\t\t\t\t\t\t\t\t\tif (file.url) {\n\t\t\t\t\t\t\t\t\t\tpreview.trigger({\n\t\t\t\t\t\t\t\t\t\t\ttype: ql.evUpdate,\n\t\t\t\t\t\t\t\t\t\t\tfile: file,\n\t\t\t\t\t\t\t\t\t\t\tforceUpdate: true\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (file.url !== '' && !getLink) {\n\t\t\t\t\t\t\tnode = $('<div style=\"width:100%;height:100%;\"/>').appendTo(preview);\n\t\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!gMaps) {\n\t\t\t\t\t\t\t\tfm.loadScript([mapScr], function() {\n\t\t\t\t\t\t\t\t\tgMaps = window.google && google.maps;\n\t\t\t\t\t\t\t\t\tgMaps && loadMap(file, node, prog);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tloadMap(file, node, prog);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Any supported files preview plugin using (Google docs | MS Office) online viewer\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tmimes   = Object.assign(fm.arrayFlip(ql.options.googleDocsMimes || [], 'g'), fm.arrayFlip(ql.options.officeOnlineMimes || [], 'm')),\n\t\t\t\tpreview = ql.preview,\n\t\t\t\twin     = ql.window,\n\t\t\t\tnavi    = ql.navbar,\n\t\t\t\turls    = {\n\t\t\t\t\tg: 'docs.google.com/gview?embedded=true&url=',\n\t\t\t\t\tm: 'view.officeapps.live.com/op/embed.aspx?wdStartOn=0&src='\n\t\t\t\t},\n\t\t\t\tnavBottom = {\n\t\t\t\t\tg: '56px',\n\t\t\t\t\tm: '24px'\n\t\t\t\t},\n\t\t\t\tmLimits = {\n\t\t\t\t\txls  : 5242880, // 5MB\n\t\t\t\t\txlsb : 5242880,\n\t\t\t\t\txlsx : 5242880,\n\t\t\t\t\txlsm : 5242880,\n\t\t\t\t\tother: 10485760 // 10MB\n\t\t\t\t},\n\t\t\t\tnode, enable;\n\t\t\t\n\t\t\tif (ql.options.googleDocsMimes.length) {\n\t\t\t\tenable = true;\n\t\t\t\tql.addIntegration({\n\t\t\t\t\ttitle: 'Google Docs Viewer',\n\t\t\t\t\tlink: 'https://docs.google.com/'\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (ql.options.officeOnlineMimes.length) {\n\t\t\t\tenable = true;\n\t\t\t\tql.addIntegration({\n\t\t\t\t\ttitle: 'MS Online Doc Viewer',\n\t\t\t\t\tlink: 'https://products.office.com/office-online/view-office-documents-online'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (enable) {\n\t\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\t\tvar file = e.file,\n\t\t\t\t\t\ttype, dfd;\n\t\t\t\t\t// 25MB is maximum filesize of Google Docs prevew\n\t\t\t\t\tif (file.size <= 26214400 && (type = mimes[file.mime])) {\n\t\t\t\t\t\tvar win     = ql.window,\n\t\t\t\t\t\t\tsetNavi = function() {\n\t\t\t\t\t\t\t\tnavi.css('bottom', win.hasClass('elfinder-quicklook-fullscreen')? navBottom[type] : '');\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\text     = fm.mimeTypes[file.mime],\n\t\t\t\t\t\t\tgetLink = (file.url == '1' && !fm.option('onetimeUrl', file.hash)),\n\t\t\t\t\t\t\tloading, prog, url, tm;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (type === 'm') {\n\t\t\t\t\t\t\tif ((mLimits[ext] && file.size > mLimits[ext]) || file.size > mLimits.other) {\n\t\t\t\t\t\t\t\ttype = 'g';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (getLink) {\n\t\t\t\t\t\t\tpreview.hide();\n\t\t\t\t\t\t\t$('<div class=\"elfinder-quicklook-info-data\"><button class=\"elfinder-info-button\">'+fm.i18n('getLink')+'</button></div>').appendTo(ql.info.find('.elfinder-quicklook-info'))\n\t\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t\tvar self = $(this);\n\t\t\t\t\t\t\t\tself.html('<span class=\"elfinder-spinner\">');\n\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\tdata : {cmd : 'url', target : file.hash},\n\t\t\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\t\t\tself.html('');\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\tvar rfile = fm.file(file.hash);\n\t\t\t\t\t\t\t\t\tfile.url = rfile.url = data.url || '';\n\t\t\t\t\t\t\t\t\tif (file.url) {\n\t\t\t\t\t\t\t\t\t\tpreview.trigger({\n\t\t\t\t\t\t\t\t\t\t\ttype: ql.evUpdate,\n\t\t\t\t\t\t\t\t\t\t\tfile: file,\n\t\t\t\t\t\t\t\t\t\t\tforceUpdate: true\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (file.url !== '' && !getLink) {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\t\t\tdfd && dfd.status && dfd.status() === 'pending' && dfd.reject();\n\t\t\t\t\t\t\t\twin.off('viewchange.googledocs');\n\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\tnode.off('load').remove();\n\t\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t\t}).addClass('elfinder-overflow-auto');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\n\t\t\t\t\t\t\tnode = $('<iframe class=\"elfinder-quicklook-preview-iframe\"/>')\n\t\t\t\t\t\t\t\t.css('background-color', 'transparent')\n\t\t\t\t\t\t\t\t.appendTo(preview);\n\n\t\t\t\t\t\t\tdfd = fm.forExternalUrl(file.hash, { progressBar: prog }).done(function(url) {\n\t\t\t\t\t\t\t\tvar load = function() {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tif (node && (!node.attr('src') || node.get(0).contentWindow.document/*maybe HTTP 204*/)) {\n\t\t\t\t\t\t\t\t\t\t\t\tnode.attr('src', 'https://' + urls[type] + encodeURIComponent(url));\n\t\t\t\t\t\t\t\t\t\t\t\t// Retry because Google Docs viewer sometimes returns HTTP 204\n\t\t\t\t\t\t\t\t\t\t\t\ttm = setTimeout(load, 2000);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\t\tif (file.ts) {\n\t\t\t\t\t\t\t\t\t\turl += (url.match(/\\?/)? '&' : '?') + '_t=' + file.ts;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnode.on('load', function() {\n\t\t\t\t\t\t\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\t\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\tql.preview.after(ql.info);\n\t\t\t\t\t\t\t\t\t\t$(this).css('background-color', '#fff').show();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.on('error', function() {\n\t\t\t\t\t\t\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\t\tql.preview.after(ql.info);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tload();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\twin.on('viewchange.googledocs', setNavi);\n\t\t\t\t\t\t\tsetNavi();\n\t\t\t\t\t\t\tql.info.after(ql.preview);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Texts preview plugin\n\t\t *\n\t\t * @param elFinder.commands.quicklook\n\t\t **/\n\t\tfunction(ql) {\n\t\t\t\"use strict\";\n\t\t\tvar fm      = ql.fm,\n\t\t\t\tpreview = ql.preview,\n\t\t\t\ttextLines = parseInt(ql.options.textInitialLines) || 150,\n\t\t\t\tprettifyLines = parseInt(ql.options.prettifyMaxLines) || 500,\n\t\t\t\tPR, _PR,\n\t\t\t\terror = function() {\n\t\t\t\t\tprettify = function() { return false; };\n\t\t\t\t\t_PR && (window.PR = _PR);\n\t\t\t\t\tPR = false;\n\t\t\t\t},\n\t\t\t\tprettify = function(node) {\n\t\t\t\t\tif (fm.options.cdns.prettify) {\n\t\t\t\t\t\tprettify = function(node) {\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tPRcheck(node);\n\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\treturn 'pending';\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (window.PR) {\n\t\t\t\t\t\t\t_PR = window.PR;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfm.loadScript([fm.options.cdns.prettify + (fm.options.cdns.prettify.match(/\\?/)? '&' : '?') + 'autorun=false'], function(wPR) {\n\t\t\t\t\t\t\tPR = wPR || window.PR;\n\t\t\t\t\t\t\tif (typeof PR === 'object') {\n\t\t\t\t\t\t\t\tprettify = function() { return true; };\n\t\t\t\t\t\t\t\tif (_PR) {\n\t\t\t\t\t\t\t\t\twindow.PR = _PR;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdelete window.PR;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\texec(node);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\terror();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\terror : error\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\terror();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\texec = function(node) {\n\t\t\t\t\tif (node && !node.hasClass('prettyprinted')) {\n\t\t\t\t\t\tnode.css('cursor', 'wait');\n\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\tPR.prettyPrint && PR.prettyPrint(null, node.get(0));\n\t\t\t\t\t\t\tnode.css('cursor', '');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tPRcheck = function(node) {\n\t\t\t\t\tvar status = prettify(node);\n\t\t\t\t\tif (status === true) {\n\t\t\t\t\t\texec(node);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\n\t\t\tpreview.on(ql.evUpdate, function(e) {\n\t\t\t\tvar file = e.file,\n\t\t\t\t\tmime = file.mime,\n\t\t\t\t\tjqxhr, loading, prog, encSelect;\n\t\t\t\t\n\t\t\t\tif (fm.mimeIsText(file.mime) && (!ql.options.getSizeMax || file.size <= ql.options.getSizeMax) && PR !== false) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\n\t\t\t\t\tloading = $('<div class=\"elfinder-quicklook-info-data\"><span class=\"elfinder-spinner-text\">'+fm.i18n('nowLoading')+'</span><span class=\"elfinder-spinner\"/></div>').appendTo(ql.info.find('.elfinder-quicklook-info'));\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(loading);\n\n\t\t\t\t\t// stop loading on change file if not loadin yet\n\t\t\t\t\tpreview.one('change', function() {\n\t\t\t\t\t\tjqxhr.state() == 'pending' && jqxhr.reject();\n\t\t\t\t\t\tencSelect && encSelect.remove();\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tjqxhr = fm.request({\n\t\t\t\t\t\tdata           : {cmd : 'get', target : file.hash, conv : (file.encoding || 1), _t : file.ts},\n\t\t\t\t\t\toptions        : {type: 'get', cache : true},\n\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\tprogressBar    : prog\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tvar reg = new RegExp('^(data:'+file.mime.replace(/([.+])/g, '\\\\$1')+';base64,)', 'i'),\n\t\t\t\t\t\t\ttext = data.content,\n\t\t\t\t\t\t\tpart, more, node, lines, m;\n\t\t\t\t\t\tif (typeof text !== 'string') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tql.hideinfo();\n\t\t\t\t\t\tif (window.atob && (m = text.match(reg))) {\n\t\t\t\t\t\t\ttext = atob(text.substr(m[1].length));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tlines = text.match(/([^\\r\\n]{1,100}[\\r\\n]*)/g);\n\t\t\t\t\t\tmore = lines.length - textLines;\n\t\t\t\t\t\tif (more > 10) {\n\t\t\t\t\t\t\tpart = lines.splice(0, textLines).join('');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmore = 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnode = $('<div class=\"elfinder-quicklook-preview-text-wrapper\"><pre class=\"elfinder-quicklook-preview-text prettyprint\"></pre></div>');\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (more) {\n\t\t\t\t\t\t\tnode.append($('<div class=\"elfinder-quicklook-preview-charsleft\"><hr/><span>' + fm.i18n('linesLeft', fm.toLocaleString(more)) + '</span></div>')\n\t\t\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t\t\tvar top = node.scrollTop();\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t\tnode.children('pre').removeClass('prettyprinted').text(text).scrollTop(top);\n\t\t\t\t\t\t\t\t\tif (lines.length <= prettifyLines) {\n\t\t\t\t\t\t\t\t\t\tPRcheck(node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.children('pre').text(part || text);\n\t\t\t\t\t\t\n\t\t\t\t\t\tnode.on('touchstart', function(e) {\n\t\t\t\t\t\t\tif ($(this)['scroll' + (fm.direction === 'ltr'? 'Right' : 'Left')]() > 5) {\n\t\t\t\t\t\t\t\te.originalEvent._preventSwipeX = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).appendTo(preview);\n\n\t\t\t\t\t\t// make toast message\n\t\t\t\t\t\tif (data.toasts && Array.isArray(data.toasts)) {\n\t\t\t\t\t\t\t$.each(data.toasts, function() {\n\t\t\t\t\t\t\t\tthis.msg && fm.toast(this);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tPRcheck(node);\n\t\t\t\t\t})\n\t\t\t\t\t.always(function(data) {\n\t\t\t\t\t\tvar cmdEdit, sel, head;\n\t\t\t\t\t\tif (cmdEdit = fm.getCommand('edit')) {\n\t\t\t\t\t\t\thead = [];\n\t\t\t\t\t\t\tif (data && data.encoding) {\n\t\t\t\t\t\t\t\thead.push({value: data.encoding});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thead.push({value: 'UTF-8'});\n\t\t\t\t\t\t\tsel = cmdEdit.getEncSelect(head);\n\t\t\t\t\t\t\tsel.on('change', function() {\n\t\t\t\t\t\t\t\tfile.encoding = sel.val();\n\t\t\t\t\t\t\t\tfm.cache(file, 'change');\n\t\t\t\t\t\t\t\tpreview.trigger({\n\t\t\t\t\t\t\t\t\ttype: ql.evUpdate,\n\t\t\t\t\t\t\t\t\tfile: file,\n\t\t\t\t\t\t\t\t\tforceUpdate: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tencSelect = $('<div class=\"elfinder-quicklook-encoding\"/>').append(sel);\n\t\t\t\t\t\t\tql.window.append(encSelect);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tloading.remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t];\n\n\treturn elFinder;\n\n});"]}