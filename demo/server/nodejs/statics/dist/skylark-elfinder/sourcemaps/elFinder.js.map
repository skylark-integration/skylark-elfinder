{"version":3,"sources":["elFinder.js"],"names":["define","res","test","css","aStyle","pStyle","webkit","chrome","hasOwnProperty","hasDontEnumBug","dontEnums","dontEnumsLength","elFinder","elm","opts","bootCallback","extToMimeTable","syncInterval","requestMaxConn","utc","i18n","bootUp","savedXhrSend","func","opFunc","arrOv","baseUrl","rmTag","loaded","theme","themes","ids","d","resizeTm","cls","resize","self","this","dfrdsBeforeBootup","conflictChecks","node","$","prevEvents","extend","_data","get","prevContent","append","contents","attr","id","length","namespace","mousedown","keydown","keypress","keyup","enabled","prevEnabled","cwd","cwdOptionsDefault","path","url","tmbUrl","disabled","separator","archives","extract","copyOverwrite","uploadOverwrite","uploadMaxSize","jpgQuality","tmbCrop","tmbReqCustomData","tmb","cwdOptions","files","hiddenFiles","ownFiles","selected","listeners","shortcuts","clipboard","remember","queue","cwdQueue","base","command","width","height","heightBase","soundPath","prevSorterStr","diableUnloadCheck","beeper","document","createElement","hide","appendTo","autoSyncStop","uiCmdMapPrev","gcJobRes","open","data","rmClass","hashes","calc","gc","prevcwd","sorterStr","diff","emptyDirs","stayDirs","api","commandMap","options","uiCmdMap","Object","keys","JSON","stringify","sync","init","i","isDir","mime","phash","navHash2Elm","hash","is","next","children","removeClass","empty","deleteCache","_abort","asyncJob","interval","numPerOnce","done","hd","storage","items","each","h","trigger","one","sorters","cache","changed","change","lastDir","autoSync","type","f","i1","parents","hidden","keeps","defsorter","name","perm","date","size","kind","sorterChk","_checked","l","setSorter","file","sortRules","key","push","arrayFlip","changedParents","hideData","hides","assign","show","sizeInfo","splice","target","remove","removed","roots","rm","leafRoots","idx","pdir","inArray","_realStats","k","v","searchStatus","state","update","optionsByHashes","requestCnt","requestQueue","currentOpenCmd","execShortcut","e","ddm","code","keyCode","ctrlKey","metaKey","isMousedown","keyState","shiftKey","altKey","shortcut","preventDefault","stopPropagation","callback","debug","description","ui","TAB","ESCAPE","find","ddmanager","current","helper","cancel","toHide","Date","inFrame","window","parent","parentIframe","pifm","ifms","ifm","contentWindow","UA","Mobile","on","a","screen","orientation","angle","Angle","Rotated","fm","extraObj","call","newAPI","oldAPI","netDrivers","i18nBaseUrl","cssloaded","mimesCanMakeEmpty","reloadCallback","localStorage","Safari","setItem","removeItem","cookie","pauseUnloadCheck","keep","requestAnimationFrame","_options","uiOptions","toolbar","Array","isArray","isPlainObject","toolbarExtra","pop","obj","toUnbindEvents","bind","event","priorityFirst","len","toLowerCase","replace","split","unbind","ci","evType","allowModify","jst","dataIsObj","handlers","dones","Event","_getEvent","parse","isDefaultPrevented","ex","console","log","getListeners","myTag","src","match","maxErrorDialogs","Math","max","parseInt","dispInlineRegex","cssAutoLoad","removeData","default","loadCss","cssurls","addClass","author","license","dfd","Deferred","fail","error","changeTheme","optionProperties","icon","csscls","netkey","enableAlways","noConflicts","noConflict","p","fn","isCORS","cors","parseUploadUrl","parseUrl","selfProtocol","location","protocol","portReg","selfHost","host","href","urlUpload","customHeaders","xhrFields","requestType","optsCustomData","customData","prevCustomData","replaceXhrSend","XMLHttpRequest","prototype","send","xhr","setRequestHeader","apply","arguments","restoreXhrSend","abortCmdsOnOpen","navPrefix","uniqueid","cwdPrefix","uploadURL","today","getFullYear","getMonth","getDate","getTime","yesterday","UTCDate","getHours","getMinutes","getSeconds","getDay","zIndex","query","mixed","ininc","lang","viewType","defaultView","sortType","sortOrder","sortStickFolders","sortAlsoTreeview","_sortRules","method","compare","proxy","notifyDelay","draggingUiHelper","droppable","greedy","tolerance","accept","hoverClass","classes","ui-droppable-hover","autoDisable","drop","cnt","dst","targets","grep","result","dups","faults","isCopy","hasClass","c","button","insideWorkzone","pageX","pageY","cwdId2Hash","navId2Hash","write","exec","_userAction","always","visible","elfinder","isRoot","isroot","root","fake","dir","rhash","indexOf","read","option","item","hasVolOptions","volOptions","opt","getDisabledCmds","flip","disCmds","alsoHidden","unshift","path2array","i18","asyncOpt","join","notify","hideCnt","ntftm","noreq","req","request","cmd","preventFail","reject","clearTimeout","resolve","setTimeout","o","async","temp","temporary","onetm","onetime","absurl","dfrd","filter","convAbsUrl","getUrl","getBaseUrl","map","n","encodeURIComponent","slice","params","param","progressBar","forExternalUrl","openUrl","download","requestOpts","onetimeSize","volumeid","isSameOrigin","hasParrotHeaders","getContents","blob","URL","webkitURL","createObjectURL","ts","val","repeat","sort","shift","cData","_t","className","selectedFiles","fileByName","validResponse","rules","returnBytes","last","isNaN","charAt","timeout","_xhr","openDir","reqId","toString","floor","random","mimes","onlyMimes","isBinary","dataType","isOpen","asNotOpen","deffail","defdone","preventDone","prog","progressVal","progTm","hasNotify","progress","raw","syncOnFail","lazy","prepare","navigate","useCache","headers","total","warning","updateCache","added","add","then","toasts","msg","toast","status","quiet","responseText","abortXHR","transport","success","response","currentReqCmd","responseDebug","setCustomHeaderByXhr","actionTarget","pushLeafRoots","setTextMimes","textMimes","normalize","norError","resources","text","maxTargets","uplMaxSize","uplMaxFile","min","newItems","findCwdNodes","inCwdHashes","cwdHash","makeToast","t","action","cwdNot","toggleClass","_currentType","_currentNode","extNode","noselect","noscroll","first","blink","incwd","inbuffer","xhrAbort","abort","mode","queueAbort","_target","errData","errMsg","err","rc","volumeExpires","cmdsToAdd","reqid","responseURL","_requestId","ndx","queueingRequest","eachCancel","progFakeUp","bindData","promise","dataArray","tree","incoming","onlydir","excludeProps","excludes","chkKeyLen","origin","orgKeys","prop","isChanged","polling","reqFail","mtime","comp","reload","curRoot","curId","exParents","when","parseError","odata","pdata","argLen","concat","upload","s","patterns","pattern","parts","allowShortcuts","isFunction","toUpperCase","charCodeAt","ret","cut","locked","isCommandEnabled","dstHash","cvid","disabledFlip","_commands","alwaysEnabled","resType","noupdate","dialog","content","elfinderdialog","dnode","closest","elfindertoast","getUI","getCommand","w","mt","fit","prv","m","outerHeight","innerHeight","getMargin","tm","cancelAnimationFrame","restoreSize","off","round","enable","disable","delay","busy","repaint","callFunc","destroy","toggleFullscreen","syncStart","arr","selector","handler","start","syncMinMs","cts","dosync","syncChkAsTs","x","y","margin","rectangle","left","top","toFront","nodes","lastnode","nohide","tgt","getMaximizeCss","display","position","maxWidth","maxHeight","Fullscreen","orgStyle","bodyOvf","funcObj","clsN","checkDialog","$d","pos","setFuncObj","useFullscreen","commandsOptions","fullscreen","fullElm","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","exitFull","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","toFull","elem","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","full","restoreStyle","style","win","curElm","maximize","toggleMaximize","exitMax","toMax","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","DIG0","DIG1","DIG2","DIG3","DIG4","DIG5","DIG6","DIG7","DIG8","DIG9","NUM0","NUM1","NUM2","NUM3","NUM4","NUM5","NUM6","NUM7","NUM8","NUM9","CONTEXTMENU","DOT","dragUpload","xhrUpload","XMLHttpRequestUpload","XMLHttpRequestEventTarget","File","FormData","IE","addEventListener","ajax","uploads","iframe","dragUploadAllow","decodeRawString","str","char","String","fromCharCode","decodeUTF8","scalars","charCodes","scalarValues","responseType","processData","getBinaryByUrl","getMimetype","orgMime","ext","mimeTypes","hashCheckers","hashLibs","Worker","ArrayBuffer","cdns","sparkmd5","SparkMD5","jssha","jsSHA","getContentsHashes","needHashes","hashOpts","needs","jobs","shake128len","shake256len","arrayBuffer","md5","job","wk","getWorker","terminate","onmessage","ans","onerror","postMessage","scripts","getWorkerUrl","bin","arg","overlay","activeElement","blur","select","unselects","value","inselect","counter","cssClass","title","resizable","destroyOnClose","buttons","html","images","sound","play","canPlayType","soundFile","history","commands","trashes","uiAutoHide","parrotHeaders","sessionStorage","useBrowserHistory","ev","onOpen","originalEvent","hasThash","thash","input","animate","scrollTop","offset","pushState","pathname","search","isEmptyObject","onhistory","onHidden","windowCloseConfirm","returnValue","enableByMouseOver","background","webkitHidden","msHidden","langJs","hasRequire","require","loadScript","loadType","columnNames","ltr","wzRect","wzBottom","wzBottom2","nodeStyle","keyEvt","navbar","messages","selectable","draggable","slider","modestr","modeoct","modeboth","listView","columnsCustomName","getColumnName","direction","dateFormat","fancyFormat","fancyDateFormat","nonameDateFormat","Touch","iOS","addClasses","distance","revert","refreshPositions","cursor","cursorAt","scroll","setInterval","autoScroll","drag","autoScr","autoUp","bottom","cwdEdge","substr","pow","elfUiWidgetInstance","elfRefresh","stop","clearInterval","ctr","element","mime2class","outerHTML","getIconStyle","chk","getfile","OS","getFileCallback","extendsCmd","proto","forceLoad","setup","linkedCmds","lcmd","workzone","elfinderworkzone","elfindernavbar","navdock","elfindernavdock","contextmenu","elfindercontextmenu","elfinderoverlay","elfindercwd","notifyDialog","canClose","absolute","autoOpen","allowMinimize","closeOnEscape","minHeight","minimize","statusbar","bottomtray","progressbar","tag","prev","handles","minWidth","navbarUp","navbarDown","cwdUp","cwdDown","lastX","lastY","nodeOffset","nodeWidth","navbarW","toolbarH","moveTm","handleW","moveEv","moveUpOn","touches","moveDownOn","navbarMode","moveX","toolbarT","_preventSwipeX","_preventSwipeY","abs","duration","handleH","autoScrTm","isin","nodeName","ent","navdir","clDropActive","wz","clearTm","dataTransfer","dropEffect","elfFrom","$elm","currentTarget","types","dropEvt","zIndexCalc","startDir","freeze","trashDisable","th","trashHash","toChkTh","rawStringDecoder","registRawStringDecoder","load","alert","toGlobal","navigator","userAgent","unqueID","opera","sidebar","documentElement","ltIE6","ltIE7","querySelectorAll","ltIE8","getElementsByClassName","ltIE9","uniqueID","documentMode","ltIE10","gtIE11","Firefox","Opera","Webkit","Chrome","Edge","msCredentials","ontouchstart","platform","Mac","CSS","cssText","positionSticky","widthMaxContent","flex","cookieEnabled","amd","en","translator","language","months","monthsShort","days","daysShort","kinds","unknown","directory","group","symlink","symlink-broken","application/x-empty","application/postscript","application/vnd.ms-office","application/msword","application/vnd.ms-word","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-word.document.macroEnabled.12","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.template.macroEnabled.12","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.slideshow.macroEnabled.12","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.openxmlformats-officedocument.presentationml.slide","application/vnd.ms-powerpoint.slide.macroEnabled.12","application/pdf","application/xml","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.text-template","application/vnd.oasis.opendocument.text-web","application/vnd.oasis.opendocument.text-master","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.graphics-template","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.presentation-template","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.oasis.opendocument.chart","application/vnd.oasis.opendocument.formula","application/vnd.oasis.opendocument.database","application/vnd.oasis.opendocument.image","application/vnd.openofficeorg.extension","application/x-shockwave-flash","application/flash-video","application/x-bittorrent","application/javascript","application/rtf","application/rtfd","application/x-font-ttf","application/x-font-otf","application/x-rpm","application/x-web-config","application/xhtml+xml","application/docbook+xml","application/x-awk","application/x-gzip","application/x-bzip2","application/x-xz","application/zip","application/x-zip","application/x-rar","application/x-tar","application/x-7z-compressed","application/x-jar","text/plain","text/x-php","text/html","text/javascript","text/css","text/rtf","text/rtfd","text/x-c","text/x-csrc","text/x-chdr","text/x-c++","text/x-c++src","text/x-c++hdr","text/x-shellscript","application/x-csh","text/x-python","text/x-java","text/x-java-source","text/x-ruby","text/x-perl","text/x-sql","text/xml","text/x-comma-separated-values","text/x-markdown","image/x-ms-bmp","image/jpeg","image/gif","image/png","image/tiff","image/x-targa","image/vnd.adobe.photoshop","image/xbm","image/pxm","audio/mpeg","audio/midi","audio/ogg","audio/mp4","audio/x-m4a","audio/wav","audio/x-mp3-playlist","video/x-dv","video/mp4","video/mpeg","video/x-msvideo","video/quicktime","video/x-ms-wmv","video/x-flv","video/x-matroska","video/ogg","defaults","parseUploadData","trim","merge","iframeCnt","xhrUploading","failSyncTm","chunkfailReq","checkExists","names","existed","exists","pathStr","confirm","renames","_remove","all","label","intersect","existedArr","cwdItems","overwriteUploadConfirm","list","checkFile","checked","hasDirs","scanDfd","paths","processing","mkdirs","doScan","entry","folderUploadExclude","check","pushItem","fullPath","readEntries","dirReader","entries","results","isFile","isDirectory","createReader","getAsEntry","webkitGetAsEntry","dfds","overwrite","bak","uniqueName","backupSuffix","lockfiles","unlockfiles","notifyto","escape","atag","tmp","parseHTML","purl","pa","clipdata","loc","regex","notifyto1","notifyto2","dataChecked","isDataType","extraData","chunkEnable","multiMax","retry","getFile","userAbort","triggerError","_cid","chunk","_chunk","cid","fnAbort","multiupload","checkNotify","uploadedNtf","chunkMerge","notifyElm","formData","isChunked","filesize","cancelBtn","ntfUpload","cancelToggle","hasChunk","startNotify","notifyWith","unite","errCnt","errors","curr","_chunkmerged","_file","_name","_mtime","_multiupload","_chunkfailure","lengthComputable","readyState","_totalSize","checkDirs","cancelDirs","maxFileSize","blobSize","blobMtime","blobName","end","chunks","failChunk","fcnt","sfiles","totalSize","chunked","chunkID","BYTES_PER_CHUNK","uploadMaxChunkSize","blobSlice","multi","num","cancelChk","sfilesLen","uploadMimeCheck","lastModified","_range","_chunkfail","webkitRelativePath","relativePath","_relativePath","dirs","rootDir","relPath","res2","existName","abortto","form","msie","onload","iframeTimeout","submit","rename","retval","oldval","precnt","sufcnt","oldkey","prefix","suffix","clrs","getItem","clear","substring","decodeURIComponent","expires","setTime","toUTCString","domain","secure","locHash","startPathHash","rememberLastDir","_node","i18nFolderName","prevId","fileFilter","RegExp","normalizeOptions","getType","disabledCmdsRels","com","rels","flg","rel","asMap","vid","targetOptions","rootNames","ign","_i18","applyLeafRootStats","dataArr","pfile","ph","setSort","order","stickFolders","alsoTreeview","file1","file2","naturalCompare","size1","size2","date1","date2","v1","v2","owner","b","userLanguage","browserLanguage","localeCompare","numeric","Intl","Collator","oFxNcL","oFyNcL","re","sre","dre","hre","ore","syre","insensitive","xN","yN","xD","yD","locRes","cLoc","numS","parseFloat","asc","stick","d1","d2","sortFiles","prc","hiddens","ndialog","ntpl","delta","fakeint","fakeinterval","close","setProgressbar","_esc","fakeUp","cur","ntfs","checkbox","btnNum","complete","modal","_cssClass","create","prepend","optionsCallback","glue","j","escFunc","isErr","ignore","message","jQuery","placeholder","asObject","cssObj","background-size","mimeType","isText","mime2kind","isObj","alias","mimeIsText","format","dw","g","formatDate","output","clientFormatDate","a1","a2","toLocaleString","Number","perms2class","formatPermissions","formatSize","u","toFixed","formatFileMode","suid","sgid","oct","fileModeStyle","allow","deny","mimeChecker","checker","firstOrder","sequence","tasks","chain","task","reloadContents","contentDocument","makeNetmountOptionOauth","noOffline","pathI18n","folders","addFolders","bro","spn","inputs","spinner","after","user","pass","vars","offline","mnt2res","oline","f0","mbtn","siblings","uniqueId","body","whole","s1","btn","f1","oauthW","hasFocus","chkCnt","chkdone","nextAll","rem","click","reset","integrateInfo","integrate","newItem","cwdHash2Elm","firstOnly","reg","checkUrl","port","navHash2Id","cwdHash2Id","getElementById","isInWindow","nochkHide","rect","offsetParent","getBoundingClientRect","elementFromPoint","ni","z","urls","defOpts","tryRequire","fi","hasError","loadResults","script","_error","charset","onreadystatechange","appendScript","clName","link","abortFlg","parms","resArr","curVars","getSize","reqs","tgtlen","checkPhash","grps","singles","dirCnt","fileCnt","isCache","cnts","cntsTxt","sizes","formated","wkObjUrl","Blob","importScripts","filename","getTheme","themeid","themeObj","absUrl","getJSON","prevTs","getResponseHeader","phs","getRequestId","trans","tmpArr","isArr","splitFileExtention","sliceArrayBuffer","sliceSize","segments","byteLength","arrayBufferToBase64","ab","btoa","dView","Uint8Array","arr1","tbOpts","showlog","tb","toastBackendWarn","rd","mountErrors","backendErrors","time","timeEnd","propertyIsEnumerable","TypeError","count","RangeError","Infinity","rpt","_apply","Function","thisArg","argArray","from","lastTime","vendors","currTime","timeToCall"],"mappings":"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","file":"../elFinder.js","sourcesContent":["\tdefine([],function() {\n\n\t/**\n\t * @class elFinder - file manager for web\n\t *\n\t * @author Dmitry (dio) Levashov\n\t **/\n\tvar elFinder = function(elm, opts, bootCallback) {\n\t\t\"use strict\";\n\t\t//this.time('load');\n\t\tvar self = this,\n\t\t\t\n\t\t\t/**\n\t\t\t * Objects array of jQuery.Deferred that calls before elFinder boot up\n\t\t\t * \n\t\t\t * @type Array\n\t\t\t */\n\t\t\tdfrdsBeforeBootup = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Plugin name to check for conflicts with bootstrap etc\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tconflictChecks = ['button', 'tooltip'],\n\t\t\t\n\t\t\t/**\n\t\t\t * Node on which elfinder creating\n\t\t\t *\n\t\t\t * @type jQuery\n\t\t\t **/\n\t\t\tnode = $(elm),\n\t\t\t\n\t\t\t/**\n\t\t\t * Object of events originally registered in this node\n\t\t\t * \n\t\t\t * @type Object\n\t\t\t */\n\t\t\tprevEvents = $.extend(true, {}, $._data(node.get(0), 'events')),\n\t\t\t\n\t\t\t/**\n\t\t\t * Store node contents.\n\t\t\t *\n\t\t\t * @see this.destroy\n\t\t\t * @type jQuery\n\t\t\t **/\n\t\t\tprevContent = $('<div/>').append(node.contents()).attr('class', node.attr('class') || '').attr('style', node.attr('style') || ''),\n\t\t\t\n\t\t\t/**\n\t\t\t * Instance ID. Required to get/set cookie\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tid = node.attr('id') || node.attr('id', 'elfauto' + $('.elfinder').length).attr('id'),\n\t\t\t\n\t\t\t/**\n\t\t\t * Events namespace\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tnamespace = 'elfinder-' + id,\n\t\t\t\n\t\t\t/**\n\t\t\t * Mousedown event\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tmousedown = 'mousedown.'+namespace,\n\t\t\t\n\t\t\t/**\n\t\t\t * Keydown event\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tkeydown = 'keydown.'+namespace,\n\t\t\t\n\t\t\t/**\n\t\t\t * Keypress event\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tkeypress = 'keypress.'+namespace,\n\t\t\t\n\t\t\t/**\n\t\t\t * Keypup event\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tkeyup    = 'keyup.'+namespace,\n\n\t\t\t/**\n\t\t\t * Is shortcuts/commands enabled\n\t\t\t *\n\t\t\t * @type Boolean\n\t\t\t **/\n\t\t\tenabled = false,\n\t\t\t\n\t\t\t/**\n\t\t\t * Store enabled value before ajax request\n\t\t\t *\n\t\t\t * @type Boolean\n\t\t\t **/\n\t\t\tprevEnabled = false,\n\t\t\t\n\t\t\t/**\n\t\t\t * List of build-in events which mapped into methods with same names\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tevents = ['enable', 'disable', 'load', 'open', 'reload', 'select',  'add', 'remove', 'change', 'dblclick', 'getfile', 'lockfiles', 'unlockfiles', 'selectfiles', 'unselectfiles', 'dragstart', 'dragstop', 'search', 'searchend', 'viewchange'],\n\t\t\t\n\t\t\t/**\n\t\t\t * Rules to validate data from backend\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\trules = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Current working directory hash\n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tcwd = '',\n\t\t\t\n\t\t\t/**\n\t\t\t * Current working directory options default\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tcwdOptionsDefault = {\n\t\t\t\tpath          : '',\n\t\t\t\turl           : '',\n\t\t\t\ttmbUrl        : '',\n\t\t\t\tdisabled      : [],\n\t\t\t\tseparator     : '/',\n\t\t\t\tarchives      : [],\n\t\t\t\textract       : [],\n\t\t\t\tcopyOverwrite : true,\n\t\t\t\tuploadOverwrite : true,\n\t\t\t\tuploadMaxSize : 0,\n\t\t\t\tjpgQuality    : 100,\n\t\t\t\ttmbCrop       : false,\n\t\t\t\ttmbReqCustomData : false,\n\t\t\t\ttmb           : false // old API\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Current working directory options\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tcwdOptions = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Files/dirs cache\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tfiles = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Hidden Files/dirs cache\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\thiddenFiles = {},\n\n\t\t\t/**\n\t\t\t * Files/dirs hash cache of each dirs\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\townFiles = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Selected files hashes\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tselected = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Events listeners\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tlisteners = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Shortcuts\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tshortcuts = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Buffer for copied files\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tclipboard = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Copied/cuted files hashes\n\t\t\t * Prevent from remove its from cache.\n\t\t\t * Required for dispaly correct files names in error messages\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tremember = {},\n\t\t\t\n\t\t\t/**\n\t\t\t * Queue for 'open' requests\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tqueue = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Queue for only cwd requests e.g. `tmb`\n\t\t\t *\n\t\t\t * @type Array\n\t\t\t **/\n\t\t\tcwdQueue = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Commands prototype\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tbase = new self.command(self),\n\t\t\t\n\t\t\t/**\n\t\t\t * elFinder node width\n\t\t\t *\n\t\t\t * @type String\n\t\t\t * @default \"auto\"\n\t\t\t **/\n\t\t\twidth  = 'auto',\n\t\t\t\n\t\t\t/**\n\t\t\t * elFinder node height\n\t\t\t * Number: pixcel or String: Number + \"%\"\n\t\t\t *\n\t\t\t * @type Number | String\n\t\t\t * @default 400\n\t\t\t **/\n\t\t\theight = 400,\n\t\t\t\n\t\t\t/**\n\t\t\t * Base node object or selector\n\t\t\t * Element which is the reference of the height percentage\n\t\t\t *\n\t\t\t * @type Object|String\n\t\t\t * @default null | $(window) (if height is percentage)\n\t\t\t **/\n\t\t\theightBase = null,\n\t\t\t\n\t\t\t/**\n\t\t\t * MIME type list(Associative array) handled as a text file\n\t\t\t * \n\t\t\t * @type Object|null\n\t\t\t */\n\t\t\ttextMimes = null,\n\t\t\t\n\t\t\t/**\n\t\t\t * elfinder path for sound played on remove\n\t\t\t * @type String\n\t\t\t * @default ./sounds/\n\t\t\t **/\n\t\t\tsoundPath = 'sounds/',\n\t\t\t\n\t\t\t/**\n\t\t\t * JSON.stringify of previous fm.sorters\n\t\t\t * @type String\n\t\t\t */\n\t\t\tprevSorterStr = '',\n\n\t\t\t/**\n\t\t\t * Map table of file extention to MIME-Type\n\t\t\t * @type Object\n\t\t\t */\n\t\t\textToMimeTable,\n\n\t\t\t/**\n\t\t\t * Disabled page unload function\n\t\t\t * @type Boolean\n\t\t\t */\n\t\t\tdiableUnloadCheck = false,\n\n\t\t\tbeeper = $(document.createElement('audio')).hide().appendTo('body')[0],\n\t\t\t\t\n\t\t\tsyncInterval,\n\t\t\tautoSyncStop = 0,\n\t\t\t\n\t\t\tuiCmdMapPrev = '',\n\t\t\t\n\t\t\tgcJobRes = null,\n\t\t\t\n\t\t\topen = function(data) {\n\t\t\t\t// NOTES: Do not touch data object\n\t\t\t\n\t\t\t\tvar volumeid, contextmenu, emptyDirs = {}, stayDirs = {},\n\t\t\t\t\trmClass, hashes, calc, gc, collapsed, prevcwd, sorterStr, diff;\n\t\t\t\t\n\t\t\t\tif (self.api >= 2.1) {\n\t\t\t\t\t// support volume driver option `uiCmdMap`\n\t\t\t\t\tself.commandMap = (data.options.uiCmdMap && Object.keys(data.options.uiCmdMap).length)? data.options.uiCmdMap : {};\n\t\t\t\t\tif (uiCmdMapPrev !== JSON.stringify(self.commandMap)) {\n\t\t\t\t\t\tuiCmdMapPrev = JSON.stringify(self.commandMap);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tself.options.sync = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (data.init) {\n\t\t\t\t\t// init - reset cache\n\t\t\t\t\tfiles = {};\n\t\t\t\t\townFiles = {};\n\t\t\t\t} else {\n\t\t\t\t\t// remove only files from prev cwd\n\t\t\t\t\t// and collapsed directory (included 100+ directories) to empty for perfomance tune in DnD\n\t\t\t\t\tprevcwd = cwd;\n\t\t\t\t\trmClass = 'elfinder-subtree-loaded ' + self.res('class', 'navexpand');\n\t\t\t\t\tcollapsed = self.res('class', 'navcollapse');\n\t\t\t\t\thashes = Object.keys(files);\n\t\t\t\t\tcalc = function(i) {\n\t\t\t\t\t\tif (!files[i]) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar isDir = (files[i].mime === 'directory'),\n\t\t\t\t\t\t\tphash = files[i].phash,\n\t\t\t\t\t\t\tpnav;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(!isDir\n\t\t\t\t\t\t\t\t|| emptyDirs[phash]\n\t\t\t\t\t\t\t\t|| (!stayDirs[phash]\n\t\t\t\t\t\t\t\t\t&& self.navHash2Elm(files[i].hash).is(':hidden')\n\t\t\t\t\t\t\t\t\t&& self.navHash2Elm(phash).next('.elfinder-navbar-subtree').children().length > 100\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t&& (isDir || phash !== cwd)\n\t\t\t\t\t\t\t&& ! remember[i]\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (isDir && !emptyDirs[phash]) {\n\t\t\t\t\t\t\t\temptyDirs[phash] = true;\n\t\t\t\t\t\t\t\tself.navHash2Elm(phash)\n\t\t\t\t\t\t\t\t .removeClass(rmClass)\n\t\t\t\t\t\t\t\t .next('.elfinder-navbar-subtree').empty();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdeleteCache(files[i]);\n\t\t\t\t\t\t} else if (isDir) {\n\t\t\t\t\t\t\tstayDirs[phash] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tgc = function() {\n\t\t\t\t\t\tif (hashes.length) {\n\t\t\t\t\t\t\tgcJobRes && gcJobRes._abort();\n\t\t\t\t\t\t\tgcJobRes = self.asyncJob(calc, hashes, {\n\t\t\t\t\t\t\t\tinterval : 20,\n\t\t\t\t\t\t\t\tnumPerOnce : 100\n\t\t\t\t\t\t\t}).done(function() {\n\t\t\t\t\t\t\t\tvar hd = self.storage('hide') || {items: {}};\n\t\t\t\t\t\t\t\tif (Object.keys(hiddenFiles).length) {\n\t\t\t\t\t\t\t\t\t$.each(hiddenFiles, function(h) {\n\t\t\t\t\t\t\t\t\t\tif (!hd.items[h]) {\n\t\t\t\t\t\t\t\t\t\t\tdelete hiddenFiles[h];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tself.trigger('filesgc').one('filesgc', function() {\n\t\t\t\t\t\thashes = [];\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tself.one('opendone', function() {\n\t\t\t\t\t\tif (prevcwd !== cwd) {\n\t\t\t\t\t\t\tif (! node.data('lazycnt')) {\n\t\t\t\t\t\t\t\tgc();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tself.one('lazydone', gc);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tself.sorters = {};\n\t\t\t\tcwd = data.cwd.hash;\n\t\t\t\tcache(data.files);\n\t\t\t\tif (!files[cwd]) {\n\t\t\t\t\tcache([data.cwd]);\n\t\t\t\t} else {\n\t\t\t\t\tdiff = self.diff([data.cwd], true);\n\t\t\t\t\tif (diff.changed.length) {\n\t\t\t\t\t\tcache(diff.changed, 'change');\n\t\t\t\t\t\tself.change({changed: diff.changed});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdata.changed && data.changed.length && cache(data.changed, 'change');\n\n\t\t\t\t// trigger event 'sorterupdate'\n\t\t\t\tsorterStr = JSON.stringify(self.sorters);\n\t\t\t\tif (prevSorterStr !== sorterStr) {\n\t\t\t\t\tself.trigger('sorterupdate');\n\t\t\t\t\tprevSorterStr = sorterStr;\n\t\t\t\t}\n\n\t\t\t\tself.lastDir(cwd);\n\t\t\t\t\n\t\t\t\tself.autoSync();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Store info about files/dirs in \"files\" object.\n\t\t\t *\n\t\t\t * @param  Array  files\n\t\t\t * @param  String data type\n\t\t\t * @return void\n\t\t\t **/\n\t\t\tcache = function(data, type) {\n\t\t\t\tvar type      = type || 'files',\n\t\t\t\t\tkeeps = ['sizeInfo', 'encoding'],\n\t\t\t\t\tdefsorter = { name: true, perm: true, date: true,  size: true, kind: true },\n\t\t\t\t\tsorterChk = !self.sorters._checked && (type === 'files'),\n\t\t\t\t\tl         = data.length,\n\t\t\t\t\tsetSorter = function(file) {\n\t\t\t\t\t\tvar f = file || {},\n\t\t\t\t\t\t\tsorters = [];\n\t\t\t\t\t\t$.each(self.sortRules, function(key) {\n\t\t\t\t\t\t\tif (defsorter[key] || typeof f[key] !== 'undefined' || (key === 'mode' && typeof f.perm !== 'undefined')) {\n\t\t\t\t\t\t\t\tsorters.push(key);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.sorters = self.arrayFlip(sorters, true);\n\t\t\t\t\t\tself.sorters._checked = true;\n\t\t\t\t\t},\n\t\t\t\t\tchangedParents = {},\n\t\t\t\t\thideData = self.storage('hide') || {},\n\t\t\t\t\thides = hideData.items || {},\n\t\t\t\t\tf, i, i1, keepProp, parents, hidden;\n\n\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\tf = Object.assign({}, data[i]);\n\t\t\t\t\thidden = (!hideData.show && hides[f.hash])? true : false;\n\t\t\t\t\tif (f.name && f.hash && f.mime) {\n\t\t\t\t\t\tif (!hidden) {\n\t\t\t\t\t\t\tif (sorterChk && f.phash === cwd) {\n\t\t\t\t\t\t\t\tsetSorter(f);\n\t\t\t\t\t\t\t\tsorterChk = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (f.phash && (type === 'add' || (type === 'change' && (!files[f.hash] || f.size !== files[f.hash])))) {\n\t\t\t\t\t\t\t\tif (parents = self.parents(f.phash)) {\n\t\t\t\t\t\t\t\t\t$.each(parents, function() {\n\t\t\t\t\t\t\t\t\t\tchangedParents[this] = true;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (files[f.hash]) {\n\t\t\t\t\t\t\tfor (i1 =0; i1 < keeps.length; i1++) {\n\t\t\t\t\t\t\t\tif(files[f.hash][keeps[i1]] && ! f[keeps[i1]]) {\n\t\t\t\t\t\t\t\t\tf[keeps[i1]] = files[f.hash][keeps[i1]];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (f.sizeInfo && !f.size) {\n\t\t\t\t\t\t\t\tf.size = f.sizeInfo.size;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdeleteCache(files[f.hash], true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hides[f.hash]) {\n\t\t\t\t\t\t\thiddenFiles[f.hash] = f;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hidden) {\n\t\t\t\t\t\t\tl--;\n\t\t\t\t\t\t\tdata.splice(i--, 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfiles[f.hash] = f;\n\t\t\t\t\t\t\tif (f.mime === 'directory' && !ownFiles[f.hash]) {\n\t\t\t\t\t\t\t\townFiles[f.hash] = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (f.phash) {\n\t\t\t\t\t\t\t\tif (!ownFiles[f.phash]) {\n\t\t\t\t\t\t\t\t\townFiles[f.phash] = {};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\townFiles[f.phash][f.hash] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// delete sizeInfo cache\n\t\t\t\t$.each(Object.keys(changedParents), function() {\n\t\t\t\t\tvar target = files[this];\n\t\t\t\t\tif (target && target.sizeInfo) {\n\t\t\t\t\t\tdelete target.sizeInfo;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// for empty folder\n\t\t\t\tsorterChk && setSorter();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Delete file object from files caches\n\t\t\t * \n\t\t\t * @param  Array  removed hashes\n\t\t\t * @return void\n\t\t\t */\n\t\t\tremove = function(removed) {\n\t\t\t\tvar l       = removed.length,\n\t\t\t\t\troots   = {},\n\t\t\t\t\trm      = function(hash) {\n\t\t\t\t\t\tvar file = files[hash], i;\n\t\t\t\t\t\tif (file) {\n\t\t\t\t\t\t\tif (file.mime === 'directory') {\n\t\t\t\t\t\t\t\tif (roots[hash]) {\n\t\t\t\t\t\t\t\t\tdelete self.roots[roots[hash]];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// restore stats of deleted root parent directory\n\t\t\t\t\t\t\t\t$.each(self.leafRoots, function(phash, roots) {\n\t\t\t\t\t\t\t\t\tvar idx, pdir;\n\t\t\t\t\t\t\t\t\tif ((idx = $.inArray(hash, roots))!== -1) {\n\t\t\t\t\t\t\t\t\t\tif (roots.length === 1) {\n\t\t\t\t\t\t\t\t\t\t\tif ((pdir = Object.assign({}, files[phash])) && pdir._realStats) {\n\t\t\t\t\t\t\t\t\t\t\t\t$.each(pdir._realStats, function(k, v) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tpdir[k] = v;\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tremove(files[phash]._realStats);\n\t\t\t\t\t\t\t\t\t\t\t\tself.change({ changed: [pdir] });\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdelete self.leafRoots[phash];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tself.leafRoots[phash].splice(idx, 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (self.searchStatus.state < 2) {\n\t\t\t\t\t\t\t\t\t$.each(files, function(h, f) {\n\t\t\t\t\t\t\t\t\t\tf.phash == hash && rm(h);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (file.phash) {\n\t\t\t\t\t\t\t\tif (parents = self.parents(file.phash)) {\n\t\t\t\t\t\t\t\t\t$.each(parents, function() {\n\t\t\t\t\t\t\t\t\t\tchangedParents[this] = true;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdeleteCache(files[hash]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tchangedParents = {},\n\t\t\t\t\tparents;\n\t\t\t\n\t\t\t\t$.each(self.roots, function(k, v) {\n\t\t\t\t\troots[v] = k;\n\t\t\t\t});\n\t\t\t\twhile (l--) {\n\t\t\t\t\trm(removed[l]);\n\t\t\t\t}\n\t\t\t\t// delete sizeInfo cache\n\t\t\t\t$.each(Object.keys(changedParents), function() {\n\t\t\t\t\tvar target = files[this];\n\t\t\t\t\tif (target && target.sizeInfo) {\n\t\t\t\t\t\tdelete target.sizeInfo;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Update file object in files caches\n\t\t\t * \n\t\t\t * @param  Array  changed file objects\n\t\t\t * @return void\n\t\t\t * @deprecated should be use `cache(updatesArrayData, 'change');`\n\t\t\t */\n\t\t\tchange = function(changed) {\n\t\t\t\t$.each(changed, function(i, file) {\n\t\t\t\t\tvar hash = file.hash;\n\t\t\t\t\tif (files[hash]) {\n\t\t\t\t\t\t$.each(Object.keys(files[hash]), function(i, v){\n\t\t\t\t\t\t\tif (typeof file[v] === 'undefined') {\n\t\t\t\t\t\t\t\tdelete files[hash][v];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tfiles[hash] = files[hash] ? Object.assign(files[hash], file) : file;\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Delete cache data of files, ownFiles and self.optionsByHashes\n\t\t\t * \n\t\t\t * @param  Object  file\n\t\t\t * @param  Boolean update\n\t\t\t * @return void\n\t\t\t */\n\t\t\tdeleteCache = function(file, update) {\n\t\t\t\tvar hash = file.hash,\n\t\t\t\t\tphash = file.phash;\n\t\t\t\t\n\t\t\t\tif (phash && ownFiles[phash]) {\n\t\t\t\t\t delete ownFiles[phash][hash];\n\t\t\t\t}\n\t\t\t\tif (!update) {\n\t\t\t\t\townFiles[hash] && delete ownFiles[hash];\n\t\t\t\t\tself.optionsByHashes[hash] && delete self.optionsByHashes[hash];\n\t\t\t\t}\n\t\t\t\tdelete files[hash];\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * Maximum number of concurrent connections on request\n\t\t\t * \n\t\t\t * @type Number\n\t\t\t */\n\t\t\trequestMaxConn,\n\t\t\t\n\t\t\t/**\n\t\t\t * Current number of connections\n\t\t\t * \n\t\t\t * @type Number\n\t\t\t */\n\t\t\trequestCnt = 0,\n\t\t\t\n\t\t\t/**\n\t\t\t * Queue waiting for connection\n\t\t\t * \n\t\t\t * @type Array\n\t\t\t */\n\t\t\trequestQueue = [],\n\t\t\t\n\t\t\t/**\n\t\t\t * Current open command instance\n\t\t\t * \n\t\t\t * @type Object\n\t\t\t */\n\t\t\tcurrentOpenCmd = null,\n\n\t\t\t/**\n\t\t\t * Exec shortcut\n\t\t\t *\n\t\t\t * @param  jQuery.Event  keydown/keypress event\n\t\t\t * @return void\n\t\t\t */\n\t\t\texecShortcut = function(e) {\n\t\t\t\tvar code    = e.keyCode,\n\t\t\t\t\tctrlKey = !!(e.ctrlKey || e.metaKey),\n\t\t\t\t\tisMousedown = e.type === 'mousedown',\n\t\t\t\t\tddm;\n\n\t\t\t\t!isMousedown && (self.keyState.keyCode = code);\n\t\t\t\tself.keyState.ctrlKey  = ctrlKey;\n\t\t\t\tself.keyState.shiftKey = e.shiftKey;\n\t\t\t\tself.keyState.metaKey  = e.metaKey;\n\t\t\t\tself.keyState.altKey   = e.altKey;\n\t\t\t\tif (isMousedown) {\n\t\t\t\t\treturn;\n\t\t\t\t} else if (e.type === 'keyup') {\n\t\t\t\t\tself.keyState.keyCode = null;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (enabled) {\n\n\t\t\t\t\t$.each(shortcuts, function(i, shortcut) {\n\t\t\t\t\t\tif (shortcut.type    == e.type \n\t\t\t\t\t\t&& shortcut.keyCode  == code \n\t\t\t\t\t\t&& shortcut.shiftKey == e.shiftKey \n\t\t\t\t\t\t&& shortcut.ctrlKey  == ctrlKey \n\t\t\t\t\t\t&& shortcut.altKey   == e.altKey) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tshortcut.callback(e, self);\n\t\t\t\t\t\t\tself.debug('shortcut-exec', i+' : '+shortcut.description);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// prevent tab out of elfinder\n\t\t\t\t\tif (code == $.ui.keyCode.TAB && !$(e.target).is(':input')) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// cancel any actions by [Esc] key\n\t\t\t\t\tif (e.type === 'keydown' && code == $.ui.keyCode.ESCAPE) {\n\t\t\t\t\t\t// copy or cut \n\t\t\t\t\t\tif (! node.find('.ui-widget:visible').length) {\n\t\t\t\t\t\t\tself.clipboard().length && self.clipboard([]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// dragging\n\t\t\t\t\t\tif ($.ui.ddmanager) {\n\t\t\t\t\t\t\tddm = $.ui.ddmanager.current;\n\t\t\t\t\t\t\tddm && ddm.helper && ddm.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// button menus\n\t\t\t\t\t\tself.toHide(node.find('.ui-widget.elfinder-button-menu.elfinder-frontmost:visible'));\n\t\t\t\t\t\t// trigger keydownEsc\n\t\t\t\t\t\tself.trigger('keydownEsc', e);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tdate = new Date(),\n\t\t\tutc,\n\t\t\ti18n,\n\t\t\tinFrame = (window.parent !== window),\n\t\t\tparentIframe = (function() {\n\t\t\t\tvar pifm, ifms;\n\t\t\t\tif (inFrame) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tifms = $('iframe', window.parent.document);\n\t\t\t\t\t\tif (ifms.length) {\n\t\t\t\t\t\t\t$.each(ifms, function(i, ifm) {\n\t\t\t\t\t\t\t\tif (ifm.contentWindow === window) {\n\t\t\t\t\t\t\t\t\tpifm = $(ifm);\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\treturn pifm;\n\t\t\t})(),\n\t\t\t/**\n\t\t\t * elFinder boot up function\n\t\t\t * \n\t\t\t * @type Function\n\t\t\t */\n\t\t\tbootUp,\n\t\t\t/**\n\t\t\t * Original function of XMLHttpRequest.prototype.send\n\t\t\t * \n\t\t\t * @type Function\n\t\t\t */\n\t\t\tsavedXhrSend;\n\t\t\n\t\t// opts must be an object\n\t\tif (!opts) {\n\t\t\topts = {};\n\t\t}\n\t\t\n\t\t// set UA.Angle, UA.Rotated for mobile devices\n\t\tif (self.UA.Mobile) {\n\t\t\t$(window).on('orientationchange.'+namespace, function() {\n\t\t\t\tvar a = ((screen && screen.orientation && screen.orientation.angle) || window.orientation || 0) + 0;\n\t\t\t\tif (a === -90) {\n\t\t\t\t\ta = 270;\n\t\t\t\t}\n\t\t\t\tself.UA.Angle = a;\n\t\t\t\tself.UA.Rotated = a % 180 === 0? false : true;\n\t\t\t}).trigger('orientationchange.'+namespace);\n\t\t}\n\t\t\n\t\t// check opt.bootCallback\n\t\tif (opts.bootCallback && typeof opts.bootCallback === 'function') {\n\t\t\t(function() {\n\t\t\t\tvar func = bootCallback,\n\t\t\t\t\topFunc = opts.bootCallback;\n\t\t\t\tbootCallback = function(fm, extraObj) {\n\t\t\t\t\tfunc && typeof func === 'function' && func.call(this, fm, extraObj);\n\t\t\t\t\topFunc.call(this, fm, extraObj);\n\t\t\t\t};\n\t\t\t})();\n\t\t}\n\t\tdelete opts.bootCallback;\n\n\t\t/**\n\t\t * Protocol version\n\t\t *\n\t\t * @type String\n\t\t **/\n\t\tthis.api = null;\n\t\t\n\t\t/**\n\t\t * elFinder use new api\n\t\t *\n\t\t * @type Boolean\n\t\t **/\n\t\tthis.newAPI = false;\n\t\t\n\t\t/**\n\t\t * elFinder use old api\n\t\t *\n\t\t * @type Boolean\n\t\t **/\n\t\tthis.oldAPI = false;\n\t\t\n\t\t/**\n\t\t * Net drivers names\n\t\t *\n\t\t * @type Array\n\t\t **/\n\t\tthis.netDrivers = [];\n\t\t\n\t\t/**\n\t\t * Base URL of elfFinder library starting from Manager HTML\n\t\t * \n\t\t * @type String\n\t\t */\n\t\tthis.baseUrl = '';\n\t\t\n\t\t/**\n\t\t * Base URL of i18n js files\n\t\t * baseUrl + \"js/i18n/\" when empty value\n\t\t * \n\t\t * @type String\n\t\t */\n\t\tthis.i18nBaseUrl = '';\n\n\t\t/**\n\t\t * Is elFinder CSS loaded\n\t\t * \n\t\t * @type Boolean\n\t\t */\n\t\tthis.cssloaded = false;\n\t\t\n\t\t/**\n\t\t * Current theme object\n\t\t * \n\t\t * @type Object|Null\n\t\t */\n\t\tthis.theme = null;\n\n\t\tthis.mimesCanMakeEmpty = {};\n\n\t\t/**\n\t\t * Callback function at boot up that option specified at elFinder starting\n\t\t * \n\t\t * @type Function\n\t\t */\n\t\tthis.bootCallback;\n\n\t\t/**\n\t\t * Callback function at reload(restart) elFinder \n\t\t * \n\t\t * @type Function\n\t\t */\n\t\tthis.reloadCallback;\n\n\t\t/**\n\t\t * ID. Required to create unique cookie name\n\t\t *\n\t\t * @type String\n\t\t **/\n\t\tthis.id = id;\n\n\t\t/**\n\t\t * Method to store/fetch data\n\t\t *\n\t\t * @type Function\n\t\t **/\n\t\tthis.storage = (function() {\n\t\t\ttry {\n\t\t\t\tif ('localStorage' in window && window.localStorage !== null) {\n\t\t\t\t\tif (self.UA.Safari) {\n\t\t\t\t\t\t// check for Mac/iOS safari private browsing mode\n\t\t\t\t\t\twindow.localStorage.setItem('elfstoragecheck', 1);\n\t\t\t\t\t\twindow.localStorage.removeItem('elfstoragecheck');\n\t\t\t\t\t}\n\t\t\t\t\treturn self.localStorage;\n\t\t\t\t} else {\n\t\t\t\t\treturn self.cookie;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\treturn self.cookie;\n\t\t\t}\n\t\t})();\n\n\t\t/**\n\t\t * Set pause page unload check function or Get state\n\t\t *\n\t\t * @param      Boolean   state   To set state\n\t\t * @param      Boolean   keep    Keep disabled\n\t\t * @return     Boolean|void\n\t\t */\n\t\tthis.pauseUnloadCheck = function(state, keep) {\n\t\t\tif (typeof state === 'undefined') {\n\t\t\t\treturn diableUnloadCheck;\n\t\t\t} else {\n\t\t\t\tdiableUnloadCheck = !!state;\n\t\t\t\tif (state && !keep) {\n\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\tdiableUnloadCheck = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Configuration options\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\t//this.options = $.extend(true, {}, this._options, opts);\n\t\tthis.options = Object.assign({}, this._options);\n\t\t\n\t\t// for old type configuration\n\t\tif (opts.uiOptions) {\n\t\t\tif (opts.uiOptions.toolbar && Array.isArray(opts.uiOptions.toolbar)) {\n\t\t\t\tif ($.isPlainObject(opts.uiOptions.toolbar[opts.uiOptions.toolbar.length - 1])) {\n\t\t\t\t\tself.options.uiOptions.toolbarExtra = Object.assign(self.options.uiOptions.toolbarExtra || {}, opts.uiOptions.toolbar.pop());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Overwrite if opts value is an array\n\t\t(function() {\n\t\t\tvar arrOv = function(obj, base) {\n\t\t\t\tif ($.isPlainObject(obj)) {\n\t\t\t\t\t$.each(obj, function(k, v) {\n\t\t\t\t\t\tif ($.isPlainObject(v)) {\n\t\t\t\t\t\t\tif (!base[k]) {\n\t\t\t\t\t\t\t\tbase[k] = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tarrOv(v, base[k]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbase[k] = v;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\tarrOv(opts, self.options);\n\t\t})();\n\t\t\n\t\t// join toolbarExtra to toolbar\n\t\tthis.options.uiOptions.toolbar.push(this.options.uiOptions.toolbarExtra);\n\t\tdelete this.options.uiOptions.toolbarExtra;\n\n\t\t/**\n\t\t * Arrays that has to unbind events\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.toUnbindEvents = {};\n\t\t\n\t\t/**\n\t\t * Attach listener to events\n\t\t * To bind to multiply events at once, separate events names by space\n\t\t * \n\t\t * @param  String  event(s) name(s)\n\t\t * @param  Object  event handler or {done: handler}\n\t\t * @param  Boolean priority first\n\t\t * @return elFinder\n\t\t */\n\t\tthis.bind = function(event, callback, priorityFirst) {\n\t\t\tvar i, len;\n\t\t\t\n\t\t\tif (callback && (typeof callback === 'function' || typeof callback.done === 'function')) {\n\t\t\t\tevent = ('' + event).toLowerCase().replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\n\t\t\t\t\n\t\t\t\tlen = event.length;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tif (listeners[event[i]] === void(0)) {\n\t\t\t\t\t\tlisteners[event[i]] = [];\n\t\t\t\t\t}\n\t\t\t\t\tlisteners[event[i]][priorityFirst? 'unshift' : 'push'](callback);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Remove event listener if exists\n\t\t * To un-bind to multiply events at once, separate events names by space\n\t\t *\n\t\t * @param  String    event(s) name(s)\n\t\t * @param  Function  callback\n\t\t * @return elFinder\n\t\t */\n\t\tthis.unbind = function(event, callback) {\n\t\t\tvar i, len, l, ci;\n\t\t\t\n\t\t\tevent = ('' + event).toLowerCase().split(/\\s+/);\n\t\t\t\n\t\t\tlen = event.length;\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tif (l = listeners[event[i]]) {\n\t\t\t\t\tci = $.inArray(callback, l);\n\t\t\t\t\tci > -1 && l.splice(ci, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcallback = null;\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Fire event - send notification to all event listeners\n\t\t * In the callback `this` becames an event object\n\t\t *\n\t\t * @param  String   event type\n\t\t * @param  Object   data to send across event\n\t\t * @param  Boolean  allow modify data (call by reference of data) default: true\n\t\t * @return elFinder\n\t\t */\n\t\tthis.trigger = function(evType, data, allowModify) {\n\t\t\tvar type      = evType.toLowerCase(),\n\t\t\t\tisopen    = (type === 'open'),\n\t\t\t\tdataIsObj = (typeof data === 'object'),\n\t\t\t\thandlers  = listeners[type] || [],\n\t\t\t\tdones     = [],\n\t\t\t\ti, l, jst, event;\n\t\t\t\n\t\t\tthis.debug('event-'+type, data);\n\t\t\t\n\t\t\tif (! dataIsObj || typeof allowModify === 'undefined') {\n\t\t\t\tallowModify = true;\n\t\t\t}\n\t\t\tif (l = handlers.length) {\n\t\t\t\tevent = $.Event(type);\n\t\t\t\tif (data) {\n\t\t\t\t\tdata._getEvent = function() {\n\t\t\t\t\t\treturn event;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif (allowModify) {\n\t\t\t\t\tevent.data = data;\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\tif (! handlers[i]) {\n\t\t\t\t\t\t// probably un-binded this handler\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// handler is $.Deferred(), call all functions upon completion\n\t\t\t\t\tif (handlers[i].done) {\n\t\t\t\t\t\tdones.push(handlers[i].done);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// set `event.data` only callback has argument\n\t\t\t\t\tif (handlers[i].length) {\n\t\t\t\t\t\tif (!allowModify) {\n\t\t\t\t\t\t\t// to avoid data modifications. remember about \"sharing\" passing arguments in js :) \n\t\t\t\t\t\t\tif (typeof jst === 'undefined') {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tjst = JSON.stringify(data);\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\tjst = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tevent.data = jst? JSON.parse(jst) : data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (handlers[i].call(event, event, this) === false || event.isDefaultPrevented()) {\n\t\t\t\t\t\t\tthis.debug('event-stoped', event.type);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\twindow.console && window.console.log && window.console.log(ex);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// call done functions\n\t\t\t\tif (l = dones.length) {\n\t\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (dones[i].call(event, event, this) === false || event.isDefaultPrevented()) {\n\t\t\t\t\t\t\t\tthis.debug('event-stoped', event.type + '(done)');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\twindow.console && window.console.log && window.console.log(ex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.toUnbindEvents[type] && this.toUnbindEvents[type].length) {\n\t\t\t\t\t$.each(this.toUnbindEvents[type], function(i, v) {\n\t\t\t\t\t\tself.unbind(v.type, v.callback);\n\t\t\t\t\t});\n\t\t\t\t\tdelete this.toUnbindEvents[type];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Get event listeners\n\t\t *\n\t\t * @param  String   event type\n\t\t * @return Array    listed event functions\n\t\t */\n\t\tthis.getListeners = function(event) {\n\t\t\treturn event? listeners[event.toLowerCase()] : listeners;\n\t\t};\n\n\t\t// set fm.baseUrl\n\t\tthis.baseUrl = (function() {\n\t\t\tvar myTag, base, baseUrl;\n\t\t\t\n\t\t\tif (self.options.baseUrl) {\n\t\t\t\treturn self.options.baseUrl;\n\t\t\t} else {\n\t\t\t\tbaseUrl = '';\n\t\t\t\tmyTag = null;\n\t\t\t\t$('head > script').each(function() {\n\t\t\t\t\tif (this.src && this.src.match(/js\\/elfinder(?:-[a-z0-9_-]+)?\\.(?:min|full)\\.js$/i)) {\n\t\t\t\t\t\tmyTag = $(this);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (myTag) {\n\t\t\t\t\tbaseUrl = myTag.attr('src').replace(/js\\/[^\\/]+$/, '');\n\t\t\t\t\tif (! baseUrl.match(/^(https?\\/\\/|\\/)/)) {\n\t\t\t\t\t\t// check <base> tag\n\t\t\t\t\t\tif (base = $('head > base[href]').attr('href')) {\n\t\t\t\t\t\t\tbaseUrl = base.replace(/\\/$/, '') + '/' + baseUrl; \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (baseUrl !== '') {\n\t\t\t\t\tself.options.baseUrl = baseUrl;\n\t\t\t\t} else {\n\t\t\t\t\tif (! self.options.baseUrl) {\n\t\t\t\t\t\tself.options.baseUrl = './';\n\t\t\t\t\t}\n\t\t\t\t\tbaseUrl = self.options.baseUrl;\n\t\t\t\t}\n\t\t\t\treturn baseUrl;\n\t\t\t}\n\t\t})();\n\t\t\n\t\tthis.i18nBaseUrl = (this.options.i18nBaseUrl || this.baseUrl + 'js/i18n').replace(/\\/$/, '') + '/';\n\n\t\tthis.options.maxErrorDialogs = Math.max(1, parseInt(this.options.maxErrorDialogs || 5));\n\n\t\t// set dispInlineRegex\n\t\tcwdOptionsDefault.dispInlineRegex = this.options.dispInlineRegex;\n\n\t\t// auto load required CSS\n\t\tif (this.options.cssAutoLoad) {\n\t\t\t(function() {\n\t\t\t\tvar baseUrl = self.baseUrl,\n\t\t\t\t\tmyCss = $('head > link[href$=\"css/elfinder.min.css\"],link[href$=\"css/elfinder.full.css\"]:first').length,\n\t\t\t\t\trmTag = function() {\n\t\t\t\t\t\tif (node.data('cssautoloadHide')) {\n\t\t\t\t\t\t\tnode.data('cssautoloadHide').remove();\n\t\t\t\t\t\t\tnode.removeData('cssautoloadHide');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tloaded = function() {\n\t\t\t\t\t\tif (!self.cssloaded) {\n\t\t\t\t\t\t\trmTag();\n\t\t\t\t\t\t\tself.cssloaded = true;\n\t\t\t\t\t\t\tself.trigger('cssloaded');\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif (! myCss) {\n\t\t\t\t\t// to request CSS auto loading\n\t\t\t\t\tself.cssloaded = null;\n\t\t\t\t}\n\n\t\t\t\t// additional CSS files\n\t\t\t\tif (Array.isArray(self.options.cssAutoLoad)) {\n\t\t\t\t\tif (!self.options.themes.default) {\n\t\t\t\t\t\t// set as default theme\n\t\t\t\t\t\tself.options.themes = Object.assign({\n\t\t\t\t\t\t\t'default' : {\n\t\t\t\t\t\t\t\t'name': 'default',\n\t\t\t\t\t\t\t\t'cssurls': self.options.cssAutoLoad\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, self.options.themes);\n\t\t\t\t\t\tif (!self.options.theme) {\n\t\t\t\t\t\t\tself.options.theme = 'default';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (self.cssloaded === true) {\n\t\t\t\t\t\t\tself.loadCss(self.options.cssAutoLoad);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.bind('cssloaded', function() {\n\t\t\t\t\t\t\t\tself.loadCss(self.options.cssAutoLoad);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// try to load main css\n\t\t\t\tif (self.cssloaded === null) {\n\t\t\t\t\t// hide elFinder node while css loading\n\t\t\t\t\tnode.addClass('elfinder')\n\t\t\t\t\t\t.data('cssautoloadHide', $('<style>.elfinder{visibility:hidden;overflow:hidden}</style>'));\n\t\t\t\t\t$('head').append(node.data('cssautoloadHide'));\n\n\t\t\t\t\t// set default theme\n\t\t\t\t\tif (!self.options.themes.default) {\n\t\t\t\t\t\tself.options.themes = Object.assign({\n\t\t\t\t\t\t\t'default' : {\n\t\t\t\t\t\t\t\t'name': 'default',\n\t\t\t\t\t\t\t\t'cssurls': 'css/theme.css',\n\t\t\t\t\t\t\t\t'author': 'elFinder Project',\n\t\t\t\t\t\t\t\t'license': '3-clauses BSD'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, self.options.themes);\n\t\t\t\t\t\tif (!self.options.theme) {\n\t\t\t\t\t\t\tself.options.theme = 'default';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Delay 'visibility' check it required for browsers such as Safari\n\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\tif (node.css('visibility') === 'hidden') {\n\t\t\t\t\t\t\t// load CSS\n\t\t\t\t\t\t\tself.loadCss([baseUrl+'css/elfinder.min.css'], {\n\t\t\t\t\t\t\t\tdfd: $.Deferred().done(function() {\n\t\t\t\t\t\t\t\t\tloaded();\n\t\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\t\trmTag();\n\t\t\t\t\t\t\t\t\tif (!self.cssloaded) {\n\t\t\t\t\t\t\t\t\t\tself.cssloaded = false;\n\t\t\t\t\t\t\t\t\t\tself.bind('init', function() {\n\t\t\t\t\t\t\t\t\t\t\tif (!self.cssloaded) {\n\t\t\t\t\t\t\t\t\t\t\t\tself.error(['errRead', 'CSS (elfinder.min)']);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tloaded();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\n\t\t// load theme if exists\n\t\t(function() {\n\t\t\tvar theme,\n\t\t\t\tthemes = self.options.themes,\n\t\t\t\tids = Object.keys(themes || {});\n\t\t\tif (ids.length) {\n\t\t\t\ttheme = self.storage('theme') || self.options.theme;\n\t\t\t\tif (!themes[theme]) {\n\t\t\t\t\ttheme = ids[0];\n\t\t\t\t}\n\t\t\t\tif (self.cssloaded) {\n\t\t\t\t\tself.changeTheme(theme);\n\t\t\t\t} else {\n\t\t\t\t\tself.bind('cssloaded', function() {\n\t\t\t\t\t\tself.changeTheme(theme);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t\t\n\t\t/**\n\t\t * Volume option to set the properties of the root Stat\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.optionProperties = {\n\t\t\ticon: void(0),\n\t\t\tcsscls: void(0),\n\t\t\ttmbUrl: void(0),\n\t\t\tuiCmdMap: {},\n\t\t\tnetkey: void(0),\n\t\t\tdisabled: []\n\t\t};\n\t\t\n\t\tif (! inFrame && ! this.options.enableAlways && $('body').children().length === 2) { // only node and beeper\n\t\t\tthis.options.enableAlways = true;\n\t\t}\n\t\t\n\t\t// make options.debug\n\t\tif (this.options.debug === true) {\n\t\t\tthis.options.debug = 'all';\n\t\t} else if (Array.isArray(this.options.debug)) {\n\t\t\t(function() {\n\t\t\t\tvar d = {};\n\t\t\t\t$.each(self.options.debug, function() {\n\t\t\t\t\td[this] = true;\n\t\t\t\t});\n\t\t\t\tself.options.debug = d;\n\t\t\t})();\n\t\t} else {\n\t\t\tthis.options.debug = false;\n\t\t}\n\t\t\n\t\t/**\n\t\t * Original functions evacuated by conflict check\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.noConflicts = {};\n\t\t\n\t\t/**\n\t\t * Check and save conflicts with bootstrap etc\n\t\t * \n\t\t * @type Function\n\t\t */\n\t\tthis.noConflict = function() {\n\t\t\t$.each(conflictChecks, function(i, p) {\n\t\t\t\tif ($.fn[p] && typeof $.fn[p].noConflict === 'function') {\n\t\t\t\t\tself.noConflicts[p] = $.fn[p].noConflict();\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\t// do check conflict\n\t\tthis.noConflict();\n\t\t\n\t\t/**\n\t\t * Is elFinder over CORS\n\t\t *\n\t\t * @type Boolean\n\t\t **/\n\t\tthis.isCORS = false;\n\t\t\n\t\t// configure for CORS\n\t\t(function(){\n\t\t\tif (typeof self.options.cors !== 'undefined' && self.options.cors !== null) {\n\t\t\t\tself.isCORS = self.options.cors? true : false;\n\t\t\t} else {\n\t\t\t\tvar parseUrl = document.createElement('a'),\n\t\t\t\t\tparseUploadUrl,\n\t\t\t\t\tselfProtocol = window.location.protocol,\n\t\t\t\t\tportReg = function(protocol) {\n\t\t\t\t\t\tprotocol = (!protocol || protocol === ':')? selfProtocol : protocol;\n\t\t\t\t\t\treturn protocol === 'https:'? /\\:443$/ : /\\:80$/;\n\t\t\t\t\t},\n\t\t\t\t\tselfHost = window.location.host.replace(portReg(selfProtocol), '');\n\t\t\t\tparseUrl.href = opts.url;\n\t\t\t\tif (opts.urlUpload && (opts.urlUpload !== opts.url)) {\n\t\t\t\t\tparseUploadUrl = document.createElement('a');\n\t\t\t\t\tparseUploadUrl.href = opts.urlUpload;\n\t\t\t\t}\n\t\t\t\tif (selfHost !== parseUrl.host.replace(portReg(parseUrl.protocol), '')\n\t\t\t\t\t|| (parseUrl.protocol !== ':'&& parseUrl.protocol !== '' && (selfProtocol !== parseUrl.protocol))\n\t\t\t\t\t|| (parseUploadUrl && \n\t\t\t\t\t\t(selfHost !== parseUploadUrl.host.replace(portReg(parseUploadUrl.protocol), '')\n\t\t\t\t\t\t|| (parseUploadUrl.protocol !== ':' && parseUploadUrl.protocol !== '' && (selfProtocol !== parseUploadUrl.protocol))\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tself.isCORS = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (self.isCORS) {\n\t\t\t\tif (!$.isPlainObject(self.options.customHeaders)) {\n\t\t\t\t\tself.options.customHeaders = {};\n\t\t\t\t}\n\t\t\t\tif (!$.isPlainObject(self.options.xhrFields)) {\n\t\t\t\t\tself.options.xhrFields = {};\n\t\t\t\t}\n\t\t\t\tself.options.requestType = 'post';\n\t\t\t\tself.options.customHeaders['X-Requested-With'] = 'XMLHttpRequest';\n\t\t\t\tself.options.xhrFields['withCredentials'] = true;\n\t\t\t}\n\t\t})();\n\n\t\t/**\n\t\t * Ajax request type\n\t\t *\n\t\t * @type String\n\t\t * @default \"get\"\n\t\t **/\n\t\tthis.requestType = /^(get|post)$/i.test(this.options.requestType) ? this.options.requestType.toLowerCase() : 'get';\n\t\t\n\t\t// set `requestMaxConn` by option\n\t\trequestMaxConn = Math.max(parseInt(this.options.requestMaxConn), 1);\n\t\t\n\t\t/**\n\t\t * Custom data that given as options\n\t\t * \n\t\t * @type Object\n\t\t * @default {}\n\t\t */\n\t\tthis.optsCustomData = $.isPlainObject(this.options.customData) ? this.options.customData : {};\n\n\t\t/**\n\t\t * Any data to send across every ajax request\n\t\t *\n\t\t * @type Object\n\t\t * @default {}\n\t\t **/\n\t\tthis.customData = Object.assign({}, this.optsCustomData);\n\n\t\t/**\n\t\t * Previous custom data from connector\n\t\t * \n\t\t * @type Object|null\n\t\t */\n\t\tthis.prevCustomData = null;\n\n\t\t/**\n\t\t * Any custom headers to send across every ajax request\n\t\t *\n\t\t * @type Object\n\t\t * @default {}\n\t\t*/\n\t\tthis.customHeaders = $.isPlainObject(this.options.customHeaders) ? this.options.customHeaders : {};\n\n\t\t/**\n\t\t * Any custom xhrFields to send across every ajax request\n\t\t *\n\t\t * @type Object\n\t\t * @default {}\n\t\t */\n\t\tthis.xhrFields = $.isPlainObject(this.options.xhrFields) ? this.options.xhrFields : {};\n\n\t\t/**\n\t\t * Replace XMLHttpRequest.prototype.send to extended function for 3rd party libs XHR request etc.\n\t\t * \n\t\t * @type Function\n\t\t */\n\t\tthis.replaceXhrSend = function() {\n\t\t\tif (! savedXhrSend) {\n\t\t\t\tsavedXhrSend = XMLHttpRequest.prototype.send;\n\t\t\t}\n\t\t\tXMLHttpRequest.prototype.send = function() {\n\t\t\t\tvar xhr = this;\n\t\t\t\t// set request headers\n\t\t\t\tif (self.customHeaders) {\n\t\t\t\t\t$.each(self.customHeaders, function(key) {\n\t\t\t\t\t\txhr.setRequestHeader(key, this);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// set xhrFields\n\t\t\t\tif (self.xhrFields) {\n\t\t\t\t\t$.each(self.xhrFields, function(key) {\n\t\t\t\t\t\tif (key in xhr) {\n\t\t\t\t\t\t\txhr[key] = this;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn savedXhrSend.apply(this, arguments);\n\t\t\t};\n\t\t};\n\t\t\n\t\t/**\n\t\t * Restore saved original XMLHttpRequest.prototype.send\n\t\t * \n\t\t * @type Function\n\t\t */\n\t\tthis.restoreXhrSend = function() {\n\t\t\tsavedXhrSend && (XMLHttpRequest.prototype.send = savedXhrSend);\n\t\t};\n\n\t\t/**\n\t\t * command names for into queue for only cwd requests\n\t\t * these commands aborts before `open` request\n\t\t *\n\t\t * @type Array\n\t\t * @default ['tmb', 'parents']\n\t\t */\n\t\tthis.abortCmdsOnOpen = this.options.abortCmdsOnOpen || ['tmb', 'parents'];\n\n\t\t/**\n\t\t * ui.nav id prefix\n\t\t * \n\t\t * @type String\n\t\t */\n\t\tthis.navPrefix = 'nav' + (elFinder.prototype.uniqueid? elFinder.prototype.uniqueid : '') + '-';\n\t\t\n\t\t/**\n\t\t * ui.cwd id prefix\n\t\t * \n\t\t * @type String\n\t\t */\n\t\tthis.cwdPrefix = elFinder.prototype.uniqueid? ('cwd' + elFinder.prototype.uniqueid + '-') : '';\n\t\t\n\t\t// Increment elFinder.prototype.uniqueid\n\t\t++elFinder.prototype.uniqueid;\n\t\t\n\t\t/**\n\t\t * URL to upload files\n\t\t *\n\t\t * @type String\n\t\t **/\n\t\tthis.uploadURL = opts.urlUpload || opts.url;\n\t\t\n\t\t/**\n\t\t * Events namespace\n\t\t *\n\t\t * @type String\n\t\t **/\n\t\tthis.namespace = namespace;\n\n\t\t/**\n\t\t * Today timestamp\n\t\t *\n\t\t * @type Number\n\t\t **/\n\t\tthis.today = (new Date(date.getFullYear(), date.getMonth(), date.getDate())).getTime()/1000;\n\t\t\n\t\t/**\n\t\t * Yesterday timestamp\n\t\t *\n\t\t * @type Number\n\t\t **/\n\t\tthis.yesterday = this.today - 86400;\n\t\t\n\t\tutc = this.options.UTCDate ? 'UTC' : '';\n\t\t\n\t\tthis.getHours    = 'get'+utc+'Hours';\n\t\tthis.getMinutes  = 'get'+utc+'Minutes';\n\t\tthis.getSeconds  = 'get'+utc+'Seconds';\n\t\tthis.getDate     = 'get'+utc+'Date';\n\t\tthis.getDay      = 'get'+utc+'Day';\n\t\tthis.getMonth    = 'get'+utc+'Month';\n\t\tthis.getFullYear = 'get'+utc+'FullYear';\n\t\t\n\t\t/**\n\t\t * elFinder node z-index (auto detect on elFinder load)\n\t\t *\n\t\t * @type null | Number\n\t\t **/\n\t\tthis.zIndex;\n\n\t\t/**\n\t\t * Current search status\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.searchStatus = {\n\t\t\tstate  : 0, // 0: search ended, 1: search started, 2: in search result\n\t\t\tquery  : '',\n\t\t\ttarget : '',\n\t\t\tmime   : '',\n\t\t\tmixed  : false, // in multi volumes search: false or Array that target volume ids\n\t\t\tininc  : false // in incremental search\n\t\t};\n\n\t\t/**\n\t\t * Interface language\n\t\t *\n\t\t * @type String\n\t\t * @default \"en\"\n\t\t **/\n\t\tthis.lang = this.storage('lang') || this.options.lang;\n\t\tif (this.lang === 'jp') {\n\t\t\tthis.lang = this.options.lang = 'ja';\n\t\t}\n\n\t\tthis.viewType = this.storage('view') || this.options.defaultView || 'icons';\n\n\t\tthis.sortType = this.storage('sortType') || this.options.sortType || 'name';\n\t\t\n\t\tthis.sortOrder = this.storage('sortOrder') || this.options.sortOrder || 'asc';\n\n\t\tthis.sortStickFolders = this.storage('sortStickFolders');\n\t\tif (this.sortStickFolders === null) {\n\t\t\tthis.sortStickFolders = !!this.options.sortStickFolders;\n\t\t} else {\n\t\t\tthis.sortStickFolders = !!this.sortStickFolders;\n\t\t}\n\n\t\tthis.sortAlsoTreeview = this.storage('sortAlsoTreeview');\n\t\tif (this.sortAlsoTreeview === null || this.options.sortAlsoTreeview === null) {\n\t\t\tthis.sortAlsoTreeview = !!this.options.sortAlsoTreeview;\n\t\t} else {\n\t\t\tthis.sortAlsoTreeview = !!this.sortAlsoTreeview;\n\t\t}\n\n\t\tthis.sortRules = $.extend(true, {}, this._sortRules, this.options.sortRules);\n\t\t\n\t\t$.each(this.sortRules, function(name, method) {\n\t\t\tif (typeof method != 'function') {\n\t\t\t\tdelete self.sortRules[name];\n\t\t\t} \n\t\t});\n\t\t\n\t\tthis.compare = $.proxy(this.compare, this);\n\t\t\n\t\t/**\n\t\t * Delay in ms before open notification dialog\n\t\t *\n\t\t * @type Number\n\t\t * @default 500\n\t\t **/\n\t\tthis.notifyDelay = this.options.notifyDelay > 0 ? parseInt(this.options.notifyDelay) : 500;\n\t\t\n\t\t/**\n\t\t * Dragging UI Helper object\n\t\t *\n\t\t * @type jQuery | null\n\t\t **/\n\t\tthis.draggingUiHelper = null;\n\t\t\n\t\t/**\n\t\t * Base droppable options\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis.droppable = {\n\t\t\tgreedy     : true,\n\t\t\ttolerance  : 'pointer',\n\t\t\taccept     : '.elfinder-cwd-file-wrapper,.elfinder-navbar-dir,.elfinder-cwd-file,.elfinder-cwd-filename',\n\t\t\thoverClass : this.res('class', 'adroppable'),\n\t\t\tclasses    : { // Deprecated hoverClass jQueryUI>=1.12.0\n\t\t\t\t'ui-droppable-hover': this.res('class', 'adroppable')\n\t\t\t},\n\t\t\tautoDisable: true, // elFinder original, see jquery.elfinder.js\n\t\t\tdrop : function(e, ui) {\n\t\t\t\tvar dst     = $(this),\n\t\t\t\t\ttargets = $.grep(ui.helper.data('files')||[], function(h) { return h? true : false; }),\n\t\t\t\t\tresult  = [],\n\t\t\t\t\tdups    = [],\n\t\t\t\t\tfaults  = [],\n\t\t\t\t\tisCopy  = ui.helper.hasClass('elfinder-drag-helper-plus'),\n\t\t\t\t\tc       = 'class',\n\t\t\t\t\tcnt, hash, i, h;\n\t\t\t\t\n\t\t\t\tif (typeof e.button === 'undefined' || ui.helper.data('namespace') !== namespace || ! self.insideWorkzone(e.pageX, e.pageY)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (dst.hasClass(self.res(c, 'cwdfile'))) {\n\t\t\t\t\thash = self.cwdId2Hash(dst.attr('id'));\n\t\t\t\t} else if (dst.hasClass(self.res(c, 'navdir'))) {\n\t\t\t\t\thash = self.navId2Hash(dst.attr('id'));\n\t\t\t\t} else {\n\t\t\t\t\thash = cwd;\n\t\t\t\t}\n\n\t\t\t\tcnt = targets.length;\n\t\t\t\t\n\t\t\t\twhile (cnt--) {\n\t\t\t\t\th = targets[cnt];\n\t\t\t\t\t// ignore drop into itself or in own location\n\t\t\t\t\tif (h != hash && files[h].phash != hash) {\n\t\t\t\t\t\tresult.push(h);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t((isCopy && h !== hash && files[hash].write)? dups : faults).push(h);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (faults.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tui.helper.data('droped', true);\n\t\t\t\t\n\t\t\t\tif (dups.length) {\n\t\t\t\t\tui.helper.hide();\n\t\t\t\t\tself.exec('duplicate', dups, {_userAction: true});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (result.length) {\n\t\t\t\t\tui.helper.hide();\n\t\t\t\t\tself.clipboard(result, !isCopy);\n\t\t\t\t\tself.exec('paste', hash, {_userAction: true}, hash).always(function(){\n\t\t\t\t\t\tself.clipboard([]);\n\t\t\t\t\t\tself.trigger('unlockfiles', {files : targets});\n\t\t\t\t\t});\n\t\t\t\t\tself.trigger('drop', {files : targets});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if filemanager is active\n\t\t *\n\t\t * @return Boolean\n\t\t **/\n\t\tthis.enabled = function() {\n\t\t\treturn enabled && this.visible();\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if filemanager is visible\n\t\t *\n\t\t * @return Boolean\n\t\t **/\n\t\tthis.visible = function() {\n\t\t\treturn node[0].elfinder && node.is(':visible');\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return file is root?\n\t\t * \n\t\t * @param  Object  target file object\n\t\t * @return Boolean\n\t\t */\n\t\tthis.isRoot = function(file) {\n\t\t\treturn (file.isroot || ! file.phash)? true : false;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return root dir hash for current working directory\n\t\t * \n\t\t * @param  String   target hash\n\t\t * @param  Boolean  include fake parent (optional)\n\t\t * @return String\n\t\t */\n\t\tthis.root = function(hash, fake) {\n\t\t\thash = hash || cwd;\n\t\t\tvar dir, i;\n\t\t\t\n\t\t\tif (! fake) {\n\t\t\t\t$.each(self.roots, function(id, rhash) {\n\t\t\t\t\tif (hash.indexOf(id) === 0) {\n\t\t\t\t\t\tdir = rhash;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (dir) {\n\t\t\t\t\treturn dir;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tdir = files[hash];\n\t\t\twhile (dir && dir.phash && (fake || ! dir.isroot)) {\n\t\t\t\tdir = files[dir.phash];\n\t\t\t}\n\t\t\tif (dir) {\n\t\t\t\treturn dir.hash;\n\t\t\t}\n\t\t\t\n\t\t\twhile (i in files && files.hasOwnProperty(i)) {\n\t\t\t\tdir = files[i];\n\t\t\t\tif (dir.mime === 'directory' && !dir.phash && dir.read) {\n\t\t\t\t\treturn dir.hash;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn '';\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return current working directory info\n\t\t * \n\t\t * @return Object\n\t\t */\n\t\tthis.cwd = function() {\n\t\t\treturn files[cwd] || {};\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return required cwd option\n\t\t * \n\t\t * @param  String  option name\n\t\t * @param  String  target hash (optional)\n\t\t * @return mixed\n\t\t */\n\t\tthis.option = function(name, target) {\n\t\t\tvar res, item;\n\t\t\ttarget = target || cwd;\n\t\t\tif (self.optionsByHashes[target] && typeof self.optionsByHashes[target][name] !== 'undefined') {\n\t\t\t\treturn self.optionsByHashes[target][name];\n\t\t\t}\n\t\t\tif (self.hasVolOptions && cwd !== target && (!(item = self.file(target)) || item.phash !== cwd)) {\n\t\t\t\tres = '';\n\t\t\t\t$.each(self.volOptions, function(id, opt) {\n\t\t\t\t\tif (target.indexOf(id) === 0) {\n\t\t\t\t\t\tres = opt[name] || '';\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t} else {\n\t\t\t\treturn cwdOptions[name] || '';\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return disabled commands by each folder\n\t\t * \n\t\t * @param  Array  target hashes\n\t\t * @return Array\n\t\t */\n\t\tthis.getDisabledCmds = function(targets, flip) {\n\t\t\tvar disabled = {'hidden': true};\n\t\t\tif (! Array.isArray(targets)) {\n\t\t\t\ttargets = [ targets ];\n\t\t\t}\n\t\t\t$.each(targets, function(i, h) {\n\t\t\t\tvar disCmds = self.option('disabledFlip', h);\n\t\t\t\tif (disCmds) {\n\t\t\t\t\tObject.assign(disabled, disCmds);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn flip? disabled : Object.keys(disabled);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return file data from current dir or tree by it's hash\n\t\t * \n\t\t * @param  String  file hash\n\t\t * @return Object\n\t\t */\n\t\tthis.file = function(hash, alsoHidden) { \n\t\t\treturn hash? (files[hash] || (alsoHidden? hiddenFiles[hash] : void(0))) : void(0); \n\t\t};\n\t\t\n\t\t/**\n\t\t * Return all cached files\n\t\t * \n\t\t * @param  String  parent hash\n\t\t * @return Object\n\t\t */\n\t\tthis.files = function(phash) {\n\t\t\tvar items = {};\n\t\t\tif (phash) {\n\t\t\t\tif (!ownFiles[phash]) {\n\t\t\t\t\treturn {};\n\t\t\t\t}\n\t\t\t\t$.each(ownFiles[phash], function(h) {\n\t\t\t\t\tif (files[h]) {\n\t\t\t\t\t\titems[h] = files[h];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete ownFiles[phash][h];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn Object.assign({}, items);\n\t\t\t}\n\t\t\treturn Object.assign({}, files);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return list of file parents hashes include file hash\n\t\t * \n\t\t * @param  String  file hash\n\t\t * @return Array\n\t\t */\n\t\tthis.parents = function(hash) {\n\t\t\tvar parents = [],\n\t\t\t\tdir;\n\t\t\t\n\t\t\twhile (hash && (dir = this.file(hash))) {\n\t\t\t\tparents.unshift(dir.hash);\n\t\t\t\thash = dir.phash;\n\t\t\t}\n\t\t\treturn parents;\n\t\t};\n\t\t\n\t\tthis.path2array = function(hash, i18) {\n\t\t\tvar file, \n\t\t\t\tpath = [];\n\t\t\t\t\n\t\t\twhile (hash) {\n\t\t\t\tif ((file = files[hash]) && file.hash) {\n\t\t\t\t\tpath.unshift(i18 && file.i18 ? file.i18 : file.name);\n\t\t\t\t\thash = file.isroot? null : file.phash;\n\t\t\t\t} else {\n\t\t\t\t\tpath = [];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\n\t\t\treturn path;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return file path or Get path async with jQuery.Deferred\n\t\t * \n\t\t * @param  Object  file\n\t\t * @param  Boolean i18\n\t\t * @param  Object  asyncOpt\n\t\t * @return String|jQuery.Deferred\n\t\t */\n\t\tthis.path = function(hash, i18, asyncOpt) { \n\t\t\tvar path = files[hash] && files[hash].path\n\t\t\t\t? files[hash].path\n\t\t\t\t: this.path2array(hash, i18).join(cwdOptions.separator);\n\t\t\tif (! asyncOpt || ! files[hash]) {\n\t\t\t\treturn path;\n\t\t\t} else {\n\t\t\t\tasyncOpt = Object.assign({notify: {type : 'parents', cnt : 1, hideCnt : true}}, asyncOpt);\n\t\t\t\t\n\t\t\t\tvar dfd    = $.Deferred(),\n\t\t\t\t\tnotify = asyncOpt.notify,\n\t\t\t\t\tnoreq  = false,\n\t\t\t\t\treq    = function() {\n\t\t\t\t\t\tself.request({\n\t\t\t\t\t\t\tdata : {cmd : 'parents', target : files[hash].phash},\n\t\t\t\t\t\t\tnotify : notify,\n\t\t\t\t\t\t\tpreventFail : true\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(done)\n\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tdone   = function() {\n\t\t\t\t\t\tself.one('parentsdone', function() {\n\t\t\t\t\t\t\tpath = self.path(hash, i18);\n\t\t\t\t\t\t\tif (path === '' && noreq) {\n\t\t\t\t\t\t\t\t//retry with request\n\t\t\t\t\t\t\t\tnoreq = false;\n\t\t\t\t\t\t\t\treq();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (notify) {\n\t\t\t\t\t\t\t\t\tclearTimeout(ntftm);\n\t\t\t\t\t\t\t\t\tnotify.cnt = -(parseInt(notify.cnt || 0));\n\t\t\t\t\t\t\t\t\tself.notify(notify);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdfd.resolve(path);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tntftm;\n\t\t\t\n\t\t\t\tif (path) {\n\t\t\t\t\treturn dfd.resolve(path);\n\t\t\t\t} else {\n\t\t\t\t\tif (self.ui['tree']) {\n\t\t\t\t\t\t// try as no request\n\t\t\t\t\t\tif (notify) {\n\t\t\t\t\t\t\tntftm = setTimeout(function() {\n\t\t\t\t\t\t\t\tself.notify(notify);\n\t\t\t\t\t\t\t}, self.notifyDelay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnoreq = true;\n\t\t\t\t\t\tdone(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treq();\n\t\t\t\t\t}\n\t\t\t\t\treturn dfd;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return file url if set\n\t\t * \n\t\t * @param  String  file hash\n\t\t * @param  Object  Options\n\t\t * @return String|Object of jQuery Deferred\n\t\t */\n\t\tthis.url = function(hash, o) {\n\t\t\tvar file   = files[hash],\n\t\t\t\topts   = o || {},\n\t\t\t\tasync  = opts.async || false,\n\t\t\t\ttemp   = opts.temporary || false,\n\t\t\t\tonetm  = (opts.onetime && self.option('onetimeUrl', hash)) || false,\n\t\t\t\tabsurl = opts.absurl || false,\n\t\t\t\tdfrd   = (async || onetm)? $.Deferred() : null,\n\t\t\t\tfilter = function(url) {\n\t\t\t\t\tif (url && absurl) {\n\t\t\t\t\t\turl = self.convAbsUrl(url);\n\t\t\t\t\t}\n\t\t\t\t\treturn url;\n\t\t\t\t},\n\t\t\t\tgetUrl = function(url) {\n\t\t\t\t\tif (url) {\n\t\t\t\t\t\treturn filter(url);\n\t\t\t\t\t}\n\t\t\t\t\tif (file.url) {\n\t\t\t\t\t\treturn filter(file.url);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (typeof baseUrl === 'undefined') {\n\t\t\t\t\t\tbaseUrl = getBaseUrl();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (baseUrl) {\n\t\t\t\t\t\treturn filter(baseUrl + $.map(self.path2array(hash), function(n) { return encodeURIComponent(n); }).slice(1).join('/'));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar params = Object.assign({}, self.customData, {\n\t\t\t\t\t\tcmd: 'file',\n\t\t\t\t\t\ttarget: file.hash\n\t\t\t\t\t});\n\t\t\t\t\tif (self.oldAPI) {\n\t\t\t\t\t\tparams.cmd = 'open';\n\t\t\t\t\t\tparams.current = file.phash;\n\t\t\t\t\t}\n\t\t\t\t\treturn filter(self.options.url + (self.options.url.indexOf('?') === -1 ? '?' : '&') + $.param(params, true));\n\t\t\t\t},\n\t\t\t\tgetBaseUrl = function() {\n\t\t\t\t\treturn self.option('url', (!self.isRoot(file) && file.phash) || file.hash);\n\t\t\t\t},\n\t\t\t\tbaseUrl, res;\n\t\t\t\n\t\t\tif (!file || !file.read) {\n\t\t\t\treturn async? dfrd.resolve('') : '';\n\t\t\t}\n\t\t\t\n\t\t\tif (onetm && (!file.url || file.url == '1') && !(baseUrl = getBaseUrl())) {\n\t\t\t\tasync = true;\n\t\t\t\tthis.request({\n\t\t\t\t\tdata : { cmd : 'url', target : hash, options : { onetime: 1 } },\n\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\toptions: {async: async},\n\t\t\t\t\tnotify: {type : 'file', cnt : 1, hideCnt : true},\n\t\t\t\t\tprogressBar: opts.progressBar\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tdfrd.resolve(filter(data.url || ''));\n\t\t\t\t}).fail(function() {\n\t\t\t\t\tdfrd.resolve('');\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (file.url == '1' || (temp && !file.url && !(baseUrl = getBaseUrl()))) {\n\t\t\t\t\tthis.request({\n\t\t\t\t\t\tdata : { cmd : 'url', target : hash, options : { temporary: temp? 1 : 0 } },\n\t\t\t\t\t\tpreventDefault : true,\n\t\t\t\t\t\toptions: {async: async},\n\t\t\t\t\t\tnotify: async? {type : temp? 'file' : 'url', cnt : 1, hideCnt : true} : {},\n\t\t\t\t\t\tprogressBar: opts.progressBar\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tfile.url = data.url || '';\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\tfile.url = '';\n\t\t\t\t\t})\n\t\t\t\t\t.always(function() {\n\t\t\t\t\t\tvar url;\n\t\t\t\t\t\tif (file.url && temp) {\n\t\t\t\t\t\t\turl = file.url;\n\t\t\t\t\t\t\tfile.url = '1'; // restore\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (async) {\n\t\t\t\t\t\t\tdfrd.resolve(getUrl(url));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn getUrl(url);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (async) {\n\t\t\t\t\t\tdfrd.resolve(getUrl());\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn getUrl();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (async) {\n\t\t\t\treturn dfrd;\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return file url for the extarnal service\n\t\t *\n\t\t * @param      String  hash     The hash\n\t\t * @param      Object  options  The options\n\t\t * @return     Object  jQuery Deferred\n\t\t */\n\t\tthis.forExternalUrl = function(hash, options) {\n\t\t\tvar onetime = self.option('onetimeUrl', hash),\n\t\t\t\topts = {\n\t\t\t\t\tasync: true,\n\t\t\t\t\tabsurl: true\n\t\t\t\t};\n\n\t\t\topts[onetime? 'onetime' : 'temporary'] = true;\n\t\t\treturn self.url(hash, Object.assign({}, options, opts));\n\t\t};\n\n\t\t/**\n\t\t * Return file url for open in elFinder\n\t\t * \n\t\t * @param  String  file hash\n\t\t * @param  Boolean for download link\n\t\t * @param      Object  requestOpts   The request options\n\t\t * @return String\n\t\t */\n\t\tthis.openUrl = function(hash, download, callback, requestOpts) {\n\t\t\tvar file = files[hash],\n\t\t\t\turl  = '',\n\t\t\t\tonetimeSize = (requestOpts || {}).onetimeSize || (5 * 1024 * 1024);\n\t\t\t\n\t\t\tif (!file || !file.read) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\t\n\t\t\tif (!download || download === 'sameorigin') {\n\t\t\t\tif (file.url) {\n\t\t\t\t\tif (file.url != 1) {\n\t\t\t\t\t\turl = file.url;\n\t\t\t\t\t}\n\t\t\t\t} else if (cwdOptions.url && file.hash.indexOf(self.cwd().volumeid) === 0) {\n\t\t\t\t\turl = cwdOptions.url + $.map(this.path2array(hash), function(n) { return encodeURIComponent(n); }).slice(1).join('/');\n\t\t\t\t}\n\t\t\t\tif (!download || this.isSameOrigin(url)) {\n\t\t\t\t\tif (url) {\n\t\t\t\t\t\turl += (url.match(/\\?/)? '&' : '?') + '_'.repeat((url.match(/[\\?&](_+)t=/g) || ['&t=']).sort().shift().match(/[\\?&](_*)t=/)[1].length + 1) + 't=' + (file.ts || parseInt(+new Date()/1000));\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tcallback(url);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (callback && this.hasParrotHeaders()) {\n\t\t\t\tif (!requestOpts) {\n\t\t\t\t\trequestOpts = {};\n\t\t\t\t} else {\n\t\t\t\t\tdelete requestOpts.onetimeSize;\n\t\t\t\t}\n\t\t\t\tif (!requestOpts.onetime && !requestOpts.temporary && file.size > onetimeSize) {\n\t\t\t\t\tif (file.mime.match(/^video|audio/)) {\n\t\t\t\t\t\trequestOpts.temporary = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trequestOpts.onetime = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (requestOpts.onetime || requestOpts.temporary) {\n\t\t\t\t\treturn this.url(file.hash, Object.assign({\n\t\t\t\t\t\tasync: true\n\t\t\t\t\t}, requestOpts)).done(function(url) {\n\t\t\t\t\t\tcallback(url);\n\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\tcallback('');\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn this.getContents(hash, 'blob', requestOpts).done(function(blob){\n\t\t\t\t\t\turl = (window.URL || window.webkitURL).createObjectURL(blob);\n\t\t\t\t\t\tcallback(url);\n\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\tcallback('');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\turl = this.options.url;\n\t\t\t\turl = url + (url.indexOf('?') === -1 ? '?' : '&')\n\t\t\t\t\t+ (this.oldAPI ? 'cmd=open&current='+file.phash : 'cmd=file')\n\t\t\t\t\t+ '&target=' + file.hash\n\t\t\t\t\t+ '&_t=' + (file.ts || parseInt(+new Date()/1000));\n\t\t\t\t\n\t\t\t\tif (download === true) {\n\t\t\t\t\turl += '&download=1';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$.each(this.customData, function(key, val) {\n\t\t\t\t\turl += '&' + encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t\t\t\t});\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(url);\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\treturn url;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return thumbnail url\n\t\t * \n\t\t * @param  Object  file object\n\t\t * @return String\n\t\t */\n\t\tthis.tmb = function(file) {\n\t\t\tvar tmbUrl, tmbCrop,\n\t\t\t\tcls    = 'elfinder-cwd-bgurl',\n\t\t\t\turl    = '',\n\t\t\t\tcData  = {},\n\t\t\t\tn      = 0;\n\n\t\t\tif ($.isPlainObject(file)) {\n\t\t\t\tif (self.searchStatus.state && file.hash.indexOf(self.cwd().volumeid) !== 0) {\n\t\t\t\t\ttmbUrl = self.option('tmbUrl', file.hash);\n\t\t\t\t\ttmbCrop = self.option('tmbCrop', file.hash);\n\t\t\t\t} else {\n\t\t\t\t\ttmbUrl = cwdOptions.tmbUrl;\n\t\t\t\t\ttmbCrop = cwdOptions.tmbCrop;\n\t\t\t\t}\n\t\t\t\tif (tmbCrop) {\n\t\t\t\t\tcls += ' elfinder-cwd-bgurl-crop';\n\t\t\t\t}\n\t\t\t\tif (tmbUrl === 'self' && file.mime.indexOf('image/') === 0) {\n\t\t\t\t\turl = self.openUrl(file.hash);\n\t\t\t\t\tcls += ' elfinder-cwd-bgself';\n\t\t\t\t} else if ((self.oldAPI || tmbUrl) && file && file.tmb && file.tmb != 1) {\n\t\t\t\t\turl = tmbUrl + file.tmb;\n\t\t\t\t} else if (self.newAPI && file && file.tmb && file.tmb != 1) {\n\t\t\t\t\turl = file.tmb;\n\t\t\t\t}\n\t\t\t\tif (url) {\n\t\t\t\t\tif (tmbUrl !== 'self') {\n\t\t\t\t\t\tif (file.ts) {\n\t\t\t\t\t\t\tcData._t = file.ts;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cwdOptions.tmbReqCustomData && Object.keys(this.customData).length) {\n\t\t\t\t\t\t\tcData = Object.assign(cData, this.customData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Object.keys(cData).length) {\n\t\t\t\t\t\t\turl += (url.match(/\\?/) ? '&' : '?');\n\t\t\t\t\t\t\t$.each(cData, function (key, val) {\n\t\t\t\t\t\t\t\turl += ((n++ === 0)? '' : '&') + encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn { url: url, className: cls };\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return selected files hashes\n\t\t *\n\t\t * @return Array\n\t\t **/\n\t\tthis.selected = function() {\n\t\t\treturn selected.slice(0);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return selected files info\n\t\t * \n\t\t * @return Array\n\t\t */\n\t\tthis.selectedFiles = function() {\n\t\t\treturn $.map(selected, function(hash) { return files[hash] ? Object.assign({}, files[hash]) : null; });\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if file with required name existsin required folder\n\t\t * \n\t\t * @param  String  file name\n\t\t * @param  String  parent folder hash\n\t\t * @return Boolean\n\t\t */\n\t\tthis.fileByName = function(name, phash) {\n\t\t\tvar hash;\n\t\t\n\t\t\tfor (hash in files) {\n\t\t\t\tif (files.hasOwnProperty(hash) && files[hash].phash == phash && files[hash].name == name) {\n\t\t\t\t\treturn files[hash];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Valid data for required command based on rules\n\t\t * \n\t\t * @param  String  command name\n\t\t * @param  Object  cammand's data\n\t\t * @return Boolean\n\t\t */\n\t\tthis.validResponse = function(cmd, data) {\n\t\t\treturn data.error || this.rules[this.rules[cmd] ? cmd : 'defaults'](data);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return bytes from ini formated size\n\t\t * \n\t\t * @param  String  ini formated size\n\t\t * @return Integer\n\t\t */\n\t\tthis.returnBytes = function(val) {\n\t\t\tvar last;\n\t\t\tif (isNaN(val)) {\n\t\t\t\tif (! val) {\n\t\t\t\t\tval = '';\n\t\t\t\t}\n\t\t\t\t// for ex. 1mb, 1KB\n\t\t\t\tval = val.replace(/b$/i, '');\n\t\t\t\tlast = val.charAt(val.length - 1).toLowerCase();\n\t\t\t\tval = val.replace(/[tgmk]$/i, '');\n\t\t\t\tif (last == 't') {\n\t\t\t\t\tval = val * 1024 * 1024 * 1024 * 1024;\n\t\t\t\t} else if (last == 'g') {\n\t\t\t\t\tval = val * 1024 * 1024 * 1024;\n\t\t\t\t} else if (last == 'm') {\n\t\t\t\t\tval = val * 1024 * 1024;\n\t\t\t\t} else if (last == 'k') {\n\t\t\t\t\tval = val * 1024;\n\t\t\t\t}\n\t\t\t\tval = isNaN(val)? 0 : parseInt(val);\n\t\t\t} else {\n\t\t\t\tval = parseInt(val);\n\t\t\t\tif (val < 1) val = 0;\n\t\t\t}\n\t\t\treturn val;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Process ajax request.\n\t\t * Fired events :\n\t\t * @todo\n\t\t * @example\n\t\t * @todo\n\t\t * @return $.Deferred\n\t\t */\n\t\tthis.request = function(opts) { \n\t\t\tvar self     = this,\n\t\t\t\to        = this.options,\n\t\t\t\tdfrd     = $.Deferred(),\n\t\t\t\t// request ID\n\t\t\t\treqId    = (+ new Date()).toString(16) + Math.floor(1000 * Math.random()).toString(16), \n\t\t\t\t// request data\n\t\t\t\tdata     = Object.assign({}, self.customData, {mimes : o.onlyMimes}, opts.data || opts),\n\t\t\t\t// command name\n\t\t\t\tcmd      = data.cmd,\n\t\t\t\t// request type is binary\n\t\t\t\tisBinary = (opts.options || {}).dataType === 'binary',\n\t\t\t\t// current cmd is \"open\"\n\t\t\t\tisOpen   = (!opts.asNotOpen && cmd === 'open'),\n\t\t\t\t// call default fail callback (display error dialog) ?\n\t\t\t\tdeffail  = !(isBinary || opts.preventDefault || opts.preventFail),\n\t\t\t\t// call default success callback ?\n\t\t\t\tdefdone  = !(isBinary || opts.preventDefault || opts.preventDone),\n\t\t\t\t// current progress of receive data\n\t\t\t\tprog     = opts.progressVal || 20,\n\t\t\t\t// timer of fake progress\n\t\t\t\tprogTm   = null,\n\t\t\t\t// whether the notification dialog is currently displayed\n\t\t\t\thasNotify= false,\n\t\t\t\t// options for notify dialog\n\t\t\t\tnotify   = !opts.progressBar? (opts.notify? Object.assign({progress: prog * opts.notify.cnt}, opts.notify) : {}) : {},\n\t\t\t\t// make cancel button\n\t\t\t\tcancel   = !!opts.cancel,\n\t\t\t\t// do not normalize data - return as is\n\t\t\t\traw      = isBinary || !!opts.raw,\n\t\t\t\t// sync files on request fail\n\t\t\t\tsyncOnFail = opts.syncOnFail,\n\t\t\t\t// use lazy()\n\t\t\t\tlazy     = !!opts.lazy,\n\t\t\t\t// prepare function before done()\n\t\t\t\tprepare  = opts.prepare,\n\t\t\t\t// navigate option object when cmd done\n\t\t\t\tnavigate = opts.navigate,\n\t\t\t\t// open notify dialog timeout\n\t\t\t\ttimeout,\n\t\t\t\t// use browser cache\n\t\t\t\tuseCache = (opts.options || {}).cache,\n\t\t\t\t// request options\n\t\t\t\toptions = Object.assign({\n\t\t\t\t\turl      : o.url,\n\t\t\t\t\tasync    : true,\n\t\t\t\t\ttype     : this.requestType,\n\t\t\t\t\tdataType : 'json',\n\t\t\t\t\tcache    : (self.api >= 2.1029), // api >= 2.1029 has unique request ID\n\t\t\t\t\tdata     : data,\n\t\t\t\t\theaders  : this.customHeaders,\n\t\t\t\t\txhrFields: this.xhrFields,\n\t\t\t\t\tprogress : function(e) {\n\t\t\t\t\t\tvar p = e.loaded / e.total * 100;\n\t\t\t\t\t\tprogTm && clearTimeout(progTm);\n\t\t\t\t\t\tif (opts.progressBar) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\topts.progressBar.width(p + '%');\n\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (hasNotify && notify.type) {\n\t\t\t\t\t\t\t\tp = p * notify.cnt;\n\t\t\t\t\t\t\t\tif (prog < p) {\n\t\t\t\t\t\t\t\t\tself.notify({\n\t\t\t\t\t\t\t\t\t\ttype: notify.type,\n\t\t\t\t\t\t\t\t\t\tprogress: p - prog,\n\t\t\t\t\t\t\t\t\t\tcnt: 0,\n\t\t\t\t\t\t\t\t\t\thideCnt: notify.hideCnt\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tprog = p;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opts.progress) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\topts.progress(e);\n\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, opts.options || {}),\n\t\t\t\t/**\n\t\t\t\t * Default success handler. \n\t\t\t\t * Call default data handlers and fire event with command name.\n\t\t\t\t *\n\t\t\t\t * @param Object  normalized response data\n\t\t\t\t * @return void\n\t\t\t\t **/\n\t\t\t\tdone = function(data) {\n\t\t\t\t\tdata.warning && self.error(data.warning);\n\t\t\t\t\t\n\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\topen(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.updateCache(data);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tself.lazy(function() {\n\t\t\t\t\t\t// fire some event to update cache/ui\n\t\t\t\t\t\tdata.removed && data.removed.length && self.remove(data);\n\t\t\t\t\t\tdata.added   && data.added.length   && self.add(data);\n\t\t\t\t\t\tdata.changed && data.changed.length && self.change(data);\n\t\t\t\t\t}).then(function() {\n\t\t\t\t\t\t// fire event with command name\n\t\t\t\t\t\treturn self.lazy(function() {\n\t\t\t\t\t\t\tself.trigger(cmd, data, false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}).then(function() {\n\t\t\t\t\t\t// fire event with command name + 'done'\n\t\t\t\t\t\treturn self.lazy(function() {\n\t\t\t\t\t\t\tself.trigger(cmd + 'done');\n\t\t\t\t\t\t});\n\t\t\t\t\t}).then(function() {\n\t\t\t\t\t\t// make toast message\n\t\t\t\t\t\tif (data.toasts && Array.isArray(data.toasts)) {\n\t\t\t\t\t\t\t$.each(data.toasts, function() {\n\t\t\t\t\t\t\t\tthis.msg && self.toast(this);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// force update content\n\t\t\t\t\t\tdata.sync && self.sync();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * Request error handler. Reject dfrd with correct error message.\n\t\t\t\t *\n\t\t\t\t * @param jqxhr  request object\n\t\t\t\t * @param String request status\n\t\t\t\t * @return void\n\t\t\t\t **/\n\t\t\t\terror = function(xhr, status) {\n\t\t\t\t\tvar error, data, \n\t\t\t\t\t\td = self.options.debug;\n\t\t\t\t\t\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase 'abort':\n\t\t\t\t\t\t\terror = xhr.quiet ? '' : ['errConnect', 'errAbort'];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'timeout':\t    \n\t\t\t\t\t\t\terror = ['errConnect', 'errTimeout'];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'parsererror': \n\t\t\t\t\t\t\terror = ['errResponse', 'errDataNotJSON'];\n\t\t\t\t\t\t\tif (xhr.responseText) {\n\t\t\t\t\t\t\t\tif (! cwd || (d && (d === 'all' || d['backend-error']))) {\n\t\t\t\t\t\t\t\t\terror.push(xhr.responseText);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif (xhr.responseText) {\n\t\t\t\t\t\t\t\t// check responseText, Is that JSON?\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tdata = JSON.parse(xhr.responseText);\n\t\t\t\t\t\t\t\t\tif (data && data.error) {\n\t\t\t\t\t\t\t\t\t\terror = data.error;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (! error) {\n\t\t\t\t\t\t\t\tif (xhr.status == 403) {\n\t\t\t\t\t\t\t\t\terror = ['errConnect', 'errAccess', 'HTTP error ' + xhr.status];\n\t\t\t\t\t\t\t\t} else if (xhr.status == 404) {\n\t\t\t\t\t\t\t\t\terror = ['errConnect', 'errNotFound', 'HTTP error ' + xhr.status];\n\t\t\t\t\t\t\t\t} else if (xhr.status >= 500) {\n\t\t\t\t\t\t\t\t\terror = ['errResponse', 'errServerError', 'HTTP error ' + xhr.status];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (xhr.status == 414 && options.type === 'get') {\n\t\t\t\t\t\t\t\t\t\t// retry by POST method\n\t\t\t\t\t\t\t\t\t\toptions.type = 'post';\n\t\t\t\t\t\t\t\t\t\tself.abortXHR(xhr);\n\t\t\t\t\t\t\t\t\t\tdfrd.xhr = xhr = self.transport.send(options).fail(error).done(success);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\terror = xhr.quiet ? '' : ['errConnect', 'HTTP error ' + xhr.status];\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tself.trigger(cmd + 'done');\n\t\t\t\t\tdfrd.reject({error: error}, xhr, status);\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * Request success handler. Valid response data and reject/resolve dfrd.\n\t\t\t\t *\n\t\t\t\t * @param Object  response data\n\t\t\t\t * @param String request status\n\t\t\t\t * @return void\n\t\t\t\t **/\n\t\t\t\tsuccess = function(response) {\n\t\t\t\t\t// Set currrent request command name\n\t\t\t\t\tself.currentReqCmd = cmd;\n\t\t\t\t\t\n\t\t\t\t\tresponse.debug && self.responseDebug(response);\n\t\t\t\t\t\n\t\t\t\t\tself.setCustomHeaderByXhr(xhr);\n\n\t\t\t\t\tif (raw) {\n\t\t\t\t\t\tself.abortXHR(xhr);\n\t\t\t\t\t\tresponse && response.debug && self.debug('backend-debug', response);\n\t\t\t\t\t\treturn dfrd.resolve(response);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!response) {\n\t\t\t\t\t\treturn dfrd.reject({error :['errResponse', 'errDataEmpty']}, xhr, response);\n\t\t\t\t\t} else if (!$.isPlainObject(response)) {\n\t\t\t\t\t\treturn dfrd.reject({error :['errResponse', 'errDataNotJSON']}, xhr, response);\n\t\t\t\t\t} else if (response.error) {\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\t// check leafRoots\n\t\t\t\t\t\t\t$.each(self.leafRoots, function(phash, roots) {\n\t\t\t\t\t\t\t\tself.leafRoots[phash] = $.grep(roots, function(h) { return h !== data.target; });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn dfrd.reject({error :response.error}, xhr, response);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar resolve = function() {\n\t\t\t\t\t\tvar pushLeafRoots = function(name) {\n\t\t\t\t\t\t\tif (self.leafRoots[data.target] && response[name]) {\n\t\t\t\t\t\t\t\t$.each(self.leafRoots[data.target], function(i, h) {\n\t\t\t\t\t\t\t\t\tvar root;\n\t\t\t\t\t\t\t\t\tif (root = self.file(h)) {\n\t\t\t\t\t\t\t\t\t\tresponse[name].push(root);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsetTextMimes = function() {\n\t\t\t\t\t\t\tself.textMimes = {};\n\t\t\t\t\t\t\t$.each(self.res('mimes', 'text'), function() {\n\t\t\t\t\t\t\t\tself.textMimes[this.toLowerCase()] = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tactionTarget;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\tpushLeafRoots('files');\n\t\t\t\t\t\t} else if (cmd === 'tree') {\n\t\t\t\t\t\t\tpushLeafRoots('tree');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tresponse = self.normalize(response);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!self.validResponse(cmd, response)) {\n\t\t\t\t\t\t\treturn dfrd.reject({error :(response.norError || 'errResponse')}, xhr, response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\tif (!self.api) {\n\t\t\t\t\t\t\t\tself.api    = response.api || 1;\n\t\t\t\t\t\t\t\tif (self.api == '2.0' && typeof response.options.uploadMaxSize !== 'undefined') {\n\t\t\t\t\t\t\t\t\tself.api = '2.1';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tself.newAPI = self.api >= 2;\n\t\t\t\t\t\t\t\tself.oldAPI = !self.newAPI;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (response.textMimes && Array.isArray(response.textMimes)) {\n\t\t\t\t\t\t\t\tself.resources.mimes.text = response.textMimes;\n\t\t\t\t\t\t\t\tsetTextMimes();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t!self.textMimes && setTextMimes();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (response.options) {\n\t\t\t\t\t\t\t\tcwdOptions = Object.assign({}, cwdOptionsDefault, response.options);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (response.netDrivers) {\n\t\t\t\t\t\t\t\tself.netDrivers = response.netDrivers;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (response.maxTargets) {\n\t\t\t\t\t\t\t\tself.maxTargets = response.maxTargets;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!!data.init) {\n\t\t\t\t\t\t\t\tself.uplMaxSize = self.returnBytes(response.uplMaxSize);\n\t\t\t\t\t\t\t\tself.uplMaxFile = !!response.uplMaxFile? Math.min(parseInt(response.uplMaxFile), 50) : 20;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof prepare === 'function') {\n\t\t\t\t\t\t\tprepare(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (navigate) {\n\t\t\t\t\t\t\tactionTarget = navigate.target || 'added';\n\t\t\t\t\t\t\tif (response[actionTarget] && response[actionTarget].length) {\n\t\t\t\t\t\t\t\tself.one(cmd + 'done', function() {\n\t\t\t\t\t\t\t\t\tvar targets  = response[actionTarget],\n\t\t\t\t\t\t\t\t\t\tnewItems = self.findCwdNodes(targets),\n\t\t\t\t\t\t\t\t\t\tinCwdHashes = function() {\n\t\t\t\t\t\t\t\t\t\t\tvar cwdHash = self.cwd().hash;\n\t\t\t\t\t\t\t\t\t\t\treturn $.map(targets, function(f) { return (f.phash && cwdHash === f.phash)? f.hash : null; });\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\thashes   = inCwdHashes(),\n\t\t\t\t\t\t\t\t\t\tmakeToast  = function(t) {\n\t\t\t\t\t\t\t\t\t\t\tvar node = void(0),\n\t\t\t\t\t\t\t\t\t\t\t\tdata = t.action? t.action.data : void(0),\n\t\t\t\t\t\t\t\t\t\t\t\tcmd, msg, done;\n\t\t\t\t\t\t\t\t\t\t\tif ((data || hashes.length) && t.action && (msg = t.action.msg) && (cmd = t.action.cmd) && (!t.action.cwdNot || t.action.cwdNot !== self.cwd().hash)) {\n\t\t\t\t\t\t\t\t\t\t\t\tdone = t.action.done;\n\t\t\t\t\t\t\t\t\t\t\t\tdata = t.action.data;\n\t\t\t\t\t\t\t\t\t\t\t\tnode = $('<div/>')\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('<button type=\"button\" class=\"ui-button ui-widget ui-state-default ui-corner-all elfinder-tabstop\"><span class=\"ui-button-text\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+self.i18n(msg)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+'</span></button>')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.on('mouseenter mouseleave', function(e) { \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(this).toggleClass('ui-state-hover', e.type == 'mouseenter');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.exec(cmd, data || hashes, {_userAction: true, _currentType: 'toast', _currentNode: $(this) });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (done) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.one(cmd+'done', function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (typeof done === 'function') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdone();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (done === 'select') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.trigger('selectfiles', {files : inCwdHashes()});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdelete t.action;\n\t\t\t\t\t\t\t\t\t\t\tt.extNode = node;\n\t\t\t\t\t\t\t\t\t\t\treturn t;\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (! navigate.toast) {\n\t\t\t\t\t\t\t\t\t\tnavigate.toast = {};\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t!navigate.noselect && self.trigger('selectfiles', {files : self.searchStatus.state > 1 ? $.map(targets, function(f) { return f.hash; }) : hashes});\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (newItems.length) {\n\t\t\t\t\t\t\t\t\t\tif (!navigate.noscroll) {\n\t\t\t\t\t\t\t\t\t\t\tnewItems.first().trigger('scrolltoview', {blink : false});\n\t\t\t\t\t\t\t\t\t\t\tself.resources.blink(newItems, 'lookme');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ($.isPlainObject(navigate.toast.incwd)) {\n\t\t\t\t\t\t\t\t\t\t\tself.toast(makeToast(navigate.toast.incwd));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif ($.isPlainObject(navigate.toast.inbuffer)) {\n\t\t\t\t\t\t\t\t\t\t\tself.toast(makeToast(navigate.toast.inbuffer));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdfrd.resolve(response);\n\t\t\t\t\t\t\n\t\t\t\t\t\tresponse.debug && self.debug('backend-debug', response);\n\t\t\t\t\t};\n\t\t\t\t\tself.abortXHR(xhr);\n\t\t\t\t\tlazy? self.lazy(resolve) : resolve();\n\t\t\t\t},\n\t\t\t\txhr, _xhr,\n\t\t\t\txhrAbort = function(e) {\n\t\t\t\t\tif (xhr && xhr.state() === 'pending') {\n\t\t\t\t\t\tself.abortXHR(xhr, { quiet: true , abort: true });\n\t\t\t\t\t\tif (!e || (e.type !== 'unload' && e.type !== 'destroy')) {\n\t\t\t\t\t\t\tself.autoSync();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tabort = function(e){\n\t\t\t\t\tself.trigger(cmd + 'done');\n\t\t\t\t\tif (e.type == 'autosync') {\n\t\t\t\t\t\tif (e.data.action != 'stop') return;\n\t\t\t\t\t} else if (e.type != 'unload' && e.type != 'destroy' && e.type != 'openxhrabort') {\n\t\t\t\t\t\tif (!e.data.added || !e.data.added.length) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\txhrAbort(e);\n\t\t\t\t},\n\t\t\t\trequest = function(mode) {\n\t\t\t\t\tvar queueAbort = function() {\n\t\t\t\t\t\tsyncOnFail = false;\n\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tif (mode) {\n\t\t\t\t\t\tif (mode === 'cmd') {\n\t\t\t\t\t\t\treturn cmd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\tif (currentOpenCmd && currentOpenCmd.state() === 'pending') {\n\t\t\t\t\t\t\tif (currentOpenCmd._target === data.target) {\n\t\t\t\t\t\t\t\treturn dfrd.reject('openabort');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (currentOpenCmd.xhr) {\n\t\t\t\t\t\t\t\t\tcurrentOpenCmd.xhr.queueAbort();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcurrentOpenCmd.reject('openabort');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentOpenCmd = dfrd;\n\t\t\t\t\t\tcurrentOpenCmd._target = data.target;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\tdelete options.headers['X-elFinderReqid'];\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\tcurrentOpenCmd = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}).fail(function(error, xhr, response) {\n\t\t\t\t\t\tvar errData, errMsg;\n\n\t\t\t\t\t\tif (isOpen && error === 'openabort') {\n\t\t\t\t\t\t\terror = '';\n\t\t\t\t\t\t\tsyncOnFail = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\terrData = {\n\t\t\t\t\t\t\tcmd: cmd,\n\t\t\t\t\t\t\terr: error,\n\t\t\t\t\t\t\txhr: xhr,\n\t\t\t\t\t\t\trc: response\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// unset this cmd queue when user canceling\n\t\t\t\t\t\t// see notify : function - `cancel.reject(0);`\n\t\t\t\t\t\tif (error === 0) {\n\t\t\t\t\t\t\tif (requestQueue.length) {\n\t\t\t\t\t\t\t\trequestQueue = $.grep(requestQueue, function(req) {\n\t\t\t\t\t\t\t\t\treturn (req('cmd') === cmd) ? false : true;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// trigger \"requestError\" event\n\t\t\t\t\t\tself.trigger('requestError', errData);\n\t\t\t\t\t\tif (errData._getEvent && errData._getEvent().isDefaultPrevented()) {\n\t\t\t\t\t\t\tdeffail = false;\n\t\t\t\t\t\t\tsyncOnFail = false;\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\terror.error = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// abort xhr\n\t\t\t\t\t\txhrAbort();\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\topenDir = self.file(data.target);\n\t\t\t\t\t\t\topenDir && openDir.volumeid && self.isRoot(openDir) && delete self.volumeExpires[openDir.volumeid];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.trigger(cmd + 'fail', response);\n\t\t\t\t\t\terrMsg = (typeof error === 'object')? error.error : error;\n\t\t\t\t\t\tif (errMsg) {\n\t\t\t\t\t\t\tdeffail ? self.error(errMsg) : self.debug('error', self.i18n(errMsg));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsyncOnFail && self.sync();\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!cmd) {\n\t\t\t\t\t\tsyncOnFail = false;\n\t\t\t\t\t\treturn dfrd.reject({error :'errCmdReq'});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (self.maxTargets && data.targets && data.targets.length > self.maxTargets) {\n\t\t\t\t\t\tsyncOnFail = false;\n\t\t\t\t\t\treturn dfrd.reject({error :['errMaxTargets', self.maxTargets]});\n\t\t\t\t\t}\n\n\t\t\t\t\tdefdone && dfrd.done(done);\n\t\t\t\t\t\n\t\t\t\t\t// quiet abort not completed \"open\" requests\n\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\twhile ((_xhr = queue.pop())) {\n\t\t\t\t\t\t\t_xhr.queueAbort();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cwd !== data.target) {\n\t\t\t\t\t\t\twhile ((_xhr = cwdQueue.pop())) {\n\t\t\t\t\t\t\t\t_xhr.queueAbort();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// trigger abort autoSync for commands to add the item\n\t\t\t\t\tif ($.inArray(cmd, (self.cmdsToAdd + ' autosync').split(' ')) !== -1) {\n\t\t\t\t\t\tif (cmd !== 'autosync') {\n\t\t\t\t\t\t\tself.autoSync('stop');\n\t\t\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\t\t\tself.autoSync();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.trigger('openxhrabort');\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete options.preventFail;\n\n\t\t\t\t\tif (self.api >= 2.1029) {\n\t\t\t\t\t\tif (useCache) {\n\t\t\t\t\t\t\toptions.headers['X-elFinderReqid'] = reqId;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tObject.assign(options.data, { reqid : reqId });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// function for set value of this syncOnFail\n\t\t\t\t\tdfrd.syncOnFail = function(state) {\n\t\t\t\t\t\tsyncOnFail = !!state;\n\t\t\t\t\t};\n\n\t\t\t\t\trequestCnt++;\n\n\t\t\t\t\tdfrd.xhr = xhr = self.transport.send(options).always(function() {\n\t\t\t\t\t\t// set responseURL from native xhr object\n\t\t\t\t\t\tif (options._xhr && typeof options._xhr.responseURL !== 'undefined') {\n\t\t\t\t\t\t\txhr.responseURL = options._xhr.responseURL || '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--requestCnt;\n\t\t\t\t\t\tif (requestQueue.length) {\n\t\t\t\t\t\t\trequestQueue.shift()();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).fail(error).done(success);\n\t\t\t\t\t\n\t\t\t\t\tif (self.api >= 2.1029) {\n\t\t\t\t\t\txhr._requestId = reqId;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (isOpen || (data.compare && cmd === 'info')) {\n\t\t\t\t\t\t// regist function queueAbort\n\t\t\t\t\t\txhr.queueAbort = queueAbort;\n\t\t\t\t\t\t// add autoSync xhr into queue\n\t\t\t\t\t\tqueue.unshift(xhr);\n\t\t\t\t\t\t// bind abort()\n\t\t\t\t\t\tdata.compare && self.bind(self.cmdsToAdd + ' autosync openxhrabort', abort);\n\t\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\t\tvar ndx = $.inArray(xhr, queue);\n\t\t\t\t\t\t\tdata.compare && self.unbind(self.cmdsToAdd + ' autosync openxhrabort', abort);\n\t\t\t\t\t\t\tndx !== -1 && queue.splice(ndx, 1);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if ($.inArray(cmd, self.abortCmdsOnOpen) !== -1) {\n\t\t\t\t\t\t// regist function queueAbort\n\t\t\t\t\t\txhr.queueAbort = queueAbort;\n\t\t\t\t\t\t// add \"open\" xhr, only cwd xhr into queue\n\t\t\t\t\t\tcwdQueue.unshift(xhr);\n\t\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\t\tvar ndx = $.inArray(xhr, cwdQueue);\n\t\t\t\t\t\t\tndx !== -1 && cwdQueue.splice(ndx, 1);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// abort pending xhr on window unload or elFinder destroy\n\t\t\t\t\tself.bind('unload destroy', abort);\n\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\tself.unbind('unload destroy', abort);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\treturn dfrd;\n\t\t\t\t},\n\t\t\t\tqueueingRequest = function() {\n\t\t\t\t\t// show notify\n\t\t\t\t\tif (notify.type && notify.cnt) {\n\t\t\t\t\t\tif (cancel) {\n\t\t\t\t\t\t\tnotify.cancel = dfrd;\n\t\t\t\t\t\t\topts.eachCancel && (notify.id = +new Date());\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\t\t\t// start fake count up\n\t\t\t\t\t\t\tprogTm = setTimeout(progFakeUp, 1000);\n\t\t\t\t\t\t\tself.notify(notify);\n\t\t\t\t\t\t\thasNotify = true;\n\t\t\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\t\t\tnotify.cnt = -(parseInt(notify.cnt)||0);\n\t\t\t\t\t\t\t\tself.notify(notify);\n\t\t\t\t\t\t\t\thasNotify = false;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, self.notifyDelay);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdfrd.always(function() {\n\t\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// queueing\n\t\t\t\t\tif (requestCnt < requestMaxConn) {\n\t\t\t\t\t\t// do request\n\t\t\t\t\t\treturn request();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isOpen) {\n\t\t\t\t\t\t\trequestQueue.unshift(request);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trequestQueue.push(request);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn dfrd;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tprogFakeUp = function() {\n\t\t\t\t\tvar add;\n\t\t\t\t\tif (hasNotify && progTm) {\n\t\t\t\t\t\tadd = 1 * notify.cnt;\n\t\t\t\t\t\tprogTm = null;\n\t\t\t\t\t\tself.notify({\n\t\t\t\t\t\t\ttype: notify.type,\n\t\t\t\t\t\t\tprogress: add,\n\t\t\t\t\t\t\tcnt: 0,\n\t\t\t\t\t\t\thideCnt: notify.hideCnt\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprog += add;\n\t\t\t\t\t\tif ((prog / notify.cnt) < 80) {\n\t\t\t\t\t\t\tprogTm = setTimeout(progFakeUp, 500);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbindData = {opts: opts, result: true},\n\t\t\t\topenDir;\n\t\t\t\n\t\t\t// prevent request initial request is completed\n\t\t\tif (!self.api && !data.init) {\n\t\t\t\tsyncOnFail = false;\n\t\t\t\treturn dfrd.reject();\n\t\t\t}\n\n\t\t\t// trigger \"request.cmd\" that callback be able to cancel request by substituting \"false\" for \"event.data.result\"\n\t\t\tself.trigger('request.' + cmd, bindData, true);\n\t\t\t\n\t\t\tif (! bindData.result) {\n\t\t\t\tself.trigger(cmd + 'done');\n\t\t\t\treturn dfrd.reject();\n\t\t\t} else if (typeof bindData.result === 'object' && bindData.result.promise) {\n\t\t\t\tbindData.result\n\t\t\t\t\t.done(queueingRequest)\n\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\tself.trigger(cmd + 'done');\n\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t});\n\t\t\t\treturn dfrd;\n\t\t\t}\n\t\t\t\n\t\t\treturn queueingRequest();\n\t\t};\n\t\t\n\t\t/**\n\t\t * Call cache()\n\t\t * Store info about files/dirs in \"files\" object.\n\t\t *\n\t\t * @param  Array  files\n\t\t * @param  String type\n\t\t * @return void\n\t\t */\n\t\tthis.cache = function(dataArray, type) {\n\t\t\tif (! Array.isArray(dataArray)) {\n\t\t\t\tdataArray = [ dataArray ];\n\t\t\t}\n\t\t\tcache(dataArray, type);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Update file object caches by respose data object\n\t\t * \n\t\t * @param  Object  respose data object\n\t\t * @return void\n\t\t */\n\t\tthis.updateCache = function(data) {\n\t\t\tif ($.isPlainObject(data)) {\n\t\t\t\tdata.files && data.files.length && cache(data.files, 'files');\n\t\t\t\tdata.tree && data.tree.length && cache(data.tree, 'tree');\n\t\t\t\tdata.removed && data.removed.length && remove(data.removed);\n\t\t\t\tdata.added && data.added.length && cache(data.added, 'add');\n\t\t\t\tdata.changed && data.changed.length && cache(data.changed, 'change');\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Compare current files cache with new files and return diff\n\t\t * \n\t\t * @param  Array   new files\n\t\t * @param  String  target folder hash\n\t\t * @param  Array   exclude properties to compare\n\t\t * @return Object\n\t\t */\n\t\tthis.diff = function(incoming, onlydir, excludeProps) {\n\t\t\tvar raw       = {},\n\t\t\t\tadded     = [],\n\t\t\t\tremoved   = [],\n\t\t\t\tchanged   = [],\n\t\t\t\texcludes  = null,\n\t\t\t\tisChanged = function(hash) {\n\t\t\t\t\tvar l = changed.length;\n\n\t\t\t\t\twhile (l--) {\n\t\t\t\t\t\tif (changed[l].hash == hash) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\n\t\t\t$.each(incoming, function(i, f) {\n\t\t\t\traw[f.hash] = f;\n\t\t\t});\n\t\t\t\n\t\t\t// make excludes object\n\t\t\tif (excludeProps && excludeProps.length) {\n\t\t\t\texcludes = {};\n\t\t\t\t$.each(excludeProps, function() {\n\t\t\t\t\texcludes[this] = true;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t// find removed\n\t\t\t$.each(files, function(hash, f) {\n\t\t\t\tif (! raw[hash] && (! onlydir || f.phash === onlydir)) {\n\t\t\t\t\tremoved.push(hash);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t// compare files\n\t\t\t$.each(raw, function(hash, file) {\n\t\t\t\tvar origin  = files[hash],\n\t\t\t\t\torgKeys = {},\n\t\t\t\t\tchkKeyLen;\n\n\t\t\t\tif (!origin) {\n\t\t\t\t\tadded.push(file);\n\t\t\t\t} else {\n\t\t\t\t\t// make orgKeys object\n\t\t\t\t\t$.each(Object.keys(origin), function() {\n\t\t\t\t\t\torgKeys[this] = true;\n\t\t\t\t\t});\n\t\t\t\t\t$.each(file, function(prop) {\n\t\t\t\t\t\tdelete orgKeys[prop];\n\t\t\t\t\t\tif (! excludes || ! excludes[prop]) {\n\t\t\t\t\t\t\tif (file[prop] !== origin[prop]) {\n\t\t\t\t\t\t\t\tchanged.push(file);\n\t\t\t\t\t\t\t\torgKeys = {};\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tchkKeyLen = Object.keys(orgKeys).length;\n\t\t\t\t\tif (chkKeyLen !== 0) {\n\t\t\t\t\t\tif (excludes) {\n\t\t\t\t\t\t\t$.each(orgKeys, function(prop) {\n\t\t\t\t\t\t\t\tif (excludes[prop]) {\n\t\t\t\t\t\t\t\t\t--chkKeyLen;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t(chkKeyLen !== 0) && changed.push(file);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t// parents of removed dirs mark as changed (required for tree correct work)\n\t\t\t$.each(removed, function(i, hash) {\n\t\t\t\tvar file  = files[hash], \n\t\t\t\t\tphash = file.phash;\n\n\t\t\t\tif (phash \n\t\t\t\t&& file.mime == 'directory' \n\t\t\t\t&& $.inArray(phash, removed) === -1 \n\t\t\t\t&& raw[phash] \n\t\t\t\t&& !isChanged(phash)) {\n\t\t\t\t\tchanged.push(raw[phash]);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\treturn {\n\t\t\t\tadded   : added,\n\t\t\t\tremoved : removed,\n\t\t\t\tchanged : changed\n\t\t\t};\n\t\t};\n\t\t\n\t\t/**\n\t\t * Sync content\n\t\t * \n\t\t * @return jQuery.Deferred\n\t\t */\n\t\tthis.sync = function(onlydir, polling) {\n\t\t\tthis.autoSync('stop');\n\t\t\tvar self  = this,\n\t\t\t\tcompare = function(){\n\t\t\t\t\tvar c = '', cnt = 0, mtime = 0;\n\t\t\t\t\tif (onlydir && polling) {\n\t\t\t\t\t\t$.each(files, function(h, f) {\n\t\t\t\t\t\t\tif (f.phash && f.phash === onlydir) {\n\t\t\t\t\t\t\t\t++cnt;\n\t\t\t\t\t\t\t\tmtime = Math.max(mtime, f.ts);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tc = cnt+':'+mtime;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn c;\n\t\t\t\t},\n\t\t\t\tcomp  = compare(),\n\t\t\t\tdfrd  = $.Deferred().always(function() { !reqFail && self.trigger('sync'); }),\n\t\t\t\topts = [this.request({\n\t\t\t\t\tdata           : {cmd : 'open', reload : 1, target : cwd, tree : (! onlydir && this.ui.tree) ? 1 : 0, compare : comp},\n\t\t\t\t\tpreventDefault : true\n\t\t\t\t})],\n\t\t\t\texParents = function() {\n\t\t\t\t\tvar parents = [],\n\t\t\t\t\t\tcurRoot = self.file(self.root(cwd)),\n\t\t\t\t\t\tcurId = curRoot? curRoot.volumeid : null,\n\t\t\t\t\t\tphash = self.cwd().phash,\n\t\t\t\t\t\tisroot,pdir;\n\t\t\t\t\t\n\t\t\t\t\twhile(phash) {\n\t\t\t\t\t\tif (pdir = self.file(phash)) {\n\t\t\t\t\t\t\tif (phash.indexOf(curId) !== 0) {\n\t\t\t\t\t\t\t\tparents.push( {target: phash, cmd: 'tree'} );\n\t\t\t\t\t\t\t\tif (! self.isRoot(pdir)) {\n\t\t\t\t\t\t\t\t\tparents.push( {target: phash, cmd: 'parents'} );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurRoot = self.file(self.root(phash));\n\t\t\t\t\t\t\t\tcurId = curRoot? curRoot.volumeid : null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tphash = pdir.phash;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tphash = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn parents;\n\t\t\t\t},\n\t\t\t\treqFail;\n\t\t\t\n\t\t\tif (! onlydir && self.api >= 2) {\n\t\t\t\t(cwd !== this.root()) && opts.push(this.request({\n\t\t\t\t\tdata           : {cmd : 'parents', target : cwd},\n\t\t\t\t\tpreventDefault : true\n\t\t\t\t}));\n\t\t\t\t$.each(exParents(), function(i, data) {\n\t\t\t\t\topts.push(self.request({\n\t\t\t\t\t\tdata           : {cmd : data.cmd, target : data.target},\n\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\t\t\t$.when.apply($, opts)\n\t\t\t.fail(function(error, xhr) {\n\t\t\t\treqFail = (xhr && xhr.status != 200);\n\t\t\t\tif (! polling || $.inArray('errOpen', error) !== -1) {\n\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\tself.parseError(error) && self.request({\n\t\t\t\t\t\tdata   : {cmd : 'open', target : (self.lastDir('') || self.root()), tree : 1, init : 1},\n\t\t\t\t\t\tnotify : {type : 'open', cnt : 1, hideCnt : true}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tdfrd.reject((error && xhr.status != 0)? error : void 0);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.done(function(odata) {\n\t\t\t\tvar pdata, argLen, i;\n\t\t\t\t\n\t\t\t\tif (odata.cwd.compare) {\n\t\t\t\t\tif (comp === odata.cwd.compare) {\n\t\t\t\t\t\treturn dfrd.reject();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// for 2nd and more requests\n\t\t\t\tpdata = {tree : []};\n\t\t\t\t\n\t\t\t\t// results marge of 2nd and more requests\n\t\t\t\targLen = arguments.length;\n\t\t\t\tif (argLen > 1) {\n\t\t\t\t\tfor(i = 1; i < argLen; i++) {\n\t\t\t\t\t\tif (arguments[i].tree && arguments[i].tree.length) {\n\t\t\t\t\t\t\tpdata.tree.push.apply(pdata.tree, arguments[i].tree);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (self.api < 2.1) {\n\t\t\t\t\tif (! pdata.tree) {\n\t\t\t\t\t\tpdata.tree = [];\n\t\t\t\t\t}\n\t\t\t\t\tpdata.tree.push(odata.cwd);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// data normalize\n\t\t\t\todata = self.normalize(odata);\n\t\t\t\tif (!self.validResponse('open', odata)) {\n\t\t\t\t\treturn dfrd.reject((odata.norError || 'errResponse'));\n\t\t\t\t}\n\t\t\t\tpdata = self.normalize(pdata);\n\t\t\t\tif (!self.validResponse('tree', pdata)) {\n\t\t\t\t\treturn dfrd.reject((pdata.norError || 'errResponse'));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar diff = self.diff(odata.files.concat(pdata && pdata.tree ? pdata.tree : []), onlydir);\n\n\t\t\t\tdiff.added.push(odata.cwd);\n\t\t\t\t\n\t\t\t\tself.updateCache(diff);\n\t\t\t\t\n\t\t\t\t// trigger events\n\t\t\t\tdiff.removed.length && self.remove(diff);\n\t\t\t\tdiff.added.length   && self.add(diff);\n\t\t\t\tdiff.changed.length && self.change(diff);\n\t\t\t\treturn dfrd.resolve(diff);\n\t\t\t})\n\t\t\t.always(function() {\n\t\t\t\tself.autoSync();\n\t\t\t});\n\t\t\t\n\t\t\treturn dfrd;\n\t\t};\n\t\t\n\t\tthis.upload = function(files) {\n\t\t\treturn this.transport.upload(files, this);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Bind keybord shortcut to keydown event\n\t\t *\n\t\t * @example\n\t\t *    elfinder.shortcut({ \n\t\t *       pattern : 'ctrl+a', \n\t\t *       description : 'Select all files', \n\t\t *       callback : function(e) { ... }, \n\t\t *       keypress : true|false (bind to keypress instead of keydown) \n\t\t *    })\n\t\t *\n\t\t * @param  Object  shortcut config\n\t\t * @return elFinder\n\t\t */\n\t\tthis.shortcut = function(s) {\n\t\t\tvar patterns, pattern, code, i, parts;\n\t\t\t\n\t\t\tif (this.options.allowShortcuts && s.pattern && $.isFunction(s.callback)) {\n\t\t\t\tpatterns = s.pattern.toUpperCase().split(/\\s+/);\n\t\t\t\t\n\t\t\t\tfor (i= 0; i < patterns.length; i++) {\n\t\t\t\t\tpattern = patterns[i];\n\t\t\t\t\tparts   = pattern.split('+');\n\t\t\t\t\tcode    = (code = parts.pop()).length == 1 \n\t\t\t\t\t\t? (code > 0 ? code : code.charCodeAt(0))\n\t\t\t\t\t\t: (code > 0 ? code : $.ui.keyCode[code]);\n\n\t\t\t\t\tif (code && !shortcuts[pattern]) {\n\t\t\t\t\t\tshortcuts[pattern] = {\n\t\t\t\t\t\t\tkeyCode     : code,\n\t\t\t\t\t\t\taltKey      : $.inArray('ALT', parts)   != -1,\n\t\t\t\t\t\t\tctrlKey     : $.inArray('CTRL', parts)  != -1,\n\t\t\t\t\t\t\tshiftKey    : $.inArray('SHIFT', parts) != -1,\n\t\t\t\t\t\t\ttype        : s.type || 'keydown',\n\t\t\t\t\t\t\tcallback    : s.callback,\n\t\t\t\t\t\t\tdescription : s.description,\n\t\t\t\t\t\t\tpattern     : pattern\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Registered shortcuts\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis.shortcuts = function() {\n\t\t\tvar ret = [];\n\t\t\t\n\t\t\t$.each(shortcuts, function(i, s) {\n\t\t\t\tret.push([s.pattern, self.i18n(s.description)]);\n\t\t\t});\n\t\t\treturn ret;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Get/set clipboard content.\n\t\t * Return new clipboard content.\n\t\t *\n\t\t * @example\n\t\t *   this.clipboard([]) - clean clipboard\n\t\t *   this.clipboard([{...}, {...}], true) - put 2 files in clipboard and mark it as cutted\n\t\t * \n\t\t * @param  Array    new files hashes\n\t\t * @param  Boolean  cut files?\n\t\t * @return Array\n\t\t */\n\t\tthis.clipboard = function(hashes, cut) {\n\t\t\tvar map = function() { return $.map(clipboard, function(f) { return f.hash; }); };\n\n\t\t\tif (hashes !== void(0)) {\n\t\t\t\tclipboard.length && this.trigger('unlockfiles', {files : map()});\n\t\t\t\tremember = {};\n\t\t\t\t\n\t\t\t\tclipboard = $.map(hashes||[], function(hash) {\n\t\t\t\t\tvar file = files[hash];\n\t\t\t\t\tif (file) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tremember[hash] = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thash   : hash,\n\t\t\t\t\t\t\tphash  : file.phash,\n\t\t\t\t\t\t\tname   : file.name,\n\t\t\t\t\t\t\tmime   : file.mime,\n\t\t\t\t\t\t\tread   : file.read,\n\t\t\t\t\t\t\tlocked : file.locked,\n\t\t\t\t\t\t\tcut    : !!cut\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\t\t\t\tthis.trigger('changeclipboard', {clipboard : clipboard.slice(0, clipboard.length)});\n\t\t\t\tcut && this.trigger('lockfiles', {files : map()});\n\t\t\t}\n\n\t\t\t// return copy of clipboard instead of refrence\n\t\t\treturn clipboard.slice(0, clipboard.length);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return true if command enabled\n\t\t * \n\t\t * @param  String       command name\n\t\t * @param  String|void  hash for check of own volume's disabled cmds\n\t\t * @return Boolean\n\t\t */\n\t\tthis.isCommandEnabled = function(name, dstHash) {\n\t\t\tvar disabled, cmd,\n\t\t\t\tcvid = self.cwd().volumeid || '';\n\t\t\t\n\t\t\t// In serach results use selected item hash to check\n\t\t\tif (!dstHash && self.searchStatus.state > 1 && self.selected().length) {\n\t\t\t\tdstHash = self.selected()[0];\n\t\t\t}\n\t\t\tif (dstHash && (! cvid || dstHash.indexOf(cvid) !== 0)) {\n\t\t\t\tdisabled = self.option('disabledFlip', dstHash);\n\t\t\t\t//if (! disabled) {\n\t\t\t\t//\tdisabled = {};\n\t\t\t\t//}\n\t\t\t} else {\n\t\t\t\tdisabled = cwdOptions.disabledFlip/* || {}*/;\n\t\t\t}\n\t\t\tcmd = this._commands[name];\n\t\t\treturn cmd ? (cmd.alwaysEnabled || !disabled[name]) : false;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Exec command and return result;\n\t\t *\n\t\t * @param  String         command name\n\t\t * @param  String|Array   usualy files hashes\n\t\t * @param  String|Array   command options\n\t\t * @param  String|void    hash for enabled check of own volume's disabled cmds\n\t\t * @return $.Deferred\n\t\t */\t\t\n\t\tthis.exec = function(cmd, files, opts, dstHash) {\n\t\t\tvar dfrd, resType;\n\t\t\t\n\t\t\t// apply commandMap for keyboard shortcut\n\t\t\tif (!dstHash && this.commandMap[cmd] && this.commandMap[cmd] !== 'hidden') {\n\t\t\t\tcmd = this.commandMap[cmd];\n\t\t\t}\n\n\t\t\tif (cmd === 'open') {\n\t\t\t\tif (this.searchStatus.state || this.searchStatus.ininc) {\n\t\t\t\t\tthis.trigger('searchend', { noupdate: true });\n\t\t\t\t}\n\t\t\t\tthis.autoSync('stop');\n\t\t\t}\n\t\t\tif (!dstHash && files) {\n\t\t\t\tif ($.isArray(files)) {\n\t\t\t\t\tif (files.length) {\n\t\t\t\t\t\tdstHash = files[0];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdstHash = files;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdfrd = this._commands[cmd] && this.isCommandEnabled(cmd, dstHash) \n\t\t\t\t? this._commands[cmd].exec(files, opts) \n\t\t\t\t: $.Deferred().reject('errUnknownCmd');\n\t\t\t\n\t\t\tresType = typeof dfrd;\n\t\t\tif (!(resType === 'object' && dfrd.promise)) {\n\t\t\t\tself.debug('warning', '\"cmd.exec()\" should be returned \"$.Deferred\" but cmd \"' + cmd + '\" returned \"' + resType + '\"');\n\t\t\t\tdfrd = $.Deferred().resolve();\n\t\t\t}\n\t\t\t\n\t\t\tthis.trigger('exec', { dfrd : dfrd, cmd : cmd, files : files, opts : opts, dstHash : dstHash });\n\t\t\treturn dfrd;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Create and return dialog.\n\t\t *\n\t\t * @param  String|DOMElement  dialog content\n\t\t * @param  Object             dialog options\n\t\t * @return jQuery\n\t\t */\n\t\tthis.dialog = function(content, options) {\n\t\t\tvar dialog = $('<div/>').append(content).appendTo(node).elfinderdialog(options, self),\n\t\t\t\tdnode  = dialog.closest('.ui-dialog'),\n\t\t\t\tresize = function(){\n\t\t\t\t\t! dialog.data('draged') && dialog.is(':visible') && dialog.elfinderdialog('posInit');\n\t\t\t\t};\n\t\t\tif (dnode.length) {\n\t\t\t\tself.bind('resize', resize);\n\t\t\t\tdnode.on('remove', function() {\n\t\t\t\t\tself.unbind('resize', resize);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn dialog;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Create and return toast.\n\t\t *\n\t\t * @param  Object  toast options - see ui/toast.js\n\t\t * @return jQuery\n\t\t */\n\t\tthis.toast = function(options) {\n\t\t\treturn $('<div class=\"ui-front\"/>').appendTo(this.ui.toast).elfindertoast(options || {}, this);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return UI widget or node\n\t\t *\n\t\t * @param  String  ui name\n\t\t * @return jQuery\n\t\t */\n\t\tthis.getUI = function(ui) {\n\t\t\treturn ui? (this.ui[ui] || $()) : node;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return elFinder.command instance or instances array\n\t\t *\n\t\t * @param  String  command name\n\t\t * @return Object | Array\n\t\t */\n\t\tthis.getCommand = function(name) {\n\t\t\treturn name === void(0) ? this._commands : this._commands[name];\n\t\t};\n\t\t\n\t\t/**\n\t\t * Resize elfinder node\n\t\t * \n\t\t * @param  String|Number  width\n\t\t * @param  String|Number  height\n\t\t * @return void\n\t\t */\n\t\tthis.resize = function(w, h) {\n\t\t\tvar getMargin = function() {\n\t\t\t\t\tvar m = node.outerHeight(true) - node.innerHeight(),\n\t\t\t\t\t\tp = node;\n\t\t\t\t\t\n\t\t\t\t\twhile(p.get(0) !== heightBase.get(0)) {\n\t\t\t\t\t\tp = p.parent();\n\t\t\t\t\t\tm += p.outerHeight(true) - p.innerHeight();\n\t\t\t\t\t\tif (! p.parent().length) {\n\t\t\t\t\t\t\t// reached the document\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn m;\n\t\t\t\t},\n\t\t\t\tfit = ! node.hasClass('ui-resizable'),\n\t\t\t\tprv = node.data('resizeSize') || {w: 0, h: 0},\n\t\t\t\tmt, size = {};\n\n\t\t\tif (heightBase && heightBase.data('resizeTm')) {\n\t\t\t\tclearTimeout(heightBase.data('resizeTm'));\n\t\t\t}\n\t\t\t\n\t\t\tif (typeof h === 'string') {\n\t\t\t\tif (mt = h.match(/^([0-9.]+)%$/)) {\n\t\t\t\t\t// setup heightBase\n\t\t\t\t\tif (! heightBase || ! heightBase.length) {\n\t\t\t\t\t\theightBase = $(window);\n\t\t\t\t\t}\n\t\t\t\t\tif (! heightBase.data('marginToMyNode')) {\n\t\t\t\t\t\theightBase.data('marginToMyNode', getMargin());\n\t\t\t\t\t}\n\t\t\t\t\tif (! heightBase.data('fitToBaseFunc')) {\n\t\t\t\t\t\theightBase.data('fitToBaseFunc', function(e) {\n\t\t\t\t\t\t\tvar tm = heightBase.data('resizeTm');\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\ttm && cancelAnimationFrame(tm);\n\t\t\t\t\t\t\tif (! node.hasClass('elfinder-fullscreen') && (!self.UA.Mobile || heightBase.data('rotated') !== self.UA.Rotated)) {\n\t\t\t\t\t\t\t\theightBase.data('rotated', self.UA.Rotated);\n\t\t\t\t\t\t\t\theightBase.data('resizeTm', requestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t\tself.restoreSize();\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof heightBase.data('rotated') === 'undefined') {\n\t\t\t\t\t\theightBase.data('rotated', self.UA.Rotated);\n\t\t\t\t\t}\n\t\t\t\t\th = heightBase.height() * (mt[1] / 100) - heightBase.data('marginToMyNode');\n\t\t\t\t\t\n\t\t\t\t\theightBase.off('resize.' + self.namespace, heightBase.data('fitToBaseFunc'));\n\t\t\t\t\tfit && heightBase.on('resize.' + self.namespace, heightBase.data('fitToBaseFunc'));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tnode.css({ width : w, height : parseInt(h) });\n\t\t\tsize.w = Math.round(node.width());\n\t\t\tsize.h = Math.round(node.height());\n\t\t\tnode.data('resizeSize', size);\n\t\t\tif (size.w !== prv.w || size.h !== prv.h) {\n\t\t\t\tnode.trigger('resize');\n\t\t\t\tthis.trigger('resize', {width : size.w, height : size.h});\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Restore elfinder node size\n\t\t * \n\t\t * @return elFinder\n\t\t */\n\t\tthis.restoreSize = function() {\n\t\t\tthis.resize(width, height);\n\t\t};\n\t\t\n\t\tthis.show = function() {\n\t\t\tnode.show();\n\t\t\tthis.enable().trigger('show');\n\t\t};\n\t\t\n\t\tthis.hide = function() {\n\t\t\tif (this.options.enableAlways) {\n\t\t\t\tprevEnabled = enabled;\n\t\t\t\tenabled = false;\n\t\t\t}\n\t\t\tthis.disable();\n\t\t\tthis.trigger('hide');\n\t\t\tnode.hide();\n\t\t};\n\t\t\n\t\t/**\n\t\t * Lazy execution function\n\t\t * \n\t\t * @param  Object  function\n\t\t * @param  Number  delay\n\t\t * @param  Object  options\n\t\t * @return Object  jQuery.Deferred\n\t\t */\n\t\tthis.lazy = function(func, delay, opts) {\n\t\t\tvar busy = function(state) {\n\t\t\t\t\tvar cnt = node.data('lazycnt'),\n\t\t\t\t\t\trepaint;\n\t\t\t\t\t\n\t\t\t\t\tif (state) {\n\t\t\t\t\t\trepaint = node.data('lazyrepaint')? false : opts.repaint;\n\t\t\t\t\t\tif (! cnt) {\n\t\t\t\t\t\t\tnode.data('lazycnt', 1)\n\t\t\t\t\t\t\t\t.addClass('elfinder-processing');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.data('lazycnt', ++cnt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (repaint) {\n\t\t\t\t\t\t\tnode.data('lazyrepaint', true).css('display'); // force repaint\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cnt && cnt > 1) {\n\t\t\t\t\t\t\tnode.data('lazycnt', --cnt);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trepaint = node.data('lazyrepaint');\n\t\t\t\t\t\t\tnode.data('lazycnt', 0)\n\t\t\t\t\t\t\t\t.removeData('lazyrepaint')\n\t\t\t\t\t\t\t\t.removeClass('elfinder-processing');\n\t\t\t\t\t\t\trepaint && node.css('display'); // force repaint;\n\t\t\t\t\t\t\tself.trigger('lazydone');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdfd  = $.Deferred(),\n\t\t\t\tcallFunc = function() {\n\t\t\t\t\tdfd.resolve(func.call(dfd));\n\t\t\t\t\tbusy(false);\n\t\t\t\t};\n\t\t\t\n\t\t\tdelay = delay || 0;\n\t\t\topts = opts || {};\n\t\t\tbusy(true);\n\t\t\t\n\t\t\tif (delay) {\n\t\t\t\tsetTimeout(callFunc, delay);\n\t\t\t} else {\n\t\t\t\trequestAnimationFrame(callFunc);\n\t\t\t}\n\t\t\t\n\t\t\treturn dfd;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Destroy this elFinder instance\n\t\t *\n\t\t * @return void\n\t\t **/\n\t\tthis.destroy = function() {\n\t\t\tif (node && node[0].elfinder) {\n\t\t\t\tnode.hasClass('elfinder-fullscreen') && self.toggleFullscreen(node);\n\t\t\t\tthis.options.syncStart = false;\n\t\t\t\tthis.autoSync('forcestop');\n\t\t\t\tthis.trigger('destroy').disable();\n\t\t\t\tclipboard = [];\n\t\t\t\tselected = [];\n\t\t\t\tlisteners = {};\n\t\t\t\tshortcuts = {};\n\t\t\t\t$(window).off('.' + namespace);\n\t\t\t\t$(document).off('.' + namespace);\n\t\t\t\tself.trigger = function(){};\n\t\t\t\t$(beeper).remove();\n\t\t\t\tnode.off()\n\t\t\t\t\t.removeData()\n\t\t\t\t\t.empty()\n\t\t\t\t\t.append(prevContent.contents())\n\t\t\t\t\t.attr('class', prevContent.attr('class'))\n\t\t\t\t\t.attr('style', prevContent.attr('style'));\n\t\t\t\tdelete node[0].elfinder;\n\t\t\t\t// restore kept events\n\t\t\t\t$.each(prevEvents, function(n, arr) {\n\t\t\t\t\t$.each(arr, function(i, o) {\n\t\t\t\t\t\tnode.on(o.type + (o.namespace? '.'+o.namespace : ''), o.selector, o.handler);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Start or stop auto sync\n\t\t * \n\t\t * @param  String|Bool  stop\n\t\t * @return void\n\t\t */\n\t\tthis.autoSync = function(mode) {\n\t\t\tvar sync;\n\t\t\tif (self.options.sync >= 1000) {\n\t\t\t\tif (syncInterval) {\n\t\t\t\t\tclearTimeout(syncInterval);\n\t\t\t\t\tsyncInterval = null;\n\t\t\t\t\tself.trigger('autosync', {action : 'stop'});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (mode === 'stop') {\n\t\t\t\t\t++autoSyncStop;\n\t\t\t\t} else {\n\t\t\t\t\tautoSyncStop = Math.max(0, --autoSyncStop);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (autoSyncStop || mode === 'forcestop' || ! self.options.syncStart) {\n\t\t\t\t\treturn;\n\t\t\t\t} \n\t\t\t\t\n\t\t\t\t// run interval sync\n\t\t\t\tsync = function(start){\n\t\t\t\t\tvar timeout;\n\t\t\t\t\tif (cwdOptions.syncMinMs && (start || syncInterval)) {\n\t\t\t\t\t\tstart && self.trigger('autosync', {action : 'start'});\n\t\t\t\t\t\ttimeout = Math.max(self.options.sync, cwdOptions.syncMinMs);\n\t\t\t\t\t\tsyncInterval && clearTimeout(syncInterval);\n\t\t\t\t\t\tsyncInterval = setTimeout(function() {\n\t\t\t\t\t\t\tvar dosync = true, hash = cwd, cts;\n\t\t\t\t\t\t\tif (cwdOptions.syncChkAsTs && files[hash] && (cts = files[hash].ts)) {\n\t\t\t\t\t\t\t\tself.request({\n\t\t\t\t\t\t\t\t\tdata : {cmd : 'info', targets : [hash], compare : cts, reload : 1},\n\t\t\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(data){\n\t\t\t\t\t\t\t\t\tvar ts;\n\t\t\t\t\t\t\t\t\tdosync = true;\n\t\t\t\t\t\t\t\t\tif (data.compare) {\n\t\t\t\t\t\t\t\t\t\tts = data.compare;\n\t\t\t\t\t\t\t\t\t\tif (ts == cts) {\n\t\t\t\t\t\t\t\t\t\t\tdosync = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (dosync) {\n\t\t\t\t\t\t\t\t\t\tself.sync(hash).always(function(){\n\t\t\t\t\t\t\t\t\t\t\tif (ts) {\n\t\t\t\t\t\t\t\t\t\t\t\t// update ts for cache clear etc.\n\t\t\t\t\t\t\t\t\t\t\t\tfiles[hash].ts = ts;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tsync();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsync();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function(error, xhr){\n\t\t\t\t\t\t\t\t\tvar err = self.parseError(error);\n\t\t\t\t\t\t\t\t\tif (err && xhr.status != 0) {\n\t\t\t\t\t\t\t\t\t\tself.error(err);\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(err) && $.inArray('errOpen', err) !== -1) {\n\t\t\t\t\t\t\t\t\t\t\tself.request({\n\t\t\t\t\t\t\t\t\t\t\t\tdata   : {cmd : 'open', target : (self.lastDir('') || self.root()), tree : 1, init : 1},\n\t\t\t\t\t\t\t\t\t\t\t\tnotify : {type : 'open', cnt : 1, hideCnt : true}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsyncInterval = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\tsync();\n\t\t\t\t\t\t\t\t\t\t}, timeout);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tself.sync(cwd, true).always(function(){\n\t\t\t\t\t\t\t\t\tsync();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, timeout);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tsync(true);\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Return bool is inside work zone of specific point\n\t\t * \n\t\t * @param  Number event.pageX\n\t\t * @param  Number event.pageY\n\t\t * @return Bool\n\t\t */\n\t\tthis.insideWorkzone = function(x, y, margin) {\n\t\t\tvar rectangle = this.getUI('workzone').data('rectangle');\n\t\t\t\n\t\t\tmargin = margin || 1;\n\t\t\tif (x < rectangle.left + margin\n\t\t\t|| x > rectangle.left + rectangle.width + margin\n\t\t\t|| y < rectangle.top + margin\n\t\t\t|| y > rectangle.top + rectangle.height + margin) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Target ui node move to last of children of elFinder node fot to show front\n\t\t * \n\t\t * @param  Object  target    Target jQuery node object\n\t\t */\n\t\tthis.toFront = function(target) {\n\t\t\tvar nodes = node.children('.ui-front').removeClass('elfinder-frontmost'),\n\t\t\t\tlastnode = nodes.last();\n\t\t\tnodes.css('z-index', '');\n\t\t\t$(target).addClass('ui-front elfinder-frontmost').css('z-index', lastnode.css('z-index') + 1);\n\t\t};\n\t\t\n\t\t/**\n\t\t * Remove class 'elfinder-frontmost' and hide() to target ui node\n\t\t *\n\t\t * @param      Object   target  Target jQuery node object\n\t\t * @param      Boolean  nohide  Do not hide\n\t\t */\n\t\tthis.toHide =function(target, nohide) {\n\t\t\tvar tgt = $(target),\n\t\t\t\tlast;\n\n\t\t\t!nohide && tgt.hide();\n\t\t\tif (tgt.hasClass('elfinder-frontmost')) {\n\t\t\t\ttgt.removeClass('elfinder-frontmost');\n\t\t\t\tlast = node.children('.ui-front:visible:not(.elfinder-frontmost)').last();\n\t\t\t\tif (last.length) {\n\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\tif (!node.children('.elfinder-frontmost:visible').length) {\n\t\t\t\t\t\t\tself.toFront(last);\n\t\t\t\t\t\t\tlast.trigger('frontmost');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Return css object for maximize\n\t\t * \n\t\t * @return Object\n\t\t */\n\t\tthis.getMaximizeCss = function() {\n\t\t\treturn {\n\t\t\t\twidth   : '100%',\n\t\t\t\theight  : '100%',\n\t\t\t\tmargin  : 0,\n\t\t\t\ttop     : 0,\n\t\t\t\tleft    : 0,\n\t\t\t\tdisplay : 'block',\n\t\t\t\tposition: 'fixed',\n\t\t\t\tzIndex  : Math.max(self.zIndex? (self.zIndex + 1) : 0 , 1000),\n\t\t\t\tmaxWidth : '',\n\t\t\t\tmaxHeight: ''\n\t\t\t};\n\t\t};\n\t\t\n\t\t// Closure for togglefullscreen\n\t\t(function() {\n\t\t\t// check is in iframe\n\t\t\tif (inFrame && self.UA.Fullscreen) {\n\t\t\t\tself.UA.Fullscreen = false;\n\t\t\t\tif (parentIframe && typeof parentIframe.attr('allowfullscreen') !== 'undefined') {\n\t\t\t\t\tself.UA.Fullscreen = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar orgStyle, bodyOvf, resizeTm, fullElm, exitFull, toFull, funcObj,\n\t\t\t\tcls = 'elfinder-fullscreen',\n\t\t\t\tclsN = 'elfinder-fullscreen-native',\n\t\t\t\tcheckDialog = function() {\n\t\t\t\t\tvar t = 0,\n\t\t\t\t\t\tl = 0;\n\t\t\t\t\t$.each(node.children('.ui-dialog,.ui-draggable'), function(i, d) {\n\t\t\t\t\t\tvar $d = $(d),\n\t\t\t\t\t\t\tpos = $d.position();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (pos.top < 0) {\n\t\t\t\t\t\t\t$d.css('top', t);\n\t\t\t\t\t\t\tt += 20;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pos.left < 0) {\n\t\t\t\t\t\t\t$d.css('left', l);\n\t\t\t\t\t\t\tl += 20;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetFuncObj = function() {\n\t\t\t\t\tvar useFullscreen = self.storage('useFullscreen');\n\t\t\t\t\tfuncObj = self.UA.Fullscreen && (useFullscreen? useFullscreen > 0 : self.options.commandsOptions.fullscreen.mode === 'screen') ? {\n\t\t\t\t\t\t// native full screen mode\n\t\t\t\t\t\t\n\t\t\t\t\t\tfullElm: function() {\n\t\t\t\t\t\t\treturn document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement || null;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\n\t\t\t\t\t\texitFull: function() {\n\t\t\t\t\t\t\tif (document.exitFullscreen) {\n\t\t\t\t\t\t\t\treturn document.exitFullscreen();\n\t\t\t\t\t\t\t} else if (document.webkitExitFullscreen) {\n\t\t\t\t\t\t\t\treturn document.webkitExitFullscreen();\n\t\t\t\t\t\t\t} else if (document.mozCancelFullScreen) {\n\t\t\t\t\t\t\t\treturn document.mozCancelFullScreen();\n\t\t\t\t\t\t\t} else if (document.msExitFullscreen) {\n\t\t\t\t\t\t\t\treturn document.msExitFullscreen();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\n\t\t\t\t\t\ttoFull: function(elem) {\n\t\t\t\t\t\t\tif (elem.requestFullscreen) {\n\t\t\t\t\t\t\t\treturn elem.requestFullscreen();\n\t\t\t\t\t\t\t} else if (elem.webkitRequestFullscreen) {\n\t\t\t\t\t\t\t\treturn elem.webkitRequestFullscreen();\n\t\t\t\t\t\t\t} else if (elem.mozRequestFullScreen) {\n\t\t\t\t\t\t\t\treturn elem.mozRequestFullScreen();\n\t\t\t\t\t\t\t} else if (elem.msRequestFullscreen) {\n\t\t\t\t\t\t\t\treturn elem.msRequestFullscreen();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} : {\n\t\t\t\t\t\t// node element maximize mode\n\t\t\t\t\t\t\n\t\t\t\t\t\tfullElm: function() {\n\t\t\t\t\t\t\tvar full;\n\t\t\t\t\t\t\tif (node.hasClass(cls)) {\n\t\t\t\t\t\t\t\treturn node.get(0);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfull = node.find('.' + cls);\n\t\t\t\t\t\t\t\tif (full.length) {\n\t\t\t\t\t\t\t\t\treturn full.get(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\n\t\t\t\t\t\texitFull: function() {\n\t\t\t\t\t\t\tvar elm;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(window).off('resize.' + namespace, resize);\n\t\t\t\t\t\t\tif (bodyOvf !== void(0)) {\n\t\t\t\t\t\t\t\t$('body').css('overflow', bodyOvf);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbodyOvf = void(0);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (orgStyle) {\n\t\t\t\t\t\t\t\telm = orgStyle.elm;\n\t\t\t\t\t\t\t\trestoreStyle(elm);\n\t\t\t\t\t\t\t\t$(elm).trigger('resize', {fullscreen: 'off'});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(window).trigger('resize');\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\n\t\t\t\t\t\ttoFull: function(elem) {\n\t\t\t\t\t\t\tbodyOvf = $('body').css('overflow') || '';\n\t\t\t\t\t\t\t$('body').css('overflow', 'hidden');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(elem).css(self.getMaximizeCss())\n\t\t\t\t\t\t\t\t.addClass(cls)\n\t\t\t\t\t\t\t\t.trigger('resize', {fullscreen: 'on'});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcheckDialog();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(window).on('resize.' + namespace, resize).trigger('resize');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\trestoreStyle = function(elem) {\n\t\t\t\t\tif (orgStyle && orgStyle.elm == elem) {\n\t\t\t\t\t\t$(elem).removeClass(cls + ' ' + clsN).attr('style', orgStyle.style);\n\t\t\t\t\t\torgStyle = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresize = function(e) {\n\t\t\t\t\tvar elm;\n\t\t\t\t\tif (e.target === window) {\n\t\t\t\t\t\tresizeTm && cancelAnimationFrame(resizeTm);\n\t\t\t\t\t\tresizeTm = requestAnimationFrame(function() {\n\t\t\t\t\t\t\tif (elm = funcObj.fullElm()) {\n\t\t\t\t\t\t\t\t$(elm).trigger('resize', {fullscreen: 'on'});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\n\t\t\tsetFuncObj();\n\n\t\t\t$(document).on('fullscreenchange.' + namespace + ' webkitfullscreenchange.' + namespace + ' mozfullscreenchange.' + namespace + ' MSFullscreenChange.' + namespace, function(e){\n\t\t\t\tif (self.UA.Fullscreen) {\n\t\t\t\t\tvar elm = funcObj.fullElm(),\n\t\t\t\t\t\twin = $(window);\n\t\t\t\t\t\n\t\t\t\t\tresizeTm && cancelAnimationFrame(resizeTm);\n\t\t\t\t\tif (elm === null) {\n\t\t\t\t\t\twin.off('resize.' + namespace, resize);\n\t\t\t\t\t\tif (orgStyle) {\n\t\t\t\t\t\t\telm = orgStyle.elm;\n\t\t\t\t\t\t\trestoreStyle(elm);\n\t\t\t\t\t\t\t$(elm).trigger('resize', {fullscreen: 'off'});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(elm).addClass(cls + ' ' + clsN)\n\t\t\t\t\t\t\t.attr('style', 'width:100%; height:100%; margin:0; padding:0;')\n\t\t\t\t\t\t\t.trigger('resize', {fullscreen: 'on'});\n\t\t\t\t\t\twin.on('resize.' + namespace, resize);\n\t\t\t\t\t\tcheckDialog();\n\t\t\t\t\t}\n\t\t\t\t\twin.trigger('resize');\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t/**\n\t\t\t * Toggle Full Scrren Mode\n\t\t\t * \n\t\t\t * @param  Object target\n\t\t\t * @param  Bool   full\n\t\t\t * @return Object | Null  DOM node object of current full scrren\n\t\t\t */\n\t\t\tself.toggleFullscreen = function(target, full) {\n\t\t\t\tvar elm = $(target).get(0),\n\t\t\t\t\tcurElm = null;\n\t\t\t\t\n\t\t\t\tcurElm = funcObj.fullElm();\n\t\t\t\tif (curElm) {\n\t\t\t\t\tif (curElm == elm) {\n\t\t\t\t\t\tif (full === true) {\n\t\t\t\t\t\t\treturn curElm;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (full === false) {\n\t\t\t\t\t\t\treturn curElm;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfuncObj.exitFull();\n\t\t\t\t\treturn null;\n\t\t\t\t} else {\n\t\t\t\t\tif (full === false) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsetFuncObj();\n\t\t\t\torgStyle = {elm: elm, style: $(elm).attr('style')};\n\t\t\t\tif (funcObj.toFull(elm) !== false) {\n\t\t\t\t\treturn elm;\n\t\t\t\t} else {\n\t\t\t\t\torgStyle = null;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\t\n\t\t// Closure for toggleMaximize\n\t\t(function(){\n\t\t\tvar cls = 'elfinder-maximized',\n\t\t\tresizeTm,\n\t\t\tresize = function(e) {\n\t\t\t\tif (e.target === window && e.data && e.data.elm) {\n\t\t\t\t\tvar elm = e.data.elm;\n\t\t\t\t\tresizeTm && cancelAnimationFrame(resizeTm);\n\t\t\t\t\tresizeTm = requestAnimationFrame(function() {\n\t\t\t\t\t\telm.trigger('resize', {maximize: 'on'});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\texitMax = function(elm) {\n\t\t\t\t$(window).off('resize.' + namespace, resize);\n\t\t\t\t$('body').css('overflow', elm.data('bodyOvf'));\n\t\t\t\telm.removeClass(cls)\n\t\t\t\t\t.attr('style', elm.data('orgStyle'))\n\t\t\t\t\t.removeData('bodyOvf')\n\t\t\t\t\t.removeData('orgStyle');\n\t\t\t\telm.trigger('resize', {maximize: 'off'});\n\t\t\t},\n\t\t\ttoMax = function(elm) {\n\t\t\t\telm.data('bodyOvf', $('body').css('overflow') || '')\n\t\t\t\t\t.data('orgStyle', elm.attr('style'))\n\t\t\t\t\t.addClass(cls)\n\t\t\t\t\t.css(self.getMaximizeCss());\n\t\t\t\t$('body').css('overflow', 'hidden');\n\t\t\t\t$(window).on('resize.' + namespace, {elm: elm}, resize);\n\t\t\t\telm.trigger('resize', {maximize: 'on'});\n\t\t\t};\n\t\t\t\n\t\t\t/**\n\t\t\t * Toggle Maximize target node\n\t\t\t * \n\t\t\t * @param  Object target\n\t\t\t * @param  Bool   max\n\t\t\t * @return void\n\t\t\t */\n\t\t\tself.toggleMaximize = function(target, max) {\n\t\t\t\tvar elm = $(target),\n\t\t\t\t\tmaximized = elm.hasClass(cls);\n\t\t\t\t\n\t\t\t\tif (maximized) {\n\t\t\t\t\tif (max === true) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\texitMax(elm);\n\t\t\t\t} else {\n\t\t\t\t\tif (max === false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\ttoMax(elm);\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\t\n\t\t/*************  init stuffs  ****************/\n\t\tObject.assign($.ui.keyCode, {\n\t\t\t'F1' : 112,\n\t\t\t'F2' : 113,\n\t\t\t'F3' : 114,\n\t\t\t'F4' : 115,\n\t\t\t'F5' : 116,\n\t\t\t'F6' : 117,\n\t\t\t'F7' : 118,\n\t\t\t'F8' : 119,\n\t\t\t'F9' : 120,\n\t\t\t'F10' : 121,\n\t\t\t'F11' : 122,\n\t\t\t'F12' : 123,\n\t\t\t'DIG0' : 48,\n\t\t\t'DIG1' : 49,\n\t\t\t'DIG2' : 50,\n\t\t\t'DIG3' : 51,\n\t\t\t'DIG4' : 52,\n\t\t\t'DIG5' : 53,\n\t\t\t'DIG6' : 54,\n\t\t\t'DIG7' : 55,\n\t\t\t'DIG8' : 56,\n\t\t\t'DIG9' : 57,\n\t\t\t'NUM0' : 96,\n\t\t\t'NUM1' : 97,\n\t\t\t'NUM2' : 98,\n\t\t\t'NUM3' : 99,\n\t\t\t'NUM4' : 100,\n\t\t\t'NUM5' : 101,\n\t\t\t'NUM6' : 102,\n\t\t\t'NUM7' : 103,\n\t\t\t'NUM8' : 104,\n\t\t\t'NUM9' : 105,\n\t\t\t'CONTEXTMENU' : 93,\n\t\t\t'DOT'  : 190\n\t\t});\n\t\t\n\t\tthis.dragUpload = false;\n\t\tthis.xhrUpload  = (typeof XMLHttpRequestUpload != 'undefined' || typeof XMLHttpRequestEventTarget != 'undefined') && typeof File != 'undefined' && typeof FormData != 'undefined';\n\t\t\n\t\t// configure transport object\n\t\tthis.transport = {};\n\n\t\tif (typeof(this.options.transport) == 'object') {\n\t\t\tthis.transport = this.options.transport;\n\t\t\tif (typeof(this.transport.init) == 'function') {\n\t\t\t\tthis.transport.init(this);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (typeof(this.transport.send) != 'function') {\n\t\t\tthis.transport.send = function(opts) {\n\t\t\t\tif (!self.UA.IE) {\n\t\t\t\t\t// keep native xhr object for handling property responseURL\n\t\t\t\t\topts._xhr = new XMLHttpRequest();\n\t\t\t\t\topts.xhr = function() { \n\t\t\t\t\t\tif (opts.progress) {\n\t\t\t\t\t\t\topts._xhr.addEventListener('progress', opts.progress); \n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn opts._xhr;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn $.ajax(opts);\n\t\t\t};\n\t\t}\n\t\t\n\t\tif (this.transport.upload == 'iframe') {\n\t\t\tthis.transport.upload = $.proxy(this.uploads.iframe, this);\n\t\t} else if (typeof(this.transport.upload) == 'function') {\n\t\t\tthis.dragUpload = !!this.options.dragUploadAllow;\n\t\t} else if (this.xhrUpload && !!this.options.dragUploadAllow) {\n\t\t\tthis.transport.upload = $.proxy(this.uploads.xhr, this);\n\t\t\tthis.dragUpload = true;\n\t\t} else {\n\t\t\tthis.transport.upload = $.proxy(this.uploads.iframe, this);\n\t\t}\n\n\t\t/**\n\t\t * Decoding 'raw' string converted to unicode\n\t\t * \n\t\t * @param  String str\n\t\t * @return String\n\t\t */\n\t\tthis.decodeRawString = function(str) {\n\t\t\tvar charCodes = function(str) {\n\t\t\t\tvar i, len, arr;\n\t\t\t\tfor (i=0,len=str.length,arr=[]; i<len; i++) {\n\t\t\t\t\tarr.push(str.charCodeAt(i));\n\t\t\t\t}\n\t\t\t\treturn arr;\n\t\t\t},\n\t\t\tscalarValues = function(arr) {\n\t\t\t\tvar scalars = [], i, len, c;\n\t\t\t\tif (typeof arr === 'string') {arr = charCodes(arr);}\n\t\t\t\tfor (i=0,len=arr.length; c=arr[i],i<len; i++) {\n\t\t\t\t\tif (c >= 0xd800 && c <= 0xdbff) {\n\t\t\t\t\t\tscalars.push((c & 1023) + 64 << 10 | arr[++i] & 1023);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscalars.push(c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn scalars;\n\t\t\t},\n\t\t\tdecodeUTF8 = function(arr) {\n\t\t\t\tvar i, len, c, str, char = String.fromCharCode;\n\t\t\t\tfor (i=0,len=arr.length,str=\"\"; c=arr[i],i<len; i++) {\n\t\t\t\t\tif (c <= 0x7f) {\n\t\t\t\t\t\tstr += char(c);\n\t\t\t\t\t} else if (c <= 0xdf && c >= 0xc2) {\n\t\t\t\t\t\tstr += char((c&31)<<6 | arr[++i]&63);\n\t\t\t\t\t} else if (c <= 0xef && c >= 0xe0) {\n\t\t\t\t\t\tstr += char((c&15)<<12 | (arr[++i]&63)<<6 | arr[++i]&63);\n\t\t\t\t\t} else if (c <= 0xf7 && c >= 0xf0) {\n\t\t\t\t\t\tstr += char(\n\t\t\t\t\t\t\t0xd800 | ((c&7)<<8 | (arr[++i]&63)<<2 | arr[++i]>>>4&3) - 64,\n\t\t\t\t\t\t\t0xdc00 | (arr[i++]&15)<<6 | arr[i]&63\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstr += char(0xfffd);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn str;\n\t\t\t};\n\t\t\t\n\t\t\treturn decodeUTF8(scalarValues(str));\n\t\t};\n\n\t\t/**\n\t\t * Gets target file contents by file.hash\n\t\t *\n\t\t * @param      String  hash          The hash\n\t\t * @param      String  responseType  'blob' or 'arraybuffer' (default)\n\t\t * @param      Object  requestOpts   The request options\n\t\t * @return     arraybuffer|blob  The contents.\n\t\t */\n\t\tthis.getContents = function(hash, responseType, requestOpts) {\n\t\t\tvar self = this,\n\t\t\t\tdfd = $.Deferred(),\n\t\t\t\ttype = responseType || 'arraybuffer',\n\t\t\t\turl, req;\n\n\t\t\tdfd.fail(function() {\n\t\t\t\treq && req.state() === 'pending' && req.reject();\n\t\t\t});\n\n\t\t\turl = self.openUrl(hash);\n\t\t\tif (!self.isSameOrigin(url)) {\n\t\t\t\turl = self.openUrl(hash, true);\n\t\t\t}\n\t\t\treq = self.request(Object.assign({\n\t\t\t\tdata    : {cmd : 'get'},\n\t\t\t\toptions : {\n\t\t\t\t\turl: url,\n\t\t\t\t\ttype: 'get',\n\t\t\t\t\tcache : true,\n\t\t\t\t\tdataType : 'binary',\n\t\t\t\t\tresponseType : type,\n\t\t\t\t\tprocessData: false\n\t\t\t\t},\n\t\t\t\tnotify : {\n\t\t\t\t\ttype: 'file',\n\t\t\t\t\tcnt: 1,\n\t\t\t\t\thideCnt: true\n\t\t\t\t},\n\t\t\t\tcancel : true\n\t\t\t}, requestOpts || {}))\n\t\t\t.fail(function() {\n\t\t\t\tdfd.reject();\n\t\t\t})\n\t\t\t.done(function(data) {\n\t\t\t\tdfd.resolve(data);\n\t\t\t});\n\n\t\t\treturn dfd;\n\t\t};\n\n\t\t/**\n\t\t * Gets the binary by url.\n\t\t *\n\t\t * @param      {Object}    opts      The options\n\t\t * @param      {Function}  callback  The callback\n\t\t * @param      {Object}    requestOpts The request options\n\t\t * @return     arraybuffer|blob  The contents.\n\t\t */\n\t\tthis.getBinaryByUrl = function(opts, callback, requestOpts) {\n\t\t\tvar self = this,\n\t\t\t\tdfd = $.Deferred(),\n\t\t\t\turl, req;\n\n\t\t\tdfd.fail(function() {\n\t\t\t\treq && req.state() === 'pending' && req.reject();\n\t\t\t});\n\n\t\t\treq = self.request(Object.assign({\n\t\t\t\tdata    : {cmd : 'get'},\n\t\t\t\toptions : Object.assign({\n\t\t\t\t\ttype: 'get',\n\t\t\t\t\tcache : true,\n\t\t\t\t\tdataType : 'binary',\n\t\t\t\t\tresponseType : 'blob',\n\t\t\t\t\tprocessData: false\n\t\t\t\t}, opts)\n\t\t\t}, requestOpts || {}))\n\t\t\t.fail(function() {\n\t\t\t\tdfd.reject();\n\t\t\t})\n\t\t\t.done(function(data) {\n\t\t\t\tcallback && callback(data);\n\t\t\t\tdfd.resolve(data);\n\t\t\t});\n\n\t\t\treturn dfd;\n\t\t};\n\n\t\t/**\n\t\t * Gets the mimetype.\n\t\t *\n\t\t * @param      {string}  name     The name\n\t\t * @param      {string}  orgMime  The organization mime\n\t\t * @return     {string}  The mimetype.\n\t\t */\n\t\tthis.getMimetype = function(name, orgMime) {\n\t\t\tvar mime = orgMime,\n\t\t\t\text, m;\n\t\t\tm = (name + '').match(/\\.([^.]+)$/);\n\t\t\tif (m && (ext = m[1])) {\n\t\t\t\tif (!extToMimeTable) {\n\t\t\t\t\textToMimeTable = self.arrayFlip(self.mimeTypes);\n\t\t\t\t}\n\t\t\t\tif (!(mime = extToMimeTable[ext.toLowerCase()])) {\n\t\t\t\t\tmime = orgMime;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mime;\n\t\t};\n\n\t\t/**\n\t\t * Supported check hash algorisms\n\t\t * \n\t\t * @type Array\n\t\t */\n\t\tself.hashCheckers = [];\n\n\t\t/**\n\t\t * Closure of getContentsHashes()\n\t\t */\n\t\t(function(self) {\n\t\t\tvar hashLibs = {};\n\n\t\t\tif (window.Worker && window.ArrayBuffer) {\n\t\t\t\t// make fm.hashCheckers\n\t\t\t\tif (self.options.cdns.sparkmd5) {\n\t\t\t\t\thashLibs.SparkMD5 = true;\n\t\t\t\t\tself.hashCheckers.push('md5');\n\t\t\t\t}\n\t\t\t\tif (self.options.cdns.jssha) {\n\t\t\t\t\thashLibs.jsSHA = true;\n\t\t\t\t\tself.hashCheckers = self.hashCheckers.concat(['sha1', 'sha224', 'sha256', 'sha384', 'sha512', 'sha3-224', 'sha3-256', 'sha3-384', 'sha3-512', 'shake128', 'shake256']);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the contents hashes.\n\t\t\t *\n\t\t\t * @param      String  target      target file.hash\n\t\t\t * @param      Object  needHashes  need hash lib names\n\t\t\t * @param      Object  requestOpts The request options\n\t\t\t * @return     Object  hashes with lib name as key\n\t\t\t */\n\t\t\tself.getContentsHashes = function(target, needHashes, hashOpts, requestOpts) {\n\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\tneeds = self.arrayFlip(needHashes || ['md5'], true),\n\t\t\t\t\tlibs = [],\n\t\t\t\t\tjobs = [],\n\t\t\t\t\tres = {},\n\t\t\t\t\topts = hashOpts? hashOpts : {\n\t\t\t\t\t\tshake128len : 256,\n\t\t\t\t\t\tshake256len : 512\n\t\t\t\t\t},\n\t\t\t\t\treq;\n\n\t\t\t\tdfd.fail(function() {\n\t\t\t\t\treq && req.reject();\n\t\t\t\t});\n\n\t\t\t\tif (Object.keys(hashLibs).length) {\n\t\t\t\t\treq = self.getContents(target, 'arraybuffer', requestOpts).done(function(arrayBuffer) {\n\t\t\t\t\t\tif (needs.md5 && hashLibs.SparkMD5) {\n\t\t\t\t\t\t\tjobs.push((function() {\n\t\t\t\t\t\t\t\tvar job = $.Deferred();\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tvar wk = self.getWorker();\n\t\t\t\t\t\t\t\t\tjob.fail(function() {\n\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\twk.onmessage = function(ans) {\n\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\tif (ans.data.hash) {\n\t\t\t\t\t\t\t\t\t\t\tvar f;\n\t\t\t\t\t\t\t\t\t\t\tres.md5 = ans.data.hash;\n\t\t\t\t\t\t\t\t\t\t\tif (f = self.file(target)) {\n\t\t\t\t\t\t\t\t\t\t\t\tf.md5 = res.md5;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else if (ans.data.error) {\n\t\t\t\t\t\t\t\t\t\t\tres.md5 = ans.data.error;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdfd.notify(res);\n\t\t\t\t\t\t\t\t\t\tjob.resolve();\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\twk.onerror = function(e) {\n\t\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\tscripts: [self.options.cdns.sparkmd5, self.getWorkerUrl('calcfilehash.js')],\n\t\t\t\t\t\t\t\t\t\tdata: { type: 'md5', bin: arrayBuffer }\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tdfd.fail(function() {\n\t\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\tdelete hashLibs.SparkMD5;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn job;\n\t\t\t\t\t\t\t})());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hashLibs.jsSHA) {\n\t\t\t\t\t\t\t$.each(['1', '224', '256', '384', '512', '3-224', '3-256', '3-384', '3-512', 'ke128', 'ke256'], function(i, v) {\n\t\t\t\t\t\t\t\tif (needs['sha' + v]) {\n\t\t\t\t\t\t\t\t\tjobs.push((function() {\n\t\t\t\t\t\t\t\t\t\tvar job = $.Deferred();\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tvar wk = self.getWorker();\n\t\t\t\t\t\t\t\t\t\t\tjob.fail(function() {\n\t\t\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\twk.onmessage = function(ans) {\n\t\t\t\t\t\t\t\t\t\t\t\twk && wk.terminate();\n\t\t\t\t\t\t\t\t\t\t\t\tif (ans.data.hash) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar f;\n\t\t\t\t\t\t\t\t\t\t\t\t\tres['sha' + v] = ans.data.hash;\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (f = self.file(target)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tf['sha' + v] = res['sha' + v];\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (ans.data.error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tres['sha' + v] = ans.data.error;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tdfd.notify(res);\n\t\t\t\t\t\t\t\t\t\t\t\tjob.resolve();\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\twk.onerror = function(e) {\n\t\t\t\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\twk.postMessage({\n\t\t\t\t\t\t\t\t\t\t\t\tscripts: [self.options.cdns.jssha, self.getWorkerUrl('calcfilehash.js')],\n\t\t\t\t\t\t\t\t\t\t\t\tdata: { type: v, bin: arrayBuffer, hashOpts: opts }\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tdfd.fail(function() {\n\t\t\t\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\t\t\tjob.reject();\n\t\t\t\t\t\t\t\t\t\t\tdelete hashLibs.jsSHA;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn job;\n\t\t\t\t\t\t\t\t\t})());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (jobs.length) {\n\t\t\t\t\t\t\t$.when.apply(null, jobs).always(function() {\n\t\t\t\t\t\t\t\tdfd.resolve(res);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tdfd.reject();\n\t\t\t\t}\n\n\t\t\t\treturn dfd;\n\t\t\t};\n\t\t})(this);\n\n\t\t/**\n\t\t * Parse error value to display\n\t\t *\n\t\t * @param  Mixed  error\n\t\t * @return Mixed  parsed error\n\t\t */\n\t\tthis.parseError = function(error) {\n\t\t\tvar arg = error;\n\t\t\tif ($.isPlainObject(arg)) {\n\t\t\t\targ = arg.error;\n\t\t\t}\n\t\t\treturn arg;\n\t\t};\n\n\t\t/**\n\t\t * Alias for this.trigger('error', {error : 'message'})\n\t\t *\n\t\t * @param  String  error message\n\t\t * @return elFinder\n\t\t **/\n\t\tthis.error = function() {\n\t\t\tvar arg = arguments[0],\n\t\t\t\topts = arguments[1] || null,\n\t\t\t\terr;\n\t\t\tif (arguments.length == 1 && typeof(arg) === 'function') {\n\t\t\t\treturn self.bind('error', arg);\n\t\t\t} else {\n\t\t\t\terr = this.parseError(arg);\n\t\t\t\treturn (err === true || !err)? this : self.trigger('error', {error: err, opts : opts});\n\t\t\t}\n\t\t};\n\t\t\n\t\t// create bind/trigger aliases for build-in events\n\t\t$.each(events, function(i, name) {\n\t\t\tself[name] = function() {\n\t\t\t\tvar arg = arguments[0];\n\t\t\t\treturn arguments.length == 1 && typeof(arg) == 'function'\n\t\t\t\t\t? self.bind(name, arg)\n\t\t\t\t\t: self.trigger(name, $.isPlainObject(arg) ? arg : {});\n\t\t\t};\n\t\t});\n\n\t\t// bind core event handlers\n\t\tthis\n\t\t\t.enable(function() {\n\t\t\t\tif (!enabled && self.api && self.visible() && self.ui.overlay.is(':hidden') && ! node.children('.elfinder-dialog.' + self.res('class', 'editing') + ':visible').length) {\n\t\t\t\t\tenabled = true;\n\t\t\t\t\tdocument.activeElement && document.activeElement.blur();\n\t\t\t\t\tnode.removeClass('elfinder-disabled');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.disable(function() {\n\t\t\t\tprevEnabled = enabled;\n\t\t\t\tenabled = false;\n\t\t\t\tnode.addClass('elfinder-disabled');\n\t\t\t})\n\t\t\t.open(function() {\n\t\t\t\tselected = [];\n\t\t\t})\n\t\t\t.select(function(e) {\n\t\t\t\tvar cnt = 0,\n\t\t\t\t\tunselects = [];\n\t\t\t\tselected = $.grep(e.data.selected || e.data.value|| [], function(hash) {\n\t\t\t\t\tif (unselects.length || (self.maxTargets && ++cnt > self.maxTargets)) {\n\t\t\t\t\t\tunselects.push(hash);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn files[hash] ? true : false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (unselects.length) {\n\t\t\t\t\tself.trigger('unselectfiles', {files: unselects, inselect: true});\n\t\t\t\t\tself.toast({mode: 'warning', msg: self.i18n(['errMaxTargets', self.maxTargets])});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.error(function(e) { \n\t\t\t\tvar opts  = {\n\t\t\t\t\t\tcssClass  : 'elfinder-dialog-error',\n\t\t\t\t\t\ttitle     : self.i18n('error'),\n\t\t\t\t\t\tresizable : false,\n\t\t\t\t\t\tdestroyOnClose : true,\n\t\t\t\t\t\tbuttons   : {}\n\t\t\t\t\t},\n\t\t\t\t\tnode = self.getUI(),\n\t\t\t\t\tcnt = node.children('.elfinder-dialog-error').length,\n\t\t\t\t\tlast, counter;\n\t\t\t\t\n\t\t\t\tif (cnt < self.options.maxErrorDialogs) {\n\t\t\t\t\topts.buttons[self.i18n(self.i18n('btnClose'))] = function() { $(this).elfinderdialog('close'); };\n\n\t\t\t\t\tif (e.data.opts && $.isPlainObject(e.data.opts)) {\n\t\t\t\t\t\tObject.assign(opts, e.data.opts);\n\t\t\t\t\t}\n\n\t\t\t\t\tself.dialog('<span class=\"elfinder-dialog-icon elfinder-dialog-icon-error\"/>'+self.i18n(e.data.error), opts);\n\t\t\t\t} else {\n\t\t\t\t\tlast = node.children('.elfinder-dialog-error:last').children('.ui-dialog-content:first');\n\t\t\t\t\tcounter = last.children('.elfinder-error-counter');\n\t\t\t\t\tif (counter.length) {\n\t\t\t\t\t\tcounter.data('cnt', parseInt(counter.data('cnt')) + 1).html(self.i18n(['moreErrors', counter.data('cnt')]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcounter = $('<span class=\"elfinder-error-counter\">'+ self.i18n(['moreErrors', 1]) +'</span>').data('cnt', 1);\n\t\t\t\t\t\tlast.append('<br/>', counter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind('tmb', function(e) {\n\t\t\t\t$.each(e.data.images||[], function(hash, tmb) {\n\t\t\t\t\tif (files[hash]) {\n\t\t\t\t\t\tfiles[hash].tmb = tmb;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.bind('searchstart', function(e) {\n\t\t\t\tObject.assign(self.searchStatus, e.data);\n\t\t\t\tself.searchStatus.state = 1;\n\t\t\t})\n\t\t\t.bind('search', function(e) {\n\t\t\t\tself.searchStatus.state = 2;\n\t\t\t})\n\t\t\t.bind('searchend', function() {\n\t\t\t\tself.searchStatus.state = 0;\n\t\t\t\tself.searchStatus.ininc = false;\n\t\t\t\tself.searchStatus.mixed = false;\n\t\t\t})\n\t\t\t.bind('canMakeEmptyFile', function(e) {\n\t\t\t\tvar data = e.data,\n\t\t\t\t\tobj = {};\n\t\t\t\tif (data && Array.isArray(data.mimes)) {\n\t\t\t\t\tif (!data.unshift) {\n\t\t\t\t\t\tobj = self.mimesCanMakeEmpty;\n\t\t\t\t\t}\n\t\t\t\t\t$.each(data.mimes, function() {\n\t\t\t\t\t\tif (!obj[this]) {\n\t\t\t\t\t\t\tobj[this] = self.mimeTypes[this];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (data.unshift) {\n\t\t\t\t\t\tself.mimesCanMakeEmpty = Object.assign(obj, self.mimesCanMakeEmpty);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind('themechange', function() {\n\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\tself.trigger('uiresize');\n\t\t\t\t});\n\t\t\t})\n\t\t\t;\n\n\t\t// We listen and emit a sound on delete according to option\n\t\tif (true === this.options.sound) {\n\t\t\tthis.bind('playsound', function(e) {\n\t\t\t\tvar play  = beeper.canPlayType && beeper.canPlayType('audio/wav; codecs=\"1\"'),\n\t\t\t\t\tfile = e.data && e.data.soundFile;\n\n\t\t\t\tplay && file && play != '' && play != 'no' && $(beeper).html('<source src=\"' + soundPath + file + '\" type=\"audio/wav\">')[0].play();\n\t\t\t});\n\t\t}\n\n\t\t// bind external event handlers\n\t\t$.each(this.options.handlers, function(event, callback) {\n\t\t\tself.bind(event, callback);\n\t\t});\n\n\t\t/**\n\t\t * History object. Store visited folders\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis.history = new this.history(this);\n\t\t\n\t\t/**\n\t\t * Root hashed\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.roots = {};\n\t\t\n\t\t/**\n\t\t * leaf roots\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.leafRoots = {};\n\t\t\n\t\tthis.volumeExpires = {};\n\n\t\t/**\n\t\t * Loaded commands\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis._commands = {};\n\t\t\n\t\tif (!Array.isArray(this.options.commands)) {\n\t\t\tthis.options.commands = [];\n\t\t}\n\t\t\n\t\tif ($.inArray('*', this.options.commands) !== -1) {\n\t\t\tthis.options.commands = Object.keys(this.commands);\n\t\t}\n\t\t\n\t\t/**\n\t\t * UI command map of cwd volume ( That volume driver option `uiCmdMap` )\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tthis.commandMap = {};\n\t\t\n\t\t/**\n\t\t * cwd options of each volume\n\t\t * key: volumeid\n\t\t * val: options object\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.volOptions = {};\n\n\t\t/**\n\t\t * Has volOptions data\n\t\t * \n\t\t * @type Boolean\n\t\t */\n\t\tthis.hasVolOptions = false;\n\n\t\t/**\n\t\t * Hash of trash holders\n\t\t * key: trash folder hash\n\t\t * val: source volume hash\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tthis.trashes = {};\n\n\t\t/**\n\t\t * cwd options of each folder/file\n\t\t * key: hash\n\t\t * val: options object\n\t\t *\n\t\t * @type Object\n\t\t */\n\t\tthis.optionsByHashes = {};\n\t\t\n\t\t/**\n\t\t * UI Auto Hide Functions\n\t\t * Each auto hide function mast be call to `fm.trigger('uiautohide')` at end of process\n\t\t *\n\t\t * @type Array\n\t\t **/\n\t\tthis.uiAutoHide = [];\n\t\t\n\t\t// trigger `uiautohide`\n\t\tthis.one('open', function() {\n\t\t\tif (self.uiAutoHide.length) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.trigger('uiautohide');\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t});\n\t\t\n\t\t// Auto Hide Functions sequential processing start\n\t\tthis.bind('uiautohide', function() {\n\t\t\tif (self.uiAutoHide.length) {\n\t\t\t\tself.uiAutoHide.shift()();\n\t\t\t}\n\t\t});\n\n\t\tif (this.options.width) {\n\t\t\twidth = this.options.width;\n\t\t}\n\t\t\n\t\tif (this.options.height) {\n\t\t\theight = this.options.height;\n\t\t}\n\t\t\n\t\tif (this.options.heightBase) {\n\t\t\theightBase = $(this.options.heightBase);\n\t\t}\n\t\t\n\t\tif (this.options.soundPath) {\n\t\t\tsoundPath = this.options.soundPath.replace(/\\/+$/, '') + '/';\n\t\t} else {\n\t\t\tsoundPath = this.baseUrl + soundPath;\n\t\t}\n\t\t\n\t\tif (this.options.parrotHeaders && Array.isArray(this.options.parrotHeaders) && this.options.parrotHeaders.length) {\n\t\t\tthis.parrotHeaders = this.options.parrotHeaders;\n\t\t\t// check sessionStorage\n\t\t\t$.each(this.parrotHeaders, function(i, h) {\n\t\t\t\tvar v = self.sessionStorage('core-ph:' + h);\n\t\t\t\tif (v) {\n\t\t\t\t\tself.customHeaders[h] = v;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.parrotHeaders = [];\n\t\t}\n\n\t\tself.one('opendone', function() {\n\t\t\tvar tm;\n\t\t\t// attach events to document\n\t\t\t$(document)\n\t\t\t\t// disable elfinder on click outside elfinder\n\t\t\t\t.on('click.'+namespace, function(e) { enabled && ! self.options.enableAlways && !$(e.target).closest(node).length && self.disable(); })\n\t\t\t\t// exec shortcuts\n\t\t\t\t.on(keydown+' '+keypress+' '+keyup+' '+mousedown, execShortcut);\n\t\t\t\n\t\t\t// attach events to window\n\t\t\tself.options.useBrowserHistory && $(window)\n\t\t\t\t.on('popstate.' + namespace, function(ev) {\n\t\t\t\t\tvar state = ev.originalEvent.state || {},\n\t\t\t\t\t\thasThash = state.thash? true : false,\n\t\t\t\t\t\tdialog = node.find('.elfinder-frontmost:visible'),\n\t\t\t\t\t\tinput = node.find('.elfinder-navbar-dir,.elfinder-cwd-filename').find('input,textarea'),\n\t\t\t\t\t\tonOpen, toast;\n\t\t\t\t\tif (!hasThash) {\n\t\t\t\t\t\tstate = { thash: self.cwd().hash };\n\t\t\t\t\t\t// scroll to elFinder node\n\t\t\t\t\t\t$('html,body').animate({ scrollTop: node.offset().top });\n\t\t\t\t\t}\n\t\t\t\t\tif (dialog.length || input.length) {\n\t\t\t\t\t\thistory.pushState(state, null, location.pathname + location.search + '#elf_' + state.thash);\n\t\t\t\t\t\tif (dialog.length) {\n\t\t\t\t\t\t\tif (!dialog.hasClass(self.res('class', 'preventback'))) {\n\t\t\t\t\t\t\t\tif (dialog.hasClass('elfinder-contextmenu')) {\n\t\t\t\t\t\t\t\t\t$(document).trigger($.Event('keydown', { keyCode: $.ui.keyCode.ESCAPE, ctrlKey : false, shiftKey : false, altKey : false, metaKey : false }));\n\t\t\t\t\t\t\t\t} else if (dialog.hasClass('elfinder-dialog')) {\n\t\t\t\t\t\t\t\t\tdialog.elfinderdialog('close');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdialog.trigger('close');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.trigger($.Event('keydown', { keyCode: $.ui.keyCode.ESCAPE, ctrlKey : false, shiftKey : false, altKey : false, metaKey : false }));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (hasThash) {\n\t\t\t\t\t\t\t!$.isEmptyObject(self.files()) && self.request({\n\t\t\t\t\t\t\t\tdata   : {cmd  : 'open', target : state.thash, onhistory : 1},\n\t\t\t\t\t\t\t\tnotify : {type : 'open', cnt : 1, hideCnt : true},\n\t\t\t\t\t\t\t\tsyncOnFail : true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tonOpen = function() {\n\t\t\t\t\t\t\t\ttoast.trigger('click');\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.one('open', onOpen, true);\n\t\t\t\t\t\t\ttoast = self.toast({\n\t\t\t\t\t\t\t\tmsg: self.i18n('pressAgainToExit'),\n\t\t\t\t\t\t\t\tonHidden: function() {\n\t\t\t\t\t\t\t\t\tself.unbind('open', onOpen);\n\t\t\t\t\t\t\t\t\thistory.pushState(state, null, location.pathname + location.search + '#elf_' + state.thash);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\n\t\t\t$(window).on('resize.' + namespace, function(e){\n\t\t\t\tif (e.target === this) {\n\t\t\t\t\ttm && cancelAnimationFrame(tm);\n\t\t\t\t\ttm = requestAnimationFrame(function() {\n\t\t\t\t\t\tvar prv = node.data('resizeSize') || {w: 0, h: 0},\n\t\t\t\t\t\t\tsize = {w: Math.round(node.width()), h: Math.round(node.height())};\n\t\t\t\t\t\tnode.data('resizeSize', size);\n\t\t\t\t\t\tif (size.w !== prv.w || size.h !== prv.h) {\n\t\t\t\t\t\t\tnode.trigger('resize');\n\t\t\t\t\t\t\tself.trigger('resize', {width : size.w, height : size.h});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('beforeunload.' + namespace,function(e){\n\t\t\t\tvar msg, cnt;\n\t\t\t\tif (!self.pauseUnloadCheck()) {\n\t\t\t\t\tif (node.is(':visible')) {\n\t\t\t\t\t\tif (self.ui.notify.children().length && $.inArray('hasNotifyDialog', self.options.windowCloseConfirm) !== -1) {\n\t\t\t\t\t\t\tmsg = self.i18n('ntfsmth');\n\t\t\t\t\t\t} else if (node.find('.'+self.res('class', 'editing')).length && $.inArray('editingFile', self.options.windowCloseConfirm) !== -1) {\n\t\t\t\t\t\t\tmsg = self.i18n('editingFile');\n\t\t\t\t\t\t} else if ((cnt = Object.keys(self.selected()).length) && $.inArray('hasSelectedItem', self.options.windowCloseConfirm) !== -1) {\n\t\t\t\t\t\t\tmsg = self.i18n('hasSelected', ''+cnt);\n\t\t\t\t\t\t} else if ((cnt = Object.keys(self.clipboard()).length) && $.inArray('hasClipboardData', self.options.windowCloseConfirm) !== -1) {\n\t\t\t\t\t\t\tmsg = self.i18n('hasClipboard', ''+cnt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (msg) {\n\t\t\t\t\t\t\te.returnValue = msg;\n\t\t\t\t\t\t\treturn msg;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tself.trigger('unload');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// bind window onmessage for CORS\n\t\t\t$(window).on('message.' + namespace, function(e){\n\t\t\t\tvar res = e.originalEvent || null,\n\t\t\t\t\tobj, data;\n\t\t\t\tif (res && (self.convAbsUrl(self.options.url).indexOf(res.origin) === 0 || self.convAbsUrl(self.uploadURL).indexOf(res.origin) === 0)) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tobj = JSON.parse(res.data);\n\t\t\t\t\t\tdata = obj.data || null;\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tif (data.error) {\n\t\t\t\t\t\t\t\tif (obj.bind) {\n\t\t\t\t\t\t\t\t\tself.trigger(obj.bind+'fail', data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tself.error(data.error);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdata.warning && self.error(data.warning);\n\t\t\t\t\t\t\t\tself.updateCache(data);\n\t\t\t\t\t\t\t\tdata.removed && data.removed.length && self.remove(data);\n\t\t\t\t\t\t\t\tdata.added   && data.added.length   && self.add(data);\n\t\t\t\t\t\t\t\tdata.changed && data.changed.length && self.change(data);\n\t\t\t\t\t\t\t\tif (obj.bind) {\n\t\t\t\t\t\t\t\t\tself.trigger(obj.bind, data);\n\t\t\t\t\t\t\t\t\tself.trigger(obj.bind+'done');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata.sync && self.sync();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tself.sync();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// elFinder enable always\n\t\t\tif (self.options.enableAlways) {\n\t\t\t\t$(window).on('focus.' + namespace, function(e){\n\t\t\t\t\t(e.target === this) && self.enable();\n\t\t\t\t});\n\t\t\t\tif (inFrame) {\n\t\t\t\t\t$(window.top).on('focus.' + namespace, function() {\n\t\t\t\t\t\tif (self.enable() && (! parentIframe || parentIframe.is(':visible'))) {\n\t\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t$(window).trigger('focus');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (inFrame) {\n\t\t\t\t$(window).on('blur.' + namespace, function(e){\n\t\t\t\t\tenabled && e.target === this && self.disable();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// return focus to the window on click (elFInder in the frame)\n\t\t\tif (inFrame) {\n\t\t\t\tnode.on('click', function(e) {\n\t\t\t\t\t$(window).trigger('focus');\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t// elFinder to enable by mouse over\n\t\t\tif (self.options.enableByMouseOver) {\n\t\t\t\tnode.on('mouseenter touchstart', function(e) {\n\t\t\t\t\t(inFrame) && $(window).trigger('focus');\n\t\t\t\t\t! self.enabled() && self.enable();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// When the browser tab turn to foreground/background\n\t\t\t$(window).on('visibilitychange.' + namespace, function(e) {\n\t\t\t\tvar background = document.hidden || document.webkitHidden || document.msHidden;\n\t\t\t\t// AutoSync turn On/Off\n\t\t\t\tif (self.options.syncStart) {\n\t\t\t\t\tself.autoSync(background? 'stop' : void(0));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// store instance in node\n\t\tnode[0].elfinder = this;\n\n\t\t// auto load language file\n\t\tdfrdsBeforeBootup.push((function() {\n\t\t\tvar lang   = self.lang,\n\t\t\t\tlangJs = self.i18nBaseUrl + 'elfinder.' + lang + '.js',\n\t\t\t\tdfd    = $.Deferred(),\n\t\t\t\tdfd1 = dfd.done(function() { // modified by lwf\n\t\t\t\t\tif (self.i18[lang]) {\n\t\t\t\t\t\tself.lang = lang;\n\t\t\t\t\t}\n\t\t\t\t\tself.trigger('i18load');\n\t\t\t\t\ti18n = self.lang === 'en' \n\t\t\t\t\t\t? self.i18['en'] \n\t\t\t\t\t\t: $.extend(true, {}, self.i18['en'], self.i18[self.lang]);\n\t\t\t\t});\n\t\t\t\n\t\t\tif (!self.i18[lang]) {\n\t\t\t\tself.lang = 'en';\n\t\t\t\tif (self.hasRequire) {\n\t\t\t\t\trequire([langJs], function() {\n\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t}, function() {\n\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tself.loadScript([langJs], function() {\n\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t}, {\n\t\t\t\t\t\tloadType: 'tag',\n\t\t\t\t\t\terror : function() {\n\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdfd.resolve();\n\t\t\t}\n\t\t\treturn dfd;\n\t\t})());\n\t\t\n\t\t// elFinder boot up function\n\t\tbootUp = function() {\n\t\t\tvar columnNames;\n\n\t\t\t/**\n\t\t\t * i18 messages\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tself.messages = i18n.messages;\n\t\t\t\n\t\t\t// check jquery ui\n\t\t\tif (!($.fn.selectable && $.fn.draggable && $.fn.droppable && $.fn.resizable && $.fn.button && $.fn.slider)) {\n\t\t\t\treturn alert(self.i18n('errJqui'));\n\t\t\t}\n\t\t\t\n\t\t\t// check node\n\t\t\tif (!node.length) {\n\t\t\t\treturn alert(self.i18n('errNode'));\n\t\t\t}\n\t\t\t// check connector url\n\t\t\tif (!self.options.url) {\n\t\t\t\treturn alert(self.i18n('errURL'));\n\t\t\t}\n\t\t\t\n\t\t\t// column key/name map for fm.getColumnName()\n\t\t\tcolumnNames = Object.assign({\n\t\t\t\tname : self.i18n('name'),\n\t\t\t\tperm : self.i18n('perms'),\n\t\t\t\tdate : self.i18n('modify'),\n\t\t\t\tsize : self.i18n('size'),\n\t\t\t\tkind : self.i18n('kind'),\n\t\t\t\tmodestr : self.i18n('mode'),\n\t\t\t\tmodeoct : self.i18n('mode'),\n\t\t\t\tmodeboth : self.i18n('mode')\n\t\t\t}, self.options.uiOptions.cwd.listView.columnsCustomName);\n\n\t\t\t/**\n\t\t\t * Gets the column name of cwd list view\n\t\t\t *\n\t\t\t * @param      String  key     The key\n\t\t\t * @return     String  The column name.\n\t\t\t */\n\t\t\tself.getColumnName = function(key) {\n\t\t\t\treturn columnNames[key] || self.i18n(key);\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Interface direction\n\t\t\t *\n\t\t\t * @type String\n\t\t\t * @default \"ltr\"\n\t\t\t **/\n\t\t\tself.direction = i18n.direction;\n\t\t\t\n\t\t\t/**\n\t\t\t * Date/time format\n\t\t\t *\n\t\t\t * @type String\n\t\t\t * @default \"m.d.Y\"\n\t\t\t **/\n\t\t\tself.dateFormat = self.options.dateFormat || i18n.dateFormat;\n\t\t\t\n\t\t\t/**\n\t\t\t * Date format like \"Yesterday 10:20:12\"\n\t\t\t *\n\t\t\t * @type String\n\t\t\t * @default \"{day} {time}\"\n\t\t\t **/\n\t\t\tself.fancyFormat = self.options.fancyDateFormat || i18n.fancyDateFormat;\n\t\t\t\n\t\t\t/**\n\t\t\t * Date format for if upload file has not original unique name\n\t\t\t * e.g. Clipboard image data, Image data taken with iOS\n\t\t\t *\n\t\t\t * @type String\n\t\t\t * @default \"ymd-His\"\n\t\t\t **/\n\t\t\tself.nonameDateFormat = (self.options.nonameDateFormat || i18n.nonameDateFormat).replace(/[\\/\\\\]/g, '_');\n\n\t\t\t/**\n\t\t\t * Css classes \n\t\t\t *\n\t\t\t * @type String\n\t\t\t **/\n\t\t\tself.cssClass = 'ui-helper-reset ui-helper-clearfix ui-widget ui-widget-content ui-corner-all elfinder elfinder-'\n\t\t\t\t\t+(self.direction == 'rtl' ? 'rtl' : 'ltr')\n\t\t\t\t\t+(self.UA.Touch? (' elfinder-touch' + (self.options.resizable ? ' touch-punch' : '')) : '')\n\t\t\t\t\t+(self.UA.Mobile? ' elfinder-mobile' : '')\n\t\t\t\t\t+(self.UA.iOS? ' elfinder-ios' : '')\n\t\t\t\t\t+' '+self.options.cssClass;\n\n\t\t\t// prepare node\n\t\t\tnode.addClass(self.cssClass)\n\t\t\t\t.on(mousedown, function() {\n\t\t\t\t\t!enabled && self.enable();\n\t\t\t\t});\n\n\t\t\t// draggable closure\n\t\t\t(function() {\n\t\t\t\tvar ltr, wzRect, wzBottom, wzBottom2, nodeStyle,\n\t\t\t\t\tkeyEvt = keydown + 'draggable' + ' keyup.' + namespace + 'draggable';\n\t\t\t\t\n\t\t\t\t/**\n\t\t\t\t * Base draggable options\n\t\t\t\t *\n\t\t\t\t * @type Object\n\t\t\t\t **/\n\t\t\t\tself.draggable = {\n\t\t\t\t\tappendTo   : node,\n\t\t\t\t\taddClasses : false,\n\t\t\t\t\tdistance   : 4,\n\t\t\t\t\trevert     : true,\n\t\t\t\t\trefreshPositions : false,\n\t\t\t\t\tcursor     : 'crosshair',\n\t\t\t\t\tcursorAt   : {left : 50, top : 47},\n\t\t\t\t\tscroll     : false,\n\t\t\t\t\tstart      : function(e, ui) {\n\t\t\t\t\t\tvar helper   = ui.helper,\n\t\t\t\t\t\t\ttargets  = $.grep(helper.data('files')||[], function(h) {\n\t\t\t\t\t\t\t\tif (h) {\n\t\t\t\t\t\t\t\t\tremember[h] = true;\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tlocked   = false,\n\t\t\t\t\t\t\tcnt, h;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// fix node size\n\t\t\t\t\t\tnodeStyle = node.attr('style');\n\t\t\t\t\t\tnode.width(node.width()).height(node.height());\n\t\t\t\t\t\t\n\t\t\t\t\t\t// set var for drag()\n\t\t\t\t\t\tltr = (self.direction === 'ltr');\n\t\t\t\t\t\twzRect = self.getUI('workzone').data('rectangle');\n\t\t\t\t\t\twzBottom = wzRect.top + wzRect.height;\n\t\t\t\t\t\twzBottom2 = wzBottom - self.getUI('navdock').outerHeight(true);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.draggingUiHelper = helper;\n\t\t\t\t\t\tcnt = targets.length;\n\t\t\t\t\t\twhile (cnt--) {\n\t\t\t\t\t\t\th = targets[cnt];\n\t\t\t\t\t\t\tif (files[h].locked) {\n\t\t\t\t\t\t\t\tlocked = true;\n\t\t\t\t\t\t\t\thelper.data('locked', true);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t!locked && self.trigger('lockfiles', {files : targets});\n\t\t\t\n\t\t\t\t\t\thelper.data('autoScrTm', setInterval(function() {\n\t\t\t\t\t\t\tif (helper.data('autoScr')) {\n\t\t\t\t\t\t\t\tself.autoScroll[helper.data('autoScr')](helper.data('autoScrVal'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 50));\n\t\t\t\t\t},\n\t\t\t\t\tdrag       : function(e, ui) {\n\t\t\t\t\t\tvar helper = ui.helper,\n\t\t\t\t\t\t\tautoScr, autoUp, bottom;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ((autoUp = wzRect.top > e.pageY) || wzBottom2 < e.pageY) {\n\t\t\t\t\t\t\tif (wzRect.cwdEdge > e.pageX) {\n\t\t\t\t\t\t\t\tautoScr = (ltr? 'navbar' : 'cwd') + (autoUp? 'Up' : 'Down');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tautoScr = (ltr? 'cwd' : 'navbar') + (autoUp? 'Up' : 'Down');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!autoUp) {\n\t\t\t\t\t\t\t\tif (autoScr.substr(0, 3) === 'cwd') {\n\t\t\t\t\t\t\t\t\tif (wzBottom < e.pageY) {\n\t\t\t\t\t\t\t\t\t\tbottom = wzBottom;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tautoScr = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbottom = wzBottom2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (autoScr) {\n\t\t\t\t\t\t\t\thelper.data('autoScr', autoScr);\n\t\t\t\t\t\t\t\thelper.data('autoScrVal', Math.pow((autoUp? wzRect.top - e.pageY : e.pageY - bottom), 1.3));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (! autoScr) {\n\t\t\t\t\t\t\tif (helper.data('autoScr')) {\n\t\t\t\t\t\t\t\thelper.data('refreshPositions', 1).data('autoScr', null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (helper.data('refreshPositions') && $(this).elfUiWidgetInstance('draggable')) {\n\t\t\t\t\t\t\tif (helper.data('refreshPositions') > 0) {\n\t\t\t\t\t\t\t\t$(this).draggable('option', { refreshPositions : true, elfRefresh : true });\n\t\t\t\t\t\t\t\thelper.data('refreshPositions', -1);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(this).draggable('option', { refreshPositions : false, elfRefresh : false });\n\t\t\t\t\t\t\t\thelper.data('refreshPositions', null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tstop       : function(e, ui) {\n\t\t\t\t\t\tvar helper = ui.helper,\n\t\t\t\t\t\t\tfiles;\n\t\t\t\t\t\t\n\t\t\t\t\t\t$(document).off(keyEvt);\n\t\t\t\t\t\t$(this).elfUiWidgetInstance('draggable') && $(this).draggable('option', { refreshPositions : false });\n\t\t\t\t\t\tself.draggingUiHelper = null;\n\t\t\t\t\t\tself.trigger('focus').trigger('dragstop');\n\t\t\t\t\t\tif (! helper.data('droped')) {\n\t\t\t\t\t\t\tfiles = $.grep(helper.data('files')||[], function(h) { return h? true : false ;});\n\t\t\t\t\t\t\tself.trigger('unlockfiles', {files : files});\n\t\t\t\t\t\t\tself.trigger('selectfiles', {files : self.selected()});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.enable();\n\t\t\t\t\t\t\n\t\t\t\t\t\t// restore node style\n\t\t\t\t\t\tnode.attr('style', nodeStyle);\n\t\t\t\t\t\t\n\t\t\t\t\t\thelper.data('autoScrTm') && clearInterval(helper.data('autoScrTm'));\n\t\t\t\t\t},\n\t\t\t\t\thelper     : function(e, ui) {\n\t\t\t\t\t\tvar element = this.id ? $(this) : $(this).parents('[id]:first'),\n\t\t\t\t\t\t\thelper  = $('<div class=\"elfinder-drag-helper\"><span class=\"elfinder-drag-helper-icon-status\"/></div>'),\n\t\t\t\t\t\t\ticon    = function(f) {\n\t\t\t\t\t\t\t\tvar mime = f.mime, i, tmb = self.tmb(f);\n\t\t\t\t\t\t\t\ti = '<div class=\"elfinder-cwd-icon elfinder-cwd-icon-drag '+self.mime2class(mime)+' ui-corner-all\"/>';\n\t\t\t\t\t\t\t\tif (tmb) {\n\t\t\t\t\t\t\t\t\ti = $(i).addClass(tmb.className).css('background-image', \"url('\"+tmb.url+\"')\").get(0).outerHTML;\n\t\t\t\t\t\t\t\t} else if (f.icon) {\n\t\t\t\t\t\t\t\t\ti = $(i).css(self.getIconStyle(f, true)).get(0).outerHTML;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (f.csscls) {\n\t\t\t\t\t\t\t\t\ti = '<div class=\"'+f.csscls+'\">' + i + '</div>';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thashes, l, ctr;\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.draggingUiHelper && self.draggingUiHelper.stop(true, true);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.trigger('dragstart', {target : element[0], originalEvent : e}, true);\n\t\t\t\t\t\t\n\t\t\t\t\t\thashes = element.hasClass(self.res('class', 'cwdfile')) \n\t\t\t\t\t\t\t? self.selected() \n\t\t\t\t\t\t\t: [self.navId2Hash(element.attr('id'))];\n\t\t\t\t\t\t\n\t\t\t\t\t\thelper.append(icon(files[hashes[0]])).data('files', hashes).data('locked', false).data('droped', false).data('namespace', namespace).data('dropover', 0);\n\t\t\t\n\t\t\t\t\t\tif ((l = hashes.length) > 1) {\n\t\t\t\t\t\t\thelper.append(icon(files[hashes[l-1]]) + '<span class=\"elfinder-drag-num\">'+l+'</span>');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$(document).on(keyEvt, function(e){\n\t\t\t\t\t\t\tvar chk = (e.shiftKey||e.ctrlKey||e.metaKey);\n\t\t\t\t\t\t\tif (ctr !== chk) {\n\t\t\t\t\t\t\t\tctr = chk;\n\t\t\t\t\t\t\t\tif (helper.is(':visible') && helper.data('dropover') && ! helper.data('droped')) {\n\t\t\t\t\t\t\t\t\thelper.toggleClass('elfinder-drag-helper-plus', helper.data('locked')? true : ctr);\n\t\t\t\t\t\t\t\t\tself.trigger(ctr? 'unlockfiles' : 'lockfiles', {files : hashes, helper: helper});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn helper;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})();\n\n\t\t\t// in getFileCallback set - change default actions on double click/enter/ctrl+enter\n\t\t\tif (self.commands.getfile) {\n\t\t\t\tif (typeof(self.options.getFileCallback) == 'function') {\n\t\t\t\t\tself.bind('dblclick', function(e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tself.exec('getfile').fail(function() {\n\t\t\t\t\t\t\tself.exec('open', e.data && e.data.file? [ e.data.file ]: void(0));\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tself.shortcut({\n\t\t\t\t\t\tpattern     : 'enter',\n\t\t\t\t\t\tdescription : self.i18n('cmdgetfile'),\n\t\t\t\t\t\tcallback    : function() { self.exec('getfile').fail(function() { self.exec(self.OS == 'mac' ? 'rename' : 'open'); }); }\n\t\t\t\t\t})\n\t\t\t\t\t.shortcut({\n\t\t\t\t\t\tpattern     : 'ctrl+enter',\n\t\t\t\t\t\tdescription : self.i18n(self.OS == 'mac' ? 'cmdrename' : 'cmdopen'),\n\t\t\t\t\t\tcallback    : function() { self.exec(self.OS == 'mac' ? 'rename' : 'open'); }\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tself.options.getFileCallback = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// load commands\n\t\t\t$.each(self.commands, function(name, cmd) {\n\t\t\t\tvar proto = Object.assign({}, cmd.prototype),\n\t\t\t\t\textendsCmd, opts;\n\t\t\t\tif ($.isFunction(cmd) && !self._commands[name] && (cmd.prototype.forceLoad || $.inArray(name, self.options.commands) !== -1)) {\n\t\t\t\t\textendsCmd = cmd.prototype.extendsCmd || '';\n\t\t\t\t\tif (extendsCmd) {\n\t\t\t\t\t\tif ($.isFunction(self.commands[extendsCmd])) {\n\t\t\t\t\t\t\tcmd.prototype = Object.assign({}, base, new self.commands[extendsCmd](), cmd.prototype);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcmd.prototype = Object.assign({}, base, cmd.prototype);\n\t\t\t\t\t}\n\t\t\t\t\tself._commands[name] = new cmd();\n\t\t\t\t\tcmd.prototype = proto;\n\t\t\t\t\topts = self.options.commandsOptions[name] || {};\n\t\t\t\t\tif (extendsCmd && self.options.commandsOptions[extendsCmd]) {\n\t\t\t\t\t\topts = $.extend(true, {}, self.options.commandsOptions[extendsCmd], opts);\n\t\t\t\t\t}\n\t\t\t\t\tself._commands[name].setup(name, opts);\n\t\t\t\t\t// setup linked commands\n\t\t\t\t\tif (self._commands[name].linkedCmds.length) {\n\t\t\t\t\t\t$.each(self._commands[name].linkedCmds, function(i, n) {\n\t\t\t\t\t\t\tvar lcmd = self.commands[n];\n\t\t\t\t\t\t\tif ($.isFunction(lcmd) && !self._commands[n]) {\n\t\t\t\t\t\t\t\tlcmd.prototype = base;\n\t\t\t\t\t\t\t\tself._commands[n] = new lcmd();\n\t\t\t\t\t\t\t\tself._commands[n].setup(n, self.options.commandsOptions[n]||{});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t/**\n\t\t\t * UI nodes\n\t\t\t *\n\t\t\t * @type Object\n\t\t\t **/\n\t\t\tself.ui = {\n\t\t\t\t// container for nav panel and current folder container\n\t\t\t\tworkzone : $('<div/>').appendTo(node).elfinderworkzone(self),\n\t\t\t\t// contaainer for folders tree / places\n\t\t\t\tnavbar : $('<div/>').appendTo(node).elfindernavbar(self, self.options.uiOptions.navbar || {}),\n\t\t\t\t// container for for preview etc at below the navbar\n\t\t\t\tnavdock : $('<div/>').appendTo(node).elfindernavdock(self, self.options.uiOptions.navdock || {}),\n\t\t\t\t// contextmenu\n\t\t\t\tcontextmenu : $('<div/>').appendTo(node).elfindercontextmenu(self),\n\t\t\t\t// overlay\n\t\t\t\toverlay : $('<div/>').appendTo(node).elfinderoverlay({\n\t\t\t\t\tshow : function() { self.disable(); },\n\t\t\t\t\thide : function() { prevEnabled && self.enable(); }\n\t\t\t\t}),\n\t\t\t\t// current folder container\n\t\t\t\tcwd : $('<div/>').appendTo(node).elfindercwd(self, self.options.uiOptions.cwd || {}),\n\t\t\t\t// notification dialog window\n\t\t\t\tnotify : self.dialog('', {\n\t\t\t\t\tcssClass      : 'elfinder-dialog-notify' + (self.options.notifyDialog.canClose? '' : ' elfinder-titlebar-button-hide'),\n\t\t\t\t\tposition      : self.options.notifyDialog.position,\n\t\t\t\t\tabsolute      : true,\n\t\t\t\t\tresizable     : false,\n\t\t\t\t\tautoOpen      : false,\n\t\t\t\t\tallowMinimize : true,\n\t\t\t\t\tcloseOnEscape : self.options.notifyDialog.canClose? true : false,\n\t\t\t\t\ttitle         : '&nbsp;',\n\t\t\t\t\twidth         : self.options.notifyDialog.width? parseInt(self.options.notifyDialog.width) : null,\n\t\t\t\t\tminHeight     : null,\n\t\t\t\t\tminimize      : function() { self.ui.notify.trigger('minimize'); }\n\t\t\t\t}),\n\t\t\t\tstatusbar : $('<div class=\"ui-widget-header ui-helper-clearfix ui-corner-bottom elfinder-statusbar\"/>').hide().appendTo(node),\n\t\t\t\ttoast : $('<div class=\"elfinder-toast\"/>').appendTo(node),\n\t\t\t\tbottomtray : $('<div class=\"elfinder-bottomtray\">').appendTo(node),\n\t\t\t\tprogressbar : $('<div class=\"elfinder-ui-progressbar\">').appendTo(node)\n\t\t\t};\n\n\t\t\tself.trigger('uiready');\n\n\t\t\t// load required ui\n\t\t\t$.each(self.options.ui || [], function(i, ui) {\n\t\t\t\tvar name = 'elfinder'+ui,\n\t\t\t\t\topts = self.options.uiOptions[ui] || {};\n\t\t\n\t\t\t\tif (!self.ui[ui] && $.fn[name]) {\n\t\t\t\t\t// regist to self.ui before make instance\n\t\t\t\t\tself.ui[ui] = $('<'+(opts.tag || 'div')+'/>').appendTo(node);\n\t\t\t\t\tself.ui[ui][name](self, opts);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tself.ui.progressbar.appendTo(self.ui.workzone);\n\t\t\tself.ui.notify.prev('.ui-dialog-titlebar').append('<div class=\"elfinder-ui-progressbar\"></div>');\n\n\t\t\t// update size\t\n\t\t\tself.resize(width, height);\n\t\t\t\n\t\t\t// make node resizable\n\t\t\tif (self.options.resizable) {\n\t\t\t\tnode.resizable({\n\t\t\t\t\tresize    : function(e, ui) {\n\t\t\t\t\t\tself.resize(ui.size.width, ui.size.height);\n\t\t\t\t\t},\n\t\t\t\t\thandles   : 'se',\n\t\t\t\t\tminWidth  : 300,\n\t\t\t\t\tminHeight : 200\n\t\t\t\t});\n\t\t\t\tif (self.UA.Touch) {\n\t\t\t\t\tnode.addClass('touch-punch');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t(function() {\n\t\t\t\tvar navbar = self.getUI('navbar'),\n\t\t\t\t\tcwd    = self.getUI('cwd').parent();\n\t\t\t\t\n\t\t\t\tself.autoScroll = {\n\t\t\t\t\tnavbarUp   : function(v) {\n\t\t\t\t\t\tnavbar.scrollTop(Math.max(0, navbar.scrollTop() - v));\n\t\t\t\t\t},\n\t\t\t\t\tnavbarDown : function(v) {\n\t\t\t\t\t\tnavbar.scrollTop(navbar.scrollTop() + v);\n\t\t\t\t\t},\n\t\t\t\t\tcwdUp     : function(v) {\n\t\t\t\t\t\tcwd.scrollTop(Math.max(0, cwd.scrollTop() - v));\n\t\t\t\t\t},\n\t\t\t\t\tcwdDown   : function(v) {\n\t\t\t\t\t\tcwd.scrollTop(cwd.scrollTop() + v);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})();\n\n\t\t\t// Swipe on the touch devices to show/hide of toolbar or navbar\n\t\t\tif (self.UA.Touch) {\n\t\t\t\t(function() {\n\t\t\t\t\tvar lastX, lastY, nodeOffset, nodeWidth, nodeTop, navbarW, toolbarH,\n\t\t\t\t\t\tnavbar = self.getUI('navbar'),\n\t\t\t\t\t\ttoolbar = self.getUI('toolbar'),\n\t\t\t\t\t\tmoveEv = 'touchmove.stopscroll',\n\t\t\t\t\t\tmoveTm,\n\t\t\t\t\t\tmoveUpOn = function(e) {\n\t\t\t\t\t\t\tvar touches = e.originalEvent.touches || [{}],\n\t\t\t\t\t\t\t\ty = touches[0].pageY || null;\n\t\t\t\t\t\t\tif (!lastY || y < lastY) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\tmoveTm && clearTimeout(moveTm);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmoveDownOn = function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tmoveTm && clearTimeout(moveTm);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmoveOff = function() {\n\t\t\t\t\t\t\tmoveTm = setTimeout(function() {\n\t\t\t\t\t\t\t\tnode.off(moveEv);\n\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t},\n\t\t\t\t\t\thandleW, handleH = 50;\n\n\t\t\t\t\tnavbar = navbar.children().length? navbar : null;\n\t\t\t\t\ttoolbar = toolbar.length? toolbar : null;\n\t\t\t\t\tnode.on('touchstart touchmove touchend', function(e) {\n\t\t\t\t\t\tif (e.type === 'touchend') {\n\t\t\t\t\t\t\tlastX = false;\n\t\t\t\t\t\t\tlastY = false;\n\t\t\t\t\t\t\tmoveOff();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar touches = e.originalEvent.touches || [{}],\n\t\t\t\t\t\t\tx = touches[0].pageX || null,\n\t\t\t\t\t\t\ty = touches[0].pageY || null,\n\t\t\t\t\t\t\tltr = (self.direction === 'ltr'),\n\t\t\t\t\t\t\tnavbarMode, treeWidth, swipeX, moveX, toolbarT, mode;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (x === null || y === null || (e.type === 'touchstart' && touches.length > 1)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (e.type === 'touchstart') {\n\t\t\t\t\t\t\tnodeOffset = node.offset();\n\t\t\t\t\t\t\tnodeWidth = node.width();\n\t\t\t\t\t\t\tif (navbar) {\n\t\t\t\t\t\t\t\tlastX = false;\n\t\t\t\t\t\t\t\tif (navbar.is(':hidden')) {\n\t\t\t\t\t\t\t\t\tif (! handleW) {\n\t\t\t\t\t\t\t\t\t\thandleW = Math.max(50, nodeWidth / 10);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ((ltr? (x - nodeOffset.left) : (nodeWidth + nodeOffset.left - x)) < handleW) {\n\t\t\t\t\t\t\t\t\t\tlastX = x;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (! e.originalEvent._preventSwipeX) {\n\t\t\t\t\t\t\t\t\tnavbarW = navbar.width();\n\t\t\t\t\t\t\t\t\tif (ltr) {\n\t\t\t\t\t\t\t\t\t\tswipeX = (x < nodeOffset.left + navbarW);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tswipeX = (x > nodeOffset.left + nodeWidth - navbarW);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (swipeX) {\n\t\t\t\t\t\t\t\t\t\thandleW = Math.max(50, nodeWidth / 10);\n\t\t\t\t\t\t\t\t\t\tlastX = x;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlastX = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (toolbar) {\n\t\t\t\t\t\t\t\tlastY = false;\n\t\t\t\t\t\t\t\tif (! e.originalEvent._preventSwipeY) {\n\t\t\t\t\t\t\t\t\ttoolbarH = toolbar.height();\n\t\t\t\t\t\t\t\t\tnodeTop = nodeOffset.top;\n\t\t\t\t\t\t\t\t\tif (y - nodeTop < (toolbar.is(':hidden')? handleH : (toolbarH + 30))) {\n\t\t\t\t\t\t\t\t\t\tlastY = y;\n\t\t\t\t\t\t\t\t\t\tnode.on(moveEv, toolbar.is(':hidden')? moveDownOn: moveUpOn);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (navbar && lastX !== false) {\n\t\t\t\t\t\t\t\tnavbarMode = (ltr? (lastX > x) : (lastX < x))? 'navhide' : 'navshow';\n\t\t\t\t\t\t\t\tmoveX = Math.abs(lastX - x);\n\t\t\t\t\t\t\t\tif (navbarMode === 'navhide' && moveX > navbarW * 0.6\n\t\t\t\t\t\t\t\t\t|| (moveX > (navbarMode === 'navhide'? navbarW / 3 : 45)\n\t\t\t\t\t\t\t\t\t\t&& (navbarMode === 'navshow'\n\t\t\t\t\t\t\t\t\t\t\t|| (ltr? x < nodeOffset.left + 20 : x > nodeOffset.left + nodeWidth - 20)\n\t\t\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tself.getUI('navbar').trigger(navbarMode, {handleW: handleW});\n\t\t\t\t\t\t\t\t\tlastX = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (toolbar && lastY !== false ) {\n\t\t\t\t\t\t\t\ttoolbarT = toolbar.offset().top;\n\t\t\t\t\t\t\t\tif (Math.abs(lastY - y) > Math.min(45, toolbarH / 3)) {\n\t\t\t\t\t\t\t\t\tmode = (lastY > y)? 'slideUp' : 'slideDown';\n\t\t\t\t\t\t\t\t\tif (mode === 'slideDown' || toolbarT + 20 > y) {\n\t\t\t\t\t\t\t\t\t\tif (toolbar.is(mode === 'slideDown' ? ':hidden' : ':visible')) {\n\t\t\t\t\t\t\t\t\t\t\ttoolbar.stop(true, true).trigger('toggle', {duration: 100, handleH: handleH});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlastY = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})();\n\t\t\t}\n\n\t\t\tif (self.dragUpload) {\n\t\t\t\t// add event listener for HTML5 DnD upload\n\t\t\t\t(function() {\n\t\t\t\t\tvar isin = function(e) {\n\t\t\t\t\t\treturn (e.target.nodeName !== 'TEXTAREA' && e.target.nodeName !== 'INPUT' && $(e.target).closest('div.ui-dialog-content').length === 0);\n\t\t\t\t\t},\n\t\t\t\t\tent       = 'native-drag-enter',\n\t\t\t\t\tdisable   = 'native-drag-disable',\n\t\t\t\t\tc         = 'class',\n\t\t\t\t\tnavdir    = self.res(c, 'navdir'),\n\t\t\t\t\tdroppable = self.res(c, 'droppable'),\n\t\t\t\t\tdropover  = self.res(c, 'adroppable'),\n\t\t\t\t\tarrow     = self.res(c, 'navarrow'),\n\t\t\t\t\tclDropActive = self.res(c, 'adroppable'),\n\t\t\t\t\twz        = self.getUI('workzone'),\n\t\t\t\t\tltr       = (self.direction === 'ltr'),\n\t\t\t\t\tclearTm   = function() {\n\t\t\t\t\t\tautoScrTm && cancelAnimationFrame(autoScrTm);\n\t\t\t\t\t\tautoScrTm = null;\n\t\t\t\t\t},\n\t\t\t\t\twzRect, autoScrFn, autoScrTm;\n\t\t\t\t\t\n\t\t\t\t\tnode.on('dragenter', function(e) {\n\t\t\t\t\t\tclearTm();\n\t\t\t\t\t\tif (isin(e)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\twzRect = wz.data('rectangle');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('dragleave', function(e) {\n\t\t\t\t\t\tclearTm();\n\t\t\t\t\t\tif (isin(e)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('dragover', function(e) {\n\t\t\t\t\t\tvar autoUp;\n\t\t\t\t\t\tif (isin(e)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.originalEvent.dataTransfer.dropEffect = 'none';\n\t\t\t\t\t\t\tif (! autoScrTm) {\n\t\t\t\t\t\t\t\tautoScrTm = requestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t\tvar wzBottom = wzRect.top + wzRect.height,\n\t\t\t\t\t\t\t\t\t\twzBottom2 = wzBottom - self.getUI('navdock').outerHeight(true),\n\t\t\t\t\t\t\t\t\t\tfn;\n\t\t\t\t\t\t\t\t\tif ((autoUp = e.pageY < wzRect.top) || e.pageY > wzBottom2 ) {\n\t\t\t\t\t\t\t\t\t\tif (wzRect.cwdEdge > e.pageX) {\n\t\t\t\t\t\t\t\t\t\t\tfn = (ltr? 'navbar' : 'cwd') + (autoUp? 'Up' : 'Down');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfn = (ltr? 'cwd' : 'navbar') + (autoUp? 'Up' : 'Down');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (!autoUp) {\n\t\t\t\t\t\t\t\t\t\t\tif (fn.substr(0, 3) === 'cwd') {\n\t\t\t\t\t\t\t\t\t\t\t\tif (wzBottom < e.pageY) {\n\t\t\t\t\t\t\t\t\t\t\t\t\twzBottom2 = wzBottom;\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfn = '';\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfn && self.autoScroll[fn](Math.pow((autoUp? wzRect.top - e.pageY : e.pageY - wzBottom2), 1.3));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tautoScrTm = null;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclearTm();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('drop', function(e) {\n\t\t\t\t\t\tclearTm();\n\t\t\t\t\t\tif (isin(e)) {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tnode.on('dragenter', '.native-droppable', function(e){\n\t\t\t\t\t\tif (e.originalEvent.dataTransfer) {\n\t\t\t\t\t\t\tvar $elm = $(e.currentTarget),\n\t\t\t\t\t\t\t\tid   = e.currentTarget.id || null,\n\t\t\t\t\t\t\t\tcwd  = null,\n\t\t\t\t\t\t\t\telfFrom;\n\t\t\t\t\t\t\tif (!id) { // target is cwd\n\t\t\t\t\t\t\t\tcwd = self.cwd();\n\t\t\t\t\t\t\t\t$elm.data(disable, false);\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t$.each(e.originalEvent.dataTransfer.types, function(i, v){\n\t\t\t\t\t\t\t\t\t\tif (v.substr(0, 13) === 'elfinderfrom:') {\n\t\t\t\t\t\t\t\t\t\t\telfFrom = v.substr(13).toLowerCase();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!cwd || (cwd.write && (!elfFrom || elfFrom !== (window.location.href + cwd.hash).toLowerCase()))) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t$elm.data(ent, true);\n\t\t\t\t\t\t\t\t$elm.addClass(clDropActive);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$elm.data(disable, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('dragleave', '.native-droppable', function(e){\n\t\t\t\t\t\tif (e.originalEvent.dataTransfer) {\n\t\t\t\t\t\t\tvar $elm = $(e.currentTarget);\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tif ($elm.data(ent)) {\n\t\t\t\t\t\t\t\t$elm.data(ent, false);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$elm.removeClass(clDropActive);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('dragover', '.native-droppable', function(e){\n\t\t\t\t\t\tif (e.originalEvent.dataTransfer) {\n\t\t\t\t\t\t\tvar $elm = $(e.currentTarget);\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.originalEvent.dataTransfer.dropEffect = $elm.data(disable)? 'none' : 'copy';\n\t\t\t\t\t\t\t$elm.data(ent, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('drop', '.native-droppable', function(e){\n\t\t\t\t\t\tif (e.originalEvent && e.originalEvent.dataTransfer) {\n\t\t\t\t\t\t\tvar $elm = $(e.currentTarget),\n\t\t\t\t\t\t\t\tid;\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t$elm.removeClass(clDropActive);\n\t\t\t\t\t\t\tif (e.currentTarget.id) {\n\t\t\t\t\t\t\t\tid = $elm.hasClass(navdir)? self.navId2Hash(e.currentTarget.id) : self.cwdId2Hash(e.currentTarget.id);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tid = self.cwd().hash;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\te.originalEvent._target = id;\n\t\t\t\t\t\t\tself.exec('upload', {dropEvt: e.originalEvent, target: id}, void 0, id);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})();\n\t\t\t}\n\n\t\t\t// trigger event cssloaded if cssAutoLoad disabled\n\t\t\tif (self.cssloaded === false) {\n\t\t\t\tself.cssloaded = true;\n\t\t\t\tself.trigger('cssloaded');\n\t\t\t}\n\n\t\t\t// calculate elFinder node z-index\n\t\t\tself.zIndexCalc();\n\n\t\t\t// send initial request and start to pray >_<\n\t\t\tself.trigger('init')\n\t\t\t\t.request({\n\t\t\t\t\tdata        : {cmd : 'open', target : self.startDir(), init : 1, tree : 1}, \n\t\t\t\t\tpreventDone : true,\n\t\t\t\t\tnotify      : {type : 'open', cnt : 1, hideCnt : true},\n\t\t\t\t\tfreeze      : true\n\t\t\t\t})\n\t\t\t\t.fail(function() {\n\t\t\t\t\tself.trigger('fail').disable().lastDir('');\n\t\t\t\t\tlisteners = {};\n\t\t\t\t\tshortcuts = {};\n\t\t\t\t\t$(document).add(node).off('.'+namespace);\n\t\t\t\t\tself.trigger = function() { };\n\t\t\t\t})\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tvar trashDisable = function(th) {\n\t\t\t\t\t\t\tvar src = self.file(self.trashes[th]),\n\t\t\t\t\t\t\t\td = self.options.debug,\n\t\t\t\t\t\t\t\terror;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (src && src.volumeid) {\n\t\t\t\t\t\t\t\tdelete self.volOptions[src.volumeid].trashHash;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.trashes[th] = false;\n\t\t\t\t\t\t\tself.debug('backend-error', 'Trash hash \"'+th+'\" was not found or not writable.');\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttoChkTh = {};\n\t\t\t\t\t\n\t\t\t\t\t// regist rawStringDecoder\n\t\t\t\t\tif (self.options.rawStringDecoder) {\n\t\t\t\t\t\tself.registRawStringDecoder(self.options.rawStringDecoder);\n\t\t\t\t\t}\n\n\t\t\t\t\t// re-calculate elFinder node z-index\n\t\t\t\t\tself.zIndexCalc();\n\t\t\t\t\t\n\t\t\t\t\tself.load().debug('api', self.api);\n\t\t\t\t\t// update ui's size after init\n\t\t\t\t\tnode.trigger('resize');\n\t\t\t\t\t// initial open\n\t\t\t\t\topen(data);\n\t\t\t\t\tself.trigger('open', data, false);\n\t\t\t\t\tself.trigger('opendone');\n\t\t\t\t\t\n\t\t\t\t\tif (inFrame && self.options.enableAlways) {\n\t\t\t\t\t\t$(window).trigger('focus');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// check self.trashes\n\t\t\t\t\t$.each(self.trashes, function(th) {\n\t\t\t\t\t\tvar dir = self.file(th),\n\t\t\t\t\t\t\tsrc;\n\t\t\t\t\t\tif (! dir) {\n\t\t\t\t\t\t\ttoChkTh[th] = true;\n\t\t\t\t\t\t} else if (dir.mime !== 'directory' || ! dir.write) {\n\t\t\t\t\t\t\ttrashDisable(th);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (Object.keys(toChkTh).length) {\n\t\t\t\t\t\tself.request({\n\t\t\t\t\t\t\tdata : {cmd : 'info', targets : Object.keys(toChkTh)},\n\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\t\tif (data && data.files) {\n\t\t\t\t\t\t\t\t$.each(data.files, function(i, dir) {\n\t\t\t\t\t\t\t\t\tif (dir.mime === 'directory' && dir.write) {\n\t\t\t\t\t\t\t\t\t\tdelete toChkTh[dir.hash];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t$.each(toChkTh, trashDisable);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// to enable / disable\n\t\t\t\t\tself[self.options.enableAlways? 'enable' : 'disable']();\n\t\t\t\t});\n\t\t\t\n\t\t\t// self.timeEnd('load');\n\t\t\t// End of bootUp()\n\t\t};\n\t\t\n\t\t// call bootCallback function with elFinder instance, extraObject - { dfrdsBeforeBootup: dfrdsBeforeBootup }\n\t\tif (bootCallback && typeof bootCallback === 'function') {\n\t\t\tself.bootCallback = bootCallback;\n\t\t\tbootCallback.call(node.get(0), self, { dfrdsBeforeBootup: dfrdsBeforeBootup });\n\t\t}\n\t\t\n\t\t// call dfrdsBeforeBootup functions then boot up elFinder\n\t\t$.when.apply(null, dfrdsBeforeBootup).done(function() {\n\t\t\tbootUp();\n\t\t}).fail(function(error) {\n\t\t\tself.error(error);\n\t\t});\n\t};\n\n\t//register elFinder to global scope\n\tif (typeof toGlobal === 'undefined' || toGlobal) {\n\t\twindow.elFinder = elFinder;\n\t}\n\n\t/**\n\t * Prototype\n\t * \n\t * @type  Object\n\t */\n\telFinder.prototype = {\n\t\t\n\t\tuniqueid : 0,\n\t\t\n\t\tres : function(type, id) {\n\t\t\treturn this.resources[type] && this.resources[type][id];\n\t\t}, \n\n\t\t/**\n\t\t * User os. Required to bind native shortcuts for open/rename\n\t\t *\n\t\t * @type String\n\t\t **/\n\t\tOS : navigator.userAgent.indexOf('Mac') !== -1 ? 'mac' : navigator.userAgent.indexOf('Win') !== -1  ? 'win' : 'other',\n\t\t\n\t\t/**\n\t\t * User browser UA.\n\t\t * jQuery.browser: version deprecated: 1.3, removed: 1.9\n\t\t *\n\t\t * @type Object\n\t\t **/\n\t\tUA : (function(){\n\t\t\tvar self = this,\n\t\t\t\twebkit = !document.unqueID && !window.opera && !window.sidebar && 'localStorage' in window && 'WebkitAppearance' in document.documentElement.style,\n\t\t\t\tchrome = webkit && window.chrome,\n\t\t\t\t/*setRotated = function() {\n\t\t\t\t\tvar a = ((screen && screen.orientation && screen.orientation.angle) || window.orientation || 0) + 0;\n\t\t\t\t\tif (a === -90) {\n\t\t\t\t\t\ta = 270;\n\t\t\t\t\t}\n\t\t\t\t\tUA.Angle = a;\n\t\t\t\t\tUA.Rotated = a % 180 === 0? false : true;\n\t\t\t\t},*/\n\t\t\t\tUA = {\n\t\t\t\t\t// Browser IE <= IE 6\n\t\t\t\t\tltIE6   : typeof window.addEventListener == \"undefined\" && typeof document.documentElement.style.maxHeight == \"undefined\",\n\t\t\t\t\t// Browser IE <= IE 7\n\t\t\t\t\tltIE7   : typeof window.addEventListener == \"undefined\" && typeof document.querySelectorAll == \"undefined\",\n\t\t\t\t\t// Browser IE <= IE 8\n\t\t\t\t\tltIE8   : typeof window.addEventListener == \"undefined\" && typeof document.getElementsByClassName == \"undefined\",\n\t\t\t\t\t// Browser IE <= IE 9\n\t\t\t\t\tltIE9  : document.uniqueID && document.documentMode <= 9,\n\t\t\t\t\t// Browser IE <= IE 10\n\t\t\t\t\tltIE10  : document.uniqueID && document.documentMode <= 10,\n\t\t\t\t\t// Browser IE >= IE 11\n\t\t\t\t\tgtIE11  : document.uniqueID && document.documentMode >= 11,\n\t\t\t\t\tIE      : document.uniqueID,\n\t\t\t\t\tFirefox : window.sidebar,\n\t\t\t\t\tOpera   : window.opera,\n\t\t\t\t\tWebkit  : webkit,\n\t\t\t\t\tChrome  : chrome,\n\t\t\t\t\tEdge    : (chrome && window.msCredentials)? true : false,\n\t\t\t\t\tSafari  : webkit && !window.chrome,\n\t\t\t\t\tMobile  : typeof window.orientation != \"undefined\",\n\t\t\t\t\tTouch   : typeof window.ontouchstart != \"undefined\",\n\t\t\t\t\tiOS     : navigator.platform.match(/^iP(?:[ao]d|hone)/),\n\t\t\t\t\tMac     : navigator.platform.match(/^Mac/),\n\t\t\t\t\tFullscreen : (typeof (document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen || document.msExitFullscreen) !== 'undefined'),\n\t\t\t\t\tAngle   : 0,\n\t\t\t\t\tRotated : false,\n\t\t\t\t\tCSS : (function() {\n\t\t\t\t\t\tvar aStyle = document.createElement('a').style,\n\t\t\t\t\t\t\tpStyle = document.createElement('p').style,\n\t\t\t\t\t\t\tcss;\n\t\t\t\t\t\tcss = 'position:sticky;position:-webkit-sticky;';\n\t\t\t\t\t\tcss += 'width:-webkit-max-content;width:-moz-max-content;width:-ms-max-content;width:max-content;';\n\t\t\t\t\t\taStyle.cssText = css;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tpositionSticky : aStyle.position.indexOf('sticky')!==-1,\n\t\t\t\t\t\t\twidthMaxContent : aStyle.width.indexOf('max-content')!==-1,\n\t\t\t\t\t\t\tflex : typeof pStyle.flex !== 'undefined'\n\t\t\t\t\t\t};\n\t\t\t\t\t})()\n\t\t\t\t};\n\t\t\t\treturn UA;\n\t\t})(),\n\t\t\n\t\t/**\n\t\t * Is cookie enabled\n\t\t * \n\t\t * @type Boolean\n\t\t */\n\t\tcookieEnabled : (function() {\n\t\t\tvar res = false,\n\t\t\t\ttest = 'elftest=';\n\t\t\tdocument.cookie = test + '1';\n\t\t\tres = document.cookie.split(test).length === 2;\n\t\t\tdocument.cookie = test + ';max-age=0';\n\t\t\treturn res;\n\t\t})(),\n\n\t\t/**\n\t\t * Has RequireJS?\n\t\t * \n\t\t * @type Boolean\n\t\t */\n\t\thasRequire : (typeof define === 'function' && define.amd),\n\t\t\n\t\t/**\n\t\t * Current request command\n\t\t * \n\t\t * @type  String\n\t\t */\n\t\tcurrentReqCmd : '',\n\t\t\n\t\t/**\n\t\t * Current keyboard state\n\t\t * \n\t\t * @type  Object\n\t\t */\n\t\tkeyState : {},\n\t\t\n\t\t/**\n\t\t * Internationalization object\n\t\t * \n\t\t * @type  Object\n\t\t */\n\t\ti18 : {\n\t\t\ten : {\n\t\t\t\ttranslator      : '',\n\t\t\t\tlanguage        : 'English',\n\t\t\t\tdirection       : 'ltr',\n\t\t\t\tdateFormat      : 'd.m.Y H:i',\n\t\t\t\tfancyDateFormat : '$1 H:i',\n\t\t\t\tnonameDateFormat : 'ymd-His',\n\t\t\t\tmessages        : {}\n\t\t\t},\n\t\t\tmonths : ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n\t\t\tmonthsShort : ['msJan', 'msFeb', 'msMar', 'msApr', 'msMay', 'msJun', 'msJul', 'msAug', 'msSep', 'msOct', 'msNov', 'msDec'],\n\n\t\t\tdays : ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n\t\t\tdaysShort : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n\t\t},\n\t\t\n\t\t/**\n\t\t * File mimetype to kind mapping\n\t\t * \n\t\t * @type  Object\n\t\t */\n\t\tkinds : \t{\n\t\t\t\t'unknown'                       : 'Unknown',\n\t\t\t\t'directory'                     : 'Folder',\n\t\t\t\t'group'                         : 'Selects',\n\t\t\t\t'symlink'                       : 'Alias',\n\t\t\t\t'symlink-broken'                : 'AliasBroken',\n\t\t\t\t'application/x-empty'           : 'TextPlain',\n\t\t\t\t'application/postscript'        : 'Postscript',\n\t\t\t\t'application/vnd.ms-office'     : 'MsOffice',\n\t\t\t\t'application/msword'            : 'MsWord',\n\t\t\t\t'application/vnd.ms-word'       : 'MsWord',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document' : 'MsWord',\n\t\t\t\t'application/vnd.ms-word.document.macroEnabled.12'                        : 'MsWord',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.template' : 'MsWord',\n\t\t\t\t'application/vnd.ms-word.template.macroEnabled.12'                        : 'MsWord',\n\t\t\t\t'application/vnd.ms-excel'      : 'MsExcel',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'       : 'MsExcel',\n\t\t\t\t'application/vnd.ms-excel.sheet.macroEnabled.12'                          : 'MsExcel',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.template'    : 'MsExcel',\n\t\t\t\t'application/vnd.ms-excel.template.macroEnabled.12'                       : 'MsExcel',\n\t\t\t\t'application/vnd.ms-excel.sheet.binary.macroEnabled.12'                   : 'MsExcel',\n\t\t\t\t'application/vnd.ms-excel.addin.macroEnabled.12'                          : 'MsExcel',\n\t\t\t\t'application/vnd.ms-powerpoint' : 'MsPP',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.presentation' : 'MsPP',\n\t\t\t\t'application/vnd.ms-powerpoint.presentation.macroEnabled.12'              : 'MsPP',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.slideshow'  : 'MsPP',\n\t\t\t\t'application/vnd.ms-powerpoint.slideshow.macroEnabled.12'                 : 'MsPP',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.template'   : 'MsPP',\n\t\t\t\t'application/vnd.ms-powerpoint.template.macroEnabled.12'                  : 'MsPP',\n\t\t\t\t'application/vnd.ms-powerpoint.addin.macroEnabled.12'                     : 'MsPP',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.slide'      : 'MsPP',\n\t\t\t\t'application/vnd.ms-powerpoint.slide.macroEnabled.12'                     : 'MsPP',\n\t\t\t\t'application/pdf'               : 'PDF',\n\t\t\t\t'application/xml'               : 'XML',\n\t\t\t\t'application/vnd.oasis.opendocument.text' : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.text-template'         : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.text-web'              : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.text-master'           : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.graphics'              : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.graphics-template'     : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.presentation'          : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.presentation-template' : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.spreadsheet'           : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.spreadsheet-template'  : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.chart'                 : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.formula'               : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.database'              : 'OO',\n\t\t\t\t'application/vnd.oasis.opendocument.image'                 : 'OO',\n\t\t\t\t'application/vnd.openofficeorg.extension'                  : 'OO',\n\t\t\t\t'application/x-shockwave-flash' : 'AppFlash',\n\t\t\t\t'application/flash-video'       : 'Flash video',\n\t\t\t\t'application/x-bittorrent'      : 'Torrent',\n\t\t\t\t'application/javascript'        : 'JS',\n\t\t\t\t'application/rtf'               : 'RTF',\n\t\t\t\t'application/rtfd'              : 'RTF',\n\t\t\t\t'application/x-font-ttf'        : 'TTF',\n\t\t\t\t'application/x-font-otf'        : 'OTF',\n\t\t\t\t'application/x-rpm'             : 'RPM',\n\t\t\t\t'application/x-web-config'      : 'TextPlain',\n\t\t\t\t'application/xhtml+xml'         : 'HTML',\n\t\t\t\t'application/docbook+xml'       : 'DOCBOOK',\n\t\t\t\t'application/x-awk'             : 'AWK',\n\t\t\t\t'application/x-gzip'            : 'GZIP',\n\t\t\t\t'application/x-bzip2'           : 'BZIP',\n\t\t\t\t'application/x-xz'              : 'XZ',\n\t\t\t\t'application/zip'               : 'ZIP',\n\t\t\t\t'application/x-zip'               : 'ZIP',\n\t\t\t\t'application/x-rar'             : 'RAR',\n\t\t\t\t'application/x-tar'             : 'TAR',\n\t\t\t\t'application/x-7z-compressed'   : '7z',\n\t\t\t\t'application/x-jar'             : 'JAR',\n\t\t\t\t'text/plain'                    : 'TextPlain',\n\t\t\t\t'text/x-php'                    : 'PHP',\n\t\t\t\t'text/html'                     : 'HTML',\n\t\t\t\t'text/javascript'               : 'JS',\n\t\t\t\t'text/css'                      : 'CSS',\n\t\t\t\t'text/rtf'                      : 'RTF',\n\t\t\t\t'text/rtfd'                     : 'RTF',\n\t\t\t\t'text/x-c'                      : 'C',\n\t\t\t\t'text/x-csrc'                   : 'C',\n\t\t\t\t'text/x-chdr'                   : 'CHeader',\n\t\t\t\t'text/x-c++'                    : 'CPP',\n\t\t\t\t'text/x-c++src'                 : 'CPP',\n\t\t\t\t'text/x-c++hdr'                 : 'CPPHeader',\n\t\t\t\t'text/x-shellscript'            : 'Shell',\n\t\t\t\t'application/x-csh'             : 'Shell',\n\t\t\t\t'text/x-python'                 : 'Python',\n\t\t\t\t'text/x-java'                   : 'Java',\n\t\t\t\t'text/x-java-source'            : 'Java',\n\t\t\t\t'text/x-ruby'                   : 'Ruby',\n\t\t\t\t'text/x-perl'                   : 'Perl',\n\t\t\t\t'text/x-sql'                    : 'SQL',\n\t\t\t\t'text/xml'                      : 'XML',\n\t\t\t\t'text/x-comma-separated-values' : 'CSV',\n\t\t\t\t'text/x-markdown'               : 'Markdown',\n\t\t\t\t'image/x-ms-bmp'                : 'BMP',\n\t\t\t\t'image/jpeg'                    : 'JPEG',\n\t\t\t\t'image/gif'                     : 'GIF',\n\t\t\t\t'image/png'                     : 'PNG',\n\t\t\t\t'image/tiff'                    : 'TIFF',\n\t\t\t\t'image/x-targa'                 : 'TGA',\n\t\t\t\t'image/vnd.adobe.photoshop'     : 'PSD',\n\t\t\t\t'image/xbm'                     : 'XBITMAP',\n\t\t\t\t'image/pxm'                     : 'PXM',\n\t\t\t\t'audio/mpeg'                    : 'AudioMPEG',\n\t\t\t\t'audio/midi'                    : 'AudioMIDI',\n\t\t\t\t'audio/ogg'                     : 'AudioOGG',\n\t\t\t\t'audio/mp4'                     : 'AudioMPEG4',\n\t\t\t\t'audio/x-m4a'                   : 'AudioMPEG4',\n\t\t\t\t'audio/wav'                     : 'AudioWAV',\n\t\t\t\t'audio/x-mp3-playlist'          : 'AudioPlaylist',\n\t\t\t\t'video/x-dv'                    : 'VideoDV',\n\t\t\t\t'video/mp4'                     : 'VideoMPEG4',\n\t\t\t\t'video/mpeg'                    : 'VideoMPEG',\n\t\t\t\t'video/x-msvideo'               : 'VideoAVI',\n\t\t\t\t'video/quicktime'               : 'VideoMOV',\n\t\t\t\t'video/x-ms-wmv'                : 'VideoWM',\n\t\t\t\t'video/x-flv'                   : 'VideoFlash',\n\t\t\t\t'video/x-matroska'              : 'VideoMKV',\n\t\t\t\t'video/ogg'                     : 'VideoOGG'\n\t\t\t},\n\t\t\n\t\t/**\n\t\t * File mimetype to file extention mapping\n\t\t * \n\t\t * @type  Object\n\t\t * @see   elFinder.mimetypes.js\n\t\t */\n\t\tmimeTypes : {},\n\t\t\n\t\t/**\n\t\t * Ajax request data validation rules\n\t\t * \n\t\t * @type  Object\n\t\t */\n\t\trules : {\n\t\t\tdefaults : function(data) {\n\t\t\t\tif (!data\n\t\t\t\t|| (data.added && !Array.isArray(data.added))\n\t\t\t\t||  (data.removed && !Array.isArray(data.removed))\n\t\t\t\t||  (data.changed && !Array.isArray(data.changed))) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\topen    : function(data) { return data && data.cwd && data.files && $.isPlainObject(data.cwd) && Array.isArray(data.files); },\n\t\t\ttree    : function(data) { return data && data.tree && Array.isArray(data.tree); },\n\t\t\tparents : function(data) { return data && data.tree && Array.isArray(data.tree); },\n\t\t\ttmb     : function(data) { return data && data.images && ($.isPlainObject(data.images) || Array.isArray(data.images)); },\n\t\t\tupload  : function(data) { return data && ($.isPlainObject(data.added) || Array.isArray(data.added));},\n\t\t\tsearch  : function(data) { return data && data.files && Array.isArray(data.files); }\n\t\t},\n\t\t\n\t\t/**\n\t\t * Commands costructors\n\t\t *\n\t\t * @type Object\n\t\t */\n\t\tcommands : {},\n\t\t\n\t\t/**\n\t\t * Commands to add the item (space delimited)\n\t\t * \n\t\t * @type String\n\t\t */\n\t\tcmdsToAdd : 'archive duplicate extract mkdir mkfile paste rm upload',\n\t\t\n\t\tparseUploadData : function(text) {\n\t\t\tvar self = this,\n\t\t\t\tdata;\n\t\t\t\n\t\t\tif (!$.trim(text)) {\n\t\t\t\treturn {error : ['errResponse', 'errDataEmpty']};\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tdata = JSON.parse(text);\n\t\t\t} catch (e) {\n\t\t\t\treturn {error : ['errResponse', 'errDataNotJSON']};\n\t\t\t}\n\t\t\t\n\t\t\tdata = self.normalize(data);\n\t\t\tif (!self.validResponse('upload', data)) {\n\t\t\t\treturn {error : (data.norError || ['errResponse'])};\n\t\t\t}\n\t\t\tdata.removed = $.merge((data.removed || []), $.map(data.added || [], function(f) { return self.file(f.hash)? f.hash : null; }));\n\t\t\treturn data;\n\t\t\t\n\t\t},\n\t\t\n\t\tiframeCnt : 0,\n\t\t\n\t\tuploads : {\n\t\t\t// xhr muiti uploading flag\n\t\t\txhrUploading: false,\n\t\t\t\n\t\t\t// Timer of request fail to sync\n\t\t\tfailSyncTm: null,\n\t\t\t\n\t\t\t// current chunkfail requesting chunk\n\t\t\tchunkfailReq: {},\n\t\t\t\n\t\t\t// check file/dir exists\n\t\t\tcheckExists: function(files, target, fm, isDir) {\n\t\t\t\tvar dfrd = $.Deferred(),\n\t\t\t\t\tnames, renames = [], hashes = {}, chkFiles = [],\n\t\t\t\t\tcancel = function() {\n\t\t\t\t\t\tvar i = files.length;\n\t\t\t\t\t\twhile (--i > -1) {\n\t\t\t\t\t\t\tfiles[i]._remove = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tresolve = function() {\n\t\t\t\t\t\tdfrd.resolve(renames, hashes);\n\t\t\t\t\t},\n\t\t\t\t\tcheck = function() {\n\t\t\t\t\t\tvar existed = [], exists = [], i, c,\n\t\t\t\t\t\t\tpathStr = target !== fm.cwd().hash? fm.path(target, true) + fm.option('separator', target) : '',\n\t\t\t\t\t\t\tconfirm = function(ndx) {\n\t\t\t\t\t\t\t\tvar last = ndx == exists.length-1,\n\t\t\t\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\t\t\t\tcssClass : 'elfinder-confirm-upload',\n\t\t\t\t\t\t\t\t\t\ttitle  : fm.i18n('cmdupload'),\n\t\t\t\t\t\t\t\t\t\ttext   : ['errExists', pathStr + exists[ndx].name, 'confirmRepl'], \n\t\t\t\t\t\t\t\t\t\tall    : !last,\n\t\t\t\t\t\t\t\t\t\taccept : {\n\t\t\t\t\t\t\t\t\t\t\tlabel    : 'btnYes',\n\t\t\t\t\t\t\t\t\t\t\tcallback : function(all) {\n\t\t\t\t\t\t\t\t\t\t\t\t!last && !all\n\t\t\t\t\t\t\t\t\t\t\t\t\t? confirm(++ndx)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: resolve();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\treject : {\n\t\t\t\t\t\t\t\t\t\t\tlabel    : 'btnNo',\n\t\t\t\t\t\t\t\t\t\t\tcallback : function(all) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar i;\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tif (all) {\n\t\t\t\t\t\t\t\t\t\t\t\t\ti = exists.length;\n\t\t\t\t\t\t\t\t\t\t\t\t\twhile (ndx < i--) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles[exists[i].i]._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfiles[exists[ndx].i]._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t!last && !all\n\t\t\t\t\t\t\t\t\t\t\t\t\t? confirm(++ndx)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: resolve();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tcancel : {\n\t\t\t\t\t\t\t\t\t\t\tlabel    : 'btnCancel',\n\t\t\t\t\t\t\t\t\t\t\tcallback : function() {\n\t\t\t\t\t\t\t\t\t\t\t\tcancel();\n\t\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tbuttons : [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlabel : 'btnBackup',\n\t\t\t\t\t\t\t\t\t\t\t\tcssClass : 'elfinder-confirm-btn-backup',\n\t\t\t\t\t\t\t\t\t\t\t\tcallback : function(all) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar i;\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (all) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ti = exists.length;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twhile (ndx < i--) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trenames.push(exists[i].name);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trenames.push(exists[ndx].name);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t!last && !all\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? confirm(++ndx)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: resolve();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (!isDir) {\n\t\t\t\t\t\t\t\t\topts.buttons.push({\n\t\t\t\t\t\t\t\t\t\tlabel : 'btnRename' + (last? '' : 'All'),\n\t\t\t\t\t\t\t\t\t\tcssClass : 'elfinder-confirm-btn-rename',\n\t\t\t\t\t\t\t\t\t\tcallback : function() {\n\t\t\t\t\t\t\t\t\t\t\trenames = null;\n\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (fm.iframeCnt > 0) {\n\t\t\t\t\t\t\t\t\tdelete opts.reject;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfm.confirm(opts);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (! fm.file(target).read) {\n\t\t\t\t\t\t\t// for dropbox type\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tnames = $.map(files, function(file, i) { return file.name && (!fm.UA.iOS || file.name !== 'image.jpg')? {i: i, name: file.name} : null ;});\n\t\t\t\t\t\t\n\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\tdata : {cmd : 'ls', target : target, intersect : $.map(names, function(item) { return item.name;})},\n\t\t\t\t\t\t\tnotify : {type : 'preupload', cnt : 1, hideCnt : true},\n\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\tvar existedArr, cwdItems;\n\t\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\t\tif (data.error) {\n\t\t\t\t\t\t\t\t\tcancel();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (fm.options.overwriteUploadConfirm && fm.option('uploadOverwrite', target)) {\n\t\t\t\t\t\t\t\t\t\tif (data.list) {\n\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(data.list)) {\n\t\t\t\t\t\t\t\t\t\t\t\texisted = data.list || [];\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\texistedArr = [];\n\t\t\t\t\t\t\t\t\t\t\t\texisted = $.map(data.list, function(n) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (typeof n === 'string') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn n;\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// support to >=2.1.11 plugin Normalizer, Sanitizer\n\t\t\t\t\t\t\t\t\t\t\t\t\t\texistedArr = existedArr.concat(n);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tif (existedArr.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\texisted = existed.concat(existedArr);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\thashes = data.list;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\texists = $.grep(names, function(name){\n\t\t\t\t\t\t\t\t\t\t\t\treturn $.inArray(name.name, existed) !== -1 ? true : false ;\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (exists.length && existed.length && target == fm.cwd().hash) {\n\t\t\t\t\t\t\t\t\t\t\t\tcwdItems = $.map(fm.files(target), function(file) { return file.name; } );\n\t\t\t\t\t\t\t\t\t\t\t\tif ($.grep(existed, function(n) { \n\t\t\t\t\t\t\t\t\t\t\t\t\treturn $.inArray(n, cwdItems) === -1? true : false;\n\t\t\t\t\t\t\t\t\t\t\t\t}).length){\n\t\t\t\t\t\t\t\t\t\t\t\t\tfm.sync();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (exists.length > 0) {\n\t\t\t\t\t\t\t\tconfirm(0);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\tcancel();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\terror && fm.error(error);\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\tif (fm.api >= 2.1 && typeof files[0] == 'object') {\n\t\t\t\t\tcheck();\n\t\t\t\t} else {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\t\n\t\t\t// check droped contents\n\t\t\tcheckFile : function(data, fm, target) {\n\t\t\t\tif (!!data.checked || data.type == 'files') {\n\t\t\t\t\treturn data.files;\n\t\t\t\t} else if (data.type == 'data') {\n\t\t\t\t\tvar dfrd = $.Deferred(),\n\t\t\t\t\tscanDfd = $.Deferred(),\n\t\t\t\t\tfiles = [],\n\t\t\t\t\tpaths = [],\n\t\t\t\t\tdirctorys = [],\n\t\t\t\t\tprocessing = 0,\n\t\t\t\t\titems,\n\t\t\t\t\tmkdirs = [],\n\t\t\t\t\tcancel = false,\n\t\t\t\t\ttoArray = function(list) {\n\t\t\t\t\t\treturn Array.prototype.slice.call(list || [], 0);\n\t\t\t\t\t},\n\t\t\t\t\tdoScan = function(items) {\n\t\t\t\t\t\tvar entry, readEntries,\n\t\t\t\t\t\t\texcludes = fm.options.folderUploadExclude[fm.OS] || null,\n\t\t\t\t\t\t\tlength = items.length,\n\t\t\t\t\t\t\tcheck = function() {\n\t\t\t\t\t\t\t\tif (--processing < 1 && scanDfd.state() === 'pending') {\n\t\t\t\t\t\t\t\t\tscanDfd.resolve();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpushItem = function(file) {\n\t\t\t\t\t\t\t\tif (! excludes || ! file.name.match(excludes)) {\n\t\t\t\t\t\t\t\t\tpaths.push(entry.fullPath || '');\n\t\t\t\t\t\t\t\t\tfiles.push(file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcheck();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\treadEntries = function(dirReader) {\n\t\t\t\t\t\t\t\tvar entries = [],\n\t\t\t\t\t\t\t\t\tread = function() {\n\t\t\t\t\t\t\t\t\t\tdirReader.readEntries(function(results) {\n\t\t\t\t\t\t\t\t\t\t\tif (cancel || !results.length) {\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < entries.length; i++) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (cancel) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tscanDfd.reject();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tdoScan([entries[i]]);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcheck();\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tentries = entries.concat(toArray(results));\n\t\t\t\t\t\t\t\t\t\t\t\tread();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}, check);\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tread();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\tprocessing++;\n\t\t\t\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\t\t\t\tif (cancel) {\n\t\t\t\t\t\t\t\tscanDfd.reject();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tentry = items[i];\n\t\t\t\t\t\t\tif (entry) {\n\t\t\t\t\t\t\t\tif (entry.isFile) {\n\t\t\t\t\t\t\t\t\tprocessing++;\n\t\t\t\t\t\t\t\t\tentry.file(pushItem, check);\n\t\t\t\t\t\t\t\t} else if (entry.isDirectory) {\n\t\t\t\t\t\t\t\t\tif (fm.api >= 2.1) {\n\t\t\t\t\t\t\t\t\t\tprocessing++;\n\t\t\t\t\t\t\t\t\t\tmkdirs.push(entry.fullPath);\n\t\t\t\t\t\t\t\t\t\treadEntries(entry.createReader()); // Start reading dirs.\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcheck();\n\t\t\t\t\t\treturn scanDfd;\n\t\t\t\t\t}, hasDirs;\n\t\t\t\t\t\n\t\t\t\t\titems = $.map(data.files.items, function(item){\n\t\t\t\t\t\treturn item.getAsEntry? item.getAsEntry() : item.webkitGetAsEntry();\n\t\t\t\t\t});\n\t\t\t\t\t$.each(items, function(i, item) {\n\t\t\t\t\t\tif (item.isDirectory) {\n\t\t\t\t\t\t\thasDirs = true;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (items.length > 0) {\n\t\t\t\t\t\tfm.uploads.checkExists(items, target, fm, hasDirs).done(function(renames, hashes){\n\t\t\t\t\t\t\tvar dfds = [];\n\t\t\t\t\t\t\tif (fm.options.overwriteUploadConfirm && fm.option('uploadOverwrite', target)) {\n\t\t\t\t\t\t\t\tif (renames === null) {\n\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t\trenames = [];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\titems = $.grep(items, function(item){\n\t\t\t\t\t\t\t\t\tvar i, bak, hash, dfd, hi;\n\t\t\t\t\t\t\t\t\tif (item.isDirectory && renames.length) {\n\t\t\t\t\t\t\t\t\t\ti = $.inArray(item.name, renames);\n\t\t\t\t\t\t\t\t\t\tif (i !== -1) {\n\t\t\t\t\t\t\t\t\t\t\trenames.splice(i, 1);\n\t\t\t\t\t\t\t\t\t\t\tbak = fm.uniqueName(item.name + fm.options.backupSuffix , null, '');\n\t\t\t\t\t\t\t\t\t\t\t$.each(hashes, function(h, name) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (item.name == name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\thash = h;\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (! hash) {\n\t\t\t\t\t\t\t\t\t\t\t\thash = fm.fileByName(item.name, target).hash;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfm.lockfiles({files : [hash]});\n\t\t\t\t\t\t\t\t\t\t\tdfd = fm.request({\n\t\t\t\t\t\t\t\t\t\t\t\tdata   : {cmd : 'rename', target : hash, name : bak},\n\t\t\t\t\t\t\t\t\t\t\t\tnotify : {type : 'rename', cnt : 1}\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t\t\t\t\t\titem._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\tfm.sync();\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\t\t\t\t\t\tfm.unlockfiles({files : [hash]});\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tdfds.push(dfd);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn !item._remove? true : false;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$.when.apply($, dfds).done(function(){\n\t\t\t\t\t\t\t\tvar notifyto, msg,\n\t\t\t\t\t\t\t\t\tid = +new Date();\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (items.length > 0) {\n\t\t\t\t\t\t\t\t\tmsg = fm.escape(items[0].name);\n\t\t\t\t\t\t\t\t\tif (items.length > 1) {\n\t\t\t\t\t\t\t\t\t\tmsg += ' ... ' + items.length + fm.i18n('items');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnotifyto = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tfm.notify({\n\t\t\t\t\t\t\t\t\t\t\ttype : 'readdir',\n\t\t\t\t\t\t\t\t\t\t\tid : id,\n\t\t\t\t\t\t\t\t\t\t\tcnt : 1,\n\t\t\t\t\t\t\t\t\t\t\thideCnt: true,\n\t\t\t\t\t\t\t\t\t\t\tmsg : fm.i18n('ntfreaddir') + ' (' + msg + ')',\n\t\t\t\t\t\t\t\t\t\t\tcancel: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tcancel = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}, fm.options.notifyDelay);\n\t\t\t\t\t\t\t\t\tdoScan(items).done(function() {\n\t\t\t\t\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\t\t\t\t\tfm.notify({type : 'readdir', id: id, cnt : -1});\n\t\t\t\t\t\t\t\t\t\tif (cancel) {\n\t\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdfrd.resolve([files, paths, renames, hashes, mkdirs]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn dfrd.promise();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn dfrd.reject();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar ret = [];\n\t\t\t\t\tvar check = [];\n\t\t\t\t\tvar str = data.files[0];\n\t\t\t\t\tif (data.type == 'html') {\n\t\t\t\t\t\tvar tmp = $(\"<html/>\").append($.parseHTML(str.replace(/ src=/ig, ' _elfsrc='))),\n\t\t\t\t\t\t\tatag;\n\t\t\t\t\t\t$('img[_elfsrc]', tmp).each(function(){\n\t\t\t\t\t\t\tvar url, purl,\n\t\t\t\t\t\t\tself = $(this),\n\t\t\t\t\t\t\tpa = self.closest('a');\n\t\t\t\t\t\t\tif (pa && pa.attr('href') && pa.attr('href').match(/\\.(?:jpe?g|gif|bmp|png)/i)) {\n\t\t\t\t\t\t\t\tpurl = pa.attr('href');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\turl = self.attr('_elfsrc');\n\t\t\t\t\t\t\tif (url) {\n\t\t\t\t\t\t\t\tif (purl) {\n\t\t\t\t\t\t\t\t\t$.inArray(purl, ret) == -1 && ret.push(purl);\n\t\t\t\t\t\t\t\t\t$.inArray(url, check) == -1 &&  check.push(url);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$.inArray(url, ret) == -1 && ret.push(url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Probably it's clipboard data\n\t\t\t\t\t\t\tif (ret.length === 1 && ret[0].match(/^data:image\\/png/)) {\n\t\t\t\t\t\t\t\tdata.clipdata = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tatag = $('a[href]', tmp);\n\t\t\t\t\t\tatag.each(function(){\n\t\t\t\t\t\t\tvar text, loc,\n\t\t\t\t\t\t\t\tparseUrl = function(url) {\n\t\t\t\t\t\t\t\t\tvar a = document.createElement('a');\n\t\t\t\t\t\t\t\t\ta.href = url;\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (text = $(this).text()) {\n\t\t\t\t\t\t\t\tloc = parseUrl($(this).attr('href'));\n\t\t\t\t\t\t\t\tif (loc.href && loc.href.match(/^(?:ht|f)tp/i) && (atag.length === 1 || ! loc.pathname.match(/(?:\\.html?|\\/[^\\/.]*)$/i) || $.trim(text).match(/\\.[a-z0-9-]{1,10}$/i))) {\n\t\t\t\t\t\t\t\t\tif ($.inArray(loc.href, ret) == -1 && $.inArray(loc.href, check) == -1) ret.push(loc.href);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar regex, m, url;\n\t\t\t\t\t\tregex = /((?:ht|f)tps?:\\/\\/[-_.!~*\\'()a-z0-9;/?:\\@&=+\\$,%#\\*\\[\\]]+)/ig;\n\t\t\t\t\t\twhile (m = regex.exec(str)) {\n\t\t\t\t\t\t\turl = m[1].replace(/&amp;/g, '&');\n\t\t\t\t\t\t\tif ($.inArray(url, ret) == -1) ret.push(url);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// upload transport using XMLHttpRequest\n\t\t\txhr : function(data, fm) { \n\t\t\t\tvar self   = fm ? fm : this,\n\t\t\t\t\tnode        = self.getUI(),\n\t\t\t\t\txhr         = new XMLHttpRequest(),\n\t\t\t\t\tnotifyto    = null,\n\t\t\t\t\tnotifyto1   = null,\n\t\t\t\t\tnotifyto2   = null,\n\t\t\t\t\tdataChecked = data.checked,\n\t\t\t\t\tisDataType  = (data.isDataType || data.type == 'data'),\n\t\t\t\t\ttarget      = (data.target || self.cwd().hash),\n\t\t\t\t\tdropEvt     = (data.dropEvt || null),\n\t\t\t\t\textraData   = data.extraData || null,\n\t\t\t\t\tchunkEnable = (self.option('uploadMaxConn', target) != -1),\n\t\t\t\t\tmultiMax    = Math.min(5, Math.max(1, self.option('uploadMaxConn', target))),\n\t\t\t\t\tretryWait   = 10000, // 10 sec\n\t\t\t\t\tretryMax    = 30, // 10 sec * 30 = 300 secs (Max 5 mins)\n\t\t\t\t\tretry       = 0,\n\t\t\t\t\tgetFile     = function(files) {\n\t\t\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\t\t\tfile;\n\t\t\t\t\t\tif (files.promise) {\n\t\t\t\t\t\t\tfiles.always(function(f) {\n\t\t\t\t\t\t\t\tdfd.resolve(Array.isArray(f) && f.length? (isDataType? f[0][0] : f[0]) : {});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfd.resolve(files.length? (isDataType? files[0][0] : files[0]) : {});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn dfd;\n\t\t\t\t\t},\n\t\t\t\t\tdfrd   = $.Deferred()\n\t\t\t\t\t\t.fail(function(err) {\n\t\t\t\t\t\t\tvar error = self.parseError(err),\n\t\t\t\t\t\t\t\tuserAbort;\n\t\t\t\t\t\t\tif (error === 'userabort') {\n\t\t\t\t\t\t\t\tuserAbort = true;\n\t\t\t\t\t\t\t\terror = void 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (files && (self.uploads.xhrUploading || userAbort)) {\n\t\t\t\t\t\t\t\t// send request om fail\n\t\t\t\t\t\t\t\tgetFile(files).done(function(file) {\n\t\t\t\t\t\t\t\t\tif (!userAbort) {\n\t\t\t\t\t\t\t\t\t\ttriggerError(error, file);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (! file._cid) {\n\t\t\t\t\t\t\t\t\t\t// send sync request\n\t\t\t\t\t\t\t\t\t\tself.uploads.failSyncTm && clearTimeout(self.uploads.failSyncTm);\n\t\t\t\t\t\t\t\t\t\tself.uploads.failSyncTm = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\tself.sync(target);\n\t\t\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t\t\t} else if (! self.uploads.chunkfailReq[file._cid]) {\n\t\t\t\t\t\t\t\t\t\t// send chunkfail request\n\t\t\t\t\t\t\t\t\t\tself.uploads.chunkfailReq[file._cid] = true;\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\t\t\t\tdata : {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcmd: 'upload',\n\t\t\t\t\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\t\t\t\t\tchunk: file._chunk,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcid: file._cid,\n\t\t\t\t\t\t\t\t\t\t\t\t\tupload: ['chunkfail'],\n\t\t\t\t\t\t\t\t\t\t\t\t\tmimes: 'chunkfail'\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\toptions : {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: self.uploadURL\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tpreventDefault: true\n\t\t\t\t\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\t\t\t\t\tdelete self.uploads.chunkfailReq[file._chunk];\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttriggerError(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t!userAbort && self.sync();\n\t\t\t\t\t\t\tself.uploads.xhrUploading = false;\n\t\t\t\t\t\t\tfiles = null;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\tself.uploads.xhrUploading = false;\n\t\t\t\t\t\t\tfiles = null;\n\t\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\t\tself.currentReqCmd = 'upload';\n\t\t\t\t\t\t\t\tdata.warning && triggerError(data.warning);\n\t\t\t\t\t\t\t\tself.updateCache(data);\n\t\t\t\t\t\t\t\tdata.removed && data.removed.length && self.remove(data);\n\t\t\t\t\t\t\t\tdata.added   && data.added.length   && self.add(data);\n\t\t\t\t\t\t\t\tdata.changed && data.changed.length && self.change(data);\n\t\t\t\t\t\t\t\tself.trigger('upload', data, false);\n\t\t\t\t\t\t\t\tself.trigger('uploaddone');\n\t\t\t\t\t\t\t\tif (data.toasts && Array.isArray(data.toasts)) {\n\t\t\t\t\t\t\t\t\t$.each(data.toasts, function() {\n\t\t\t\t\t\t\t\t\t\tthis.msg && self.toast(this);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata.sync && self.sync();\n\t\t\t\t\t\t\t\tif (data.debug) {\n\t\t\t\t\t\t\t\t\tself.responseDebug(data);\n\t\t\t\t\t\t\t\t\tfm.debug('backend-debug', data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\tself.abortXHR(xhr);\n\t\t\t\t\t\t\t// unregist fnAbort function\n\t\t\t\t\t\t\tnode.off('uploadabort', fnAbort);\n\t\t\t\t\t\t\t$(window).off('unload', fnAbort);\n\t\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\t\tnotifyto1 && clearTimeout(notifyto1);\n\t\t\t\t\t\t\tnotifyto2 && clearTimeout(notifyto2);\n\t\t\t\t\t\t\tdataChecked && !data.multiupload && checkNotify() && self.notify({type : 'upload', cnt : -cnt, progress : 0, size : 0});\n\t\t\t\t\t\t\tnotifyto1 && uploadedNtf && self.notify({type : 'chunkmerge', cnt : -cnt});\n\t\t\t\t\t\t\tchunkMerge && notifyElm.children('.elfinder-notify-chunkmerge').length && self.notify({type : 'chunkmerge', cnt : -1});\n\t\t\t\t\t\t}),\n\t\t\t\t\tformData    = new FormData(),\n\t\t\t\t\tfiles       = data.input ? data.input.files : self.uploads.checkFile(data, self, target), \n\t\t\t\t\tcnt         = data.checked? (isDataType? files[0].length : files.length) : files.length,\n\t\t\t\t\tisChunked   = false,\n\t\t\t\t\tloaded      = 0,\n\t\t\t\t\tprev        = 0,\n\t\t\t\t\tfilesize    = 0,\n\t\t\t\t\tnotify      = false,\n\t\t\t\t\tnotifyElm   = self.ui.notify,\n\t\t\t\t\tcancelBtn   = true,\n\t\t\t\t\tuploadedNtf = false,\n\t\t\t\t\tabort       = false,\n\t\t\t\t\tcheckNotify = function() {\n\t\t\t\t\t\tif (!notify && (ntfUpload = notifyElm.children('.elfinder-notify-upload')).length) {\n\t\t\t\t\t\t\tnotify = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn notify;\n\t\t\t\t\t},\n\t\t\t\t\tfnAbort     = function(e, error) {\n\t\t\t\t\t\tabort = true;\n\t\t\t\t\t\tself.abortXHR(xhr, { quiet: true, abort: true });\n\t\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\t\tif (checkNotify()) {\n\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : ntfUpload.data('cnt') * -1, progress : 0, size : 0});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcancelToggle = function(show, hasChunk) {\n\t\t\t\t\t\tntfUpload.children('.elfinder-notify-cancel')[show? 'show':'hide']();\n\t\t\t\t\t\tcancelBtn = show;\n\t\t\t\t\t},\n\t\t\t\t\tstartNotify = function(size) {\n\t\t\t\t\t\tif (!size) size = filesize;\n\t\t\t\t\t\treturn setTimeout(function() {\n\t\t\t\t\t\t\tnotify = true;\n\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : cnt, progress : loaded - prev, size : size,\n\t\t\t\t\t\t\t\tcancel: function() {\n\t\t\t\t\t\t\t\t\tnode.trigger('uploadabort', 'userabort');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tntfUpload = notifyElm.children('.elfinder-notify-upload');\n\t\t\t\t\t\t\tprev = loaded;\n\t\t\t\t\t\t\tif (data.multiupload) {\n\t\t\t\t\t\t\t\tcancelBtn && cancelToggle(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcancelToggle(cancelBtn && loaded < size);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, self.options.notifyDelay);\n\t\t\t\t\t},\n\t\t\t\t\tdoRetry = function() {\n\t\t\t\t\t\tif (retry++ <= retryMax) {\n\t\t\t\t\t\t\tif (checkNotify() && prev) {\n\t\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : 0, progress : 0, size : prev});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.abortXHR(xhr, { quiet: true });\n\t\t\t\t\t\t\tprev = loaded = 0;\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tvar reqId;\n\t\t\t\t\t\t\t\tif (! abort) {\n\t\t\t\t\t\t\t\t\txhr.open('POST', self.uploadURL, true);\n\t\t\t\t\t\t\t\t\tif (self.api >= 2.1029) {\n\t\t\t\t\t\t\t\t\t\treqId = (+ new Date()).toString(16) + Math.floor(1000 * Math.random()).toString(16);\n\t\t\t\t\t\t\t\t\t\t(typeof formData['delete'] === 'function') && formData['delete']('reqid');\n\t\t\t\t\t\t\t\t\t\tformData.append('reqid', reqId);\n\t\t\t\t\t\t\t\t\t\txhr._requestId = reqId;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\txhr.send(formData);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, retryWait);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.trigger('uploadabort', ['errAbort', 'errTimeout']);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tprogress = function() {\n\t\t\t\t\t\tvar node;\n\t\t\t\t\t\tif (notify) {\n\t\t\t\t\t\t\tdfrd.notifyWith(ntfUpload, [{\n\t\t\t\t\t\t\t\tcnt: ntfUpload.data('cnt'),\n\t\t\t\t\t\t\t\tprogress: ntfUpload.data('progress'),\n\t\t\t\t\t\t\t\ttotal: ntfUpload.data('total')\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttriggerError = function(err, file, unite) {\n\t\t\t\t\t\terr && self.trigger('xhruploadfail', { error: err, file: file });\n\t\t\t\t\t\tif (unite) {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tif (errCnt < self.options.maxErrorDialogs) {\n\t\t\t\t\t\t\t\t\tif (Array.isArray(err)) {\n\t\t\t\t\t\t\t\t\t\terrors = errors.concat(err);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\terrors.push(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrCnt++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tself.error(err);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (errors.length) {\n\t\t\t\t\t\t\t\t\tif (errCnt >= self.options.maxErrorDialogs) {\n\t\t\t\t\t\t\t\t\t\terrors = errors.concat('moreErrors', errCnt - self.options.maxErrorDialogs);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tself.error(errors);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\terrors = [];\n\t\t\t\t\t\t\t\terrCnt = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terrors = [],\n\t\t\t\t\terrCnt = 0,\n\t\t\t\t\trenames = (data.renames || null),\n\t\t\t\t\thashes = (data.hashes || null),\n\t\t\t\t\tchunkMerge = false,\n\t\t\t\t\tntfUpload = $();\n\t\t\t\t\n\t\t\t\t// regist fnAbort function\n\t\t\t\tnode.one('uploadabort', fnAbort);\n\t\t\t\t$(window).one('unload.' + fm.namespace, fnAbort);\n\t\t\t\t\n\t\t\t\t!chunkMerge && (prev = loaded);\n\t\t\t\t\n\t\t\t\tif (!isDataType && !cnt) {\n\t\t\t\t\treturn dfrd.reject(['errUploadNoFiles']);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\txhr.addEventListener('error', function() {\n\t\t\t\t\tif (xhr.status == 0) {\n\t\t\t\t\t\tif (abort) {\n\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// ff bug while send zero sized file\n\t\t\t\t\t\t\t// for safari - send directory\n\t\t\t\t\t\t\tif (!isDataType && data.files && $.grep(data.files, function(f){return ! f.type && f.size === (self.UA.Safari? 1802 : 0)? true : false;}).length) {\n\t\t\t\t\t\t\t\tdfrd.reject(['errAbort', 'errFolderUpload']);\n\t\t\t\t\t\t\t} else if (data.input && $.grep(data.input.files, function(f){return ! f.type && f.size === (self.UA.Safari? 1802 : 0)? true : false;}).length) {\n\t\t\t\t\t\t\t\tdfrd.reject(['errUploadNoFiles']);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdoRetry();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.trigger('uploadabort', 'errConnect');\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\t\n\t\t\t\txhr.addEventListener('load', function(e) {\n\t\t\t\t\tvar status = xhr.status, res, curr = 0, error = '', errData, errObj;\n\t\t\t\t\t\n\t\t\t\t\tself.setCustomHeaderByXhr(xhr);\n\n\t\t\t\t\tif (status >= 400) {\n\t\t\t\t\t\tif (status > 500) {\n\t\t\t\t\t\t\terror = 'errResponse';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terror = ['errResponse', 'errServerError'];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!xhr.responseText) {\n\t\t\t\t\t\t\terror = ['errResponse', 'errDataEmpty'];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tnode.trigger('uploadabort');\n\t\t\t\t\t\tgetFile(files || {}).done(function(file) {\n\t\t\t\t\t\t\treturn dfrd.reject(file._cid? null : error);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tloaded = filesize;\n\t\t\t\t\t\n\t\t\t\t\tif (checkNotify() && (curr = loaded - prev)) {\n\t\t\t\t\t\tself.notify({type : 'upload', cnt : 0, progress : curr, size : 0});\n\t\t\t\t\t\tprogress();\n\t\t\t\t\t}\n\n\t\t\t\t\tres = self.parseUploadData(xhr.responseText);\n\t\t\t\t\t\n\t\t\t\t\t// chunked upload commit\n\t\t\t\t\tif (res._chunkmerged) {\n\t\t\t\t\t\tformData = new FormData();\n\t\t\t\t\t\tvar _file = [{_chunkmerged: res._chunkmerged, _name: res._name, _mtime: res._mtime}];\n\t\t\t\t\t\tchunkMerge = true;\n\t\t\t\t\t\tnode.off('uploadabort', fnAbort);\n\t\t\t\t\t\tnotifyto2 = setTimeout(function() {\n\t\t\t\t\t\t\tself.notify({type : 'chunkmerge', cnt : 1});\n\t\t\t\t\t\t}, self.options.notifyDelay);\n\t\t\t\t\t\tisDataType? send(_file, files[1]) : send(_file);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tres._multiupload = data.multiupload? true : false;\n\t\t\t\t\tif (res.error) {\n\t\t\t\t\t\terrData = {\n\t\t\t\t\t\t\tcmd: 'upload',\n\t\t\t\t\t\t\terr: res,\n\t\t\t\t\t\t\txhr: xhr,\n\t\t\t\t\t\t\trc: xhr.status\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself.trigger('uploadfail', res);\n\t\t\t\t\t\t// trigger \"requestError\" event\n\t\t\t\t\t\tself.trigger('requestError', errData);\n\t\t\t\t\t\tif (errData._getEvent && errData._getEvent().isDefaultPrevented()) {\n\t\t\t\t\t\t\tres.error = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (res._chunkfailure || res._multiupload) {\n\t\t\t\t\t\t\tabort = true;\n\t\t\t\t\t\t\tself.uploads.xhrUploading = false;\n\t\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\t\tif (ntfUpload.length) {\n\t\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : -cnt, progress : 0, size : 0});\n\t\t\t\t\t\t\t\tdfrd.reject(res);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// for multi connection\n\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfrd.reject(res);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfrd.resolve(res);\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\t\n\t\t\t\txhr.upload.addEventListener('loadstart', function(e) {\n\t\t\t\t\tif (!chunkMerge && e.lengthComputable) {\n\t\t\t\t\t\tloaded = e.loaded;\n\t\t\t\t\t\tretry && (loaded = 0);\n\t\t\t\t\t\tfilesize = e.total;\n\t\t\t\t\t\tif (!loaded) {\n\t\t\t\t\t\t\tloaded = parseInt(filesize * 0.05);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (checkNotify()) {\n\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : 0, progress : loaded - prev, size : data.multiupload? 0 : filesize});\n\t\t\t\t\t\t\tprev = loaded;\n\t\t\t\t\t\t\tprogress();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\t\n\t\t\t\txhr.upload.addEventListener('progress', function(e) {\n\t\t\t\t\tvar curr;\n\n\t\t\t\t\tif (e.lengthComputable && !chunkMerge && xhr.readyState < 2) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tloaded = e.loaded;\n\n\t\t\t\t\t\t// to avoid strange bug in safari (not in chrome) with drag&drop.\n\t\t\t\t\t\t// bug: macos finder opened in any folder,\n\t\t\t\t\t\t// reset safari cache (option+command+e), reload elfinder page,\n\t\t\t\t\t\t// drop file from finder\n\t\t\t\t\t\t// on first attempt request starts (progress callback called ones) but never ends.\n\t\t\t\t\t\t// any next drop - successfull.\n\t\t\t\t\t\tif (!data.checked && loaded > 0 && !notifyto) {\n\t\t\t\t\t\t\tnotifyto = startNotify(xhr._totalSize - loaded);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!filesize) {\n\t\t\t\t\t\t\tfilesize = e.total;\n\t\t\t\t\t\t\tif (!loaded) {\n\t\t\t\t\t\t\t\tloaded = parseInt(filesize * 0.05);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tcurr = loaded - prev;\n\t\t\t\t\t\tif (checkNotify() && (curr/e.total) >= 0.05) {\n\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : 0, progress : curr, size : 0});\n\t\t\t\t\t\t\tprev = loaded;\n\t\t\t\t\t\t\tprogress();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!uploadedNtf && loaded >= filesize && !isChunked) {\n\t\t\t\t\t\t\t// Use \"chunkmerge\" for \"server-in-process\" notification\n\t\t\t\t\t\t\tuploadedNtf = true;\n\t\t\t\t\t\t\tnotifyto1 = setTimeout(function() {\n\t\t\t\t\t\t\t\tself.notify({type : 'chunkmerge', cnt : cnt});\n\t\t\t\t\t\t\t}, self.options.notifyDelay);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (cancelBtn && ! data.multiupload && loaded >= filesize) {\n\t\t\t\t\t\t\tcheckNotify() && cancelToggle(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\t\n\t\t\t\tvar send = function(files, paths){\n\t\t\t\t\tvar size = 0,\n\t\t\t\t\tfcnt = 1,\n\t\t\t\t\tsfiles = [],\n\t\t\t\t\tc = 0,\n\t\t\t\t\ttotal = cnt,\n\t\t\t\t\tmaxFileSize,\n\t\t\t\t\ttotalSize = 0,\n\t\t\t\t\tchunked = [],\n\t\t\t\t\tchunkID = new Date().getTime().toString().substr(-9), // for take care of the 32bit backend system\n\t\t\t\t\tBYTES_PER_CHUNK = Math.min((fm.uplMaxSize? fm.uplMaxSize : 2097152) - 8190, fm.options.uploadMaxChunkSize), // uplMaxSize margin 8kb or options.uploadMaxChunkSize\n\t\t\t\t\tblobSlice = chunkEnable? false : '',\n\t\t\t\t\tblobSize, blobMtime, blobName, i, start, end, chunks, blob, chunk, added, done, last, failChunk,\n\t\t\t\t\tmulti = function(files, num){\n\t\t\t\t\t\tvar sfiles = [], cid, sfilesLen = 0, cancelChk, hasChunk;\n\t\t\t\t\t\tif (!abort) {\n\t\t\t\t\t\t\twhile(files.length && sfiles.length < num) {\n\t\t\t\t\t\t\t\tsfiles.push(files.shift());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsfilesLen = sfiles.length;\n\t\t\t\t\t\t\tif (sfilesLen) {\n\t\t\t\t\t\t\t\tcancelChk = sfilesLen;\n\t\t\t\t\t\t\t\tfor (var i=0; i < sfilesLen; i++) {\n\t\t\t\t\t\t\t\t\tif (abort) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcid = isDataType? (sfiles[i][0][0]._cid || null) : (sfiles[i][0]._cid || null);\n\t\t\t\t\t\t\t\t\thasChunk = (hasChunk || cid)? true : false;\n\t\t\t\t\t\t\t\t\tif (!!failChunk[cid]) {\n\t\t\t\t\t\t\t\t\t\tlast--;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfm.exec('upload', {\n\t\t\t\t\t\t\t\t\t\ttype: data.type,\n\t\t\t\t\t\t\t\t\t\tisDataType: isDataType,\n\t\t\t\t\t\t\t\t\t\tfiles: sfiles[i],\n\t\t\t\t\t\t\t\t\t\tchecked: true,\n\t\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\t\tdropEvt: dropEvt,\n\t\t\t\t\t\t\t\t\t\trenames: renames,\n\t\t\t\t\t\t\t\t\t\thashes: hashes,\n\t\t\t\t\t\t\t\t\t\tmultiupload: true,\n\t\t\t\t\t\t\t\t\t\toverwrite: data.overwrite === 0? 0 : void 0,\n\t\t\t\t\t\t\t\t\t\tclipdata: data.clipdata\n\t\t\t\t\t\t\t\t\t}, void 0, target)\n\t\t\t\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\t\t\t\tif (error && error === 'No such command') {\n\t\t\t\t\t\t\t\t\t\t\tabort = true;\n\t\t\t\t\t\t\t\t\t\t\tfm.error(['errUpload', 'errPerm']);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (cid) {\t\n\t\t\t\t\t\t\t\t\t\t\tfailChunk[cid] = true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.always(function(e) {\n\t\t\t\t\t\t\t\t\t\tif (e && e.added) added = $.merge(added, e.added);\n\t\t\t\t\t\t\t\t\t\tif (last <= ++done) {\n\t\t\t\t\t\t\t\t\t\t\tfm.trigger('multiupload', {added: added});\n\t\t\t\t\t\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\t\t\t\t\t\tif (checkNotify()) {\n\t\t\t\t\t\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : -cnt, progress : 0, size : 0});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (files.length) {\n\t\t\t\t\t\t\t\t\t\t\tmulti(files, 1); // Next one\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tif (--cancelChk <= 1) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cancelBtn) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcancelToggle(false, hasChunk);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdfrd.resolve();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (sfiles.length < 1 || abort) {\n\t\t\t\t\t\t\tif (abort) {\n\t\t\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\t\t\tif (cid) {\n\t\t\t\t\t\t\t\t\tfailChunk[cid] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdfrd.resolve();\n\t\t\t\t\t\t\t\tself.uploads.xhrUploading = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcheck = function(){\n\t\t\t\t\t\tif (!self.uploads.xhrUploading) {\n\t\t\t\t\t\t\tself.uploads.xhrUploading = true;\n\t\t\t\t\t\t\tmulti(sfiles, multiMax); // Max connection: 3\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetTimeout(check, 100);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\treqId, err;\n\n\t\t\t\t\tif (! dataChecked && (isDataType || data.type == 'files')) {\n\t\t\t\t\t\tif (! (maxFileSize = fm.option('uploadMaxSize', target))) {\n\t\t\t\t\t\t\tmaxFileSize = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i=0; i < files.length; i++) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tblob = files[i];\n\t\t\t\t\t\t\t\tblobSize = blob.size;\n\t\t\t\t\t\t\t\tif (blobSlice === false) {\n\t\t\t\t\t\t\t\t\tblobSlice = '';\n\t\t\t\t\t\t\t\t\tif (self.api >= 2.1) {\n\t\t\t\t\t\t\t\t\t\tif ('slice' in blob) {\n\t\t\t\t\t\t\t\t\t\t\tblobSlice = 'slice';\n\t\t\t\t\t\t\t\t\t\t} else if ('mozSlice' in blob) {\n\t\t\t\t\t\t\t\t\t\t\tblobSlice = 'mozSlice';\n\t\t\t\t\t\t\t\t\t\t} else if ('webkitSlice' in blob) {\n\t\t\t\t\t\t\t\t\t\t\tblobSlice = 'webkitSlice';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t\t\ttotal--;\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// file size check\n\t\t\t\t\t\t\tif ((maxFileSize && blobSize > maxFileSize) || (!blobSlice && fm.uplMaxSize && blobSize > fm.uplMaxSize)) {\n\t\t\t\t\t\t\t\ttriggerError(['errUploadFile', blob.name, 'errUploadFileSize'], blob, true);\n\t\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t\t\ttotal--;\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// file mime check\n\t\t\t\t\t\t\tif (blob.type && ! self.uploadMimeCheck(blob.type, target)) {\n\t\t\t\t\t\t\t\ttriggerError(['errUploadFile', blob.name, 'errUploadMime', '(' + blob.type + ')'], blob, true);\n\t\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t\t\ttotal--;\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (blobSlice && blobSize > BYTES_PER_CHUNK) {\n\t\t\t\t\t\t\t\tstart = 0;\n\t\t\t\t\t\t\t\tend = BYTES_PER_CHUNK;\n\t\t\t\t\t\t\t\tchunks = -1;\n\t\t\t\t\t\t\t\ttotal = Math.floor((blobSize - 1) / BYTES_PER_CHUNK);\n\t\t\t\t\t\t\t\tblobMtime = blob.lastModified? Math.round(blob.lastModified/1000) : 0;\n\t\t\t\t\t\t\t\tblobName = data.clipdata? fm.date(fm.nonameDateFormat) + '.png' : blob.name;\n\n\t\t\t\t\t\t\t\ttotalSize += blobSize;\n\t\t\t\t\t\t\t\tchunked[chunkID] = 0;\n\t\t\t\t\t\t\t\twhile(start < blobSize) {\n\t\t\t\t\t\t\t\t\tchunk = blob[blobSlice](start, end);\n\t\t\t\t\t\t\t\t\tchunk._chunk = blobName + '.' + (++chunks) + '_' + total + '.part';\n\t\t\t\t\t\t\t\t\tchunk._cid   = chunkID;\n\t\t\t\t\t\t\t\t\tchunk._range = start + ',' + chunk.size + ',' + blobSize;\n\t\t\t\t\t\t\t\t\tchunk._mtime = blobMtime;\n\t\t\t\t\t\t\t\t\tchunked[chunkID]++;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (size) {\n\t\t\t\t\t\t\t\t\t\tc++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (typeof sfiles[c] == 'undefined') {\n\t\t\t\t\t\t\t\t\t\tsfiles[c] = [];\n\t\t\t\t\t\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t\t\t\t\t\tsfiles[c][0] = [];\n\t\t\t\t\t\t\t\t\t\t\tsfiles[c][1] = [];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsize = BYTES_PER_CHUNK;\n\t\t\t\t\t\t\t\t\tfcnt = 1;\n\t\t\t\t\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t\t\t\t\tsfiles[c][0].push(chunk);\n\t\t\t\t\t\t\t\t\t\tsfiles[c][1].push(paths[i]);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsfiles[c].push(chunk);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tstart = end;\n\t\t\t\t\t\t\t\t\tend = start + BYTES_PER_CHUNK;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (chunk == null) {\n\t\t\t\t\t\t\t\t\ttriggerError(['errUploadFile', blob.name, 'errUploadFileSize'], blob, true);\n\t\t\t\t\t\t\t\t\tcnt--;\n\t\t\t\t\t\t\t\t\ttotal--;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttotal += chunks;\n\t\t\t\t\t\t\t\t\tsize = 0;\n\t\t\t\t\t\t\t\t\tfcnt = 1;\n\t\t\t\t\t\t\t\t\tc++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ((fm.uplMaxSize && size + blobSize > fm.uplMaxSize) || fcnt > fm.uplMaxFile) {\n\t\t\t\t\t\t\t\tsize = 0;\n\t\t\t\t\t\t\t\tfcnt = 1;\n\t\t\t\t\t\t\t\tc++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (typeof sfiles[c] == 'undefined') {\n\t\t\t\t\t\t\t\tsfiles[c] = [];\n\t\t\t\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t\t\t\tsfiles[c][0] = [];\n\t\t\t\t\t\t\t\t\tsfiles[c][1] = [];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t\t\tsfiles[c][0].push(blob);\n\t\t\t\t\t\t\t\tsfiles[c][1].push(paths[i]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsfiles[c].push(blob);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsize += blobSize;\n\t\t\t\t\t\t\ttotalSize += blobSize;\n\t\t\t\t\t\t\tfcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (errors.length) {\n\t\t\t\t\t\t\ttriggerError();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (sfiles.length == 0) {\n\t\t\t\t\t\t\t// no data\n\t\t\t\t\t\t\tdata.checked = true;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (sfiles.length > 1) {\n\t\t\t\t\t\t\t// multi upload\n\t\t\t\t\t\t\tnotifyto = startNotify(totalSize);\n\t\t\t\t\t\t\tadded = [];\n\t\t\t\t\t\t\tdone = 0;\n\t\t\t\t\t\t\tlast = sfiles.length;\n\t\t\t\t\t\t\tfailChunk = [];\n\t\t\t\t\t\t\tcheck();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// single upload\n\t\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t\tfiles = sfiles[0][0];\n\t\t\t\t\t\t\tpaths = sfiles[0][1];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfiles = sfiles[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!dataChecked) {\n\t\t\t\t\t\tif (!fm.UA.Safari || !data.files) {\n\t\t\t\t\t\t\tnotifyto = startNotify(totalSize);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\txhr._totalSize = totalSize;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tdataChecked = true;\n\t\t\t\t\t\n\t\t\t\t\tif (! files.length) {\n\t\t\t\t\t\tdfrd.reject(['errUploadNoFiles']);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\txhr.open('POST', self.uploadURL, true);\n\t\t\t\t\t\n\t\t\t\t\t// set request headers\n\t\t\t\t\tif (fm.customHeaders) {\n\t\t\t\t\t\t$.each(fm.customHeaders, function(key) {\n\t\t\t\t\t\t\txhr.setRequestHeader(key, this);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// set xhrFields\n\t\t\t\t\tif (fm.xhrFields) {\n\t\t\t\t\t\t$.each(fm.xhrFields, function(key) {\n\t\t\t\t\t\t\tif (key in xhr) {\n\t\t\t\t\t\t\t\txhr[key] = this;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (self.api >= 2.1029) {\n\t\t\t\t\t\t// request ID\n\t\t\t\t\t\treqId = (+ new Date()).toString(16) + Math.floor(1000 * Math.random()).toString(16);\n\t\t\t\t\t\tformData.append('reqid', reqId);\n\t\t\t\t\t\txhr._requestId = reqId;\n\t\t\t\t\t}\n\t\t\t\t\tformData.append('cmd', 'upload');\n\t\t\t\t\tformData.append(self.newAPI ? 'target' : 'current', target);\n\t\t\t\t\tif (renames && renames.length) {\n\t\t\t\t\t\t$.each(renames, function(i, v) {\n\t\t\t\t\t\t\tformData.append('renames[]', v);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tformData.append('suffix', fm.options.backupSuffix);\n\t\t\t\t\t}\n\t\t\t\t\tif (hashes) {\n\t\t\t\t\t\t$.each(hashes, function(i, v) {\n\t\t\t\t\t\t\tformData.append('hashes['+ i +']', v);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$.each(self.customData, function(key, val) {\n\t\t\t\t\t\tformData.append(key, val);\n\t\t\t\t\t});\n\t\t\t\t\t$.each(self.options.onlyMimes, function(i, mime) {\n\t\t\t\t\t\tformData.append('mimes[]', mime);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t$.each(files, function(i, file) {\n\t\t\t\t\t\tvar name, relpath;\n\t\t\t\t\t\tif (file._chunkmerged) {\n\t\t\t\t\t\t\tformData.append('chunk', file._chunkmerged);\n\t\t\t\t\t\t\tformData.append('upload[]', file._name);\n\t\t\t\t\t\t\tformData.append('mtime[]', file._mtime);\n\t\t\t\t\t\t\tdata.clipdata && formData.append('overwrite', 0);\n\t\t\t\t\t\t\tisChunked = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (file._chunkfail) {\n\t\t\t\t\t\t\t\tformData.append('upload[]', 'chunkfail');\n\t\t\t\t\t\t\t\tformData.append('mimes', 'chunkfail');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (data.clipdata) {\n\t\t\t\t\t\t\t\t\tif (!file._chunk) {\n\t\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t\t\tname = fm.date(fm.nonameDateFormat) + '.png';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (file.name) {\n\t\t\t\t\t\t\t\t\t\tname = file.name;\n\t\t\t\t\t\t\t\t\t\tif (fm.UA.iOS) {\n\t\t\t\t\t\t\t\t\t\t\tif (name.match(/^image\\.jpe?g$/i)) {\n\t\t\t\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t\t\t\t\tname = fm.date(fm.nonameDateFormat) + '.jpg';\n\t\t\t\t\t\t\t\t\t\t\t} else if (name.match(/^capturedvideo\\.mov$/i)) {\n\t\t\t\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t\t\t\t\tname = fm.date(fm.nonameDateFormat) + '.mov';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\trelpath = (file.webkitRelativePath || file.relativePath || file._relativePath || '').replace(/[^\\/]+$/, '');\n\t\t\t\t\t\t\t\t\t\tname = relpath + name;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tname? formData.append('upload[]', file, name) : formData.append('upload[]', file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (file._chunk) {\n\t\t\t\t\t\t\t\tformData.append('chunk', file._chunk);\n\t\t\t\t\t\t\t\tformData.append('cid'  , file._cid);\n\t\t\t\t\t\t\t\tformData.append('range', file._range);\n\t\t\t\t\t\t\t\tformData.append('mtime[]', file._mtime);\n\t\t\t\t\t\t\t\tisChunked = true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tformData.append('mtime[]', file.lastModified? Math.round(file.lastModified/1000) : 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (isDataType) {\n\t\t\t\t\t\t$.each(paths, function(i, path) {\n\t\t\t\t\t\t\tformData.append('upload_path[]', path);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (data.overwrite === 0) {\n\t\t\t\t\t\tformData.append('overwrite', 0);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// send int value that which meta key was pressed when dropped  as `dropWith`\n\t\t\t\t\tif (dropEvt) {\n\t\t\t\t\t\tformData.append('dropWith', parseInt(\n\t\t\t\t\t\t\t(dropEvt.altKey  ? '1' : '0')+\n\t\t\t\t\t\t\t(dropEvt.ctrlKey ? '1' : '0')+\n\t\t\t\t\t\t\t(dropEvt.metaKey ? '1' : '0')+\n\t\t\t\t\t\t\t(dropEvt.shiftKey? '1' : '0'), 2));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// set extraData on current request\n\t\t\t\t\tif (extraData) {\n\t\t\t\t\t\t$.each(extraData, function(key, val) {\n\t\t\t\t\t\t\tformData.append(key, val);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\txhr.send(formData);\n\t\t\t\t\t\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif (! isDataType) {\n\t\t\t\t\tif (files.length > 0) {\n\t\t\t\t\t\tif (! data.clipdata && renames == null) {\n\t\t\t\t\t\t\tvar mkdirs = [],\n\t\t\t\t\t\t\t\tpaths = [],\n\t\t\t\t\t\t\t\texcludes = fm.options.folderUploadExclude[fm.OS] || null;\n\t\t\t\t\t\t\t$.each(files, function(i, file) {\n\t\t\t\t\t\t\t\tvar relPath = file.webkitRelativePath || file.relativePath || '',\n\t\t\t\t\t\t\t\t\tidx, rootDir;\n\t\t\t\t\t\t\t\tif (! relPath) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (excludes && file.name.match(excludes)) {\n\t\t\t\t\t\t\t\t\tfile._remove = true;\n\t\t\t\t\t\t\t\t\trelPath = void(0);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// add '/' as prefix to make same to folder uploading with DnD, see #2607\n\t\t\t\t\t\t\t\t\trelPath = '/' + relPath.replace(/\\/[^\\/]*$/, '').replace(/^\\//, '');\n\t\t\t\t\t\t\t\t\tif (relPath && $.inArray(relPath, mkdirs) === -1) {\n\t\t\t\t\t\t\t\t\t\tmkdirs.push(relPath);\n\t\t\t\t\t\t\t\t\t\t// checking the root directory to supports <input type=\"file\" webkitdirectory> see #2378\n\t\t\t\t\t\t\t\t\t\tidx = relPath.substr(1).indexOf('/');\n\t\t\t\t\t\t\t\t\t\tif (idx !== -1 && (rootDir = relPath.substr(0, idx + 1)) && $.inArray(rootDir, mkdirs) === -1) {\n\t\t\t\t\t\t\t\t\t\t\tmkdirs.unshift(rootDir);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpaths.push(relPath);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\trenames = [];\n\t\t\t\t\t\t\thashes = {};\n\t\t\t\t\t\t\tif (mkdirs.length) {\n\t\t\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\t\t\tvar checkDirs = $.map(mkdirs, function(name) { return name.substr(1).indexOf('/') === -1 ? {name: name.substr(1)} : null;}),\n\t\t\t\t\t\t\t\t\t\tcancelDirs = [];\n\t\t\t\t\t\t\t\t\tfm.uploads.checkExists(checkDirs, target, fm, true).done(\n\t\t\t\t\t\t\t\t\t\tfunction(res, res2) {\n\t\t\t\t\t\t\t\t\t\t\tvar dfds = [], dfd, bak, hash;\n\t\t\t\t\t\t\t\t\t\t\tif (fm.options.overwriteUploadConfirm && fm.option('uploadOverwrite', target)) {\n\t\t\t\t\t\t\t\t\t\t\t\tcancelDirs = $.map(checkDirs, function(dir) { return dir._remove? dir.name : null ;} );\n\t\t\t\t\t\t\t\t\t\t\t\tcheckDirs = $.grep(checkDirs, function(dir) { return !dir._remove? true : false ;} );\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (cancelDirs.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t$.each(paths.concat(), function(i, path) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ($.inArray(path, cancelDirs) === 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles[i]._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpaths[i] = void(0);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfiles = $.grep(files, function(file) { return file._remove? false : true; });\n\t\t\t\t\t\t\t\t\t\t\tpaths = $.grep(paths, function(path) { return path === void 0 ? false : true; });\n\t\t\t\t\t\t\t\t\t\t\tif (checkDirs.length) {\n\t\t\t\t\t\t\t\t\t\t\t\tdfd = $.Deferred();\n\t\t\t\t\t\t\t\t\t\t\t\tif (res.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res, function(i, existName) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// backup\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbak = fm.uniqueName(existName + fm.options.backupSuffix , null, '');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$.each(res2, function(h, name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res[0] == name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thash = h;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (! hash) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thash = fm.fileByName(res[0], target).hash;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfm.lockfiles({files : [hash]});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfds.push(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata   : {cmd : 'rename', target : hash, name : bak},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnotify : {type : 'rename', cnt : 1}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfm.sync();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.always(function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfm.unlockfiles({files : [hash]});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdfds.push(null);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t$.when.apply($, dfds).done(function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t// ensure directories\n\t\t\t\t\t\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata   : {cmd : 'mkdir', target : target, dirs : mkdirs},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnotify : {type : 'mkdir', cnt : mkdirs.length},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreventFail: true\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\terror = error || ['errUnknown'];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (error[0] === 'errCmdParams') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmultiMax = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmultiMax = 0;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar rm = false;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!data.hashes) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.hashes = {};\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpaths = $.map(paths.concat(), function(p, i) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (p === '/') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (data.hashes[p]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn data.hashes[p];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trm = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles[i]._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (rm) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = $.grep(files, function(file) { return file._remove? false : true; });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t.always(function(data) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (multiMax) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisDataType = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (! send(files, paths)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfm.uploads.checkExists(files, target, fm).done(\n\t\t\t\t\t\t\t\t\tfunction(res, res2){\n\t\t\t\t\t\t\t\t\t\tif (fm.options.overwriteUploadConfirm && fm.option('uploadOverwrite', target)) {\n\t\t\t\t\t\t\t\t\t\t\thashes = res2;\n\t\t\t\t\t\t\t\t\t\t\tif (res === null) {\n\t\t\t\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\trenames = res;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfiles = $.grep(files, function(file){return !file._remove? true : false ;});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcnt = files.length;\n\t\t\t\t\t\t\t\t\t\tif (cnt > 0) {\n\t\t\t\t\t\t\t\t\t\t\tif (! send(files)) {\n\t\t\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (! send(files)) {\n\t\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (dataChecked) {\n\t\t\t\t\t\tsend(files[0], files[1]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfiles.done(function(result) { // result: [files, paths, renames, hashes, mkdirs]\n\t\t\t\t\t\t\trenames = [];\n\t\t\t\t\t\t\tcnt = result[0].length;\n\t\t\t\t\t\t\tif (cnt) {\n\t\t\t\t\t\t\t\tif (result[4] && result[4].length) {\n\t\t\t\t\t\t\t\t\t// ensure directories\n\t\t\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\t\t\tdata   : {cmd : 'mkdir', target : target, dirs : result[4]},\n\t\t\t\t\t\t\t\t\t\tnotify : {type : 'mkdir', cnt : result[4].length},\n\t\t\t\t\t\t\t\t\t\tpreventFail: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\t\t\t\terror = error || ['errUnknown'];\n\t\t\t\t\t\t\t\t\t\tif (error[0] === 'errCmdParams') {\n\t\t\t\t\t\t\t\t\t\t\tmultiMax = 1;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tmultiMax = 0;\n\t\t\t\t\t\t\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\t\t\t\t\tvar rm = false;\n\t\t\t\t\t\t\t\t\t\tif (!data.hashes) {\n\t\t\t\t\t\t\t\t\t\t\tdata.hashes = {};\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tresult[1] = $.map(result[1], function(p, i) {\n\t\t\t\t\t\t\t\t\t\t\tresult[0][i]._relativePath = p.replace(/^\\//, '');\n\t\t\t\t\t\t\t\t\t\t\tp = p.replace(/\\/[^\\/]*$/, '');\n\t\t\t\t\t\t\t\t\t\t\tif (p === '') {\n\t\t\t\t\t\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tif (data.hashes[p]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn data.hashes[p];\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\trm = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\tresult[0][i]._remove = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tif (rm) {\n\t\t\t\t\t\t\t\t\t\t\tresult[0] = $.grep(result[0], function(file) { return file._remove? false : true; });\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.always(function(data) {\n\t\t\t\t\t\t\t\t\t\tif (multiMax) {\n\t\t\t\t\t\t\t\t\t\t\trenames = result[2];\n\t\t\t\t\t\t\t\t\t\t\thashes = result[3];\n\t\t\t\t\t\t\t\t\t\t\tsend(result[0], result[1]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tresult[1] = $.map(result[1], function() { return target; });\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trenames = result[2];\n\t\t\t\t\t\t\t\thashes = result[3];\n\t\t\t\t\t\t\t\tsend(result[0], result[1]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdfrd.reject(['errUploadNoFiles']);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).fail(function(){\n\t\t\t\t\t\t\tdfrd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\t\n\t\t\t// upload transport using iframe\n\t\t\tiframe : function(data, fm) { \n\t\t\t\tvar self   = fm ? fm : this,\n\t\t\t\t\tinput  = data.input? data.input : false,\n\t\t\t\t\tfiles  = !input ? self.uploads.checkFile(data, self) : false,\n\t\t\t\t\tdfrd   = $.Deferred()\n\t\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\t\terror && self.error(error);\n\t\t\t\t\t\t}),\n\t\t\t\t\tname = 'iframe-'+fm.namespace+(++self.iframeCnt),\n\t\t\t\t\tform = $('<form action=\"'+self.uploadURL+'\" method=\"post\" enctype=\"multipart/form-data\" encoding=\"multipart/form-data\" target=\"'+name+'\" style=\"display:none\"><input type=\"hidden\" name=\"cmd\" value=\"upload\" /></form>'),\n\t\t\t\t\tmsie = this.UA.IE,\n\t\t\t\t\t// clear timeouts, close notification dialog, remove form/iframe\n\t\t\t\t\tonload = function() {\n\t\t\t\t\t\tabortto  && clearTimeout(abortto);\n\t\t\t\t\t\tnotifyto && clearTimeout(notifyto);\n\t\t\t\t\t\tnotify   && self.notify({type : 'upload', cnt : -cnt});\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tmsie && $('<iframe src=\"javascript:false;\"/>').appendTo(form);\n\t\t\t\t\t\t\tform.remove();\n\t\t\t\t\t\t\tiframe.remove();\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t},\n\t\t\t\t\tiframe = $('<iframe src=\"'+(msie ? 'javascript:false;' : 'about:blank')+'\" name=\"'+name+'\" style=\"position:absolute;left:-1000px;top:-1000px\" />')\n\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\tiframe.off('load')\n\t\t\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\t\t\tonload();\n\t\t\t\t\t\t\t\t\t// data will be processed in callback response or window onmessage\n\t\t\t\t\t\t\t\t\tdfrd.resolve();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// notify dialog\n\t\t\t\t\t\t\t\tnotifyto = setTimeout(function() {\n\t\t\t\t\t\t\t\t\tnotify = true;\n\t\t\t\t\t\t\t\t\tself.notify({type : 'upload', cnt : cnt});\n\t\t\t\t\t\t\t\t}, self.options.notifyDelay);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// emulate abort on timeout\n\t\t\t\t\t\t\t\tif (self.options.iframeTimeout > 0) {\n\t\t\t\t\t\t\t\t\tabortto = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tonload();\n\t\t\t\t\t\t\t\t\t\tdfrd.reject(['errConnect', 'errTimeout']);\n\t\t\t\t\t\t\t\t\t}, self.options.iframeTimeout);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tform.submit();\n\t\t\t\t\t\t}),\n\t\t\t\t\ttarget  = (data.target || self.cwd().hash),\n\t\t\t\t\tnames   = [],\n\t\t\t\t\tdfds    = [],\n\t\t\t\t\trenames = [],\n\t\t\t\t\thashes  = {},\n\t\t\t\t\tcnt, notify, notifyto, abortto;\n\n\t\t\t\tif (files && files.length) {\n\t\t\t\t\t$.each(files, function(i, val) {\n\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"upload[]\" value=\"'+val+'\"/>');\n\t\t\t\t\t});\n\t\t\t\t\tcnt = 1;\n\t\t\t\t} else if (input && $(input).is(':file') && $(input).val()) {\n\t\t\t\t\tif (fm.options.overwriteUploadConfirm && fm.option('uploadOverwrite', target)) {\n\t\t\t\t\t\tnames = input.files? input.files : [{ name: $(input).val().replace(/^(?:.+[\\\\\\/])?([^\\\\\\/]+)$/, '$1') }];\n\t\t\t\t\t\t//names = $.map(names, function(file){return file.name? { name: file.name } : null ;});\n\t\t\t\t\t\tdfds.push(self.uploads.checkExists(names, target, self).done(\n\t\t\t\t\t\t\tfunction(res, res2){\n\t\t\t\t\t\t\t\thashes = res2;\n\t\t\t\t\t\t\t\tif (res === null) {\n\t\t\t\t\t\t\t\t\tdata.overwrite = 0;\n\t\t\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\t\t\trenames = res;\n\t\t\t\t\t\t\t\t\tcnt = $.grep(names, function(file){return !file._remove? true : false ;}).length;\n\t\t\t\t\t\t\t\t\tif (cnt != names.length) {\n\t\t\t\t\t\t\t\t\t\tcnt = 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t));\n\t\t\t\t\t}\n\t\t\t\t\tcnt = input.files ? input.files.length : 1;\n\t\t\t\t\tform.append(input);\n\t\t\t\t} else {\n\t\t\t\t\treturn dfrd.reject();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$.when.apply($, dfds).done(function() {\n\t\t\t\t\tif (cnt < 1) {\n\t\t\t\t\t\treturn dfrd.reject();\n\t\t\t\t\t}\n\t\t\t\t\tform.append('<input type=\"hidden\" name=\"'+(self.newAPI ? 'target' : 'current')+'\" value=\"'+target+'\"/>')\n\t\t\t\t\t\t.append('<input type=\"hidden\" name=\"html\" value=\"1\"/>')\n\t\t\t\t\t\t.append('<input type=\"hidden\" name=\"node\" value=\"'+self.id+'\"/>')\n\t\t\t\t\t\t.append($(input).attr('name', 'upload[]'));\n\t\t\t\t\t\n\t\t\t\t\tif (renames.length > 0) {\n\t\t\t\t\t\t$.each(renames, function(i, rename) {\n\t\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"renames[]\" value=\"'+self.escape(rename)+'\"/>');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"suffix\" value=\"'+fm.options.backupSuffix+'\"/>');\n\t\t\t\t\t}\n\t\t\t\t\tif (hashes) {\n\t\t\t\t\t\t$.each(renames, function(i, v) {\n\t\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"['+i+']\" value=\"'+self.escape(v)+'\"/>');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (data.overwrite === 0) {\n\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"overwrite\" value=\"0\"/>');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t$.each(self.options.onlyMimes||[], function(i, mime) {\n\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"mimes[]\" value=\"'+self.escape(mime)+'\"/>');\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t$.each(self.customData, function(key, val) {\n\t\t\t\t\t\tform.append('<input type=\"hidden\" name=\"'+key+'\" value=\"'+self.escape(val)+'\"/>');\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tform.appendTo('body');\n\t\t\t\t\tiframe.appendTo('body');\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn dfrd;\n\t\t\t}\n\t\t},\n\t\t\n\t\t\n\t\t/**\n\t\t * Bind callback to event(s) The callback is executed at most once per event.\n\t\t * To bind to multiply events at once, separate events names by space\n\t\t *\n\t\t * @param  String    event name\n\t\t * @param  Function  callback\n\t\t * @param  Boolan    priority first\n\t\t * @return elFinder\n\t\t */\n\t\tone : function(ev, callback, priorityFirst) {\n\t\t\tvar self  = this,\n\t\t\t\tevent = ev.toLowerCase(),\n\t\t\t\th     = function(e, f) {\n\t\t\t\t\tif (!self.toUnbindEvents[event]) {\n\t\t\t\t\t\tself.toUnbindEvents[event] = [];\n\t\t\t\t\t}\n\t\t\t\t\tself.toUnbindEvents[event].push({\n\t\t\t\t\t\ttype: event,\n\t\t\t\t\t\tcallback: h\n\t\t\t\t\t});\n\t\t\t\t\treturn (callback.done? callback.done : callback).apply(this, arguments);\n\t\t\t\t};\n\t\t\tif (callback.done) {\n\t\t\t\th = {done: h};\n\t\t\t}\n\t\t\treturn this.bind(event, h, priorityFirst);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Set/get data into/from localStorage\n\t\t *\n\t\t * @param  String       key\n\t\t * @param  String|void  value\n\t\t * @return String|null\n\t\t */\n\t\tlocalStorage : function(key, val) {\n\t\t\tvar self   = this,\n\t\t\t\ts      = window.localStorage,\n\t\t\t\toldkey = 'elfinder-'+(key || '')+this.id, // old key of elFinder < 2.1.6\n\t\t\t\tprefix = window.location.pathname+'-elfinder-',\n\t\t\t\tsuffix = this.id,\n\t\t\t\tclrs   = [],\n\t\t\t\tretval, oldval, t, precnt, sufcnt;\n\n\t\t\t// reset this node data\n\t\t\tif (typeof(key) === 'undefined') {\n\t\t\t\tprecnt = prefix.length;\n\t\t\t\tsufcnt = suffix.length * -1;\n\t\t\t\t$.each(s, function(key) {\n\t\t\t\t\tif (key.substr(0, precnt) === prefix && key.substr(sufcnt) === suffix) {\n\t\t\t\t\t\tclrs.push(key);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t$.each(clrs, function(i, key) {\n\t\t\t\t\ts.removeItem(key);\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\t// new key of elFinder >= 2.1.6\n\t\t\tkey = prefix+key+suffix;\n\t\t\t\n\t\t\tif (val === null) {\n\t\t\t\treturn s.removeItem(key);\n\t\t\t}\n\t\t\t\n\t\t\tif (val === void(0) && !(retval = s.getItem(key)) && (oldval = s.getItem(oldkey))) {\n\t\t\t\tval = oldval;\n\t\t\t\ts.removeItem(oldkey);\n\t\t\t}\n\t\t\t\n\t\t\tif (val !== void(0)) {\n\t\t\t\tt = typeof val;\n\t\t\t\tif (t !== 'string' && t !== 'number') {\n\t\t\t\t\tval = JSON.stringify(val);\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\ts.setItem(key, val);\n\t\t\t\t} catch (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\ts.clear();\n\t\t\t\t\t\ts.setItem(key, val);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tself.debug('error', e.toString());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tretval = s.getItem(key);\n\t\t\t}\n\n\t\t\tif (retval && (retval.substr(0,1) === '{' || retval.substr(0,1) === '[')) {\n\t\t\t\ttry {\n\t\t\t\t\treturn JSON.parse(retval);\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * Set/get data into/from sessionStorage\n\t\t *\n\t\t * @param  String       key\n\t\t * @param  String|void  value\n\t\t * @return String|null\n\t\t */\n\t\tsessionStorage : function(key, val) {\n\t\t\tvar self   = this,\n\t\t\t\ts, retval, t;\n\n\t\t\ttry {\n\t\t\t\ts = window.sessionStorage;\n\t\t\t} catch(e) {}\n\n\t\t\tif (!s) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (val === null) {\n\t\t\t\treturn s.removeItem(key);\n\t\t\t}\n\n\t\t\tif (val !== void(0)) {\n\t\t\t\tt = typeof val;\n\t\t\t\tif (t !== 'string' && t !== 'number') {\n\t\t\t\t\tval = JSON.stringify(val);\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\ts.setItem(key, val);\n\t\t\t\t} catch (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\ts.clear();\n\t\t\t\t\t\ts.setItem(key, val);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tself.debug('error', e.toString());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tretval = s.getItem(key);\n\n\t\t\tif (retval && (retval.substr(0,1) === '{' || retval.substr(0,1) === '[')) {\n\t\t\t\ttry {\n\t\t\t\t\treturn JSON.parse(retval);\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * Get/set cookie\n\t\t *\n\t\t * @param  String       cookie name\n\t\t * @param  String|void  cookie value\n\t\t * @return String|null\n\t\t */\n\t\tcookie : function(name, value) {\n\t\t\tvar d, o, c, i, retval, t;\n\n\t\t\tname = 'elfinder-'+name+this.id;\n\n\t\t\tif (value === void(0)) {\n\t\t\t\tif (this.cookieEnabled && document.cookie && document.cookie != '') {\n\t\t\t\t\tc = document.cookie.split(';');\n\t\t\t\t\tname += '=';\n\t\t\t\t\tfor (i=0; i<c.length; i++) {\n\t\t\t\t\t\tc[i] = $.trim(c[i]);\n\t\t\t\t\t\tif (c[i].substring(0, name.length) == name) {\n\t\t\t\t\t\t\tretval = decodeURIComponent(c[i].substring(name.length));\n\t\t\t\t\t\t\tif (retval.substr(0,1) === '{' || retval.substr(0,1) === '[') {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\treturn JSON.parse(retval);\n\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn retval;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!this.cookieEnabled) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\to = Object.assign({}, this.options.cookie);\n\t\t\tif (value === null) {\n\t\t\t\tvalue = '';\n\t\t\t\to.expires = -1;\n\t\t\t} else {\n\t\t\t\tt = typeof value;\n\t\t\t\tif (t !== 'string' && t !== 'number') {\n\t\t\t\t\tvalue = JSON.stringify(value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof(o.expires) == 'number') {\n\t\t\t\td = new Date();\n\t\t\t\td.setTime(d.getTime()+(o.expires * 86400000));\n\t\t\t\to.expires = d;\n\t\t\t}\n\t\t\tdocument.cookie = name+'='+encodeURIComponent(value)+'; expires='+o.expires.toUTCString()+(o.path ? '; path='+o.path : '')+(o.domain ? '; domain='+o.domain : '')+(o.secure ? '; secure' : '');\n\t\t\tif (value && (value.substr(0,1) === '{' || value.substr(0,1) === '[')) {\n\t\t\t\ttry {\n\t\t\t\t\treturn JSON.parse(value);\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Get start directory (by location.hash or last opened directory)\n\t\t * \n\t\t * @return String\n\t\t */\n\t\tstartDir : function() {\n\t\t\tvar locHash = window.location.hash;\n\t\t\tif (locHash && locHash.match(/^#elf_/)) {\n\t\t\t\treturn locHash.replace(/^#elf_/, '');\n\t\t\t} else if (this.options.startPathHash) {\n\t\t\t\treturn this.options.startPathHash;\n\t\t\t} else {\n\t\t\t\treturn this.lastDir();\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Get/set last opened directory\n\t\t * \n\t\t * @param  String|undefined  dir hash\n\t\t * @return String\n\t\t */\n\t\tlastDir : function(hash) { \n\t\t\treturn this.options.rememberLastDir ? this.storage('lastdir', hash) : '';\n\t\t},\n\t\t\n\t\t/**\n\t\t * Node for escape html entities in texts\n\t\t * \n\t\t * @type jQuery\n\t\t */\n\t\t_node : $('<span/>'),\n\t\t\n\t\t/**\n\t\t * Replace not html-safe symbols to html entities\n\t\t * \n\t\t * @param  String  text to escape\n\t\t * @return String\n\t\t */\n\t\tescape : function(name) {\n\t\t\treturn this._node.text(name).html().replace(/\"/g, '&quot;').replace(/'/g, '&#039;');\n\t\t},\n\t\t\n\t\t/**\n\t\t * Cleanup ajax data.\n\t\t * For old api convert data into new api format\n\t\t * \n\t\t * @param  String  command name\n\t\t * @param  Object  data from backend\n\t\t * @return Object\n\t\t */\n\t\tnormalize : function(data) {\n\t\t\tvar self   = this,\n\t\t\t\tfileFilter = (function() {\n\t\t\t\t\tvar func, filter;\n\t\t\t\t\tif (filter = self.options.fileFilter) {\n\t\t\t\t\t\tif (typeof filter === 'function') {\n\t\t\t\t\t\t\tfunc = function(file) {\n\t\t\t\t\t\t\t\treturn filter.call(self, file);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else if (filter instanceof RegExp) {\n\t\t\t\t\t\t\tfunc = function(file) {\n\t\t\t\t\t\t\t\treturn filter.test(file.name);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn func? func : null;\n\t\t\t\t})(),\n\t\t\t\tchkCmdMap = function(opts) {\n\t\t\t\t\t// Disable command to replace with other command\n\t\t\t\t\tvar disabled;\n\t\t\t\t\tif (opts.uiCmdMap) {\n\t\t\t\t\t\tif ($.isPlainObject(opts.uiCmdMap) && Object.keys(opts.uiCmdMap).length) {\n\t\t\t\t\t\t\tif (!opts.disabledFlip) {\n\t\t\t\t\t\t\t\topts.disabledFlip = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdisabled = opts.disabledFlip;\n\t\t\t\t\t\t\t$.each(opts.uiCmdMap, function(f, t) {\n\t\t\t\t\t\t\t\tif (t === 'hidden' && !disabled[f]) {\n\t\t\t\t\t\t\t\t\topts.disabled.push(f);\n\t\t\t\t\t\t\t\t\topts.disabledFlip[f] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete opts.uiCmdMap;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnormalizeOptions = function(opts) {\n\t\t\t\t\tvar getType = function(v) {\n\t\t\t\t\t\t\tvar type = typeof v;\n\t\t\t\t\t\t\tif (type === 'object' && Array.isArray(v)) {\n\t\t\t\t\t\t\t\ttype = 'array';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn type;\n\t\t\t\t\t\t};\n\t\t\t\t\t$.each(self.optionProperties, function(k, empty) {\n\t\t\t\t\t\tif (empty !== void(0)) {\n\t\t\t\t\t\t\tif (opts[k] && getType(opts[k]) !== getType(empty)) {\n\t\t\t\t\t\t\t\topts[k] = empty;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (opts.disabled) {\n\t\t\t\t\t\topts.disabledFlip = self.arrayFlip(opts.disabled, true);\n\t\t\t\t\t\t$.each(self.options.disabledCmdsRels, function(com, rels) {\n\t\t\t\t\t\t\tvar m, flg;\n\t\t\t\t\t\t\tif (opts.disabledFlip[com]) {\n\t\t\t\t\t\t\t\tflg = true;\n\t\t\t\t\t\t\t} else if (m = com.match(/^([^&]+)&([^=]+)=(.*)$/)) {\n\t\t\t\t\t\t\t\tif (opts.disabledFlip[m[1]] && opts[m[2]] == m[3]) {\n\t\t\t\t\t\t\t\t\tflg = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (flg) {\n\t\t\t\t\t\t\t\t$.each(rels, function(i, rel) {\n\t\t\t\t\t\t\t\t\tif (!opts.disabledFlip[rel]) {\n\t\t\t\t\t\t\t\t\t\topts.disabledFlip[rel] = true;\n\t\t\t\t\t\t\t\t\t\topts.disabled.push(rel);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\topts.disabledFlip = {};\n\t\t\t\t\t}\n\t\t\t\t\treturn opts;\n\t\t\t\t},\n\t\t\t\tfilter = function(file, asMap, type) { \n\t\t\t\t\tvar res = asMap? file : true,\n\t\t\t\t\t\tign = asMap? null : false,\n\t\t\t\t\t\tvid, targetOptions, isRoot, rootNames;\n\t\t\t\t\t\n\t\t\t\t\tif (file && file.hash && file.name && file.mime) {\n\t\t\t\t\t\tif (file.mime === 'application/x-empty') {\n\t\t\t\t\t\t\tfile.mime = 'text/plain';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tisRoot = self.isRoot(file);\n\t\t\t\t\t\tif (isRoot && ! file.volumeid) {\n\t\t\t\t\t\t\tself.debug('warning', 'The volume root statuses requires `volumeid` property.');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isRoot || file.mime === 'directory') {\n\t\t\t\t\t\t\t// Prevention of circular reference\n\t\t\t\t\t\t\tif (file.phash) {\n\t\t\t\t\t\t\t\tif (file.phash === file.hash) {\n\t\t\t\t\t\t\t\t\terror = error.concat(['Parent folder of \"$1\" is itself.', file.name]);\n\t\t\t\t\t\t\t\t\treturn ign;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (isRoot && file.volumeid && file.phash.indexOf(file.volumeid) === 0) {\n\t\t\t\t\t\t\t\t\terror = error.concat(['Parent folder of \"$1\" is inner itself.', file.name]);\n\t\t\t\t\t\t\t\t\treturn ign;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// set options, tmbUrls for each volume\n\t\t\t\t\t\t\tif (file.volumeid) {\n\t\t\t\t\t\t\t\tvid = file.volumeid;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\t\t\t// make or update of leaf roots cache\n\t\t\t\t\t\t\t\t\tif (file.phash) {\n\t\t\t\t\t\t\t\t\t\tif (! self.leafRoots[file.phash]) {\n\t\t\t\t\t\t\t\t\t\t\tself.leafRoots[file.phash] = [ file.hash ];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tif ($.inArray(file.hash, self.leafRoots[file.phash]) === -1) {\n\t\t\t\t\t\t\t\t\t\t\t\tself.leafRoots[file.phash].push(file.hash);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tself.hasVolOptions = true;\n\t\t\t\t\t\t\t\t\tif (! self.volOptions[vid]) {\n\t\t\t\t\t\t\t\t\t\tself.volOptions[vid] = {\n\t\t\t\t\t\t\t\t\t\t\t// set dispInlineRegex\n\t\t\t\t\t\t\t\t\t\t\tdispInlineRegex: self.options.dispInlineRegex\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\ttargetOptions = self.volOptions[vid];\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (file.options) {\n\t\t\t\t\t\t\t\t\t\t// >= v.2.1.14 has file.options\n\t\t\t\t\t\t\t\t\t\tObject.assign(targetOptions, file.options);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// for compat <= v2.1.13\n\t\t\t\t\t\t\t\t\tif (file.disabled) {\n\t\t\t\t\t\t\t\t\t\ttargetOptions.disabled = file.disabled;\n\t\t\t\t\t\t\t\t\t\ttargetOptions.disabledFlip = self.arrayFlip(file.disabled, true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (file.tmbUrl) {\n\t\t\t\t\t\t\t\t\t\ttargetOptions.tmbUrl = file.tmbUrl;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// '/' required at the end of url\n\t\t\t\t\t\t\t\t\tif (targetOptions.url && targetOptions.url.substr(-1) !== '/') {\n\t\t\t\t\t\t\t\t\t\ttargetOptions.url += '/';\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// check uiCmdMap\n\t\t\t\t\t\t\t\t\tchkCmdMap(targetOptions);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// check trash bin hash\n\t\t\t\t\t\t\t\t\tif (targetOptions.trashHash) {\n\t\t\t\t\t\t\t\t\t\tif (self.trashes[targetOptions.trashHash] === false) {\n\t\t\t\t\t\t\t\t\t\t\tdelete targetOptions.trashHash;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tself.trashes[targetOptions.trashHash] = file.hash;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// set immediate properties\n\t\t\t\t\t\t\t\t\t$.each(self.optionProperties, function(k) {\n\t\t\t\t\t\t\t\t\t\tif (targetOptions[k]) {\n\t\t\t\t\t\t\t\t\t\t\tfile[k] = targetOptions[k];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t// regist fm.roots\n\t\t\t\t\t\t\t\t\tif (type !== 'cwd') {\n\t\t\t\t\t\t\t\t\t\tself.roots[vid] = file.hash;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// regist fm.volumeExpires\n\t\t\t\t\t\t\t\t\tif (file.expires) {\n\t\t\t\t\t\t\t\t\t\tself.volumeExpires[vid] = file.expires;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (prevId !== vid) {\n\t\t\t\t\t\t\t\t\tprevId = vid;\n\t\t\t\t\t\t\t\t\ti18nFolderName = self.option('i18nFolderName', vid);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// volume root i18n name\n\t\t\t\t\t\t\tif (isRoot && ! file.i18) {\n\t\t\t\t\t\t\t\tname = 'volume_' + file.name,\n\t\t\t\t\t\t\t\ti18 = self.i18n(false, name);\n\t\t\n\t\t\t\t\t\t\t\tif (name !== i18) {\n\t\t\t\t\t\t\t\t\tfile.i18 = i18;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// i18nFolderName\n\t\t\t\t\t\t\tif (i18nFolderName && ! file.i18) {\n\t\t\t\t\t\t\t\tname = 'folder_' + file.name,\n\t\t\t\t\t\t\t\ti18 = self.i18n(false, name);\n\t\t\n\t\t\t\t\t\t\t\tif (name !== i18) {\n\t\t\t\t\t\t\t\t\tfile.i18 = i18;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\t\tif (rootNames = self.storage('rootNames')) {\n\t\t\t\t\t\t\t\t\tif (rootNames[file.hash]) {\n\t\t\t\t\t\t\t\t\t\tfile._name = file.name;\n\t\t\t\t\t\t\t\t\t\tfile._i18 = file.i18;\n\t\t\t\t\t\t\t\t\t\tfile.name = rootNames[file.hash] = rootNames[file.hash];\n\t\t\t\t\t\t\t\t\t\tdelete file.i18;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tself.storage('rootNames', rootNames);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// lock trash bins holder\n\t\t\t\t\t\t\tif (self.trashes[file.hash]) {\n\t\t\t\t\t\t\t\tfile.locked = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (fileFilter) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tif (! fileFilter(file)) {\n\t\t\t\t\t\t\t\t\t\treturn ign;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\tself.debug(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (file.size == 0) {\n\t\t\t\t\t\t\t\tfile.mime = self.getMimetype(file.name, file.mime);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (file.options) {\n\t\t\t\t\t\t\tself.optionsByHashes[file.hash] = normalizeOptions(file.options);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdelete file.options;\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t}\n\t\t\t\t\treturn ign;\n\t\t\t\t},\n\t\t\t\tgetDescendants = function(hashes) {\n\t\t\t\t\tvar res = [];\n\t\t\t\t\t$.each(self.files(), function(h, f) {\n\t\t\t\t\t\t$.each(self.parents(h), function(i, ph) {\n\t\t\t\t\t\t\tif ($.inArray(ph, hashes) !== -1 && $.inArray(h, hashes) === -1) {\n\t\t\t\t\t\t\t\tres.push(h);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\treturn res;\n\t\t\t\t},\n\t\t\t\tapplyLeafRootStats = function(dataArr, type) {\n\t\t\t\t\t$.each(dataArr, function(i, f) {\n\t\t\t\t\t\tvar pfile, done;\n\t\t\t\t\t\tif (self.leafRoots[f.hash]) {\n\t\t\t\t\t\t\tself.applyLeafRootStats(f);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// update leaf root parent stat\n\t\t\t\t\t\tif (type !== 'change' && f.phash && self.isRoot(f) && (pfile = self.file(f.phash))) {\n\t\t\t\t\t\t\tself.applyLeafRootStats(pfile);\n\t\t\t\t\t\t\t// add to data.changed\n\t\t\t\t\t\t\tif (!data.changed) {\n\t\t\t\t\t\t\t\tdata.changed = [pfile];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$.each(data.changed, function(i, f) {\n\t\t\t\t\t\t\t\t\tif (f.hash === pfile.hash) {\n\t\t\t\t\t\t\t\t\t\tdata.changed[i] = pfile;\n\t\t\t\t\t\t\t\t\t\tdone = true;\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (!done) {\n\t\t\t\t\t\t\t\t\tdata.changed.push(pfile);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\terror = [],\n\t\t\t\tname, i18, i18nFolderName, prevId, cData;\n\t\t\t\n\t\t\t// set cunstom data\n\t\t\tif (data.customData && (!self.prevCustomData || (JSON.stringify(data.customData) !== JSON.stringify(self.prevCustomData)))) {\n\t\t\t\tself.prevCustomData = data.customData;\n\t\t\t\ttry {\n\t\t\t\t\tcData = JSON.parse(data.customData);\n\t\t\t\t\tif ($.isPlainObject(cData)) {\n\t\t\t\t\t\tself.prevCustomData = cData;\n\t\t\t\t\t\t$.each(Object.keys(cData), function(i, key) {\n\t\t\t\t\t\t\tif (cData[key] === null) {\n\t\t\t\t\t\t\t\tdelete cData[key];\n\t\t\t\t\t\t\t\tdelete self.optsCustomData[key];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.customData = Object.assign({}, self.optsCustomData, cData);\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t\tif (data.options) {\n\t\t\t\tnormalizeOptions(data.options);\n\t\t\t}\n\t\t\t\n\t\t\tif (data.cwd) {\n\t\t\t\tif (data.cwd.volumeid && data.options && Object.keys(data.options).length && self.isRoot(data.cwd)) {\n\t\t\t\t\tself.hasVolOptions = true;\n\t\t\t\t\tself.volOptions[data.cwd.volumeid] = data.options;\n\t\t\t\t}\n\t\t\t\tdata.cwd = filter(data.cwd, true, 'cwd');\n\t\t\t}\n\t\t\tif (data.files) {\n\t\t\t\tdata.files = $.grep(data.files, filter);\n\t\t\t} \n\t\t\tif (data.tree) {\n\t\t\t\tdata.tree = $.grep(data.tree, filter);\n\t\t\t}\n\t\t\tif (data.added) {\n\t\t\t\tdata.added = $.grep(data.added, filter);\n\t\t\t}\n\t\t\tif (data.changed) {\n\t\t\t\tdata.changed = $.grep(data.changed, filter);\n\t\t\t}\n\t\t\tif (data.removed && data.removed.length && self.searchStatus.state === 2) {\n\t\t\t\tdata.removed = data.removed.concat(getDescendants(data.removed));\n\t\t\t}\n\t\t\tif (data.api) {\n\t\t\t\tdata.init = true;\n\t\t\t}\n\n\t\t\tif (Object.keys(self.leafRoots).length) {\n\t\t\t\tdata.files && applyLeafRootStats(data.files);\n\t\t\t\tdata.tree && applyLeafRootStats(data.tree);\n\t\t\t\tdata.added && applyLeafRootStats(data.added);\n\t\t\t\tdata.changed && applyLeafRootStats(data.changed, 'change');\n\t\t\t}\n\n\t\t\t// merge options that apply only to cwd\n\t\t\tif (data.cwd && data.cwd.options && data.options) {\n\t\t\t\tObject.assign(data.options, normalizeOptions(data.cwd.options));\n\t\t\t}\n\n\t\t\t// '/' required at the end of url\n\t\t\tif (data.options && data.options.url && data.options.url.substr(-1) !== '/') {\n\t\t\t\tdata.options.url += '/';\n\t\t\t}\n\t\t\t\n\t\t\t// check error\n\t\t\tif (error.length) {\n\t\t\t\tdata.norError = ['errResponse'].concat(error);\n\t\t\t}\n\t\t\t\n\t\t\treturn data;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Update sort options\n\t\t *\n\t\t * @param {String} sort type\n\t\t * @param {String} sort order\n\t\t * @param {Boolean} show folder first\n\t\t */\n\t\tsetSort : function(type, order, stickFolders, alsoTreeview) {\n\t\t\tthis.storage('sortType', (this.sortType = this.sortRules[type] ? type : 'name'));\n\t\t\tthis.storage('sortOrder', (this.sortOrder = /asc|desc/.test(order) ? order : 'asc'));\n\t\t\tthis.storage('sortStickFolders', (this.sortStickFolders = !!stickFolders) ? 1 : '');\n\t\t\tthis.storage('sortAlsoTreeview', (this.sortAlsoTreeview = !!alsoTreeview) ? 1 : '');\n\t\t\tthis.trigger('sortchange');\n\t\t},\n\t\t\n\t\t_sortRules : {\n\t\t\tname : function(file1, file2) {\n\t\t\t\treturn elFinder.prototype.naturalCompare(file1.i18 || file1.name, file2.i18 || file2.name);\n\t\t\t},\n\t\t\tsize : function(file1, file2) { \n\t\t\t\tvar size1 = parseInt(file1.size) || 0,\n\t\t\t\t\tsize2 = parseInt(file2.size) || 0;\n\t\t\t\t\t\n\t\t\t\treturn size1 === size2 ? 0 : size1 > size2 ? 1 : -1;\n\t\t\t},\n\t\t\tkind : function(file1, file2) {\n\t\t\t\treturn elFinder.prototype.naturalCompare(file1.mime, file2.mime);\n\t\t\t},\n\t\t\tdate : function(file1, file2) { \n\t\t\t\tvar date1 = file1.ts || file1.date || 0,\n\t\t\t\t\tdate2 = file2.ts || file2.date || 0;\n\n\t\t\t\treturn date1 === date2 ? 0 : date1 > date2 ? 1 : -1;\n\t\t\t},\n\t\t\tperm : function(file1, file2) { \n\t\t\t\tvar val = function(file) { return (file.write? 2 : 0) + (file.read? 1 : 0); },\n\t\t\t\t\tv1  = val(file1),\n\t\t\t\t\tv2  = val(file2);\n\t\t\t\treturn v1 === v2 ? 0 : v1 > v2 ? 1 : -1;\n\t\t\t},\n\t\t\tmode : function(file1, file2) { \n\t\t\t\tvar v1 = file1.mode || (file1.perm || ''),\n\t\t\t\t\tv2 = file2.mode || (file2.perm || '');\n\t\t\t\treturn elFinder.prototype.naturalCompare(v1, v2);\n\t\t\t},\n\t\t\towner : function(file1, file2) { \n\t\t\t\tvar v1 = file1.owner || '',\n\t\t\t\t\tv2 = file2.owner || '';\n\t\t\t\treturn elFinder.prototype.naturalCompare(v1, v2);\n\t\t\t},\n\t\t\tgroup : function(file1, file2) { \n\t\t\t\tvar v1 = file1.group || '',\n\t\t\t\t\tv2 = file2.group || '';\n\t\t\t\treturn elFinder.prototype.naturalCompare(v1, v2);\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Valid sort rule names\n\t\t * \n\t\t * @type Object\n\t\t */\n\t\tsorters : {},\n\t\t\n\t\t/**\n\t\t * Compare strings for natural sort\n\t\t *\n\t\t * @param  String\n\t\t * @param  String\n\t\t * @return Number\n\t\t */\n\t\tnaturalCompare : function(a, b) {\n\t\t\tvar self = elFinder.prototype.naturalCompare;\n\t\t\tif (typeof self.loc == 'undefined') {\n\t\t\t\tself.loc = (navigator.userLanguage || navigator.browserLanguage || navigator.language || 'en-US');\n\t\t\t}\n\t\t\tif (typeof self.sort == 'undefined') {\n\t\t\t\tif ('11'.localeCompare('2', self.loc, {numeric: true}) > 0) {\n\t\t\t\t\t// Native support\n\t\t\t\t\tif (window.Intl && window.Intl.Collator) {\n\t\t\t\t\t\tself.sort = new Intl.Collator(self.loc, {numeric: true}).compare;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.sort = function(a, b) {\n\t\t\t\t\t\t\treturn a.localeCompare(b, self.loc, {numeric: true});\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t/*\n\t\t\t\t\t * Edited for elFinder (emulates localeCompare() by numeric) by Naoki Sawada aka nao-pon\n\t\t\t\t\t */\n\t\t\t\t\t/*\n\t\t\t\t\t * Huddle/javascript-natural-sort (https://github.com/Huddle/javascript-natural-sort)\n\t\t\t\t\t */\n\t\t\t\t\t/*\n\t\t\t\t\t * Natural Sort algorithm for Javascript - Version 0.7 - Released under MIT license\n\t\t\t\t\t * Author: Jim Palmer (based on chunking idea from Dave Koelle)\n\t\t\t\t\t * http://opensource.org/licenses/mit-license.php\n\t\t\t\t\t */\n\t\t\t\t\tself.sort = function(a, b) {\n\t\t\t\t\t\tvar re = /(^-?[0-9]+(\\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,\n\t\t\t\t\t\tsre = /(^[ ]*|[ ]*$)/g,\n\t\t\t\t\t\tdre = /(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[\\/\\-]\\d{1,4}[\\/\\-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/,\n\t\t\t\t\t\thre = /^0x[0-9a-f]+$/i,\n\t\t\t\t\t\tore = /^0/,\n\t\t\t\t\t\tsyre = /^[\\x01\\x21-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7e]/, // symbol first - (Naoki Sawada)\n\t\t\t\t\t\ti = function(s) { return self.sort.insensitive && (''+s).toLowerCase() || ''+s; },\n\t\t\t\t\t\t// convert all to strings strip whitespace\n\t\t\t\t\t\t// first character is \"_\", it's smallest - (Naoki Sawada)\n\t\t\t\t\t\tx = i(a).replace(sre, '').replace(/^_/, \"\\x01\") || '',\n\t\t\t\t\t\ty = i(b).replace(sre, '').replace(/^_/, \"\\x01\") || '',\n\t\t\t\t\t\t// chunk/tokenize\n\t\t\t\t\t\txN = x.replace(re, '\\0$1\\0').replace(/\\0$/,'').replace(/^\\0/,'').split('\\0'),\n\t\t\t\t\t\tyN = y.replace(re, '\\0$1\\0').replace(/\\0$/,'').replace(/^\\0/,'').split('\\0'),\n\t\t\t\t\t\t// numeric, hex or date detection\n\t\t\t\t\t\txD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x)),\n\t\t\t\t\t\tyD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null,\n\t\t\t\t\t\toFxNcL, oFyNcL,\n\t\t\t\t\t\tlocRes = 0;\n\n\t\t\t\t\t\t// first try and sort Hex codes or Dates\n\t\t\t\t\t\tif (yD) {\n\t\t\t\t\t\t\tif ( xD < yD ) return -1;\n\t\t\t\t\t\t\telse if ( xD > yD ) return 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// natural sorting through split numeric strings and default strings\n\t\t\t\t\t\tfor(var cLoc=0, numS=Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {\n\n\t\t\t\t\t\t\t// find floats not starting with '0', string or 0 if not defined (Clint Priest)\n\t\t\t\t\t\t\toFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;\n\t\t\t\t\t\t\toFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;\n\n\t\t\t\t\t\t\t// handle numeric vs string comparison - number < string - (Kyle Adams)\n\t\t\t\t\t\t\t// but symbol first < number - (Naoki Sawada)\n\t\t\t\t\t\t\tif (isNaN(oFxNcL) !== isNaN(oFyNcL)) {\n\t\t\t\t\t\t\t\tif (isNaN(oFxNcL) && (typeof oFxNcL !== 'string' || ! oFxNcL.match(syre))) {\n\t\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t\t} else if (typeof oFyNcL !== 'string' || ! oFyNcL.match(syre)) {\n\t\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// use decimal number comparison if either value is string zero\n\t\t\t\t\t\t\tif (parseInt(oFxNcL, 10) === 0) oFxNcL = 0;\n\t\t\t\t\t\t\tif (parseInt(oFyNcL, 10) === 0) oFyNcL = 0;\n\n\t\t\t\t\t\t\t// rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'\n\t\t\t\t\t\t\tif (typeof oFxNcL !== typeof oFyNcL) {\n\t\t\t\t\t\t\t\toFxNcL += '';\n\t\t\t\t\t\t\t\toFyNcL += '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// use locale sensitive sort for strings when case insensitive\n\t\t\t\t\t\t\t// note: localeCompare interleaves uppercase with lowercase (e.g. A,a,B,b)\n\t\t\t\t\t\t\tif (self.sort.insensitive && typeof oFxNcL === 'string' && typeof oFyNcL === 'string') {\n\t\t\t\t\t\t\t\tlocRes = oFxNcL.localeCompare(oFyNcL, self.loc);\n\t\t\t\t\t\t\t\tif (locRes !== 0) return locRes;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (oFxNcL < oFyNcL) return -1;\n\t\t\t\t\t\t\tif (oFxNcL > oFyNcL) return 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t};\n\t\t\t\t\tself.sort.insensitive = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn self.sort(a, b);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Compare files based on elFinder.sort\n\t\t *\n\t\t * @param  Object  file\n\t\t * @param  Object  file\n\t\t * @return Number\n\t\t */\n\t\tcompare : function(file1, file2) {\n\t\t\tvar self  = this,\n\t\t\t\ttype  = self.sortType,\n\t\t\t\tasc   = self.sortOrder == 'asc',\n\t\t\t\tstick = self.sortStickFolders,\n\t\t\t\trules = self.sortRules,\n\t\t\t\tsort  = rules[type],\n\t\t\t\td1    = file1.mime == 'directory',\n\t\t\t\td2    = file2.mime == 'directory',\n\t\t\t\tres;\n\t\t\t\t\n\t\t\tif (stick) {\n\t\t\t\tif (d1 && !d2) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if (!d1 && d2) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tres = asc ? sort(file1, file2) : sort(file2, file1);\n\t\t\t\n\t\t\treturn type !== 'name' && res === 0\n\t\t\t\t? res = asc ? rules.name(file1, file2) : rules.name(file2, file1)\n\t\t\t\t: res;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Sort files based on config\n\t\t *\n\t\t * @param  Array  files\n\t\t * @return Array\n\t\t */\n\t\tsortFiles : function(files) {\n\t\t\treturn files.sort(this.compare);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Open notification dialog \n\t\t * and append/update message for required notification type.\n\t\t *\n\t\t * @param  Object  options\n\t\t * @example  \n\t\t * this.notify({\n\t\t *    type : 'copy',\n\t\t *    msg : 'Copy files', // not required for known types @see this.notifyType\n\t\t *    cnt : 3,\n\t\t *    hideCnt  : false,   // true for not show count\n\t\t *    progress : 10,      // progress bar percents (use cnt : 0 to update progress bar)\n\t\t *    cancel   : callback // callback function for cancel button\n\t\t * })\n\t\t * @return elFinder\n\t\t */\n\t\tnotify : function(opts) {\n\t\t\tvar self     = this,\n\t\t\t\ttype     = opts.type,\n\t\t\t\tid       = opts.id? 'elfinder-notify-'+opts.id : '',\n\t\t\t\tmsg      = this.i18n((typeof opts.msg !== 'undefined')? opts.msg : (this.messages['ntf'+type] ? 'ntf'+type : 'ntfsmth')),\n\t\t\t\thiddens  = this.arrayFlip(this.options.notifyDialog.hiddens || []),\n\t\t\t\tndialog  = this.ui.notify,\n\t\t\t\tdialog   = ndialog.closest('.ui-dialog'),\n\t\t\t\tnotify   = ndialog.children('.elfinder-notify-'+type+(id? ('.'+id) : '')),\n\t\t\t\tbutton   = notify.children('div.elfinder-notify-cancel').children('button'),\n\t\t\t\tntpl     = '<div class=\"elfinder-notify elfinder-notify-{type}'+(id? (' '+id) : '')+'\"><span class=\"elfinder-dialog-icon elfinder-dialog-icon-{type}\"/><span class=\"elfinder-notify-msg\">{msg}</span> <span class=\"elfinder-notify-cnt\"/><div class=\"elfinder-notify-progressbar\"><div class=\"elfinder-notify-progress\"/></div><div class=\"elfinder-notify-cancel\"/></div>',\n\t\t\t\tdelta    = opts.cnt + 0,\n\t\t\t\tsize     = (typeof opts.size != 'undefined')? parseInt(opts.size) : null,\n\t\t\t\tprogress = (typeof opts.progress != 'undefined' && opts.progress >= 0) ? opts.progress : null,\n\t\t\t\tfakeint  = opts.fakeinterval || 200,\n\t\t\t\tcancel   = opts.cancel,\n\t\t\t\tclhover  = 'ui-state-hover',\n\t\t\t\tclose    = function() {\n\t\t\t\t\tvar prog = notify.find('.elfinder-notify-progress'),\n\t\t\t\t\t\trm = function() {\n\t\t\t\t\t\t\tnotify.remove();\n\t\t\t\t\t\t\tif (!ndialog.children(dialog.data('minimized')? void(0) : ':visible').length) {\n\t\t\t\t\t\t\t\tif (dialog.data('minimized')) {\n\t\t\t\t\t\t\t\t\tdialog.data('minimized').hide();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tndialog.elfinderdialog('close');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetProgressbar();\n\t\t\t\t\t\t};\n\t\t\t\t\tnotify._esc && $(document).off('keydown', notify._esc);\n\t\t\t\t\tif (notify.data('cur') < 100) {\n\t\t\t\t\t\tprog.animate({\n\t\t\t\t\t\t\twidth : '100%'\n\t\t\t\t\t\t}, 50, function() { requestAnimationFrame(function() { rm(); }); });\n\t\t\t\t\t} else {\n\t\t\t\t\t\trm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfakeUp = function(interval) {\n\t\t\t\t\tvar cur;\n\t\t\t\t\tif (notify.length) {\n\t\t\t\t\t\tcur = notify.data('cur') + 1;\n\t\t\t\t\t\tif (cur <= 98) {\n\t\t\t\t\t\t\tnotify.find('.elfinder-notify-progress').width(cur + '%');\n\t\t\t\t\t\t\tnotify.data('cur', cur);\n\t\t\t\t\t\t\tsetProgressbar();\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tinterval *= 1.05; \n\t\t\t\t\t\t\t\tfakeUp(interval);\n\t\t\t\t\t\t\t}, interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetProgressbar = function() {\n\t\t\t\t\tvar cnt = 0,\n\t\t\t\t\t\tval = 0,\n\t\t\t\t\t\tntfs = ndialog.children('.elfinder-notify'),\n\t\t\t\t\t\tw;\n\t\t\t\t\tif (ntfs.length) {\n\t\t\t\t\t\tntfs.each(function() {\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\tval += Math.min($(this).data('cur'), 100);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tw = cnt? Math.floor(val / (cnt * 100) * 100) + '%' : 0;\n\t\t\t\t\t\tself.ui.progressbar.width(w);\n\t\t\t\t\t\tif (dialog.data('minimized')) {\n\t\t\t\t\t\t\tdialog.data('minimized').title(w);\n\t\t\t\t\t\t\tdialog.data('minimized').dialog().children('.ui-dialog-titlebar').children('.elfinder-ui-progressbar').width(w);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.ui.progressbar.width(0);\n\t\t\t\t\t\tdialog.data('minimized') && dialog.data('minimized').hide();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcnt, total, prc;\n\n\t\t\tif (!type) {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\t\n\t\t\tif (!notify.length) {\n\t\t\t\tnotify = $(ntpl.replace(/\\{type\\}/g, type).replace(/\\{msg\\}/g, msg));\n\t\t\t\tif (hiddens[type]) {\n\t\t\t\t\tnotify.hide();\n\t\t\t\t} else {\n\t\t\t\t\tndialog.on('minimize', function(e) {\n\t\t\t\t\t\tdialog.data('minimized') && setProgressbar();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tnotify.appendTo(ndialog).data('cnt', 0);\n\n\t\t\t\tif (progress != null) {\n\t\t\t\t\tnotify.data({progress : 0, total : 0, cur : 0});\n\t\t\t\t} else {\n\t\t\t\t\tnotify.data({cur : 0});\n\t\t\t\t\tfakeUp(fakeint);\n\t\t\t\t}\n\n\t\t\t\tif (cancel) {\n\t\t\t\t\tbutton = $('<span class=\"elfinder-notify-button ui-icon ui-icon-close\" title=\"'+this.i18n('btnCancel')+'\"/>')\n\t\t\t\t\t\t.on('mouseenter mouseleave', function(e) { \n\t\t\t\t\t\t\t$(this).toggleClass(clhover, e.type === 'mouseenter');\n\t\t\t\t\t\t});\n\t\t\t\t\tnotify.children('div.elfinder-notify-cancel').append(button);\n\t\t\t\t}\n\t\t\t\tndialog.trigger('resize');\n\t\t\t} else if (typeof opts.msg !== 'undefined') {\n\t\t\t\tnotify.children('span.elfinder-notify-msg').html(msg);\n\t\t\t}\n\n\t\t\tcnt = delta + parseInt(notify.data('cnt'));\n\t\t\t\n\t\t\tif (cnt > 0) {\n\t\t\t\tif (cancel && button.length) {\n\t\t\t\t\tif ($.isFunction(cancel) || (typeof cancel === 'object' && cancel.promise)) {\n\t\t\t\t\t\tnotify._esc = function(e) {\n\t\t\t\t\t\t\tif (e.type == 'keydown' && e.keyCode != $.ui.keyCode.ESCAPE) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tclose();\n\t\t\t\t\t\t\tif (cancel.promise) {\n\t\t\t\t\t\t\t\tcancel.reject(0); // 0 is canceling flag\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcancel(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbutton.on('click', function(e) {\n\t\t\t\t\t\t\tnotify._esc(e);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$(document).on('keydown.' + this.namespace, notify._esc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t!opts.hideCnt && notify.children('.elfinder-notify-cnt').text('('+cnt+')');\n\t\t\t\tif (delta > 0 && ndialog.is(':hidden') && !hiddens[type]) {\n\t\t\t\t\tif (dialog.data('minimized')) {\n\t\t\t\t\t\tdialog.data('minimized').show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tndialog.elfinderdialog('open', this).height('auto');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnotify.data('cnt', cnt);\n\t\t\t\t\n\t\t\t\tif ((progress != null)\n\t\t\t\t&& (total = notify.data('total')) >= 0\n\t\t\t\t&& (prc = notify.data('progress')) >= 0) {\n\n\t\t\t\t\ttotal += size != null? size : delta;\n\t\t\t\t\tprc   += progress;\n\t\t\t\t\t(size == null && delta < 0) && (prc += delta * 100);\n\t\t\t\t\tnotify.data({progress : prc, total : total});\n\t\t\t\t\tif (size != null) {\n\t\t\t\t\t\tprc *= 100;\n\t\t\t\t\t\ttotal = Math.max(1, total);\n\t\t\t\t\t}\n\t\t\t\t\tprogress = Math.min(parseInt(prc/total), 100);\n\t\t\t\t\t\n\t\t\t\t\tnotify.find('.elfinder-notify-progress')\n\t\t\t\t\t\t.animate({\n\t\t\t\t\t\t\twidth : (progress < 100 ? progress : 100)+'%'\n\t\t\t\t\t\t}, 20, function() {\n\t\t\t\t\t\t\tnotify.data('cur', progress);\n\t\t\t\t\t\t\tsetProgressbar();\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tclose();\n\t\t\t}\n\t\t\t\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Open confirmation dialog \n\t\t *\n\t\t * @param  Object  options\n\t\t * @example  \n\t\t * this.confirm({\n\t\t *    cssClass : 'elfinder-confirm-mydialog',\n\t\t *    title : 'Remove files',\n\t\t *    text  : 'Here is question text',\n\t\t *    accept : {  // accept callback - required\n\t\t *      label : 'Continue',\n\t\t *      callback : function(applyToAll) { fm.log('Ok') }\n\t\t *    },\n\t\t *    cancel : { // cancel callback - required\n\t\t *      label : 'Cancel',\n\t\t *      callback : function() { fm.log('Cancel')}\n\t\t *    },\n\t\t *    reject : { // reject callback - optionally\n\t\t *      label : 'No',\n\t\t *      callback : function(applyToAll) { fm.log('No')}\n\t\t *    },\n\t\t *    buttons : [ // additional buttons callback - optionally\n\t\t *      {\n\t\t *        label : 'Btn1',\n\t\t *        callback : function(applyToAll) { fm.log('Btn1')}\n\t\t *      }\n\t\t *    ],\n\t\t *    all : true  // display checkbox \"Apply to all\"\n\t\t * })\n\t\t * @return elFinder\n\t\t */\n\t\tconfirm : function(opts) {\n\t\t\tvar self     = this,\n\t\t\t\tcomplete = false,\n\t\t\t\toptions = {\n\t\t\t\t\tcssClass  : 'elfinder-dialog-confirm',\n\t\t\t\t\tmodal     : true,\n\t\t\t\t\tresizable : false,\n\t\t\t\t\ttitle     : this.i18n(opts.title || 'confirmReq'),\n\t\t\t\t\tbuttons   : {},\n\t\t\t\t\tclose     : function() { \n\t\t\t\t\t\t!complete && opts.cancel.callback();\n\t\t\t\t\t\t$(this).elfinderdialog('destroy');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tapply = this.i18n('apllyAll'),\n\t\t\t\tlabel, checkbox, btnNum;\n\n\t\t\tif (opts.cssClass) {\n\t\t\t\toptions.cssClass += ' ' + opts.cssClass;\n\t\t\t}\n\t\t\toptions.buttons[this.i18n(opts.accept.label)] = function() {\n\t\t\t\topts.accept.callback(!!(checkbox && checkbox.prop('checked')));\n\t\t\t\tcomplete = true;\n\t\t\t\t$(this).elfinderdialog('close');\n\t\t\t};\n\t\t\toptions.buttons[this.i18n(opts.accept.label)]._cssClass = 'elfinder-confirm-accept';\n\t\t\t\n\t\t\tif (opts.reject) {\n\t\t\t\toptions.buttons[this.i18n(opts.reject.label)] = function() {\n\t\t\t\t\topts.reject.callback(!!(checkbox && checkbox.prop('checked')));\n\t\t\t\t\tcomplete = true;\n\t\t\t\t\t$(this).elfinderdialog('close');\n\t\t\t\t};\n\t\t\t\toptions.buttons[this.i18n(opts.reject.label)]._cssClass = 'elfinder-confirm-reject';\n\t\t\t}\n\t\t\t\n\t\t\tif (opts.buttons && opts.buttons.length > 0) {\n\t\t\t\tbtnNum = 1;\n\t\t\t\t$.each(opts.buttons, function(i, v){\n\t\t\t\t\toptions.buttons[self.i18n(v.label)] = function() {\n\t\t\t\t\t\tv.callback(!!(checkbox && checkbox.prop('checked')));\n\t\t\t\t\t\tcomplete = true;\n\t\t\t\t\t\t$(this).elfinderdialog('close');\n\t\t\t\t\t};\n\t\t\t\t\toptions.buttons[self.i18n(v.label)]._cssClass = 'elfinder-confirm-extbtn' + (btnNum++);\n\t\t\t\t\tif (v.cssClass) {\n\t\t\t\t\t\toptions.buttons[self.i18n(v.label)]._cssClass += ' ' + v.cssClass;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\toptions.buttons[this.i18n(opts.cancel.label)] = function() {\n\t\t\t\t$(this).elfinderdialog('close');\n\t\t\t};\n\t\t\toptions.buttons[this.i18n(opts.cancel.label)]._cssClass = 'elfinder-confirm-cancel';\n\t\t\t\n\t\t\tif (opts.all) {\n\t\t\t\toptions.create = function() {\n\t\t\t\t\tvar base = $('<div class=\"elfinder-dialog-confirm-applyall\"/>');\n\t\t\t\t\tcheckbox = $('<input type=\"checkbox\" />');\n\t\t\t\t\t$(this).next().find('.ui-dialog-buttonset')\n\t\t\t\t\t\t.prepend(base.append($('<label>'+apply+'</label>').prepend(checkbox)));\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tif (opts.optionsCallback && $.isFunction(opts.optionsCallback)) {\n\t\t\t\topts.optionsCallback(options);\n\t\t\t}\n\t\t\t\n\t\t\treturn this.dialog('<span class=\"elfinder-dialog-icon elfinder-dialog-icon-confirm\"/>' + this.i18n(opts.text), options);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Create unique file name in required dir\n\t\t * \n\t\t * @param  String  file name\n\t\t * @param  String  parent dir hash\n\t\t * @param  String  glue\n\t\t * @return String\n\t\t */\n\t\tuniqueName : function(prefix, phash, glue) {\n\t\t\tvar i = 0, ext = '', p, name;\n\t\t\t\n\t\t\tprefix = this.i18n(false, prefix);\n\t\t\tphash = phash || this.cwd().hash;\n\t\t\tglue = (typeof glue === 'undefined')? ' ' : glue;\n\n\t\t\tif (p = prefix.match(/^(.+)(\\.[^.]+)$/)) {\n\t\t\t\text    = p[2];\n\t\t\t\tprefix = p[1];\n\t\t\t}\n\t\t\t\n\t\t\tname   = prefix+ext;\n\t\t\t\n\t\t\tif (!this.fileByName(name, phash)) {\n\t\t\t\treturn name;\n\t\t\t}\n\t\t\twhile (i < 10000) {\n\t\t\t\tname = prefix + glue + (++i) + ext;\n\t\t\t\tif (!this.fileByName(name, phash)) {\n\t\t\t\t\treturn name;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn prefix + Math.random() + ext;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return message translated onto current language\n\t\t * Allowed accept HTML element that was wrapped in jQuery object\n\t\t * To be careful to XSS vulnerability of HTML element Ex. You should use `fm.escape(file.name)`\n\t\t *\n\t\t * @param  String|Array  message[s]|Object jQuery\n\t\t * @return String\n\t\t **/\n\t\ti18n : function() {\n\t\t\tvar self = this,\n\t\t\t\tmessages = this.messages, \n\t\t\t\tinput    = [],\n\t\t\t\tignore   = [], \n\t\t\t\tmessage = function(m) {\n\t\t\t\t\tvar file;\n\t\t\t\t\tif (m.indexOf('#') === 0) {\n\t\t\t\t\t\tif ((file = self.file(m.substr(1)))) {\n\t\t\t\t\t\t\treturn file.name;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn m;\n\t\t\t\t},\n\t\t\t\ti, j, m, escFunc, start = 0, isErr;\n\t\t\t\n\t\t\tif (arguments.length && arguments[0] === false) {\n\t\t\t\tescFunc = function(m){ return m; };\n\t\t\t\tstart = 1;\n\t\t\t}\n\t\t\tfor (i = start; i< arguments.length; i++) {\n\t\t\t\tm = arguments[i];\n\t\t\t\t\n\t\t\t\tif (Array.isArray(m)) {\n\t\t\t\t\tfor (j = 0; j < m.length; j++) {\n\t\t\t\t\t\tif (m[j] instanceof jQuery) {\n\t\t\t\t\t\t\t// jQuery object is HTML element\n\t\t\t\t\t\t\tinput.push(m[j]);\n\t\t\t\t\t\t} else if (typeof m[j] !== 'undefined'){\n\t\t\t\t\t\t\tinput.push(message('' + m[j]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (m instanceof jQuery) {\n\t\t\t\t\t// jQuery object is HTML element\n\t\t\t\t\tinput.push(m[j]);\n\t\t\t\t} else if (typeof m !== 'undefined'){\n\t\t\t\t\tinput.push(message('' + m));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (i = 0; i < input.length; i++) {\n\t\t\t\t// dont translate placeholders\n\t\t\t\tif ($.inArray(i, ignore) !== -1) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tm = input[i];\n\t\t\t\tif (typeof m == 'string') {\n\t\t\t\t\tisErr = !!(messages[m] && m.match(/^err/));\n\t\t\t\t\t// translate message\n\t\t\t\t\tm = messages[m] || (escFunc? escFunc(m) : self.escape(m));\n\t\t\t\t\t// replace placeholders in message\n\t\t\t\t\tm = m.replace(/\\$(\\d+)/g, function(match, placeholder) {\n\t\t\t\t\t\tvar res;\n\t\t\t\t\t\tplaceholder = i + parseInt(placeholder);\n\t\t\t\t\t\tif (placeholder > 0 && input[placeholder]) {\n\t\t\t\t\t\t\tignore.push(placeholder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tres = escFunc? escFunc(input[placeholder]) : self.escape(input[placeholder]);\n\t\t\t\t\t\tif (isErr) {\n\t\t\t\t\t\t\tres = '<span class=\"elfinder-err-var elfinder-err-var' + placeholder + '\">' + res + '</span>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// get HTML from jQuery object\n\t\t\t\t\tm = m.get(0).outerHTML;\n\t\t\t\t}\n\n\t\t\t\tinput[i] = m;\n\t\t\t}\n\n\t\t\treturn $.grep(input, function(m, i) { return $.inArray(i, ignore) === -1 ? true : false; }).join('<br>');\n\t\t},\n\t\t\n\t\t/**\n\t\t * Get icon style from file.icon\n\t\t * \n\t\t * @param  Object  elFinder file object\n\t\t * @return String|Object\n\t\t */\n\t\tgetIconStyle : function(file, asObject) {\n\t\t\tvar self = this,\n\t\t\t\ttemplate = {\n\t\t\t\t\t'background' : 'url(\\'{url}\\') 0 0 no-repeat',\n\t\t\t\t\t'background-size' : 'contain'\n\t\t\t\t},\n\t\t\t\tstyle = '',\n\t\t\t\tcssObj = {},\n\t\t\t\ti = 0;\n\t\t\tif (file.icon) {\n\t\t\t\tstyle = 'style=\"';\n\t\t\t\t$.each(template, function(k, v) {\n\t\t\t\t\tif (i++ === 0) {\n\t\t\t\t\t\tv = v.replace('{url}', self.escape(file.icon));\n\t\t\t\t\t}\n\t\t\t\t\tif (asObject) {\n\t\t\t\t\t\tcssObj[k] = v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle += k+':'+v+';';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tstyle += '\"';\n\t\t\t}\n\t\t\treturn asObject? cssObj : style;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Convert mimetype into css classes\n\t\t * \n\t\t * @param  String  file mimetype\n\t\t * @return String\n\t\t */\n\t\tmime2class : function(mimeType) {\n\t\t\tvar prefix = 'elfinder-cwd-icon-',\n\t\t\t\tmime   = mimeType.toLowerCase(),\n\t\t\t\tisText = this.textMimes[mime];\n\t\t\t\n\t\t\tmime = mime.split('/');\n\t\t\tif (isText) {\n\t\t\t\tmime[0] += ' ' + prefix + 'text';\n\t\t\t} else if (mime[1] && mime[1].match(/\\+xml$/)) {\n\t\t\t\tmime[0] += ' ' + prefix + 'xml';\n\t\t\t}\n\t\t\t\n\t\t\treturn prefix + mime[0] + (mime[1] ? ' ' + prefix + mime[1].replace(/(\\.|\\+)/g, '-') : '');\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return localized kind of file\n\t\t * \n\t\t * @param  Object|String  file or file mimetype\n\t\t * @return String\n\t\t */\n\t\tmime2kind : function(f) {\n\t\t\tvar isObj = typeof(f) == 'object' ? true : false,\n\t\t\t\tmime  = isObj ? f.mime : f,\n\t\t\t\tkind;\n\t\t\t\n\n\t\t\tif (isObj && f.alias && mime != 'symlink-broken') {\n\t\t\t\tkind = 'Alias';\n\t\t\t} else if (this.kinds[mime]) {\n\t\t\t\tif (isObj && mime === 'directory' && (! f.phash || f.isroot)) {\n\t\t\t\t\tkind = 'Root';\n\t\t\t\t} else {\n\t\t\t\t\tkind = this.kinds[mime];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (! kind) {\n\t\t\t\tif (mime.indexOf('text') === 0) {\n\t\t\t\t\tkind = 'Text';\n\t\t\t\t} else if (mime.indexOf('image') === 0) {\n\t\t\t\t\tkind = 'Image';\n\t\t\t\t} else if (mime.indexOf('audio') === 0) {\n\t\t\t\t\tkind = 'Audio';\n\t\t\t\t} else if (mime.indexOf('video') === 0) {\n\t\t\t\t\tkind = 'Video';\n\t\t\t\t} else if (mime.indexOf('application') === 0) {\n\t\t\t\t\tkind = 'App';\n\t\t\t\t} else {\n\t\t\t\t\tkind = mime;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this.messages['kind'+kind] ? this.i18n('kind'+kind) : mime;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return boolean Is mime-type text file\n\t\t * \n\t\t * @param  String  mime-type\n\t\t * @return Boolean\n\t\t */\n\t\tmimeIsText : function(mime) {\n\t\t\treturn (this.textMimes[mime.toLowerCase()] || (mime.indexOf('text/') === 0 && mime.substr(5, 3) !== 'rtf') || mime.match(/^application\\/.+\\+xml$/))? true : false;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Returns a date string formatted according to the given format string\n\t\t * \n\t\t * @param  String  format string\n\t\t * @param  Object  Date object\n\t\t * @return String\n\t\t */\n\t\tdate : function(format, date) {\n\t\t\tvar self = this,\n\t\t\t\toutput, d, dw, m, y, h, g, i, s;\n\t\t\t\n\t\t\tif (! date) {\n\t\t\t\tdate = new Date();\n\t\t\t}\n\t\t\t\n\t\t\th  = date[self.getHours]();\n\t\t\tg  = h > 12 ? h - 12 : h;\n\t\t\ti  = date[self.getMinutes]();\n\t\t\ts  = date[self.getSeconds]();\n\t\t\td  = date[self.getDate]();\n\t\t\tdw = date[self.getDay]();\n\t\t\tm  = date[self.getMonth]() + 1;\n\t\t\ty  = date[self.getFullYear]();\n\t\t\t\n\t\t\toutput = format.replace(/[a-z]/gi, function(val) {\n\t\t\t\tswitch (val) {\n\t\t\t\t\tcase 'd': return d > 9 ? d : '0'+d;\n\t\t\t\t\tcase 'j': return d;\n\t\t\t\t\tcase 'D': return self.i18n(self.i18.daysShort[dw]);\n\t\t\t\t\tcase 'l': return self.i18n(self.i18.days[dw]);\n\t\t\t\t\tcase 'm': return m > 9 ? m : '0'+m;\n\t\t\t\t\tcase 'n': return m;\n\t\t\t\t\tcase 'M': return self.i18n(self.i18.monthsShort[m-1]);\n\t\t\t\t\tcase 'F': return self.i18n(self.i18.months[m-1]);\n\t\t\t\t\tcase 'Y': return y;\n\t\t\t\t\tcase 'y': return (''+y).substr(2);\n\t\t\t\t\tcase 'H': return h > 9 ? h : '0'+h;\n\t\t\t\t\tcase 'G': return h;\n\t\t\t\t\tcase 'g': return g;\n\t\t\t\t\tcase 'h': return g > 9 ? g : '0'+g;\n\t\t\t\t\tcase 'a': return h >= 12 ? 'pm' : 'am';\n\t\t\t\t\tcase 'A': return h >= 12 ? 'PM' : 'AM';\n\t\t\t\t\tcase 'i': return i > 9 ? i : '0'+i;\n\t\t\t\t\tcase 's': return s > 9 ? s : '0'+s;\n\t\t\t\t}\n\t\t\t\treturn val;\n\t\t\t});\n\t\t\t\n\t\t\treturn output;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return localized date\n\t\t * \n\t\t * @param  Object  file object\n\t\t * @return String\n\t\t */\n\t\tformatDate : function(file, t) {\n\t\t\tvar self = this, \n\t\t\t\tts   = t || file.ts, \n\t\t\t\ti18  = self.i18,\n\t\t\t\tdate, format, output, d, dw, m, y, h, g, i, s;\n\n\t\t\tif (self.options.clientFormatDate && ts > 0) {\n\n\t\t\t\tdate = new Date(ts*1000);\n\t\t\t\tformat = ts >= this.yesterday \n\t\t\t\t\t? this.fancyFormat \n\t\t\t\t\t: this.dateFormat;\n\n\t\t\t\toutput = self.date(format, date);\n\t\t\t\t\n\t\t\t\treturn ts >= this.yesterday\n\t\t\t\t\t? output.replace('$1', this.i18n(ts >= this.today ? 'Today' : 'Yesterday'))\n\t\t\t\t\t: output;\n\t\t\t} else if (file.date) {\n\t\t\t\treturn file.date.replace(/([a-z]+)\\s/i, function(a1, a2) { return self.i18n(a2)+' '; });\n\t\t\t}\n\t\t\t\n\t\t\treturn self.i18n('dateUnknown');\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return localized number string\n\t\t * \n\t\t * @param  Number\n\t\t * @return String\n\t\t */\n\t\ttoLocaleString : function(num) {\n\t\t\tvar v = new Number(num);\n\t\t\tif (v) {\n\t\t\t\tif (v.toLocaleString) {\n\t\t\t\t\treturn v.toLocaleString();\n\t\t\t\t} else {\n\t\t\t\t\treturn String(num).replace( /(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, '$1,');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn num;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return css class marks file permissions\n\t\t * \n\t\t * @param  Object  file \n\t\t * @return String\n\t\t */\n\t\tperms2class : function(o) {\n\t\t\tvar c = '';\n\t\t\t\n\t\t\tif (!o.read && !o.write) {\n\t\t\t\tc = 'elfinder-na';\n\t\t\t} else if (!o.read) {\n\t\t\t\tc = 'elfinder-wo';\n\t\t\t} else if (!o.write) {\n\t\t\t\tc = 'elfinder-ro';\n\t\t\t}\n\t\t\t\n\t\t\tif (o.type) {\n\t\t\t\tc += ' elfinder-' + this.escape(o.type);\n\t\t\t}\n\t\t\t\n\t\t\treturn c;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return localized string with file permissions\n\t\t * \n\t\t * @param  Object  file\n\t\t * @return String\n\t\t */\n\t\tformatPermissions : function(f) {\n\t\t\tvar p  = [];\n\t\t\t\t\n\t\t\tf.read && p.push(this.i18n('read'));\n\t\t\tf.write && p.push(this.i18n('write'));\t\n\n\t\t\treturn p.length ? p.join(' '+this.i18n('and')+' ') : this.i18n('noaccess');\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return formated file size\n\t\t * \n\t\t * @param  Number  file size\n\t\t * @return String\n\t\t */\n\t\tformatSize : function(s) {\n\t\t\tvar n = 1, u = 'b';\n\t\t\t\n\t\t\tif (s == 'unknown') {\n\t\t\t\treturn this.i18n('unknown');\n\t\t\t}\n\t\t\t\n\t\t\tif (s > 1073741824) {\n\t\t\t\tn = 1073741824;\n\t\t\t\tu = 'GB';\n\t\t\t} else if (s > 1048576) {\n\t\t\t\tn = 1048576;\n\t\t\t\tu = 'MB';\n\t\t\t} else if (s > 1024) {\n\t\t\t\tn = 1024;\n\t\t\t\tu = 'KB';\n\t\t\t}\n\t\t\ts = s/n;\n\t\t\treturn (s > 0 ? n >= 1048576 ? s.toFixed(2) : Math.round(s) : 0) +' '+u;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return formated file mode by options.fileModeStyle\n\t\t * \n\t\t * @param  String  file mode\n\t\t * @param  String  format style\n\t\t * @return String\n\t\t */\n\t\tformatFileMode : function(p, style) {\n\t\t\tvar i, o, s, b, sticy, suid, sgid, str, oct;\n\t\t\t\n\t\t\tif (!style) {\n\t\t\t\tstyle = this.options.fileModeStyle.toLowerCase();\n\t\t\t}\n\t\t\tp = $.trim(p);\n\t\t\tif (p.match(/[rwxs-]{9}$/i)) {\n\t\t\t\tstr = p = p.substr(-9);\n\t\t\t\tif (style == 'string') {\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\toct = '';\n\t\t\t\ts = 0;\n\t\t\t\tfor (i=0; i<7; i=i+3) {\n\t\t\t\t\to = p.substr(i, 3);\n\t\t\t\t\tb = 0;\n\t\t\t\t\tif (o.match(/[r]/i)) {\n\t\t\t\t\t\tb += 4;\n\t\t\t\t\t}\n\t\t\t\t\tif (o.match(/[w]/i)) {\n\t\t\t\t\t\tb += 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (o.match(/[xs]/i)) {\n\t\t\t\t\t\tif (o.match(/[xs]/)) {\n\t\t\t\t\t\t\tb += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (o.match(/[s]/i)) {\n\t\t\t\t\t\t\tif (i == 0) {\n\t\t\t\t\t\t\t\ts += 4;\n\t\t\t\t\t\t\t} else if (i == 3) {\n\t\t\t\t\t\t\t\ts += 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\toct += b.toString(8);\n\t\t\t\t}\n\t\t\t\tif (s) {\n\t\t\t\t\toct = s.toString(8) + oct;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tp = parseInt(p, 8);\n\t\t\t\toct = p? p.toString(8) : '';\n\t\t\t\tif (!p || style == 'octal') {\n\t\t\t\t\treturn oct;\n\t\t\t\t}\n\t\t\t\to = p.toString(8);\n\t\t\t\ts = 0;\n\t\t\t\tif (o.length > 3) {\n\t\t\t\t\to = o.substr(-4);\n\t\t\t\t\ts = parseInt(o.substr(0, 1), 8);\n\t\t\t\t\to = o.substr(1);\n\t\t\t\t}\n\t\t\t\tsticy = ((s & 1) == 1); // not support\n\t\t\t\tsgid = ((s & 2) == 2);\n\t\t\t\tsuid = ((s & 4) == 4);\n\t\t\t\tstr = '';\n\t\t\t\tfor(i=0; i<3; i++) {\n\t\t\t\t\tif ((parseInt(o.substr(i, 1), 8) & 4) == 4) {\n\t\t\t\t\t\tstr += 'r';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstr += '-';\n\t\t\t\t\t}\n\t\t\t\t\tif ((parseInt(o.substr(i, 1), 8) & 2) == 2) {\n\t\t\t\t\t\tstr += 'w';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstr += '-';\n\t\t\t\t\t}\n\t\t\t\t\tif ((parseInt(o.substr(i, 1), 8) & 1) == 1) {\n\t\t\t\t\t\tstr += ((i==0 && suid)||(i==1 && sgid))? 's' : 'x';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstr += '-';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (style == 'both') {\n\t\t\t\treturn str + ' (' + oct + ')';\n\t\t\t} else if (style == 'string') {\n\t\t\t\treturn str;\n\t\t\t} else {\n\t\t\t\treturn oct;\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Regist this.decodeRawString function\n\t\t * \n\t\t * @return void\n\t\t */\n\t\tregistRawStringDecoder : function(rawStringDecoder) {\n\t\t\tif ($.isFunction(rawStringDecoder)) {\n\t\t\t\tthis.decodeRawString = this.options.rawStringDecoder = rawStringDecoder;\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return boolean that uploadable MIME type into target folder\n\t\t * \n\t\t * @param  String  mime    MIME type\n\t\t * @param  String  target  target folder hash\n\t\t * @return Bool\n\t\t */\n\t\tuploadMimeCheck : function(mime, target) {\n\t\t\ttarget = target || this.cwd().hash;\n\t\t\tvar res   = true, // default is allow\n\t\t\t\tmimeChecker = this.option('uploadMime', target),\n\t\t\t\tallow,\n\t\t\t\tdeny,\n\t\t\t\tcheck = function(checker) {\n\t\t\t\t\tvar ret = false;\n\t\t\t\t\tif (typeof checker === 'string' && checker.toLowerCase() === 'all') {\n\t\t\t\t\t\tret = true;\n\t\t\t\t\t} else if (Array.isArray(checker) && checker.length) {\n\t\t\t\t\t\t$.each(checker, function(i, v) {\n\t\t\t\t\t\t\tv = v.toLowerCase();\n\t\t\t\t\t\t\tif (v === 'all' || mime.indexOf(v) === 0) {\n\t\t\t\t\t\t\t\tret = true;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn ret;\n\t\t\t\t};\n\t\t\tif (mime && $.isPlainObject(mimeChecker)) {\n\t\t\t\tmime = mime.toLowerCase();\n\t\t\t\tallow = check(mimeChecker.allow);\n\t\t\t\tdeny = check(mimeChecker.deny);\n\t\t\t\tif (mimeChecker.firstOrder === 'allow') {\n\t\t\t\t\tres = false; // default is deny\n\t\t\t\t\tif (! deny && allow === true) { // match only allow\n\t\t\t\t\t\tres = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tres = true; // default is allow\n\t\t\t\t\tif (deny === true && ! allow) { // match only deny\n\t\t\t\t\t\tres = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\t\t\n\t\t/**\n\t\t * call chained sequence of async deferred functions\n\t\t * \n\t\t * @param  Array   tasks async functions\n\t\t * @return Object  jQuery.Deferred\n\t\t */\n\t\tsequence : function(tasks) {\n\t\t\tvar l = tasks.length,\n\t\t\t\tchain = function(task, idx) {\n\t\t\t\t\t++idx;\n\t\t\t\t\tif (tasks[idx]) {\n\t\t\t\t\t\treturn chain(task.then(tasks[idx]), idx);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn task;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\tif (l > 1) {\n\t\t\t\treturn chain(tasks[0](), 0);\n\t\t\t} else {\n\t\t\t\treturn tasks[0]();\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Reload contents of target URL for clear browser cache\n\t\t * \n\t\t * @param  String  url target URL\n\t\t * @return Object  jQuery.Deferred\n\t\t */\n\t\treloadContents : function(url) {\n\t\t\tvar dfd = $.Deferred(),\n\t\t\t\tifm;\n\t\t\ttry {\n\t\t\t\tifm = $('<iframe width=\"1\" height=\"1\" scrolling=\"no\" frameborder=\"no\" style=\"position:absolute; top:-1px; left:-1px\" crossorigin=\"use-credentials\">')\n\t\t\t\t\t.attr('src', url)\n\t\t\t\t\t.one('load', function() {\n\t\t\t\t\t\tvar ifm = $(this);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.contentDocument.location.reload(true);\n\t\t\t\t\t\t\tifm.one('load', function() {\n\t\t\t\t\t\t\t\tifm.remove();\n\t\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tifm.attr('src', '').attr('src', url).one('load', function() {\n\t\t\t\t\t\t\t\tifm.remove();\n\t\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.appendTo('body');\n\t\t\t} catch(e) {\n\t\t\t\tifm && ifm.remove();\n\t\t\t\tdfd.reject();\n\t\t\t}\n\t\t\treturn dfd;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Make netmount option for OAuth2\n\t\t * \n\t\t * @param  String   protocol\n\t\t * @param  String   name\n\t\t * @param  String   host\n\t\t * @param  Object   opts  Default {noOffline: false, root: 'root', pathI18n: 'folderId', folders: true}\n\t\t\t\t}\n\t\t * \n\t\t * @return Object\n\t\t */\n\t\tmakeNetmountOptionOauth : function(protocol, name, host, opt) {\n\t\t\tvar noOffline = typeof opt === 'boolean'? opt : null, // for backward compat\n\t\t\t\topts = Object.assign({\n\t\t\t\t\tnoOffline : false,\n\t\t\t\t\troot      : 'root',\n\t\t\t\t\tpathI18n  : 'folderId',\n\t\t\t\t\tfolders   : true\n\t\t\t\t}, (noOffline === null? (opt || {}) : {noOffline : noOffline})),\n\t\t\t\taddFolders = function(fm, bro, folders) {\n\t\t\t\t\tvar self = this,\n\t\t\t\t\t\tcnt  = Object.keys($.isPlainObject(folders)? folders : {}).length,\n\t\t\t\t\t\tselect;\n\t\t\t\t\t\n\t\t\t\t\tbro.next().remove();\n\t\t\t\t\tif (cnt) {\n\t\t\t\t\t\tselect = $('<select class=\"ui-corner-all elfinder-tabstop\" style=\"max-width:200px;\">').append(\n\t\t\t\t\t\t\t$($.map(folders, function(n,i){return '<option value=\"'+fm.escape((i+'').trim())+'\">'+fm.escape(n)+'</option>';}).join(''))\n\t\t\t\t\t\t).on('change click', function(e){\n\t\t\t\t\t\t\tvar node = $(this),\n\t\t\t\t\t\t\t\tpath = node.val(),\n\t\t\t\t\t\t\t\tspn;\n\t\t\t\t\t\t\tself.inputs.path.val(path);\n\t\t\t\t\t\t\tif (opts.folders && (e.type === 'change' || node.data('current') !== path)) {\n\t\t\t\t\t\t\t\tnode.next().remove();\n\t\t\t\t\t\t\t\tnode.data('current', path);\n\t\t\t\t\t\t\t\tif (path != opts.root) {\n\t\t\t\t\t\t\t\t\tspn = spinner();\n\t\t\t\t\t\t\t\t\tif (xhr && xhr.state() === 'pending') {\n\t\t\t\t\t\t\t\t\t\tfm.abortXHR(xhr, { quiet: true , abort: true });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnode.after(spn);\n\t\t\t\t\t\t\t\t\txhr = fm.request({\n\t\t\t\t\t\t\t\t\t\tdata : {cmd : 'netmount', protocol: protocol, host: host, user: 'init', path: path, pass: 'folders'},\n\t\t\t\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t\t\t\t}).done(function(data){\n\t\t\t\t\t\t\t\t\t\taddFolders.call(self, fm, node, data.folders);\n\t\t\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\t\t\tfm.abortXHR(xhr, { quiet: true });\n\t\t\t\t\t\t\t\t\t\tspn.remove();\n\t\t\t\t\t\t\t\t\t}).xhr;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbro.after($('<div/>').append(select))\n\t\t\t\t\t\t\t.closest('.ui-dialog').trigger('tabstopsInit');\n\t\t\t\t\t\tselect.trigger('focus');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tspinner = function() {\n\t\t\t\t\treturn $('<div class=\"elfinder-netmount-spinner\"/>').append('<span class=\"elfinder-spinner\"/>');\n\t\t\t\t},\n\t\t\t\txhr;\n\t\t\treturn {\n\t\t\t\tvars : {},\n\t\t\t\tname : name,\n\t\t\t\tinputs: {\n\t\t\t\t\toffline  : $('<input type=\"checkbox\"/>').on('change', function() {\n\t\t\t\t\t\t$(this).parents('table.elfinder-netmount-tb').find('select:first').trigger('change', 'reset');\n\t\t\t\t\t}),\n\t\t\t\t\thost     : $('<span><span class=\"elfinder-spinner\"/></span><input type=\"hidden\"/>'),\n\t\t\t\t\tpath     : $('<input type=\"text\" value=\"'+opts.root+'\"/>'),\n\t\t\t\t\tuser     : $('<input type=\"hidden\"/>'),\n\t\t\t\t\tpass     : $('<input type=\"hidden\"/>'),\n\t\t\t\t\tmnt2res  : $('<input type=\"hidden\"/>')\n\t\t\t\t},\n\t\t\t\tselect: function(fm, ev, d){\n\t\t\t\t\tvar f = this.inputs,\n\t\t\t\t\t\toline = f.offline,\n\t\t\t\t\t\tf0 = $(f.host[0]),\n\t\t\t\t\t\tdata = d || null;\n\t\t\t\t\tthis.vars.mbtn = f.host.closest('.ui-dialog').children('.ui-dialog-buttonpane:first').find('button.elfinder-btncnt-0');\n\t\t\t\t\tif (! f0.data('inrequest')\n\t\t\t\t\t\t\t&& (f0.find('span.elfinder-spinner').length\n\t\t\t\t\t\t\t\t|| data === 'reset'\n\t\t\t\t\t\t\t\t|| (data === 'winfocus' && ! f0.siblings('span.elfinder-button-icon-reload').length))\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (oline.parent().children().length === 1) {\n\t\t\t\t\t\t\tf.path.parent().prev().html(fm.i18n(opts.pathI18n));\n\t\t\t\t\t\t\toline.attr('title', fm.i18n('offlineAccess'));\n\t\t\t\t\t\t\toline.uniqueId().after($('<label/>').attr('for', oline.attr('id')).html(' '+fm.i18n('offlineAccess')));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tf0.data('inrequest', true).empty().addClass('elfinder-spinner')\n\t\t\t\t\t\t\t.parent().find('span.elfinder-button-icon').remove();\n\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\tdata : {cmd : 'netmount', protocol: protocol, host: host, user: 'init', options: {id: fm.id, offline: oline.prop('checked')? 1:0, pass: f.host[1].value}},\n\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t}).done(function(data){\n\t\t\t\t\t\t\tf0.removeClass(\"elfinder-spinner\").html(data.body.replace(/\\{msg:([^}]+)\\}/g, function(whole,s1){return fm.i18n(s1, host);}));\n\t\t\t\t\t\t});\n\t\t\t\t\t\topts.noOffline && oline.closest('tr').hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\toline.closest('tr')[(opts.noOffline || f.user.val())? 'hide':'show']();\n\t\t\t\t\t\tf0.data('funcexpup') && f0.data('funcexpup')();\n\t\t\t\t\t}\n\t\t\t\t\tthis.vars.mbtn[$(f.host[1]).val()? 'show':'hide']();\n\t\t\t\t},\n\t\t\t\tdone: function(fm, data){\n\t\t\t\t\tvar f = this.inputs,\n\t\t\t\t\t\tp = this.protocol,\n\t\t\t\t\t\tf0 = $(f.host[0]),\n\t\t\t\t\t\tf1 = $(f.host[1]),\n\t\t\t\t\t\texpires = '&nbsp;',\n\t\t\t\t\t\tvars = this.vars,\n\t\t\t\t\t\tchk = function() {\n\t\t\t\t\t\t\tif (vars.oauthW && !document.hasFocus() && --vars.chkCnt) {\n\t\t\t\t\t\t\t\tp.trigger('change', 'winfocus');\n\t\t\t\t\t\t\t\tvars.tm = setTimeout(chk, 3000);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbtn;\n\t\t\t\t\t\n\t\t\t\t\topts.noOffline && f.offline.closest('tr').hide();\n\t\t\t\t\tif (data.mode == 'makebtn') {\n\t\t\t\t\t\tf0.removeClass('elfinder-spinner').removeData('expires').removeData('funcexpup');\n\t\t\t\t\t\tbtn = f.host.find('input').on('mouseenter mouseleave', function(){$(this).toggleClass('ui-state-hover');});\n\t\t\t\t\t\tif (data.url) {\n\t\t\t\t\t\t\tbtn.on('click', function() {\n\t\t\t\t\t\t\t\tvars.tm && clearTimeout(vars.tm);\n\t\t\t\t\t\t\t\tvars.oauthW = window.open(data.url);\n\t\t\t\t\t\t\t\t// To correspond to safari, authentication tab sometimes not closing in CORS environment.\n\t\t\t\t\t\t\t\t// This may be a safari bug and may improve in the future.\n\t\t\t\t\t\t\t\tif ((fm.UA.iOS || fm.UA.Mac) && fm.isCORS && !vars.chkdone) {\n\t\t\t\t\t\t\t\t\tvars.chkCnt = 60;\n\t\t\t\t\t\t\t\t\tvars.tm = setTimeout(chk, 5000);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tf1.val('');\n\t\t\t\t\t\tf.path.val(opts.root).next().remove();\n\t\t\t\t\t\tf.user.val('');\n\t\t\t\t\t\tf.pass.val('');\n\t\t\t\t\t\t! opts.noOffline && f.offline.closest('tr').show();\n\t\t\t\t\t\tvars.mbtn.hide();\n\t\t\t\t\t} else if (data.mode == 'folders') {\n\t\t\t\t\t\tif (data.folders) {\n\t\t\t\t\t\t\taddFolders.call(this, fm, f.path.nextAll(':last'), data.folders);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (vars.oauthW) {\n\t\t\t\t\t\t\tvars.tm && clearTimeout(vars.tm);\n\t\t\t\t\t\t\tvars.oauthW.close();\n\t\t\t\t\t\t\tdelete vars.oauthW;\n\t\t\t\t\t\t\t// The problem that Safari's authentication tab doesn't close only affects the first time.\n\t\t\t\t\t\t\tvars.chkdone = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.expires) {\n\t\t\t\t\t\t\texpires = '()';\n\t\t\t\t\t\t\tf0.data('expires', data.expires);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tf0.html(host + expires).removeClass('elfinder-spinner');\n\t\t\t\t\t\tif (data.expires) {\n\t\t\t\t\t\t\tf0.data('funcexpup', function() {\n\t\t\t\t\t\t\t\tvar rem = Math.floor((f0.data('expires') - (+new Date()) / 1000) / 60);\n\t\t\t\t\t\t\t\tif (rem < 3) {\n\t\t\t\t\t\t\t\t\tf0.parent().children('.elfinder-button-icon-reload').click();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tf0.text(f0.text().replace(/\\(.*\\)/, '('+fm.i18n(['minsLeft', rem])+')'));\n\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tif (f0.is(':visible')) {\n\t\t\t\t\t\t\t\t\t\t\tf0.data('funcexpup')();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, 60000);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tf0.data('funcexpup')();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.reset) {\n\t\t\t\t\t\t\tp.trigger('change', 'reset');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tf0.parent().append($('<span class=\"elfinder-button-icon elfinder-button-icon-reload\" title=\"'+fm.i18n('reAuth')+'\">')\n\t\t\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\t\t\tf1.val('reauth');\n\t\t\t\t\t\t\t\tp.trigger('change', 'reset');\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\tf1.val(protocol);\n\t\t\t\t\t\tvars.mbtn.show();\n\t\t\t\t\t\tif (data.folders) {\n\t\t\t\t\t\t\taddFolders.call(this, fm, f.path, data.folders);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.mnt2res) {\n\t\t\t\t\t\t\tf.mnt2res.val('1');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tf.user.val('done');\n\t\t\t\t\t\tf.pass.val('done');\n\t\t\t\t\t\tf.offline.closest('tr').hide();\n\t\t\t\t\t}\n\t\t\t\t\tf0.removeData('inrequest');\n\t\t\t\t},\n\t\t\t\tfail: function(fm, err){\n\t\t\t\t\t$(this.inputs.host[0]).removeData('inrequest');\n\t\t\t\t\tthis.protocol.trigger('change', 'reset');\n\t\t\t\t},\n\t\t\t\tintegrateInfo: opts.integrate\n\t\t\t};\n\t\t},\n\t\t\n\t\t/**\n\t\t * Find cwd's nodes from files\n\t\t * \n\t\t * @param  Array    files\n\t\t * @param  Object   opts   {firstOnly: true|false}\n\t\t */\n\t\tfindCwdNodes : function(files, opts) {\n\t\t\tvar self    = this,\n\t\t\t\tcwd     = this.getUI('cwd'),\n\t\t\t\tcwdHash = this.cwd().hash,\n\t\t\t\tnewItem = $();\n\t\t\t\n\t\t\topts = opts || {};\n\t\t\t\n\t\t\t$.each(files, function(i, f) {\n\t\t\t\tif (f.phash === cwdHash || self.searchStatus.state > 1) {\n\t\t\t\t\tnewItem = newItem.add(self.cwdHash2Elm(f.hash));\n\t\t\t\t\tif (opts.firstOnly) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\treturn newItem;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Convert from relative URL to abstract URL based on current URL\n\t\t * \n\t\t * @param  String  URL\n\t\t * @return String\n\t\t */\n\t\tconvAbsUrl : function(url) {\n\t\t\tif (url.match(/^http/i)) {\n\t\t\t\treturn url;\n\t\t\t}\n\t\t\tif (url.substr(0,2) === '//') {\n\t\t\t\treturn window.location.protocol + url;\n\t\t\t}\n\t\t\tvar root = window.location.protocol + '//' + window.location.host,\n\t\t\t\treg  = /[^\\/]+\\/\\.\\.\\//,\n\t\t\t\tret;\n\t\t\tif (url.substr(0, 1) === '/') {\n\t\t\t\tret = root + url;\n\t\t\t} else {\n\t\t\t\tret = root + window.location.pathname.replace(/\\/[^\\/]+$/, '/') + url;\n\t\t\t}\n\t\t\tret = ret.replace('/./', '/');\n\t\t\twhile(reg.test(ret)) {\n\t\t\t\tret = ret.replace(reg, '');\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Is same origin to current site\n\t\t * \n\t\t * @param  String  check url\n\t\t * @return Boolean\n\t\t */\n\t\tisSameOrigin : function (checkUrl) {\n\t\t\tvar url;\n\t\t\tcheckUrl = this.convAbsUrl(checkUrl);\n\t\t\tif (location.origin && window.URL) {\n\t\t\t\ttry {\n\t\t\t\t\turl = new URL(checkUrl);\n\t\t\t\t\treturn location.origin === url.origin;\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\t\t\turl = document.createElement('a');\n\t\t\turl.href = checkUrl;\n\t\t\treturn location.protocol === url.protocol && location.host === url.host && location.port && url.port;\n\t\t},\n\t\t\n\t\tnavHash2Id : function(hash) {\n\t\t\treturn this.navPrefix + hash;\n\t\t},\n\t\t\n\t\tnavId2Hash : function(id) {\n\t\t\treturn typeof(id) == 'string' ? id.substr(this.navPrefix.length) : false;\n\t\t},\n\t\t\n\t\tcwdHash2Id : function(hash) {\n\t\t\treturn this.cwdPrefix + hash;\n\t\t},\n\t\t\n\t\tcwdId2Hash : function(id) {\n\t\t\treturn typeof(id) == 'string' ? id.substr(this.cwdPrefix.length) : false;\n\t\t},\n\t\t\n\t\t/**\n\t\t * navHash to jQuery element object\n\t\t *\n\t\t * @param      String  hash    nav hash\n\t\t * @return     Object  jQuery element object\n\t\t */\n\t\tnavHash2Elm : function(hash) {\n\t\t\treturn $(document.getElementById(this.navHash2Id(hash)));\n\t\t},\n\n\t\t/**\n\t\t * cwdHash to jQuery element object\n\t\t *\n\t\t * @param      String  hash    cwd hash\n\t\t * @return     Object  jQuery element object\n\t\t */\n\t\tcwdHash2Elm : function(hash) {\n\t\t\treturn $(document.getElementById(this.cwdHash2Id(hash)));\n\t\t},\n\n\t\tisInWindow : function(elem, nochkHide) {\n\t\t\tvar elm, rect;\n\t\t\tif (! (elm = elem.get(0))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (! nochkHide && elm.offsetParent === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\trect = elm.getBoundingClientRect();\n\t\t\treturn document.elementFromPoint(rect.left, rect.top)? true : false;\n\t\t},\n\t\t\n\t\t/**\n\t\t * calculate elFinder node z-index\n\t\t * \n\t\t * @return void\n\t\t */\n\t\tzIndexCalc : function() {\n\t\t\tvar self = this,\n\t\t\t\tnode = this.getUI(),\n\t\t\t\tni = node.css('z-index');\n\t\t\tif (ni && ni !== 'auto' && ni !== 'inherit') {\n\t\t\t\tself.zIndex = ni;\n\t\t\t} else {\n\t\t\t\tnode.parents().each(function(i, n) {\n\t\t\t\t\tvar z = $(n).css('z-index');\n\t\t\t\t\tif (z !== 'auto' && z !== 'inherit' && (z = parseInt(z))) {\n\t\t\t\t\t\tself.zIndex = z;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Load JavaScript files\n\t\t * \n\t\t * @param  Array    urls      to load JavaScript file URLs\n\t\t * @param  Function callback  call back function on script loaded\n\t\t * @param  Object   opts      Additional options to $.ajax OR {loadType: 'tag'} to load by script tag\n\t\t * @param  Object   check     { obj: (Object)ParentObject, name: (String)\"Attribute name\", timeout: (Integer)milliseconds }\n\t\t * @return elFinder\n\t\t */\n\t\tloadScript : function(urls, callback, opts, check) {\n\t\t\tvar defOpts = {\n\t\t\t\t\tdataType : 'script',\n\t\t\t\t\tcache    : true\n\t\t\t\t},\n\t\t\t\tsuccess, cnt, scripts = {}, results = {};\n\t\t\t\n\t\t\topts = opts || {};\n\t\t\tif (opts.tryRequire && this.hasRequire) {\n\t\t\t\trequire(urls, callback, opts.error);\n\t\t\t} else {\n\t\t\t\tsuccess = function() {\n\t\t\t\t\tvar cnt, fi, hasError;\n\t\t\t\t\t$.each(results, function(i, status) {\n\t\t\t\t\t\tif (status !== 'success' && status !== 'notmodified') {\n\t\t\t\t\t\t\thasError = true;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!hasError) {\n\t\t\t\t\t\tif ($.isFunction(callback)) {\n\t\t\t\t\t\t\tif (check) {\n\t\t\t\t\t\t\t\tif (typeof check.obj[check.name] === 'undefined') {\n\t\t\t\t\t\t\t\t\tcnt = check.timeout? (check.timeout / 10) : 1;\n\t\t\t\t\t\t\t\t\tfi = setInterval(function() {\n\t\t\t\t\t\t\t\t\t\tif (--cnt < 0 || typeof check.obj[check.name] !== 'undefined') {\n\t\t\t\t\t\t\t\t\t\t\tclearInterval(fi);\n\t\t\t\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, 10);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (opts.error && $.isFunction(opts.error)) {\n\t\t\t\t\t\t\topts.error({ loadResults: results });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (opts.loadType === 'tag') {\n\t\t\t\t\t$('head > script').each(function() {\n\t\t\t\t\t\tscripts[this.src] = this;\n\t\t\t\t\t});\n\t\t\t\t\tcnt = urls.length;\n\t\t\t\t\t$.each(urls, function(i, url) {\n\t\t\t\t\t\tvar done = false,\n\t\t\t\t\t\t\tscript;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (scripts[url]) {\n\t\t\t\t\t\t\tresults[i] = scripts[url]._error || 'success';\n\t\t\t\t\t\t\t(--cnt < 1) && success();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscript = document.createElement('script');\n\t\t\t\t\t\t\tscript.charset = opts.charset || 'UTF-8';\n\t\t\t\t\t\t\t$('head').append(script);\n\t\t\t\t\t\t\tscript.onload = script.onreadystatechange = function() {\n\t\t\t\t\t\t\t\tif ( !done && (!this.readyState ||\n\t\t\t\t\t\t\t\t\t\tthis.readyState === 'loaded' || this.readyState === 'complete') ) {\n\t\t\t\t\t\t\t\t\tdone = true;\n\t\t\t\t\t\t\t\t\tresults[i] = 'success';\n\t\t\t\t\t\t\t\t\t(--cnt < 1) && success();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tscript.onerror = function(err) {\n\t\t\t\t\t\t\t\tresults[i] = script._error = (err && err.type)? err.type : 'error';\n\t\t\t\t\t\t\t\t(--cnt < 1) && success();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tscript.src = url;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\topts = $.isPlainObject(opts)? Object.assign(defOpts, opts) : defOpts;\n\t\t\t\t\tcnt = 0;\n\t\t\t\t\t(function appendScript(d, status) {\n\t\t\t\t\t\tif (d !== void(0)) {\n\t\t\t\t\t\t\tresults[cnt++] = status;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (urls.length) {\n\t\t\t\t\t\t\t$.ajax(Object.assign({}, opts, {\n\t\t\t\t\t\t\t\turl: urls.shift(),\n\t\t\t\t\t\t\t\tsuccess: appendScript,\n\t\t\t\t\t\t\t\terror: appendScript\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsuccess();\n\t\t\t\t\t\t}\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Load CSS files\n\t\t * \n\t\t * @param  Array    to load CSS file URLs\n\t\t * @param  Object   options\n\t\t * @return elFinder\n\t\t */\n\t\tloadCss : function(urls, opts) {\n\t\t\tvar self = this,\n\t\t\t\tclName, dfds;\n\t\t\tif (typeof urls === 'string') {\n\t\t\t\turls = [ urls ];\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tif (opts.className) {\n\t\t\t\t\tclName = opts.className;\n\t\t\t\t}\n\t\t\t\tif (opts.dfd && opts.dfd.promise) {\n\t\t\t\t\tdfds = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\t$.each(urls, function(i, url) {\n\t\t\t\tvar link, df;\n\t\t\t\turl = self.convAbsUrl(url).replace(/^https?:/i, '');\n\t\t\t\tif (dfds) {\n\t\t\t\t\tdfds[i] = $.Deferred();\n\t\t\t\t}\n\t\t\t\tif (! $('head > link[href=\"' + self.escape(url) + '\"]').length) {\n\t\t\t\t\tlink = document.createElement('link');\n\t\t\t\t\tlink.type = 'text/css';\n\t\t\t\t\tlink.rel = 'stylesheet';\n\t\t\t\t\tlink.href = url;\n\t\t\t\t\tif (clName) {\n\t\t\t\t\t\tlink.className = clName;\n\t\t\t\t\t}\n\t\t\t\t\tif (dfds) {\n\t\t\t\t\t\tlink.onload = function() {\n\t\t\t\t\t\t\tdfds[i].resolve();\n\t\t\t\t\t\t};\n\t\t\t\t\t\tlink.onerror = function() {\n\t\t\t\t\t\t\tdfds[i].reject();\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\t$('head').append(link);\n\t\t\t\t} else {\n\t\t\t\t\tdfds && dfds[i].resolve();\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (dfds) {\n\t\t\t\t$.when.apply(null, dfds).done(function() {\n\t\t\t\t\topts.dfd.resolve();\n\t\t\t\t}).fail(function() {\n\t\t\t\t\topts.dfd.reject();\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Abortable async job performer\n\t\t * \n\t\t * @param func Function\n\t\t * @param arr  Array\n\t\t * @param opts Object\n\t\t * \n\t\t * @return Object $.Deferred that has an extended method _abort()\n\t\t */\n\t\tasyncJob : function(func, arr, opts) {\n\t\t\tvar dfrd = $.Deferred(),\n\t\t\t\tabortFlg = false,\n\t\t\t\tparms = Object.assign({\n\t\t\t\t\tinterval : 0,\n\t\t\t\t\tnumPerOnce : 1\n\t\t\t\t}, opts || {}),\n\t\t\t\tresArr = [],\n\t\t\t\tvars =[],\n\t\t\t\tcurVars = [],\n\t\t\t\texec,\n\t\t\t\ttm;\n\t\t\t\n\t\t\tdfrd._abort = function(resolve) {\n\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\tvars = [];\n\t\t\t\tabortFlg = true;\n\t\t\t\tif (dfrd.state() === 'pending') {\n\t\t\t\t\tdfrd[resolve? 'resolve' : 'reject'](resArr);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\tdfrd.fail(function() {\n\t\t\t\tdfrd._abort();\n\t\t\t}).always(function() {\n\t\t\t\tdfrd._abort = function() {};\n\t\t\t});\n\n\t\t\tif (typeof func === 'function' && Array.isArray(arr)) {\n\t\t\t\tvars = arr.concat();\n\t\t\t\texec = function() {\n\t\t\t\t\tvar i, len, res;\n\t\t\t\t\tif (abortFlg) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurVars = vars.splice(0, parms.numPerOnce);\n\t\t\t\t\tlen = curVars.length;\n\t\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\t\tif (abortFlg) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tres = func(curVars[i]);\n\t\t\t\t\t\t(res !== null) && resArr.push(res);\n\t\t\t\t\t}\n\t\t\t\t\tif (abortFlg) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (vars.length) {\n\t\t\t\t\t\ttm = setTimeout(exec, parms.interval);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfrd.resolve(resArr);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (vars.length) {\n\t\t\t\t\ttm = setTimeout(exec, 0);\n\t\t\t\t} else {\n\t\t\t\t\tdfrd.resolve(resArr);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdfrd.reject();\n\t\t\t}\n\t\t\treturn dfrd;\n\t\t},\n\t\t\n\t\tgetSize : function(targets) {\n\t\t\tvar self = this,\n\t\t\t\treqs = [],\n\t\t\t\ttgtlen = targets.length,\n\t\t\t\tdfrd = $.Deferred().fail(function() {\n\t\t\t\t\t$.each(reqs, function(i, req) {\n\t\t\t\t\t\tif (req) {\n\t\t\t\t\t\t\treq.syncOnFail && req.syncOnFail(false);\n\t\t\t\t\t\t\treq.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}),\n\t\t\t\tgetLeafRoots = function(file) {\n\t\t\t\t\tvar targets = [];\n\t\t\t\t\tif (file.mime === 'directory') {\n\t\t\t\t\t\t$.each(self.leafRoots, function(hash, roots) {\n\t\t\t\t\t\t\tvar phash;\n\t\t\t\t\t\t\tif (hash === file.hash) {\n\t\t\t\t\t\t\t\ttargets.push.apply(targets, roots);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tphash = (self.file(hash) || {}).phash;\n\t\t\t\t\t\t\t\twhile(phash) {\n\t\t\t\t\t\t\t\t\tif (phash === file.hash) {\n\t\t\t\t\t\t\t\t\t\ttargets.push.apply(targets, roots);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tphash = (self.file(phash) || {}).phash;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn targets;\n\t\t\t\t},\n\t\t\t\tcheckPhash = function(hash) {\n\t\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\t\tdir = self.file(hash),\n\t\t\t\t\t\ttarget = dir? dir.phash : hash;\n\t\t\t\t\tif (target && ! self.file(target)) {\n\t\t\t\t\t\tself.request({\n\t\t\t\t\t\t\tdata : {\n\t\t\t\t\t\t\t\tcmd    : 'parents',\n\t\t\t\t\t\t\t\ttarget : target\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpreventFail : true\n\t\t\t\t\t\t}).done(function() {\n\t\t\t\t\t\t\tself.one('parentsdone', function() {\n\t\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t}\n\t\t\t\t\treturn dfd;\n\t\t\t\t},\n\t\t\t\tcache = function() {\n\t\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\t\tcnt = Object.keys(self.leafRoots).length;\n\t\t\t\t\t\n\t\t\t\t\tif (cnt > 0) {\n\t\t\t\t\t\t$.each(self.leafRoots, function(hash) {\n\t\t\t\t\t\t\tcheckPhash(hash).done(function() {\n\t\t\t\t\t\t\t\t--cnt;\n\t\t\t\t\t\t\t\tif (cnt < 1) {\n\t\t\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t}\n\t\t\t\t\treturn dfd;\n\t\t\t\t};\n\n\t\t\tself.autoSync('stop');\n\t\t\tcache().done(function() {\n\t\t\t\tvar files = [], grps = {}, dfds = [], cache = [], singles = {};\n\t\t\t\t\n\t\t\t\t$.each(targets, function() {\n\t\t\t\t\tfiles.push.apply(files, getLeafRoots(self.file(this)));\n\t\t\t\t});\n\t\t\t\ttargets.push.apply(targets, files);\n\t\t\t\t\n\t\t\t\t$.each(targets, function() {\n\t\t\t\t\tvar root = self.root(this),\n\t\t\t\t\t\tfile = self.file(this);\n\t\t\t\t\tif (file && (file.sizeInfo || file.mime !== 'directory')) {\n\t\t\t\t\t\tcache.push($.Deferred().resolve(file.sizeInfo? file.sizeInfo : {size: file.size, dirCnt: 0, fileCnt : 1}));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (! grps[root]) {\n\t\t\t\t\t\t\tgrps[root] = [ this.toString() ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgrps[root].push(this.toString());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t$.each(grps, function() {\n\t\t\t\t\tvar idx = dfds.length;\n\t\t\t\t\tif (this.length === 1) {\n\t\t\t\t\t\tsingles[idx] = this[0];\n\t\t\t\t\t}\n\t\t\t\t\tdfds.push(self.request({\n\t\t\t\t\t\tdata : {cmd : 'size', targets : this},\n\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t\treqs.push.apply(reqs, dfds);\n\t\t\t\tdfds.push.apply(dfds, cache);\n\t\t\t\t\n\t\t\t\t$.when.apply($, dfds).fail(function() {\n\t\t\t\t\tdfrd.reject();\n\t\t\t\t}).done(function() {\n\t\t\t\t\tvar cache = function(h, data) {\n\t\t\t\t\t\t\tvar file;\n\t\t\t\t\t\t\tif (file = self.file(h)) {\n\t\t\t\t\t\t\t\tfile.sizeInfo = { isCache: true };\n\t\t\t\t\t\t\t\t$.each(['size', 'dirCnt', 'fileCnt'], function() {\n\t\t\t\t\t\t\t\t\tfile.sizeInfo[this] = data[this] || 0;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tfile.size = parseInt(file.sizeInfo.size);\n\t\t\t\t\t\t\t\tchanged.push(file);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsize = 0,\n\t\t\t\t\t\tfileCnt = 0,\n\t\t\t\t\t\tdirCnt = 0,\n\t\t\t\t\t\targLen = arguments.length,\n\t\t\t\t\t\tcnts = [],\n\t\t\t\t\t\tcntsTxt = '',\n\t\t\t\t\t\tchanged = [],\n\t\t\t\t\t\ti, file, data;\n\t\t\t\t\t\n\t\t\t\t\tfor (i = 0; i < argLen; i++) {\n\t\t\t\t\t\tdata = arguments[i];\n\t\t\t\t\t\tfile = null;\n\t\t\t\t\t\tif (!data.isCache) {\n\t\t\t\t\t\t\tif (singles[i] && (file = self.file(singles[i]))) {\n\t\t\t\t\t\t\t\tcache(singles[i], data);\n\t\t\t\t\t\t\t} else if (data.sizes && $.isPlainObject(data.sizes)) {\n\t\t\t\t\t\t\t\t$.each(data.sizes, function(h, sizeInfo) {\n\t\t\t\t\t\t\t\t\tcache(h, sizeInfo);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsize += parseInt(data.size);\n\t\t\t\t\t\tif (fileCnt !== false) {\n\t\t\t\t\t\t\tif (typeof data.fileCnt === 'undefined') {\n\t\t\t\t\t\t\t\tfileCnt = false;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfileCnt += parseInt(data.fileCnt || 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (dirCnt !== false) {\n\t\t\t\t\t\t\tif (typeof data.dirCnt === 'undefined') {\n\t\t\t\t\t\t\t\tdirCnt = false;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdirCnt += parseInt(data.dirCnt || 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tchanged.length && self.change({changed: changed});\n\t\t\t\t\t\n\t\t\t\t\tif (dirCnt !== false){\n\t\t\t\t\t\tcnts.push(self.i18n('folders') + ': ' + (dirCnt - (tgtlen > 1? 0 : 1)));\n\t\t\t\t\t}\n\t\t\t\t\tif (fileCnt !== false){\n\t\t\t\t\t\tcnts.push(self.i18n('files') + ': ' + fileCnt);\n\t\t\t\t\t}\n\t\t\t\t\tif (cnts.length) {\n\t\t\t\t\t\tcntsTxt = '<br>' + cnts.join(', ');\n\t\t\t\t\t}\n\t\t\t\t\tdfrd.resolve({\n\t\t\t\t\t\tsize: size,\n\t\t\t\t\t\tfileCnt: fileCnt,\n\t\t\t\t\t\tdirCnt: dirCnt,\n\t\t\t\t\t\tformated: (size >= 0 ? self.formatSize(size) : self.i18n('unknown')) + cntsTxt\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tself.autoSync();\n\t\t\t});\n\t\t\t\n\t\t\treturn dfrd;\n\t\t},\n\n\t\t/**\n\t\t * Worker Object URL for Blob URL of getWorker()\n\t\t */\n\t\twkObjUrl : null,\n\n\t\t/**\n\t\t * Gets the web worker.\n\t\t *\n\t\t * @param      {Object}  options  The options\n\t\t * @return     {Worker}  The worker.\n\t\t */\n\t\tgetWorker : function(options){\n\t\t\t// for to make blob URL\n\t\t\tfunction woker() {\n\t\t\t\tself.onmessage = function(e) {\n\t\t\t\t\tvar d = e.data;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tself.data = d.data;\n\t\t\t\t\t\tif (d.scripts) {\n\t\t\t\t\t\t\tfor(var i = 0; i < d.scripts.length; i++) {\n\t\t\t\t\t\t\t\timportScripts(d.scripts[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.postMessage(self.res);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tself.postMessage({error: e.toString()});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t// get woker\n\t\t\tvar wk;\n\t\t\ttry {\n\t\t\t\tif (!this.wkObjUrl) {\n\t\t\t\t\tthis.wkObjUrl = (window.URL || window.webkitURL).createObjectURL(new Blob(\n\t\t\t\t\t\t[woker.toString().replace(/\\s+/g, ' ').replace(/ *([^\\w]) */g, '$1').replace(/^function\\b.+?\\{|\\}$/g, '')],\n\t\t\t\t\t\t{ type:'text/javascript' }\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t\twk = new Worker(this.wkObjUrl, options);\n\t\t\t} catch(e) {\n\t\t\t\tthis.debug('error', e.toString());\n\t\t\t}\n\t\t\treturn wk;\n\t\t},\n\n\t\t/**\n\t\t * Get worker absolute URL by filename\n\t\t *\n\t\t * @param      {string}  filename  The filename\n\t\t * @return     {<type>}  The worker url.\n\t\t */\n\t\tgetWorkerUrl : function(filename) {\n\t\t\treturn this.convAbsUrl(this.baseUrl + 'js/worker/' + filename);\n\t\t},\n\n\t\t/**\n\t\t * Gets the theme object by settings of options.themes\n\t\t *\n\t\t * @param  String  themeid  The themeid\n\t\t * @return Object  jQuery.Deferred\n\t\t */\n\t\tgetTheme : function(themeid) {\n\t\t\tvar self = this,\n\t\t\t\tdfd = $.Deferred(),\n\t\t\t\tabsUrl = function(url, base) {\n\t\t\t\t\tif (!base) {\n\t\t\t\t\t\tbase = self.convAbsUrl(self.baseUrl);\n\t\t\t\t\t}\n\t\t\t\t\tif (Array.isArray(url)) {\n\t\t\t\t\t\treturn $.map(url, function(v) {\n\t\t\t\t\t\t\treturn absUrl(v, base);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn url.match(/^(?:http|\\/\\/)/i)? url : base + url.replace(/^(?:\\.\\/|\\/)/, '');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthemeObj, m;\n\t\t\tif (themeid && (themeObj = self.options.themes[themeid])) {\n\t\t\t\tif (typeof themeObj === 'string') {\n\t\t\t\t\turl = absUrl(themeObj);\n\t\t\t\t\tif (m = url.match(/^(.+\\/)[^/]+\\.json$/i)) {\n\t\t\t\t\t\t$.getJSON(url).done(function(data) {\n\t\t\t\t\t\t\tthemeObj = data;\n\t\t\t\t\t\t\tthemeObj.id = themeid;\n\t\t\t\t\t\t\tif (themeObj.cssurls) {\n\t\t\t\t\t\t\t\tthemeObj.cssurls = absUrl(themeObj.cssurls, m[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdfd.resolve(themeObj);\n\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdfd.resolve({\n\t\t\t\t\t\t\tid: themeid,\n\t\t\t\t\t\t\tname: themeid,\n\t\t\t\t\t\t\tcssurls: [url]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else if ($.isPlainObject(themeObj) && themeObj.cssurls) {\n\t\t\t\t\tthemeObj.id = themeid;\n\t\t\t\t\tthemeObj.cssurls = absUrl(themeObj.cssurls);\n\t\t\t\t\tif (!Array.isArray(themeObj.cssurls)) {\n\t\t\t\t\t\tthemeObj.cssurls = [themeObj.cssurls];\n\t\t\t\t\t}\n\t\t\t\t\tif (!themeObj.name) {\n\t\t\t\t\t\tthemeObj.name = themeid;\n\t\t\t\t\t}\n\t\t\t\t\tdfd.resolve(themeObj);\n\t\t\t\t} else {\n\t\t\t\t\tdfd.reject();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdfd.reject();\n\t\t\t}\n\t\t\treturn dfd;\n\t\t},\n\n\t\t/**\n\t\t * Change current theme\n\t\t *\n\t\t * @param  String  themeid  The themeid\n\t\t * @return Object  this elFinder instance\n\t\t */\n\t\tchangeTheme : function(themeid) {\n\t\t\tvar self = this;\n\t\t\tif (themeid) {\n\t\t\t\tif (self.options.themes[themeid] && (!self.theme || self.theme.id !== themeid)) {\n\t\t\t\t\tself.getTheme(themeid).done(function(themeObj) {\n\t\t\t\t\t\tif (themeObj.cssurls) {\n\t\t\t\t\t\t\t$('head>link.elfinder-theme-ext').remove();\n\t\t\t\t\t\t\tself.loadCss(themeObj.cssurls, {\n\t\t\t\t\t\t\t\tclassName: 'elfinder-theme-ext',\n\t\t\t\t\t\t\t\tdfd: $.Deferred().done(function() {\n\t\t\t\t\t\t\t\t\tself.theme = themeObj;\n\t\t\t\t\t\t\t\t\tself.trigger && self.trigger('themechange');\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (themeid === 'default' && self.theme && self.theme.id !== 'default') {\n\t\t\t\t\t$('head>link.elfinder-theme-ext').remove();\n\t\t\t\t\tself.theme = null;\n\t\t\t\t\tself.trigger && self.trigger('themechange');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Apply leaf root stats to target directory\n\t\t *\n\t\t * @param      object     dir     object of target directory\n\t\t * @param      boolean    update  is force update\n\t\t * \n\t\t * @return     boolean    dir object was chenged \n\t\t */\n\t\tapplyLeafRootStats : function(dir, update) {\n\t\t\tvar self = this,\n\t\t\t\tprev = update? dir : (self.file(dir.hash) || dir),\n\t\t\t\tprevTs = prev.ts,\n\t\t\t\tchange = false;\n\t\t\t// backup original stats\n\t\t\tif (update || !dir._realStats) {\n\t\t\t\tdir._realStats = {\n\t\t\t\t\tlocked: dir.locked || 0,\n\t\t\t\t\tdirs: dir.dirs || 0,\n\t\t\t\t\tts: dir.ts\n\t\t\t\t};\n\t\t\t}\n\t\t\t// set lock\n\t\t\tdir.locked = 1;\n\t\t\tif (!prev.locked) {\n\t\t\t\tchange = true;\n\t\t\t}\n\t\t\t// has leaf root to `dirs: 1`\n\t\t\tdir.dirs = 1;\n\t\t\tif (!prev.dirs) {\n\t\t\t\tchange = true;\n\t\t\t}\n\t\t\t// set ts\n\t\t\t$.each(self.leafRoots[dir.hash], function() {\n\t\t\t\tvar f = self.file(this);\n\t\t\t\tif (f && f.ts && (dir.ts || 0) < f.ts) {\n\t\t\t\t\tdir.ts = f.ts;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (prevTs !== dir.ts) {\n\t\t\t\tchange = true;\n\t\t\t}\n\n\t\t\treturn change;\n\t\t},\n\n\t\t/**\n\t\t * To aborted XHR object\n\t\t * \n\t\t * @param Object xhr\n\t\t * @param Object opts\n\t\t * \n\t\t * @return void\n\t\t */\n\t\tabortXHR : function(xhr, o) {\n\t\t\tvar opts = o || {};\n\t\t\t\n\t\t\tif (xhr) {\n\t\t\t\topts.quiet && (xhr.quiet = true);\n\t\t\t\tif (opts.abort && xhr._requestId) {\n\t\t\t\t\tthis.request({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tcmd: 'abort',\n\t\t\t\t\t\t\tid: xhr._requestId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpreventDefault: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//xhr.abort(); // modified by lwf\n\t\t\t\txhr = void 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Sets the custom header by xhr response header with options.parrotHeaders\n\t\t *\n\t\t * @param Object xhr\n\t\t * \n\t\t * @return void\n\t\t */\n\t\tsetCustomHeaderByXhr : function(xhr) {\n\t\t\tvar self = this;\n\t\t\tif (xhr.getResponseHeader && self.parrotHeaders && self.parrotHeaders.length) {\n\t\t\t\t$.each(self.parrotHeaders, function(i, h) {\n\t\t\t\t\tvar val = xhr.getResponseHeader(h);\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tself.customHeaders[h] = val;\n\t\t\t\t\t\tself.sessionStorage('core-ph:'+h, val);\n\t\t\t\t\t} else if (typeof val === 'string') {\n\t\t\t\t\t\tdelete self.customHeaders[h];\n\t\t\t\t\t\tself.sessionStorage('core-ph:'+h, null);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Determines if parrot headers.\n\t\t *\n\t\t * @return     {boolean}  True if parrot headers, False otherwise.\n\t\t */\n\t\thasParrotHeaders : function() {\n\t\t\tvar res = false,\n\t\t\t\tphs = this.parrotHeaders;\n\t\t\tif (Object.keys(this.customHeaders).length) {\n\t\t\t\tfor (var i = 0; i < phs.length; i++) {\n\t\t\t\t\tif (this.customHeaders[phs[i]]) {\n\t\t\t\t\t\tres = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\n\t\t/**\n\t\t * Gets the request identifier\n\t\t *\n\t\t * @return  String  The request identifier.\n\t\t */\n\t\tgetRequestId : function() {\n\t\t\treturn (+ new Date()).toString(16) + Math.floor(1000 * Math.random()).toString(16);\n\t\t},\n\t\t\n\t\t/**\n\t\t * Flip key and value of array or object\n\t\t * \n\t\t * @param  Array | Object  { a: 1, b: 1, c: 2 }\n\t\t * @param  Mixed           Static value\n\t\t * @return Object          { 1: \"b\", 2: \"c\" }\n\t\t */\n\t\tarrayFlip : function (trans, val) {\n\t\t\tvar key,\n\t\t\t\ttmpArr = {},\n\t\t\t\tisArr = $.isArray(trans);\n\t\t\tfor (key in trans) {\n\t\t\t\tif (isArr || trans.hasOwnProperty(key)) {\n\t\t\t\t\ttmpArr[trans[key]] = val || key;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tmpArr;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Return array [\"name without extention\", \"extention\"]\n\t\t * \n\t\t * @param String name\n\t\t * \n\t\t * @return Array\n\t\t * \n\t\t */\n\t\tsplitFileExtention : function(name) {\n\t\t\tvar m;\n\t\t\tif (m = name.match(/^(.+?)?\\.((?:tar\\.(?:gz|bz|bz2|z|lzo))|cpio\\.gz|ps\\.gz|xcf\\.(?:gz|bz2)|[a-z0-9]{1,10})$/i)) {\n\t\t\t\tif (typeof m[1] === 'undefined') {\n\t\t\t\t\tm[1] = '';\n\t\t\t\t}\n\t\t\t\treturn [m[1], m[2]];\n\t\t\t} else {\n\t\t\t\treturn [name, ''];\n\t\t\t}\n\t\t},\n\t\t\n\t\t/**\n\t\t * Slice the ArrayBuffer by sliceSize\n\t\t *\n\t\t * @param      arraybuffer  arrayBuffer  The array buffer\n\t\t * @param      Number       sliceSize    The slice size\n\t\t * @return     Array   Array of sleced arraybuffer\n\t\t */\n\t\tsliceArrayBuffer : function(arrayBuffer, sliceSize) {\n\t\t\tvar segments= [],\n\t\t\t\tfi = 0;\n\t\t\twhile(fi * sliceSize < arrayBuffer.byteLength){\n\t\t\t\tsegments.push(arrayBuffer.slice(fi * sliceSize, (fi + 1) * sliceSize));\n\t\t\t\tfi++;\n\t\t\t}\n\t\t\treturn segments;\n\t\t},\n\n\t\tarrayBufferToBase64 : function(ab) {\n\t\t\tif (!window.btoa) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tvar dView = new Uint8Array(ab), // Get a byte view\n\t\t\t\tarr = Array.prototype.slice.call(dView), // Create a normal array\n\t\t\t\tarr1 = arr.map(function(item) {\n\t\t\t\t\treturn String.fromCharCode(item); // Convert\n\t\t\t\t});\n\t\t    return window.btoa(arr1.join('')); // Form a string\n\t\t},\n\n\t\tlog : function(m) { window.console && window.console.log && window.console.log(m); return this; },\n\t\t\n\t\tdebug : function(type, m) {\n\t\t\tvar self = this,\n\t\t\t\td = this.options.debug,\n\t\t\t\ttb = this.options.toastBackendWarn,\n\t\t\t\ttbOpts, showlog;\n\n\t\t\tif (type === 'backend-error') {\n\t\t\t\tif (! this.cwd().hash || (d && (d === 'all' || d['backend-error']))) {\n\t\t\t\t\tm = Array.isArray(m)? m : [ m ];\n\t\t\t\t\tthis.error(m);\n\t\t\t\t}\n\t\t\t} else if (type === 'backend-warning') {\n\t\t\t\tshowlog = true;\n\t\t\t\tif (tb) {\n\t\t\t\t\ttbOpts = $.isPlainObject(tb)? tb : {};\n\t\t\t\t\t$.each(Array.isArray(m)? m : [ m ], function(i, m) {\n\t\t\t\t\t\tself.toast(Object.assign({\n\t\t\t\t\t\t\tmode : 'warning',\n\t\t\t\t\t\t\tmsg: m\n\t\t\t\t\t\t}, tbOpts));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (type === 'backend-debug') {\n\t\t\t\tthis.trigger('backenddebug', m);\n\t\t\t}\n\t\t\t\n\t\t\tif (showlog || (d && (d === 'all' || d[type]))) {\n\t\t\t\twindow.console && window.console.log && window.console.log('elfinder debug: ['+type+'] ['+this.id+']', m);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Parse response.debug and trigger debug\n\t\t *\n\t\t * @param      Object  response  The response\n\t\t */\n\t\tresponseDebug : function(response) {\n\t\t\tvar rd = response.debug,\n\t\t\t\td;\n\t\t\tif (rd) {\n\t\t\t\t// set options.debug\n\t\t\t\td = this.options.debug;\n\t\t\t\tif (!d || d !== 'all') {\n\t\t\t\t\tif (!d) {\n\t\t\t\t\t\td = this.options.debug = {};\n\t\t\t\t\t}\n\t\t\t\t\td['backend-error'] = true;\n\t\t\t\t\td['warning'] = true;\n\t\t\t\t}\n\t\t\t\tif (rd.mountErrors && (typeof rd.mountErrors === 'string' || (Array.isArray(rd.mountErrors) && rd.mountErrors.length))) {\n\t\t\t\t\tthis.debug('backend-error', rd.mountErrors);\n\t\t\t\t}\n\t\t\t\tif (rd.backendErrors && (typeof rd.backendErrors === 'string' || (Array.isArray(rd.backendErrors) && rd.backendErrors.length))) {\n\t\t\t\t\tthis.debug('backend-warning', rd.backendErrors);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttime : function(l) { window.console && window.console.time && window.console.time(l); },\n\t\ttimeEnd : function(l) { window.console && window.console.timeEnd && window.console.timeEnd(l); }\n\t\t\n\n\t};\n\n\t/**\n\t * for conpat ex. ie8...\n\t *\n\t * Object.keys() - JavaScript | MDN\n\t * https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n\t */\n\tif (!Object.keys) {\n\t\tObject.keys = (function () {\n\t\t\tvar hasOwnProperty = Object.prototype.hasOwnProperty,\n\t\t\t\t\thasDontEnumBug = !({toString: null}).propertyIsEnumerable('toString'),\n\t\t\t\t\tdontEnums = [\n\t\t\t\t\t\t'toString',\n\t\t\t\t\t\t'toLocaleString',\n\t\t\t\t\t\t'valueOf',\n\t\t\t\t\t\t'hasOwnProperty',\n\t\t\t\t\t\t'isPrototypeOf',\n\t\t\t\t\t\t'propertyIsEnumerable',\n\t\t\t\t\t\t'constructor'\n\t\t\t\t\t],\n\t\t\t\t\tdontEnumsLength = dontEnums.length;\n\n\t\t\treturn function (obj) {\n\t\t\t\tif (typeof obj !== 'object' && typeof obj !== 'function' || obj === null) throw new TypeError('Object.keys called on non-object');\n\n\t\t\t\tvar result = [];\n\n\t\t\t\tfor (var prop in obj) {\n\t\t\t\t\tif (hasOwnProperty.call(obj, prop)) result.push(prop);\n\t\t\t\t}\n\n\t\t\t\tif (hasDontEnumBug) {\n\t\t\t\t\tfor (var i=0; i < dontEnumsLength; i++) {\n\t\t\t\t\t\tif (hasOwnProperty.call(obj, dontEnums[i])) result.push(dontEnums[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t})();\n\t}\n\t// Array.isArray\n\tif (!Array.isArray) {\n\t\tArray.isArray = function(arr) {\n\t\t\treturn jQuery.isArray(arr);\n\t\t};\n\t}\n\t// Object.assign\n\tif (!Object.assign) {\n\t\tObject.assign = function() {\n\t\t\treturn jQuery.extend.apply(null, arguments);\n\t\t};\n\t}\n\t// String.repeat\n\tif (!String.prototype.repeat) {\n\t\tString.prototype.repeat = function(count) {\n\t\t\t'use strict';\n\t\t\tif (this == null) {\n\t\t\t\tthrow new TypeError('can\\'t convert ' + this + ' to object');\n\t\t\t}\n\t\t\tvar str = '' + this;\n\t\t\tcount = +count;\n\t\t\tif (count != count) {\n\t\t\t\tcount = 0;\n\t\t\t}\n\t\t\tif (count < 0) {\n\t\t\t\tthrow new RangeError('repeat count must be non-negative');\n\t\t\t}\n\t\t\tif (count == Infinity) {\n\t\t\t\tthrow new RangeError('repeat count must be less than infinity');\n\t\t\t}\n\t\t\tcount = Math.floor(count);\n\t\t\tif (str.length == 0 || count == 0) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\t// Ensuring count is a 31-bit integer allows us to heavily optimize the\n\t\t\t// main part. But anyway, most current (August 2014) browsers can't handle\n\t\t\t// strings 1 << 28 chars or longer, so:\n\t\t\tif (str.length * count >= 1 << 28) {\n\t\t\t\tthrow new RangeError('repeat count must not overflow maximum string size');\n\t\t\t}\n\t\t\tvar rpt = '';\n\t\t\tfor (var i = 0; i < count; i++) {\n\t\t\t\trpt += str;\n\t\t\t}\n\t\t\treturn rpt;\n\t\t};\n\t}\n\t// String.trim\n\tif (!String.prototype.trim) {\n\t\tString.prototype.trim = function() {\n\t\t\treturn this.replace(/^\\s+|\\s+$/g, '');\n\t\t};\n\t}\n\t// Array.apply\n\t(function () {\n\t\ttry {\n\t\t\tArray.apply(null, {});\n\t\t\treturn;\n\t\t} catch (e) { }\n\n\t\tvar toString = Object.prototype.toString,\n\t\t\tarrayType = '[object Array]',\n\t\t\t_apply = Function.prototype.apply,\n\t\t\tslice = /*@cc_on @if (@_jscript_version <= 5.8)\n\t\t\t\tfunction () {\n\t\t\t\t\tvar a = [], i = this.length;\n\t\t\t\t\twhile (i-- > 0) a[i] = this[i];\n\t\t\t\t\treturn a;\n\t\t\t\t}@else@*/Array.prototype.slice/*@end@*/;\n\n\t\tFunction.prototype.apply = function apply(thisArg, argArray) {\n\t\t\treturn _apply.call(this, thisArg,\n\t\t\t\ttoString.call(argArray) === arrayType ? argArray : slice.call(argArray));\n\t\t};\n\t})();\n\t// Array.from\n\tif (!Array.from) {\n\t\tArray.from = function(obj) {\n\t\t\treturn obj.length === 1 ? [obj[0]] : Array.apply(null, obj);\n\t\t};\n\t}\n\t// window.requestAnimationFrame and window.cancelAnimationFrame\n\tif (!window.cancelAnimationFrame) {\n\t// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\t// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n\t// requestAnimationFrame polyfill by Erik Mller. fixes from Paul Irish and Tino Zijdel\n\t// MIT license\n\t(function() {\n\t    var lastTime = 0;\n\t    var vendors = ['ms', 'moz', 'webkit', 'o'];\n\t    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n\t        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] \n\t                                   || window[vendors[x]+'CancelRequestAnimationFrame'];\n\t    }\n\t \n\t    if (!window.requestAnimationFrame)\n\t        window.requestAnimationFrame = function(callback, element) {\n\t            var currTime = new Date().getTime();\n\t            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, \n\t              timeToCall);\n\t            lastTime = currTime + timeToCall;\n\t            return id;\n\t        };\n\t \n\t    if (!window.cancelAnimationFrame)\n\t        window.cancelAnimationFrame = function(id) {\n\t            clearTimeout(id);\n\t        };\n\t}());\n\t}\n\n\treturn elFinder;\n});\n"]}