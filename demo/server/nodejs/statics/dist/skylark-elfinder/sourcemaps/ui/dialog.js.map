{"version":3,"sources":["ui/dialog.js"],"names":["define","$","fn","elfinderdialog","opts","fm","propagationEvents","syncTm","dialog","elfNode","restoreStyle","platformWin","window","navigator","platform","indexOf","delta","syncSize","enabled","width","height","defaultSize","fitSize","node","options","dialogContained","maxWidth","maxHeight","Object","assign","css","trigger","data","resizable","syncFunc","e","cancelAnimationFrame","requestAnimationFrame","checkEditing","dialogs","children","res","length","ui","getUI","this","closest","elfinder","show","hide","fadeIn","stop","is","remove","close","defaults","allowMinimize","find","openMaximized","headerBtnPos","headerBtnOrder","modal","arrayFlip","filter","each","maxSize","toFocusNode","self","addClass","cldialog","clhover","cltabstop","id","parseInt","Math","random","titlebar","title","buttonset","buttonpane","append","btnWidth","btnCnt","tabstops","evCover","tabstopsInit","attr","tabstopNext","cur","elms","first","i","elm","eq","headerBtns","prepend","on","preventDefault","stopPropagation","maximize","allowMaximize","full","toggleClass","hasClass","draggable","outerHeight","removeData","posCheck","init","toggleMaximize","call","minimize","btn","mnode","doffset","$this","tray","dumStyle","dum","get","className","pos","before","position","offset","toFront","animate","v","text","clone","removeClass","empty","toHide","appendTo","cssClass","containment","handle","start","drag","top","left","minWidth","minHeight","type","namespace","d","_top","_left","ct","abs","cl","elfinderoverlay","proxy","open","closeOnEscape","document","keyCode","ESCAPE","dfd","beforeclose","promise","Deferred","resolve","reject","done","off","destroyOnClose","parent","s","storage","uiOptions","focusOnMouseOver","UA","Mobile","nodeOffset","minTop","minLeft","outerSize","win","winSize","nodeFull","enableAlways","overflow","Rotated","outerWidth","right","bottom","scrLeft","scrollLeft","scrTop","scrollTop","max","absolute","h","minH","maxH","autoH","oh","maxmize","max-height","originalEvent","match","floor","min","resize","labelfor","nodeName","btnHoverFocus","esc","move","ENTER","TAB","shiftKey","LEFT","UP","RIGHT","DOWN","ctrlKey","metaKey","val","last","split","reverse","buttons","name","cb","button","_cssClass","clearTimeout","setTimeout","optimizeNumber","create","autoOpen","bind"],"mappings":"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","file":"../../ui/dialog.js","sourcesContent":["define([\n\t\"skylark-jquery\"\n],function($) {\n\t/**\n\t * @class  elFinder dialog\n\t *\n\t * @author Dmitry (dio) Levashov\n\t **/\n\t$.fn.elfinderdialog = function(opts, fm) {\n\t\t\"use strict\";\n\t\tvar platformWin = (window.navigator.platform.indexOf('Win') != -1),\n\t\t\tdelta       = {},\n\t\t\tsyncSize    = { enabled: false, width: false, height: false, defaultSize: null },\n\t\t\tfitSize     = function(dialog) {\n\t\t\t\tvar opts, node;\n\t\t\t\tif (syncSize.enabled) {\n\t\t\t\t\tnode = fm.options.dialogContained? elfNode : $(window);\n\t\t\t\t\topts = {\n\t\t\t\t\t\tmaxWidth : syncSize.width?  node.width() - delta.width  : null,\n\t\t\t\t\t\tmaxHeight: syncSize.height? node.height() - delta.height : null\n\t\t\t\t\t};\n\t\t\t\t\tObject.assign(restoreStyle, opts);\n\t\t\t\t\tdialog.css(opts).trigger('resize');\n\t\t\t\t\tif (dialog.data('hasResizable') && (dialog.resizable('option', 'maxWidth') < opts.maxWidth || dialog.resizable('option', 'maxHeight') < opts.maxHeight)) {\n\t\t\t\t\t\tdialog.resizable('option', opts);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsyncFunc    = function(e) {\n\t\t\t\tvar dialog = e.data;\n\t\t\t\tsyncTm && cancelAnimationFrame(syncTm);\n\t\t\t\tsyncTm = requestAnimationFrame(function() {\n\t\t\t\t\tvar opts, offset;\n\t\t\t\t\tif (syncSize.enabled) {\n\t\t\t\t\t\tfitSize(dialog);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tcheckEditing = function() {\n\t\t\t\tvar cldialog = 'elfinder-dialog',\n\t\t\t\t\tdialogs = elfNode.children('.' + cldialog + '.' + fm.res('class', 'editing') + ':visible');\n\t\t\t\tfm[dialogs.length? 'disable' : 'enable']();\n\t\t\t},\n\t\t\tpropagationEvents = {},\n\t\t\tsyncTm, dialog, elfNode, restoreStyle;\n\t\t\n\t\tif (fm && fm.ui) {\n\t\t\telfNode = fm.getUI();\n\t\t} else {\n\t\t\telfNode = this.closest('.elfinder');\n\t\t\tif (! fm) {\n\t\t\t\tfm = elfNode.elfinder('instance');\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (typeof opts  === 'string') {\n\t\t\tif ((dialog = this.closest('.ui-dialog')).length) {\n\t\t\t\tif (opts === 'open') {\n\t\t\t\t\tif (dialog.css('display') === 'none') {\n\t\t\t\t\t\t// Need dialog.show() and hide() to detect elements size in open() callbacks\n\t\t\t\t\t\tdialog.trigger('posinit').show().trigger('open').hide();\n\t\t\t\t\t\tdialog.fadeIn(120, function() {\n\t\t\t\t\t\t\tfm.trigger('dialogopened', {dialog: dialog});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else if (opts === 'close' || opts === 'destroy') {\n\t\t\t\t\tdialog.stop(true);\n\t\t\t\t\tif (dialog.is(':visible') || elfNode.is(':hidden')) {\n\t\t\t\t\t\tdialog.trigger('close');\n\t\t\t\t\t\tfm.trigger('dialogclosed', {dialog: dialog});\n\t\t\t\t\t}\n\t\t\t\t\tif (opts === 'destroy') {\n\t\t\t\t\t\tdialog.remove();\n\t\t\t\t\t\tfm.trigger('dialogremoved', {dialog: dialog});\n\t\t\t\t\t} else if (dialog.data('minimized')) {\n\t\t\t\t\t\tdialog.data('minimized').close();\n\t\t\t\t\t}\n\t\t\t\t} else if (opts === 'toTop') {\n\t\t\t\t\tdialog.trigger('totop');\n\t\t\t\t\tfm.trigger('dialogtotoped', {dialog: dialog});\n\t\t\t\t} else if (opts === 'posInit') {\n\t\t\t\t\tdialog.trigger('posinit');\n\t\t\t\t\tfm.trigger('dialogposinited', {dialog: dialog});\n\t\t\t\t} else if (opts === 'tabstopsInit') {\n\t\t\t\t\tdialog.trigger('tabstopsInit');\n\t\t\t\t\tfm.trigger('dialogtabstopsinited', {dialog: dialog});\n\t\t\t\t} else if (opts === 'checkEditing') {\n\t\t\t\t\tcheckEditing();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\t\n\t\topts = Object.assign({}, $.fn.elfinderdialog.defaults, opts);\n\t\t\n\t\tif (opts.allowMinimize && opts.allowMinimize === 'auto') {\n\t\t\topts.allowMinimize = this.find('textarea,input').length? true : false; \n\t\t}\n\t\topts.openMaximized = opts.allowMinimize && opts.openMaximized;\n\t\tif (opts.headerBtnPos && opts.headerBtnPos === 'auto') {\n\t\t\topts.headerBtnPos = platformWin? 'right' : 'left';\n\t\t}\n\t\tif (opts.headerBtnOrder && opts.headerBtnOrder === 'auto') {\n\t\t\topts.headerBtnOrder = platformWin? 'close:maximize:minimize' : 'close:minimize:maximize';\n\t\t}\n\t\t\n\t\tif (opts.modal && opts.allowMinimize) {\n\t\t\topts.allowMinimize = false;\n\t\t}\n\t\t\n\t\tif (fm.options.dialogContained) {\n\t\t\tsyncSize.width = syncSize.height = syncSize.enabled = true;\n\t\t} else {\n\t\t\tsyncSize.width = (opts.maxWidth === 'window');\n\t\t\tsyncSize.height = (opts.maxHeight === 'window');\n\t\t\tif (syncSize.width || syncSize.height) {\n\t\t\t\tsyncSize.enabled = true;\n\t\t\t}\n\t\t}\n\n\t\tpropagationEvents = fm.arrayFlip(opts.propagationEvents, true);\n\t\t\n\t\tthis.filter(':not(.ui-dialog-content)').each(function() {\n\t\t\tvar self       = $(this).addClass('ui-dialog-content ui-widget-content'),\n\t\t\t\tclactive   = 'elfinder-dialog-active',\n\t\t\t\tcldialog   = 'elfinder-dialog',\n\t\t\t\tclnotify   = 'elfinder-dialog-notify',\n\t\t\t\tclhover    = 'ui-state-hover',\n\t\t\t\tcltabstop  = 'elfinder-tabstop',\n\t\t\t\tcl1stfocus = 'elfinder-focus',\n\t\t\t\tclmodal    = 'elfinder-dialog-modal',\n\t\t\t\tid         = parseInt(Math.random()*1000000),\n\t\t\t\ttitlebar   = $('<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-top ui-helper-clearfix\"><span class=\"elfinder-dialog-title\">'+opts.title+'</span></div>'),\n\t\t\t\tbuttonset  = $('<div class=\"ui-dialog-buttonset\"/>'),\n\t\t\t\tbuttonpane = $('<div class=\" ui-helper-clearfix ui-dialog-buttonpane ui-widget-content\"/>')\n\t\t\t\t\t.append(buttonset),\n\t\t\t\tbtnWidth   = 0,\n\t\t\t\tbtnCnt     = 0,\n\t\t\t\ttabstops   = $(),\n\t\t\t\tevCover    = $('<div style=\"width:100%;height:100%;position:absolute;top:0px;left:0px;\"/>').hide(),\n\t\t\t\tnumberToTel = function() {\n\t\t\t\t\tif (opts.optimizeNumber) {\n\t\t\t\t\t\tdialog.find('input[type=number]').each(function() {\n\t\t\t\t\t\t\t$(this).attr('inputmode', 'numeric');\n\t\t\t\t\t\t\t$(this).attr('pattern', '[0-9]*');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttabstopsInit = function() {\n\t\t\t\t\ttabstops = dialog.find('.'+cltabstop);\n\t\t\t\t\tif (tabstops.length) {\n\t\t\t\t\t\ttabstops.attr('tabindex', '-1');\n\t\t\t\t\t\tif (! tabstops.filter('.'+cl1stfocus).length) {\n\t\t\t\t\t\t\tbuttonset.children('.'+cltabstop+':'+(platformWin? 'first' : 'last')).addClass(cl1stfocus);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttabstopNext = function(cur) {\n\t\t\t\t\tvar elms = tabstops.filter(':visible:enabled'),\n\t\t\t\t\t\tnode = cur? null : elms.filter('.'+cl1stfocus+':first');\n\t\t\t\t\t\t\n\t\t\t\t\tif (! node || ! node.length) {\n\t\t\t\t\t\tnode = elms.first();\n\t\t\t\t\t}\n\t\t\t\t\tif (cur) {\n\t\t\t\t\t\t$.each(elms, function(i, elm) {\n\t\t\t\t\t\t\tif (elm === cur && elms[i+1]) {\n\t\t\t\t\t\t\t\tnode = elms.eq(i+1);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn node;\n\t\t\t\t},\n\t\t\t\ttabstopPrev = function(cur) {\n\t\t\t\t\tvar elms = tabstops.filter(':visible:enabled'),\n\t\t\t\t\t\tnode = elms.last();\n\t\t\t\t\t$.each(elms, function(i, elm) {\n\t\t\t\t\t\tif (elm === cur && elms[i-1]) {\n\t\t\t\t\t\t\tnode = elms.eq(i-1);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn node;\n\t\t\t\t},\n\t\t\t\tmakeHeaderBtn = function() {\n\t\t\t\t\t$.each(opts.headerBtnOrder.split(':').reverse(), function(i, v) {\n\t\t\t\t\t\theaderBtns[v] && headerBtns[v]();\n\t\t\t\t\t});\n\t\t\t\t\tif (platformWin) {\n\t\t\t\t\t\ttitlebar.children('.elfinder-titlebar-button').addClass('elfinder-titlebar-button-right');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\theaderBtns = {\n\t\t\t\t\tclose: function() {\n\t\t\t\t\t\ttitlebar.prepend($('<span class=\"ui-widget-header ui-dialog-titlebar-close ui-corner-all elfinder-titlebar-button\"><span class=\"ui-icon ui-icon-closethick\"/></span>')\n\t\t\t\t\t\t\t.on('mousedown', function(e) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tself.elfinderdialog('close');\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tmaximize: function() {\n\t\t\t\t\t\tif (opts.allowMaximize) {\n\t\t\t\t\t\t\tdialog.on('resize', function(e, data) {\n\t\t\t\t\t\t\t\tvar full, elm;\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tif (data && data.maximize) {\n\t\t\t\t\t\t\t\t\telm = titlebar.find('.elfinder-titlebar-full');\n\t\t\t\t\t\t\t\t\tfull = (data.maximize === 'on');\n\t\t\t\t\t\t\t\t\telm.children('span.ui-icon')\n\t\t\t\t\t\t\t\t\t\t.toggleClass('ui-icon-plusthick', ! full)\n\t\t\t\t\t\t\t\t\t\t.toggleClass('ui-icon-arrowreturnthick-1-s', full);\n\t\t\t\t\t\t\t\t\tif (full) {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tdialog.hasClass('ui-draggable') && dialog.draggable('disable');\n\t\t\t\t\t\t\t\t\t\t\tdialog.hasClass('ui-resizable') && dialog.resizable('disable');\n\t\t\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t\t\t\tself.css('width', '100%').css('height', dialog.height() - dialog.children('.ui-dialog-titlebar').outerHeight(true) - buttonpane.outerHeight(true));\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tself.attr('style', elm.data('style'));\n\t\t\t\t\t\t\t\t\t\telm.removeData('style');\n\t\t\t\t\t\t\t\t\t\tposCheck();\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tdialog.hasClass('ui-draggable') && dialog.draggable('enable');\n\t\t\t\t\t\t\t\t\t\t\tdialog.hasClass('ui-resizable') && dialog.resizable('enable');\n\t\t\t\t\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdialog.trigger('resize', {init: true});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ttitlebar.prepend($('<span class=\"ui-widget-header ui-corner-all elfinder-titlebar-button elfinder-titlebar-full\"><span class=\"ui-icon ui-icon-plusthick\"/></span>')\n\t\t\t\t\t\t\t\t.on('mousedown', function(e) {\n\t\t\t\t\t\t\t\t\tvar elm = $(this);\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\tif (!dialog.hasClass('elfinder-maximized') && typeof elm.data('style') === 'undefined') {\n\t\t\t\t\t\t\t\t\t\tself.height(self.height());\n\t\t\t\t\t\t\t\t\t\telm.data('style', self.attr('style') || '');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfm.toggleMaximize(dialog);\n\t\t\t\t\t\t\t\t\ttypeof(opts.maximize) === 'function' && opts.maximize.call(self[0]);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t},\n\t\t\t\t\tminimize: function() {\n\t\t\t\t\t\tvar btn, mnode, doffset;\n\t\t\t\t\t\tif (opts.allowMinimize) {\n\t\t\t\t\t\t\tbtn = $('<span class=\"ui-widget-header ui-corner-all elfinder-titlebar-button elfinder-titlebar-minimize\"><span class=\"ui-icon ui-icon-minusthick\"/></span>')\n\t\t\t\t\t\t\t\t.on('mousedown', function(e) {\n\t\t\t\t\t\t\t\t\tvar $this = $(this),\n\t\t\t\t\t\t\t\t\t\ttray = fm.getUI('bottomtray'),\n\t\t\t\t\t\t\t\t\t\tdumStyle = { width: 70, height: 24 },\n\t\t\t\t\t\t\t\t\t\tdum = $('<div/>').css(dumStyle).addClass(dialog.get(0).className + ' elfinder-dialog-minimized'),\n\t\t\t\t\t\t\t\t\t\tclose = function() {\n\t\t\t\t\t\t\t\t\t\t\tmnode.remove();\n\t\t\t\t\t\t\t\t\t\t\tdialog.removeData('minimized').show();\n\t\t\t\t\t\t\t\t\t\t\tself.elfinderdialog('close');\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tpos = {};\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\tif (!dialog.data('minimized')) {\n\t\t\t\t\t\t\t\t\t\t// minimize\n\t\t\t\t\t\t\t\t\t\tdoffset = dialog.data('minimized', {\n\t\t\t\t\t\t\t\t\t\t\tdialog : function() { return mnode; },\n\t\t\t\t\t\t\t\t\t\t\tshow : function() { mnode.show(); },\n\t\t\t\t\t\t\t\t\t\t\thide : function() { mnode.hide(); },\n\t\t\t\t\t\t\t\t\t\t\tclose : close,\n\t\t\t\t\t\t\t\t\t\t\ttitle : function(v) { mnode.children('.ui-dialog-titlebar').children('.elfinder-dialog-title').text(v); }\n\t\t\t\t\t\t\t\t\t\t}).position();\n\t\t\t\t\t\t\t\t\t\tmnode = dialog.clone().on('mousedown', function() {\n\t\t\t\t\t\t\t\t\t\t\t$this.trigger('mousedown');\n\t\t\t\t\t\t\t\t\t\t}).removeClass('ui-draggable ui-resizable elfinder-frontmost');\n\t\t\t\t\t\t\t\t\t\ttray.append(dum);\n\t\t\t\t\t\t\t\t\t\tObject.assign(pos, dum.offset(), dumStyle);\n\t\t\t\t\t\t\t\t\t\tdum.remove();\n\t\t\t\t\t\t\t\t\t\tmnode.height(dialog.height()).children('.ui-dialog-content:first').empty();\n\t\t\t\t\t\t\t\t\t\tfm.toHide(dialog.before(mnode));\n\t\t\t\t\t\t\t\t\t\tmnode.children('.ui-dialog-content:first,.ui-dialog-buttonpane,.ui-resizable-handle').remove();\n\t\t\t\t\t\t\t\t\t\tmnode.find('.elfinder-titlebar-minimize,.elfinder-titlebar-full').remove();\n\t\t\t\t\t\t\t\t\t\tmnode.find('.ui-dialog-titlebar-close').on('mousedown', function(e) {\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\tclose();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tmnode.animate(pos, function() {\n\t\t\t\t\t\t\t\t\t\t\tmnode.attr('style', '')\n\t\t\t\t\t\t\t\t\t\t\t.css({ maxWidth: dialog.width() })\n\t\t\t\t\t\t\t\t\t\t\t.addClass('elfinder-dialog-minimized')\n\t\t\t\t\t\t\t\t\t\t\t.appendTo(tray);\n\t\t\t\t\t\t\t\t\t\t\tcheckEditing();\n\t\t\t\t\t\t\t\t\t\t\ttypeof(opts.minimize) === 'function' && opts.minimize.call(self[0]);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t//restore\n\t\t\t\t\t\t\t\t\t\tdialog.removeData('minimized').before(mnode.css(Object.assign({'position': 'absolute'}, mnode.offset())));\n\t\t\t\t\t\t\t\t\t\tfm.toFront(mnode);\n\t\t\t\t\t\t\t\t\t\tmnode.animate(Object.assign({ width: dialog.width(), height: dialog.height() }, doffset), function() {\n\t\t\t\t\t\t\t\t\t\t\tdialog.show();\n\t\t\t\t\t\t\t\t\t\t\tfm.toFront(dialog);\n\t\t\t\t\t\t\t\t\t\t\tmnode.remove();\n\t\t\t\t\t\t\t\t\t\t\tposCheck();\n\t\t\t\t\t\t\t\t\t\t\tcheckEditing();\n\t\t\t\t\t\t\t\t\t\t\tdialog.trigger('resize', {init: true});\n\t\t\t\t\t\t\t\t\t\t\ttypeof(opts.minimize) === 'function' && opts.minimize.call(self[0]);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ttitlebar.on('dblclick', function(e) {\n\t\t\t\t\t\t\t\t$(this).children('.elfinder-titlebar-minimize').trigger('mousedown');\n\t\t\t\t\t\t\t}).prepend(btn);\n\t\t\t\t\t\t\tdialog.on('togleminimize', function() {\n\t\t\t\t\t\t\t\tbtn.trigger('mousedown');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdialog = $('<div class=\"ui-front ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable std42-dialog touch-punch '+cldialog+' '+opts.cssClass+'\"/>')\n\t\t\t\t\t.hide()\n\t\t\t\t\t.append(self)\n\t\t\t\t\t.appendTo(elfNode)\n\t\t\t\t\t.draggable({\n\t\t\t\t\t\tcontainment : fm.options.dialogContained? elfNode : null,\n\t\t\t\t\t\thandle : '.ui-dialog-titlebar',\n\t\t\t\t\t\tstart : function() {\n\t\t\t\t\t\t\tevCover.show();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdrag : function(e, ui) {\n\t\t\t\t\t\t\tvar top = ui.offset.top,\n\t\t\t\t\t\t\t\tleft = ui.offset.left;\n\t\t\t\t\t\t\tif (top < 0) {\n\t\t\t\t\t\t\t\tui.position.top = ui.position.top - top;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (left < 0) {\n\t\t\t\t\t\t\t\tui.position.left = ui.position.left - left;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (fm.options.dialogContained) {\n\t\t\t\t\t\t\t\tui.position.top < 0 && (ui.position.top = 0);\n\t\t\t\t\t\t\t\tui.position.left < 0 && (ui.position.left = 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstop : function(e, ui) {\n\t\t\t\t\t\t\tevCover.hide();\n\t\t\t\t\t\t\tdialog.css({height : opts.height});\n\t\t\t\t\t\t\tself.data('draged', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.css({\n\t\t\t\t\t\twidth     : opts.width,\n\t\t\t\t\t\theight    : opts.height,\n\t\t\t\t\t\tminWidth  : opts.minWidth,\n\t\t\t\t\t\tminHeight : opts.minHeight,\n\t\t\t\t\t\tmaxWidth  : opts.maxWidth,\n\t\t\t\t\t\tmaxHeight : opts.maxHeight\n\t\t\t\t\t})\n\t\t\t\t\t.on('touchstart touchmove touchend click dblclick mouseup mouseenter mouseleave mouseout mouseover mousemove', function(e) {\n\t\t\t\t\t\t// stopPropagation of user action events\n\t\t\t\t\t\t!propagationEvents[e.type] && e.stopPropagation();\n\t\t\t\t\t})\n\t\t\t\t\t.on('mousedown', function(e) {\n\t\t\t\t\t\t!propagationEvents[e.type] && e.stopPropagation();\n\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\tif (dialog.is(':visible') && !dialog.hasClass('elfinder-frontmost')) {\n\t\t\t\t\t\t\t\ttoFocusNode = $(':focus');\n\t\t\t\t\t\t\t\tif (!toFocusNode.length) {\n\t\t\t\t\t\t\t\t\ttoFocusNode = void(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdialog.trigger('totop');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.on('open', function() {\n\t\t\t\t\t\tdialog.data('margin-y', self.outerHeight(true) - self.height());\n\t\t\t\t\t\tif (syncSize.enabled) {\n\t\t\t\t\t\t\tif (opts.height && opts.height !== 'auto') {\n\t\t\t\t\t\t\t\tdialog.trigger('resize', {init: true});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!syncSize.defaultSize) {\n\t\t\t\t\t\t\t\tsyncSize.defaultSize = { width: self.width(), height: self.height() };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfitSize(dialog);\n\t\t\t\t\t\t\tdialog.trigger('resize').trigger('posinit');\n\t\t\t\t\t\t\telfNode.on('resize.'+fm.namespace, dialog, syncFunc);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!dialog.hasClass(clnotify)) {\n\t\t\t\t\t\t\telfNode.children('.'+cldialog+':visible:not(.'+clnotify+')').each(function() {\n\t\t\t\t\t\t\t\tvar d     = $(this),\n\t\t\t\t\t\t\t\t\ttop   = parseInt(d.css('top')),\n\t\t\t\t\t\t\t\t\tleft  = parseInt(d.css('left')),\n\t\t\t\t\t\t\t\t\t_top  = parseInt(dialog.css('top')),\n\t\t\t\t\t\t\t\t\t_left = parseInt(dialog.css('left')),\n\t\t\t\t\t\t\t\t\tct    = Math.abs(top - _top) < 10,\n\t\t\t\t\t\t\t\t\tcl    = Math.abs(left - _left) < 10;\n\n\t\t\t\t\t\t\t\tif (d[0] != dialog[0] && (ct || cl)) {\n\t\t\t\t\t\t\t\t\tdialog.css({\n\t\t\t\t\t\t\t\t\t\ttop  : ct ? (top + 10) : _top,\n\t\t\t\t\t\t\t\t\t\tleft : cl ? (left + 10) : _left\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} \n\t\t\t\t\t\t\n\t\t\t\t\t\tif (dialog.data('modal')) {\n\t\t\t\t\t\t\tdialog.addClass(clmodal);\n\t\t\t\t\t\t\tfm.getUI('overlay').elfinderoverlay('show');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdialog.trigger('totop');\n\t\t\t\t\t\t\n\t\t\t\t\t\topts.openMaximized && fm.toggleMaximize(dialog);\n\n\t\t\t\t\t\tfm.trigger('dialogopen', {dialog: dialog});\n\n\t\t\t\t\t\ttypeof(opts.open) == 'function' && $.proxy(opts.open, self[0])();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (opts.closeOnEscape) {\n\t\t\t\t\t\t\t$(document).on('keydown.'+id, function(e) {\n\t\t\t\t\t\t\t\tif (e.keyCode == $.ui.keyCode.ESCAPE && dialog.hasClass('elfinder-frontmost')) {\n\t\t\t\t\t\t\t\t\tself.elfinderdialog('close');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdialog.hasClass(fm.res('class', 'editing')) && checkEditing();\n\t\t\t\t\t})\n\t\t\t\t\t.on('close', function(e) {\n\t\t\t\t\t\tvar dialogs, dfd;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (opts.beforeclose && typeof opts.beforeclose === 'function') {\n\t\t\t\t\t\t\tdfd = opts.beforeclose();\n\t\t\t\t\t\t\tif (!dfd || !dfd.promise) {\n\t\t\t\t\t\t\t\tdfd = !dfd? $.Deferred().reject() : $.Deferred().resolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfd = $.Deferred().resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdfd.done(function() {\n\t\t\t\t\t\t\tsyncSize.enabled && elfNode.off('resize.'+fm.namespace, syncFunc);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (opts.closeOnEscape) {\n\t\t\t\t\t\t\t\t$(document).off('keyup.'+id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (opts.allowMaximize) {\n\t\t\t\t\t\t\t\tfm.toggleMaximize(dialog, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfm.toHide(dialog);\n\t\t\t\t\t\t\tdialog.data('modal') && fm.getUI('overlay').elfinderoverlay('hide');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (typeof(opts.close) == 'function') {\n\t\t\t\t\t\t\t\t$.proxy(opts.close, self[0])();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (opts.destroyOnClose && dialog.parent().length) {\n\t\t\t\t\t\t\t\tdialog.hide().remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// get focus to next dialog\n\t\t\t\t\t\t\tdialogs = elfNode.children('.'+cldialog+':visible');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdialog.hasClass(fm.res('class', 'editing')) && checkEditing();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.on('totop frontmost', function() {\n\t\t\t\t\t\tvar s = fm.storage('autoFocusDialog');\n\t\t\t\t\t\t\n\t\t\t\t\t\tdialog.data('focusOnMouseOver', s? (s > 0) : fm.options.uiOptions.dialog.focusOnMouseOver);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (dialog.data('minimized')) {\n\t\t\t\t\t\t\ttitlebar.children('.elfinder-titlebar-minimize').trigger('mousedown');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!dialog.data('modal') && fm.getUI('overlay').is(':visible')) {\n\t\t\t\t\t\t\tfm.getUI('overlay').before(dialog);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfm.toFront(dialog);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telfNode.children('.'+cldialog+':not(.'+clmodal+')').removeClass(clactive);\n\t\t\t\t\t\tdialog.addClass(clactive);\n\n\t\t\t\t\t\t! fm.UA.Mobile && (toFocusNode || tabstopNext()).trigger('focus');\n\n\t\t\t\t\t\ttoFocusNode = void(0);\n\t\t\t\t\t})\n\t\t\t\t\t.on('posinit', function() {\n\t\t\t\t\t\tvar css = opts.position,\n\t\t\t\t\t\t\tnodeOffset, minTop, minLeft, outerSize, win, winSize, nodeFull;\n\t\t\t\t\t\tif (dialog.hasClass('elfinder-maximized')) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (! css && ! dialog.data('resizing')) {\n\t\t\t\t\t\t\tnodeFull = elfNode.hasClass('elfinder-fullscreen') || fm.options.enableAlways;\n\t\t\t\t\t\t\tdialog.css(nodeFull? {\n\t\t\t\t\t\t\t\tmaxWidth  : '100%',\n\t\t\t\t\t\t\t\tmaxHeight : '100%',\n\t\t\t\t\t\t\t\toverflow   : 'auto'\n\t\t\t\t\t\t\t} : restoreStyle);\n\t\t\t\t\t\t\tif (fm.UA.Mobile && !nodeFull && dialog.data('rotated') === fm.UA.Rotated) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdialog.data('rotated', fm.UA.Rotated);\n\t\t\t\t\t\t\twin = $(window);\n\t\t\t\t\t\t\tnodeOffset = elfNode.offset();\n\t\t\t\t\t\t\touterSize = {\n\t\t\t\t\t\t\t\twidth : dialog.outerWidth(true),\n\t\t\t\t\t\t\t\theight: dialog.outerHeight(true)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\touterSize.right = nodeOffset.left + outerSize.width;\n\t\t\t\t\t\t\touterSize.bottom = nodeOffset.top + outerSize.height;\n\t\t\t\t\t\t\twinSize = {\n\t\t\t\t\t\t\t\tscrLeft: win.scrollLeft(),\n\t\t\t\t\t\t\t\tscrTop : win.scrollTop(),\n\t\t\t\t\t\t\t\twidth  : win.width(),\n\t\t\t\t\t\t\t\theight : win.height()\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\twinSize.right = winSize.scrLeft + winSize.width;\n\t\t\t\t\t\t\twinSize.bottom = winSize.scrTop + winSize.height;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (fm.options.dialogContained || nodeFull) {\n\t\t\t\t\t\t\t\tminTop = 0;\n\t\t\t\t\t\t\t\tminLeft = 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tminTop = nodeOffset.top * -1 + winSize.scrTop;\n\t\t\t\t\t\t\t\tminLeft = nodeOffset.left * -1 + winSize.scrLeft;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcss = {\n\t\t\t\t\t\t\t\ttop  : outerSize.height >= winSize.height? minTop  : Math.max(minTop, parseInt((elfNode.height() - outerSize.height)/2 - 42)),\n\t\t\t\t\t\t\t\tleft : outerSize.width  >= winSize.width ? minLeft : Math.max(minLeft, parseInt((elfNode.width() - outerSize.width)/2))\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (outerSize.right + css.left > winSize.right) {\n\t\t\t\t\t\t\t\tcss.left = Math.max(minLeft, winSize.right - outerSize.right);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (outerSize.bottom + css.top > winSize.bottom) {\n\t\t\t\t\t\t\t\tcss.top = Math.max(minTop, winSize.bottom - outerSize.bottom);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opts.absolute) {\n\t\t\t\t\t\t\tcss.position = 'absolute';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcss && dialog.css(css);\n\t\t\t\t\t})\n\t\t\t\t\t.on('resize', function(e, data) {\n\t\t\t\t\t\tvar oh = 0, init = data && data.init, h, minH, maxH, autoH;\n\t\t\t\t\t\tif ((data && (data.minimize || data.maxmize)) || dialog.data('minimized')) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tdialog.children('.ui-widget-header,.ui-dialog-buttonpane').each(function() {\n\t\t\t\t\t\t\toh += $(this).outerHeight(true);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tautoH = (opts.height === 'auto')? true : false;\n\t\t\t\t\t\tif (autoH) {\n\t\t\t\t\t\t\tself.css({'max-height': '', 'height': 'auto'});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!init && syncSize.enabled && !e.originalEvent && !dialog.hasClass('elfinder-maximized')) {\n\t\t\t\t\t\t\th = dialog.height();\n\t\t\t\t\t\t\tminH = dialog.css('min-height') || h;\n\t\t\t\t\t\t\tmaxH = dialog.css('max-height') || h;\n\t\t\t\t\t\t\tif (minH.match(/%/)) {\n\t\t\t\t\t\t\t\tminH = Math.floor((parseInt(minH) / 100) * dialog.parent().height());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tminH = parseInt(minH);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (maxH.match(/%/)) {\n\t\t\t\t\t\t\t\tmaxH = Math.floor((parseInt(maxH) / 100) * dialog.parent().height());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmaxH = parseInt(maxH);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\th = Math.min((autoH? dialog.height() : syncSize.defaultSize.height), Math.max(maxH, minH) - oh - dialog.data('margin-y'));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\th = dialog.height() - oh - dialog.data('margin-y');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.css(autoH? 'max-height' : 'height', h);\n\t\t\t\t\t\tif (init) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tposCheck();\n\t\t\t\t\t\tminH = self.height();\n\t\t\t\t\t\tminH = (h < minH)? (minH + oh + dialog.data('margin-y')) : opts.minHeight;\n\t\t\t\t\t\tdialog.css('min-height', minH);\n\t\t\t\t\t\tdialog.data('hasResizable') && dialog.resizable('option', { minHeight: minH });\n\t\t\t\t\t\tif (typeof(opts.resize) === 'function') {\n\t\t\t\t\t\t\t$.proxy(opts.resize, self[0])(e, data);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('tabstopsInit', tabstopsInit)\n\t\t\t\t\t.on('focus', '.'+cltabstop, function() {\n\t\t\t\t\t\t$(this).addClass(clhover).parent('label').addClass(clhover);\n\t\t\t\t\t\tthis.id && $(this).parent().find('label[for='+this.id+']').addClass(clhover);\n\t\t\t\t\t})\n\t\t\t\t\t.on('click', 'select.'+cltabstop, function() {\n\t\t\t\t\t\tvar node = $(this);\n\t\t\t\t\t\tnode.data('keepFocus')? node.removeData('keepFocus') : node.data('keepFocus', true);\n\t\t\t\t\t})\n\t\t\t\t\t.on('blur', '.'+cltabstop, function() {\n\t\t\t\t\t\t$(this).removeClass(clhover).removeData('keepFocus').parent('label').removeClass(clhover);\n\t\t\t\t\t\tthis.id && $(this).parent().find('label[for='+this.id+']').removeClass(clhover);\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseenter mouseleave', '.'+cltabstop+',label', function(e) {\n\t\t\t\t\t\tvar $this = $(this), labelfor;\n\t\t\t\t\t\tif (this.nodeName === 'LABEL') {\n\t\t\t\t\t\t\tif (!$this.children('.'+cltabstop).length && (!(labelfor = $this.attr('for')) || !$('#'+labelfor).hasClass(cltabstop))) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opts.btnHoverFocus && dialog.data('focusOnMouseOver')) {\n\t\t\t\t\t\t\tif (e.type === 'mouseenter' && ! $(':focus').data('keepFocus')) {\n\t\t\t\t\t\t\t\t$this.trigger('focus');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.toggleClass(clhover, e.type == 'mouseenter');\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('keydown', '.'+cltabstop, function(e) {\n\t\t\t\t\t\tvar $this = $(this),\n\t\t\t\t\t\t\tesc, move, moveTo;\n\t\t\t\t\t\tif ($this.is(':focus')) {\n\t\t\t\t\t\t\tesc = e.keyCode === $.ui.keyCode.ESCAPE;\n\t\t\t\t\t\t\tif (e.keyCode === $.ui.keyCode.ENTER) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t$this.trigger('click');\n\t\t\t\t\t\t\t}  else if (((e.keyCode === $.ui.keyCode.TAB) && e.shiftKey) || e.keyCode === $.ui.keyCode.LEFT || e.keyCode == $.ui.keyCode.UP) {\n\t\t\t\t\t\t\t\tmove = 'prev';\n\t\t\t\t\t\t\t}  else if (e.keyCode === $.ui.keyCode.TAB || e.keyCode == $.ui.keyCode.RIGHT || e.keyCode == $.ui.keyCode.DOWN) {\n\t\t\t\t\t\t\t\tmove = 'next';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (move\n\t\t\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t($this.is('textarea') && !(e.ctrlKey || e.metaKey))\n\t\t\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\t\t($this.is('select,span.ui-slider-handle') && e.keyCode !== $.ui.keyCode.TAB)\n\t\t\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\t\t($this.is('input:not(:checkbox,:radio)') && (!(e.ctrlKey || e.metaKey) && e.keyCode === $.ui.keyCode[move === 'prev'? 'LEFT':'RIGHT']))\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!esc) {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t} else if ($this.is('input:not(:checkbox,:radio),textarea')) {\n\t\t\t\t\t\t\t\tif ($this.val() !== '') {\n\t\t\t\t\t\t\t\t\t$this.val('');\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (move) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t(move === 'prev'? tabstopPrev : tabstopNext)(this).trigger('focus');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.data({modal: opts.modal}),\n\t\t\t\tposCheck = function() {\n\t\t\t\t\tvar node = fm.getUI(),\n\t\t\t\t\t\tpos;\n\t\t\t\t\tif (node.hasClass('elfinder-fullscreen')) {\n\t\t\t\t\t\tpos = dialog.position();\n\t\t\t\t\t\tdialog.css('top', Math.max(Math.min(Math.max(pos.top, 0), node.height() - 100), 0));\n\t\t\t\t\t\tdialog.css('left', Math.max(Math.min(Math.max(pos.left, 0), node.width() - 200), 0));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmaxSize, toFocusNode;\n\t\t\t\n\t\t\tdialog.prepend(titlebar);\n\n\t\t\tmakeHeaderBtn();\n\n\t\t\t$.each(opts.buttons, function(name, cb) {\n\t\t\t\tvar button = $('<button type=\"button\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only '\n\t\t\t\t\t\t+'elfinder-btncnt-'+(btnCnt++)+' '\n\t\t\t\t\t\t+cltabstop\n\t\t\t\t\t\t+'\"><span class=\"ui-button-text\">'+name+'</span></button>')\n\t\t\t\t\t.on('click', $.proxy(cb, self[0]));\n\t\t\t\tif (cb._cssClass) {\n\t\t\t\t\tbutton.addClass(cb._cssClass);\n\t\t\t\t}\n\t\t\t\tif (platformWin) {\n\t\t\t\t\tbuttonset.append(button);\n\t\t\t\t} else {\n\t\t\t\t\tbuttonset.prepend(button);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif (buttonset.children().length) {\n\t\t\t\tdialog.append(buttonpane);\n\t\t\t\t\n\t\t\t\tdialog.show();\n\t\t\t\tbuttonpane.find('button').each(function(i, btn) {\n\t\t\t\t\tbtnWidth += $(btn).outerWidth(true);\n\t\t\t\t});\n\t\t\t\tdialog.hide();\n\t\t\t\tbtnWidth += 20;\n\t\t\t\t\n\t\t\t\tif (dialog.width() < btnWidth) {\n\t\t\t\t\tdialog.width(btnWidth);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tdialog.append(evCover);\n\t\t\t\n\t\t\tif (syncSize.enabled) {\n\t\t\t\tdelta.width = dialog.outerWidth(true) - dialog.width() + ((dialog.outerWidth() - dialog.width()) / 2);\n\t\t\t\tdelta.height = dialog.outerHeight(true) - dialog.height() + ((dialog.outerHeight() - dialog.height()) / 2);\n\t\t\t}\n\t\t\t\n\t\t\tif (fm.options.dialogContained) {\n\t\t\t\tmaxSize = {\n\t\t\t\t\tmaxWidth: elfNode.width() - delta.width,\n\t\t\t\t\tmaxHeight: elfNode.height() - delta.height\n\t\t\t\t};\n\t\t\t\topts.maxWidth = opts.maxWidth? Math.min(maxSize.maxWidth, opts.maxWidth) : maxSize.maxWidth;\n\t\t\t\topts.maxHeight = opts.maxHeight? Math.min(maxSize.maxHeight, opts.maxHeight) : maxSize.maxHeight;\n\t\t\t\tdialog.css(maxSize);\n\t\t\t}\n\t\t\t\n\t\t\trestoreStyle = {\n\t\t\t\tmaxWidth  : dialog.css('max-width'),\n\t\t\t\tmaxHeight : dialog.css('max-height'),\n\t\t\t\toverflow   : dialog.css('overflow')\n\t\t\t};\n\t\t\t\n\t\t\tif (opts.resizable) {\n\t\t\t\tdialog.resizable({\n\t\t\t\t\tminWidth   : opts.minWidth,\n\t\t\t\t\tminHeight  : opts.minHeight,\n\t\t\t\t\tmaxWidth   : opts.maxWidth,\n\t\t\t\t\tmaxHeight  : opts.maxHeight,\n\t\t\t\t\tstart      : function() {\n\t\t\t\t\t\tevCover.show();\n\t\t\t\t\t\tif (dialog.data('resizing') !== true && dialog.data('resizing')) {\n\t\t\t\t\t\t\tclearTimeout(dialog.data('resizing'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdialog.data('resizing', true);\n\t\t\t\t\t},\n\t\t\t\t\tstop       : function(e, ui) {\n\t\t\t\t\t\tevCover.hide();\n\t\t\t\t\t\tdialog.data('resizing', setTimeout(function() {\n\t\t\t\t\t\t\tdialog.data('resizing', false);\n\t\t\t\t\t\t}, 200));\n\t\t\t\t\t\tif (syncSize.enabled) {\n\t\t\t\t\t\t\tsyncSize.defaultSize = { width: self.width(), height: self.height() };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).data('hasResizable', true);\n\t\t\t} \n\t\t\t\n\t\t\tnumberToTel();\n\t\t\t\n\t\t\ttabstopsInit();\n\t\t\t\n\t\t\ttypeof(opts.create) == 'function' && $.proxy(opts.create, this)();\n\t\t\t\n\t\t\tif (opts.autoOpen) {\n\t\t\t\tif (opts.open) {\n\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\tself.elfinderdialog('open');\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tself.elfinderdialog('open');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (opts.resize) {\n\t\t\t\tfm.bind('themechange', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tdialog.data('margin-y', self.outerHeight(true) - self.height());\n\t\t\t\t\t\tdialog.trigger('resize', {init: true});\n\t\t\t\t\t}, 300);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn this;\n\t};\n\n\t$.fn.elfinderdialog.defaults = {\n\t\tcssClass  : '',\n\t\ttitle     : '',\n\t\tmodal     : false,\n\t\tresizable : true,\n\t\tautoOpen  : true,\n\t\tcloseOnEscape : true,\n\t\tdestroyOnClose : false,\n\t\tbuttons   : {},\n\t\tbtnHoverFocus : true,\n\t\tposition  : null,\n\t\tabsolute  : false,\n\t\twidth     : 320,\n\t\theight    : 'auto',\n\t\tminWidth  : 200,\n\t\tminHeight : 70,\n\t\tmaxWidth  : null,\n\t\tmaxHeight : null,\n\t\tallowMinimize : 'auto',\n\t\tallowMaximize : false,\n\t\topenMaximized : false,\n\t\theaderBtnPos : 'auto',\n\t\theaderBtnOrder : 'auto',\n\t\toptimizeNumber : true,\n\t\tpropagationEvents : ['mousemove', 'mouseup']\n\t};\n\n});"]}