{"version":3,"sources":["ui/sortbutton.js"],"names":["define","$","fn","elfindersortbutton","cmd","this","each","tm","fm","name","c","disabled","res","hover","item","selected","asc","desc","text","title","button","addClass","attr","append","on","e","hasClass","toggleClass","type","stopPropagation","menu","is","getUI","click","css","getMenuOffset","slideToggle","duration","done","hide","toHide","appendTo","preventDefault","update","children","removeClass","filter","sortType","sortOrder","sortStickFolders","sortAlsoTreeview","baseOffset","offset","buttonOffset","top","left","sortRules","value","i18n","data","exec","one","ui","tree","options","bind","length","change","cancelAnimationFrame","requestAnimationFrame"],"mappings":";;;;;;;AAAAA,QACC,kBACC,SAASC,GAMVA,EAAEC,GAAGC,mBAAqB,SAASC,GAClC,aACA,OAAOC,KAAKC,KAAK,WAChB,IAoDCC,EApDGC,EAAWJ,EAAII,GAClBC,EAAWL,EAAIK,KACfC,EAAW,QACXC,EAAWH,EAAGI,IAAIF,EAAG,YACrBG,EAAWL,EAAGI,IAAIF,EAAG,SACrBI,EAAW,4BACXC,EAAWD,EAAK,YAChBE,EAAWD,EAAS,OACpBE,EAAWF,EAAS,QACpBG,EAAWjB,EAAE,sCAAsCG,EAAIe,MAAM,WAC7DC,EAAWnB,EAAEI,MAAMgB,SAAS,uEAAuEZ,GACjGa,KAAK,QAASlB,EAAIe,OAClBI,OAAO,0DAA0Dd,EAAK,MAAOS,GAC7EM,GAAG,wBAAyB,SAASC,IAAML,EAAOM,SAASf,IAAaS,EAAOO,YAAYd,EAAkB,eAAXY,EAAEG,QACpGJ,GAAG,QAAS,SAASC,GAChBL,EAAOM,SAASf,KACpBc,EAAEI,kBACFC,EAAKC,GAAG,YAAcvB,EAAGwB,QAAQC,QACjCH,EAAKI,IAAIC,KAAiBC,aACzBC,SAAU,IACVC,KAAM,SAASb,GACdjB,EAAGsB,EAAKC,GAAG,YAAa,UAAY,UAAUD,SAKnDS,EAAO,WAAa/B,EAAGgC,OAAOV,IAC9BA,EAAO7B,EAAE,oHACPsC,OACAE,SAASjC,EAAGwB,SACZR,GAAG,wBAAyB,IAAIV,EAAM,SAASW,GAAKxB,EAAEI,MAAMsB,YAAYd,EAAkB,eAAXY,EAAEG,QACjFJ,GAAG,QAAS,SAASC,GACrBA,EAAEiB,iBACFjB,EAAEI,oBAEFL,GAAG,QAASe,GACdI,EAAS,WACRb,EAAKc,SAAS,SAASC,YAAY9B,EAAS,IAAIC,EAAI,IAAIC,GACtD6B,OAAO,SAAStC,EAAGuC,SAAS,MAC5B1B,SAASN,EAAS,KAAqB,OAAhBP,EAAGwC,UAAqBhC,EAAMC,IAEvDa,EAAKc,SAAS,wBAAwBjB,YAAYZ,EAAUP,EAAGyC,kBAC/DnB,EAAKc,SAAS,uBAAuBjB,YAAYZ,EAAUP,EAAG0C,mBAE/Df,EAAgB,WACf,IAAIgB,EAAa3C,EAAGwB,QAAQoB,SAC3BC,EAAejC,EAAOgC,SACvB,OACCE,IAAMD,EAAaC,IAAMH,EAAWG,IACpCC,KAAOF,EAAaE,KAAOJ,EAAWI,OAKzCrC,EAAKqB,OAELtC,EAAEK,KAAKE,EAAGgD,UAAW,SAAS/C,EAAMgD,GACnC3B,EAAKP,OAAOtB,EAAE,eAAea,EAAK,UAAUL,EAAK,iGAAiGD,EAAGkD,KAAK,OAAOjD,GAAM,UAAUkD,KAAK,OAAQlD,MAG/LqB,EAAKc,WAAWpB,GAAG,QAAS,SAASC,GACpCrB,EAAIwD,QAAS3D,EAAEI,MAAMwC,YAAYhC,GAAOS,KAAK,UAG9CrB,EAAE,eAAea,EAAK,IAAIA,EAAK,0FAA0FN,EAAGkD,KAAK,oBAAoB,UACnJjB,SAASX,GACTN,GAAG,QAAS,WACZpB,EAAIwD,QAAS,WAGfpD,EAAGqD,IAAI,OAAQ,WACVrD,EAAGsD,GAAGC,MAAwC,OAAhCvD,EAAGwD,QAAQd,kBAC5BjD,EAAE,eAAea,EAAK,IAAIA,EAAK,yFAAyFN,EAAGkD,KAAK,oBAAoB,UACnJjB,SAASX,GACTN,GAAG,QAAS,WACZpB,EAAIwD,QAAS,YAIfK,KAAK,iBAAkB1B,GACvB0B,KAAK,aAActB,GAAQX,QAAQR,GAAG,QAASe,GAE5CT,EAAKc,WAAWsB,OAAS,EAC5B9D,EAAI+D,OAAO,WACT5D,GAAM6D,qBAAqB7D,GAC3BA,EAAK8D,sBAAsB,WAC1BjD,EAAOO,YAAYhB,EAAUP,EAAIO,YACjCgC,QAGDwB,SAEF/C,EAAOC,SAASV","file":"../../ui/sortbutton.js","sourcesContent":["define([\n\t\"skylark-jquery\"\n],function($) {\n\t/**\n\t * @class  elFinder toolbar button menu with sort variants.\n\t *\n\t * @author Dmitry (dio) Levashov\n\t **/\n\t$.fn.elfindersortbutton = function(cmd) {\n\t\t\"use strict\";\n\t\treturn this.each(function() {\n\t\t\tvar fm       = cmd.fm,\n\t\t\t\tname     = cmd.name,\n\t\t\t\tc        = 'class',\n\t\t\t\tdisabled = fm.res(c, 'disabled'),\n\t\t\t\thover    = fm.res(c, 'hover'),\n\t\t\t\titem     = 'elfinder-button-menu-item',\n\t\t\t\tselected = item+'-selected',\n\t\t\t\tasc      = selected+'-asc',\n\t\t\t\tdesc     = selected+'-desc',\n\t\t\t\ttext     = $('<span class=\"elfinder-button-text\">'+cmd.title+'</span>'),\n\t\t\t\tbutton   = $(this).addClass('ui-state-default elfinder-button elfinder-menubutton elfiner-button-'+name)\n\t\t\t\t\t.attr('title', cmd.title)\n\t\t\t\t\t.append('<span class=\"elfinder-button-icon elfinder-button-icon-'+name+'\"/>', text)\n\t\t\t\t\t.on('mouseenter mouseleave', function(e) { !button.hasClass(disabled) && button.toggleClass(hover, e.type === 'mouseenter'); })\n\t\t\t\t\t.on('click', function(e) {\n\t\t\t\t\t\tif (!button.hasClass(disabled)) {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tmenu.is(':hidden') && fm.getUI().click();\n\t\t\t\t\t\t\tmenu.css(getMenuOffset()).slideToggle({\n\t\t\t\t\t\t\t\tduration: 100,\n\t\t\t\t\t\t\t\tdone: function(e) {\n\t\t\t\t\t\t\t\t\tfm[menu.is(':visible')? 'toFront' : 'toHide'](menu);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\thide = function() { fm.toHide(menu); },\n\t\t\t\tmenu = $('<div class=\"ui-front ui-widget ui-widget-content elfinder-button-menu elfinder-button-sort-menu ui-corner-all\"/>')\n\t\t\t\t\t.hide()\n\t\t\t\t\t.appendTo(fm.getUI())\n\t\t\t\t\t.on('mouseenter mouseleave', '.'+item, function(e) { $(this).toggleClass(hover, e.type === 'mouseenter'); })\n\t\t\t\t\t.on('click', function(e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t})\n\t\t\t\t\t.on('close', hide),\n\t\t\t\tupdate = function() {\n\t\t\t\t\tmenu.children('[rel]').removeClass(selected+' '+asc+' '+desc)\n\t\t\t\t\t\t.filter('[rel=\"'+fm.sortType+'\"]')\n\t\t\t\t\t\t.addClass(selected+' '+(fm.sortOrder == 'asc' ? asc : desc));\n\n\t\t\t\t\tmenu.children('.elfinder-sort-stick').toggleClass(selected, fm.sortStickFolders);\n\t\t\t\t\tmenu.children('.elfinder-sort-tree').toggleClass(selected, fm.sortAlsoTreeview);\n\t\t\t\t},\n\t\t\t\tgetMenuOffset = function() {\n\t\t\t\t\tvar baseOffset = fm.getUI().offset(),\n\t\t\t\t\t\tbuttonOffset = button.offset();\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttop : buttonOffset.top - baseOffset.top,\n\t\t\t\t\t\tleft : buttonOffset.left - baseOffset.left\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\ttm;\n\t\t\t\t\n\t\t\ttext.hide();\n\t\t\t\n\t\t\t$.each(fm.sortRules, function(name, value) {\n\t\t\t\tmenu.append($('<div class=\"'+item+'\" rel=\"'+name+'\"><span class=\"ui-icon ui-icon-arrowthick-1-n\"/><span class=\"ui-icon ui-icon-arrowthick-1-s\"/>'+fm.i18n('sort'+name)+'</div>').data('type', name));\n\t\t\t});\n\t\t\t\n\t\t\tmenu.children().on('click', function(e) {\n\t\t\t\tcmd.exec([], $(this).removeClass(hover).attr('rel'));\n\t\t\t});\n\t\t\t\n\t\t\t$('<div class=\"'+item+' '+item+'-separated elfinder-sort-ext elfinder-sort-stick\"><span class=\"ui-icon ui-icon-check\"/>'+fm.i18n('sortFoldersFirst')+'</div>')\n\t\t\t\t.appendTo(menu)\n\t\t\t\t.on('click', function() {\n\t\t\t\t\tcmd.exec([], 'stick');\n\t\t\t\t});\n\n\t\t\tfm.one('init', function() {\n\t\t\t\tif (fm.ui.tree && fm.options.sortAlsoTreeview !== null) {\n\t\t\t\t\t$('<div class=\"'+item+' '+item+'-separated elfinder-sort-ext elfinder-sort-tree\"><span class=\"ui-icon ui-icon-check\"/>'+fm.i18n('sortAlsoTreeview')+'</div>')\n\t\t\t\t\t.appendTo(menu)\n\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\tcmd.exec([], 'tree');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind('disable select', hide)\n\t\t\t.bind('sortchange', update).getUI().on('click', hide);\n\t\t\t\n\t\t\tif (menu.children().length > 1) {\n\t\t\t\tcmd.change(function() {\n\t\t\t\t\t\ttm && cancelAnimationFrame(tm);\n\t\t\t\t\t\ttm = requestAnimationFrame(function() {\n\t\t\t\t\t\t\tbutton.toggleClass(disabled, cmd.disabled());\n\t\t\t\t\t\t\tupdate();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.change();\n\t\t\t} else {\n\t\t\t\tbutton.addClass(disabled);\n\t\t\t}\n\n\t\t});\n\t\t\n\t};\n\n});"]}