/**
 * skylark-elfinder - A version of elfinder that ported to running on skylarkjs.
 * @author 
 * @version v0.9.0
 * @link 
 * @license MIT
 */
define(["skylark-jquery"],function(e){e.fn.elfinderpath=function(t,n){"use strict";return this.each(function(){var a,i,r="",s="",o=[],h="statusbar",d=t.res("class","hover"),c="path"+(elFinder.prototype.uniqueid?elFinder.prototype.uniqueid:"")+"-",l=e('<div class="ui-widget-header ui-helper-clearfix elfinder-workzone-path"/>'),p=e(this).addClass("elfinder-path").html("&nbsp;").on("mousedown","span.elfinder-path-dir",function(n){var a=e(this).attr("id").substr(c.length);n.preventDefault(),a!=t.cwd().hash&&(e(this).addClass(d),r?t.exec("search",r,{target:a,mime:o.join(" ")}):t.trigger("select",{selected:[a]}).exec("open",a))}).prependTo(t.getUI("statusbar").show()),u=e('<div class="elfinder-path-roots"/>').on("click",function(n){n.stopPropagation(),n.preventDefault();var a=e.map(t.roots,function(e){return t.file(e)}),i=[];e.each(a,function(e,n){n.phash||t.root(t.cwd().hash,!0)===n.hash||i.push({label:t.escape(n.i18||n.name),icon:"home",callback:function(){t.exec("open",n.hash)},options:{iconClass:n.csscls||"",iconImg:n.icon||""}})}),t.trigger("contextmenu",{raw:i,x:n.pageX,y:n.pageY})}).append('<span class="elfinder-button-icon elfinder-button-icon-menu" />').appendTo(l),f=function(n){var a=[],i=[];return e.each(t.parents(n),function(e,r){var s=n===r?"elfinder-path-dir elfinder-path-cwd":"elfinder-path-dir",o=t.file(r),h=t.escape(o.i18||o.name);i.push(h),a.push('<span id="'+c+r+'" class="'+s+'" title="'+i.join(t.option("separator"))+'">'+h+"</span>")}),a.join('<span class="elfinder-path-other">'+t.option("separator")+"</span>")},g=function(){var n;p.children("span.elfinder-path-dir").attr("style",""),n="ltr"===t.direction?e("#"+c+t.cwd().hash).prevAll("span.elfinder-path-dir:first"):e(),p.scrollLeft(n.length?n.position().left:0)},w=function(){if(!t.UA.CSS.flex){var n,a,i=p.children("span.elfinder-path-dir"),r=i.length;"workzone"===h||r<2?i.attr("style",""):(p.width(p.css("max-width")),i.css({maxWidth:100/r+"%",display:"inline-block"}),n=p.width()-9,p.children("span.elfinder-path-other").each(function(){n-=e(this).width()}),a=[],i.each(function(t){var i=e(this).width();n-=i,i<this.scrollWidth&&a.push(t)}),p.width(""),a.length?(n>0&&(n/=a.length,e.each(a,function(t,a){var r=e(i[a]);r.css("max-width",r.width()+n)})),i.last().attr("style","")):i.attr("style",""))}};t.one("init",function(){a=t.getUI("tree").length,i=t.getUI("stat").length,!a&&n.toWorkzoneWithoutNavbar&&(l.append(p).insertBefore(t.getUI("workzone")),h="workzone",t.bind("open",g).one("opendone",function(){t.getUI().trigger("resize")}))}).bind("open searchend parents",function(){r="",s="",o=[],p.html(f(t.cwd().hash)),Object.keys(t.roots).length>1?(p.css("margin",""),u.show()):(p.css("margin",0),u.hide()),!i&&w()}).bind("searchstart",function(e){e.data&&(r=e.data.query||"",s=e.data.target||"",o=e.data.mimes||[])}).bind("search",function(e){var n="";n=s?f(s):t.i18n("btnAll"),p.html('<span class="elfinder-path-other">'+t.i18n("searcresult")+": </span>"+n),w()}).bind("navbarshow navbarhide",function(){var e=t.getUI("workzone");"navbarshow"===this.type?(t.unbind("open",g),p.prependTo(t.getUI("statusbar")),l.detach(),h="statusbar"):(l.append(p).insertBefore(e),h="workzone",g(),t.bind("open",g)),t.trigger("uiresize")}).bind("resize uistatchange",w)})}});
//# sourceMappingURL=../sourcemaps/ui/path.js.map
