/**
 * skylark-elfinder - A version of elfinder that ported to running on skylarkjs.
 * @author 
 * @version v0.9.0
 * @link 
 * @license MIT
 */
define(["../elFinder"],function(e){return e.prototype.commands.hide=function(){"use strict";var e,t,i,s,d=this,n={};this.syncTitleOnChange=!0,this.shortcuts=[{pattern:"ctrl+shift+dot",description:this.fm.i18n("toggleHidden")}],this.init=function(){var i=this.fm;e=i.storage("hide")||{items:{}},t=Object.keys(e.items).length,this.title=i.i18n(e.show?"hideHidden":"showHidden"),d.update(void 0,d.title)},this.fm.bind("select contextmenucreate closecontextmenu",function(n,a){var h=(n.data?n.data.selected||n.data.targets:null)||a.selected();"select"===n.type&&n.data?s=n.data.origin:"contextmenucreate"===n.type&&(i=n.data.type),!h.length||("contextmenucreate"!==n.type&&"navbar"!==s||"cwd"===i)&&h[0]===a.cwd().hash?d.title=a.i18n(e.show?"hideHidden":"showHidden"):d.title=a.i18n("cmdhide"),"closecontextmenu"!==n.type?d.update("cwd"===i?t?0:-1:void 0,d.title):(i="",requestAnimationFrame(function(){d.update(void 0,d.title)}))}),this.getstate=function(e){return this.fm.cookieEnabled&&"cwd"!==i&&(e||this.fm.selected()).length||t?0:-1},this.exec=function(i,a){var h,c,o=this.fm,r=$.Deferred().done(function(){o.trigger("hide",{items:u,opts:a})}).fail(function(e){o.error(e)}),l=a||{},u=l.targets?l.targets:i||o.selected(),m=[];if(e=o.storage("hide")||{},$.isPlainObject(e)||(e={}),$.isPlainObject(e.items)||(e.items={}),("shortcut"===a._currentType||!u.length||"navbar"!==a._currentType&&"navbar"!==s&&u[0]===o.cwd().hash)&&(e.show?l.hide=!0:Object.keys(e.items).length&&(l.show=!0)),l.reset&&(l.show=!0,t=0),l.show||l.hide){if(l.show?e.show=!0:delete e.show,l.show)return o.storage("hide",l.reset?null:e),d.title=o.i18n("hideHidden"),d.update(l.reset?-1:void 0,d.title),$.each(e.items,function(e){var t=o.file(e,!0);t&&(o.searchStatus.state||!t.phash||o.file(t.phash))&&m.push(t)}),m.length&&(o.updateCache({added:m}),o.add({added:m})),l.reset&&(e={items:{}}),r.resolve();u=Object.keys(e.items)}return u.length&&($.each(u,function(t,i){var s;e.items[i]||((s=o.file(i))&&(n[i]=s.i18||s.name),e.items[i]=n[i]?n[i]:i)}),t=Object.keys(e.items).length,h=this.files(u),o.storage("hide",e),o.remove({removed:u}),e.show&&this.exec(void 0,{hide:!0}),l.hide||((c={}).undo={cmd:"hide",callback:function(){var e=o.storage("hide");e&&($.each(u,function(t,i){delete e.items[i]}),t=Object.keys(e.items).length,o.storage("hide",e),o.trigger("hide",{items:u,opts:{}}),d.update(t?0:-1)),o.updateCache({added:h}),o.add({added:h})}},c.redo={cmd:"hide",callback:function(){return o.exec("hide",void 0,{targets:u})}})),"rejected"==r.state()?r:r.resolve(c)}},e});
//# sourceMappingURL=../sourcemaps/commands/hide.js.map
