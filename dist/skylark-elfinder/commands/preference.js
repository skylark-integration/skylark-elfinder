/**
 * skylark-elfinder - A version of elfinder that ported to running on skylarkjs.
 * @author 
 * @version v0.9.0
 * @link 
 * @license MIT
 */
define(["../elFinder"],function(e){return e.prototype.commands.preference=function(){var e,t,n=this,i=this.fm,a="replace",o='<li class="'+i.res("class","tabstab")+' elfinder-preference-tab-{id}"><a href="#'+i.namespace+'-preference-{id}" id="'+i.namespace+'-preference-tab-{id}" class="ui-tabs-anchor {class}">{title}</a></li>',s=$('<div class="ui-tabs ui-widget ui-widget-content ui-corner-all elfinder-preference">'),r=$('<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-top">'),c=$('<div class="elfinder-preference-tabs ui-tabs-panel ui-widget-content ui-corner-bottom"/>'),l=($("base").length&&document.location.href.replace(/#.*$/,""),function(e){$("#"+i.namespace+"-preference-tab-"+e).trigger("mouseover").trigger("click"),t=e}),d=i.res("class","tabsactive");this.shortcuts=[{pattern:"ctrl+comma",description:this.title}],this.alwaysEnabled=!0,this.getstate=function(){return 0},this.exec=function(p,u){var h,f,g,m,v,k,b,w,y,x,C,F;return!e&&(C=n.options.categories||{language:["language"],theme:["theme"],toolbar:["toolbarPref"],workspace:["iconSize","columnPref","selectAction","makefileTypes","useStoredEditor","editorMaximized","useFullscreen","showHidden"],dialog:["autoFocusDialog"],selectionInfo:["infoItems","hashChecker"],reset:["clearBrowserData"],all:!0},F=n.options.prefs||["language","theme","toolbarPref","iconSize","columnPref","selectAction","makefileTypes","useStoredEditor","editorMaximized","useFullscreen","showHidden","infoItems","hashChecker","autoFocusDialog","clearBrowserData"],i.cookieEnabled||delete C.language,F=i.arrayFlip(F,!0),i.options.getFileCallback&&delete F.selectAction,i.UA.Fullscreen||delete F.useFullscreen,F.language&&(F.language=(h=$("<select/>").on("change",function(){var e=$(this).val();i.storage("lang",e),$("#"+i.id).elfinder("reload")}),f=[],g=n.options.langs||{ar:"العربية",bg:"Български",ca:"Català",cs:"Čeština",da:"Dansk",de:"Deutsch",el:"Ελληνικά",en:"English",es:"Español",fa:"فارسی",fo:"Føroyskt",fr:"Français",fr_CA:"Français (Canada)",he:"עברית",hr:"Hrvatski",hu:"Magyar",id:"Bahasa Indonesia",it:"Italiano",ja:"日本語",ko:"한국어",nl:"Nederlands",no:"Norsk",pl:"Polski",pt_BR:"Português",ro:"Română",ru:"Pусский",si:"සිංහල",sk:"Slovenčina",sl:"Slovenščina",sr:"Srpski",sv:"Svenska",tr:"Türkçe",ug_CN:"ئۇيغۇرچە",uk:"Український",vi:"Tiếng Việt",zh_CN:"简体中文",zh_TW:"正體中文"},i.cookieEnabled?($.each(g,function(e,t){f.push('<option value="'+e+'">'+t+"</option>")}),h.append(f.join("")).val(i.lang)):$())),F.theme&&(F.theme=function(){var e=i.options.themes?Object.keys(i.options.themes).length:0;if(0===e||1===e&&i.options.themes.default)return null;var t=$("<select/>").on("change",function(){var e=$(this).val();i.changeTheme(e).storage("theme",e)}),n={image:'<img class="elfinder-preference-theme elfinder-preference-theme-image" src="$2" />',link:'<a href="$1" target="_blank" title="$3">$2</a>',data:'<dt>$1</dt><dd><span class="elfinder-preference-theme elfinder-preference-theme-$0">$2</span></dd>'},a=["image","description","author","email","license"],o=$('<button class="ui-button ui-corner-all ui-widget elfinder-preference-theme-default"/>').text(i.i18n("default")).on("click",function(e){t.val("default").trigger("change")}),s=$('<div class="elfinder-reference-hide-taball"/>').on("click","button",function(){var e=$(this).data("themeid");t.val(e).trigger("change")});return i.options.themes.default||t.append('<option value="default">'+i.i18n("default")+"</option>"),$.each(i.options.themes,function(e,o){var r,c=$('<option class="elfinder-theme-option-'+e+'" value="'+e+'">'+i.i18n(e)+"</option>"),l=$('<fieldset class="ui-widget ui-widget-content ui-corner-all elfinder-theme-list-'+e+'"><legend>'+i.i18n(e)+'</legend><div><span class="elfinder-spinner"/></div></fieldset>');t.append(c),s.append(l),r=setTimeout(function(){l.find("span.elfinder-spinner").replaceWith(i.i18n(["errRead",e]))},1e4),i.getTheme(e).always(function(){r&&clearTimeout(r)}).done(function(o){var s,r=$(),d=$("<dl/>");s=o.link?n.link.replace(/\$1/g,o.link).replace(/\$3/g,i.i18n("website")):"$2",o.name&&c.html(i.i18n(o.name)),l.children("legend").html(s.replace(/\$2/g,i.i18n(o.name)||e)),$.each(a,function(a,s){var r,c=n[s]||n.data;o[s]&&(r=c.replace(/\$0/g,i.escape(s)).replace(/\$1/g,i.i18n(s)).replace(/\$2/g,i.i18n(o[s])),"image"===s&&o.link&&(r=$(r).on("click",function(){t.val(e).trigger("change")}).attr("title",i.i18n("select"))),d.append(r))}),r=(r=r.add(d)).add($('<div class="elfinder-preference-theme-btn"/>').append($('<button class="ui-button ui-corner-all ui-widget"/>').data("themeid",e).html(i.i18n("select")))),l.find("span.elfinder-spinner").replaceWith(r)}).fail(function(){l.find("span.elfinder-spinner").replaceWith(i.i18n(["errRead",e]))})}),$("<div/>").append(t.val(i.theme&&i.theme.id?i.theme.id:"default"),o,s)}()),F.toolbarPref&&(F.toolbarPref=(m=$.map(i.options.uiOptions.toolbar,function(e){return $.isArray(e)?e:null}),v=[],k=i.storage("toolbarhides")||{},$.each(m,function(){var e=i.i18n("cmd"+this);e==="cmd"+this&&(e=i.i18n(this)),v.push('<span class="elfinder-preference-toolbar-item"><label><input type="checkbox" value="'+this+'" '+(k[this]?"":"checked")+"/>"+e+"</label></span>")}),$(v.join(" ")).on("change","input",function(){var e=$(this).val(),t=$(this).is(":checked");t||k[e]?t&&k[e]&&delete k[e]:k[e]=!0,i.storage("toolbarhides",k),i.trigger("toolbarpref")}))),F.iconSize&&(F.iconSize=(b=i.options.uiOptions.cwd.iconsView.sizeMax||3,w=i.storage("iconsize")||i.options.uiOptions.cwd.iconsView.size||0,y=$('<div class="touch-punch"/>').slider({classes:{"ui-slider-handle":"elfinder-tabstop"},value:w,max:b,slide:function(e,t){i.getUI("cwd").trigger("iconpref",{size:t.value})},change:function(e,t){i.storage("iconsize",t.value)}}),i.getUI("cwd").on("iconpref",function(e,t){y.slider("option","value",t.size)}),y)),F.columnPref&&(F.columnPref=function(){var e=i.options.uiOptions.cwd.listView.columns,t=[],n=i.storage("columnhides")||{};return $.each(e,function(){var e=i.getColumnName(this);t.push('<span class="elfinder-preference-column-item"><label><input type="checkbox" value="'+this+'" '+(n[this]?"":"checked")+"/>"+e+"</label></span>")}),$(t.join(" ")).on("change","input",function(){var e=$(this).val(),t=$(this).is(":checked");t||n[e]?t&&n[e]&&delete n[e]:n[e]=!0,i.storage("columnhides",n),i.trigger("columnpref",{repaint:!0})})}()),F.selectAction&&(F.selectAction=function(){var e=$("<select/>").on("change",function(){var e=$(this).val();i.storage("selectAction","default"===e?null:e)}),t=[],a=n.options.selectActions,o=i.getCommand("open").options.selectAction||"open";return-1===$.inArray(o,a)&&a.unshift(o),$.each(a,function(e,n){var a=$.map(n.split("/"),function(e){var t=i.i18n("cmd"+e);return t==="cmd"+e&&(t=i.i18n(e)),t});t.push('<option value="'+n+'">'+a.join("/")+"</option>")}),e.append(t.join("")).val(i.storage("selectAction")||o)}()),F.makefileTypes&&(F.makefileTypes=function(){var e=i.getCommand("edit").getMkfileHides(),t=function(){var t=[];return e=i.getCommand("edit").getMkfileHides(),$.each(i.mimesCanMakeEmpty,function(n,a){var o=i.getCommand("mkfile").getTypeName(n,a);t.push('<span class="elfinder-preference-column-item" title="'+i.escape(o)+'"><label><input type="checkbox" value="'+n+'" '+(e[n]?"":"checked")+"/>"+a+"</label></span>")}),t.join(" ")},n=$("<div/>").on("change","input",function(){var t=$(this).val(),n=$(this).is(":checked");n||e[t]?n&&e[t]&&delete e[t]:e[t]=!0,i.storage("mkfileHides",e),i.trigger("canMakeEmptyFile")}).append(t()),a=$("<div/>").append($('<input type="text" placeholder="'+i.i18n("typeOfTextfile")+'"/>').on("keydown",function(e){e.keyCode===$.ui.keyCode.ENTER&&$(this).next().trigger("click")}),$('<button class="ui-button"/>').html(i.i18n("add")).on("click",function(){var e,t=$(this).prev(),n=t.val(),a=i.getUI("toast"),o=function(){return a.appendTo(t.closest(".ui-dialog")),i.toast({msg:i.i18n("errUsupportType"),mode:"warning",onHidden:function(){1===a.children().length&&a.appendTo(i.getUI())}}),t.trigger("focus"),!1};if(!n.match(/\//)){if(!(n=i.arrayFlip(i.mimeTypes)[n]))return o();t.val(n)}if(!i.mimeIsText(n)||!i.mimeTypes[n])return o();i.trigger("canMakeEmptyFile",{mimes:[n],unshift:!0}),(e={})[n]=i.mimeTypes[n],i.storage("mkfileTextMimes",Object.assign(e,i.storage("mkfileTextMimes")||{})),t.val(""),a.appendTo(t.closest(".ui-dialog")),i.toast({msg:i.i18n(["complete",n+" ("+e[n]+")"]),onHidden:function(){1===a.children().length&&a.appendTo(i.getUI())}})}),$('<button class="ui-button"/>').html(i.i18n("reset")).on("click",function(){i.one("canMakeEmptyFile",{done:function(){n.empty().append(t())}}),i.trigger("canMakeEmptyFile",{resetTexts:!0})}));return i.bind("canMakeEmptyFile",{done:function(e){e.data&&e.data.mimes&&e.data.mimes.length&&n.empty().append(t())}}),$("<div/>").append(n,a)}()),F.useStoredEditor&&(F.useStoredEditor=$('<input type="checkbox"/>').prop("checked",(x=i.storage("useStoredEditor"),x?x>0:i.options.commandsOptions.edit.useStoredEditor)).on("change",function(e){i.storage("useStoredEditor",$(this).is(":checked")?1:-1)})),F.editorMaximized&&(F.editorMaximized=$('<input type="checkbox"/>').prop("checked",function(){var e=i.storage("editorMaximized");return e?e>0:i.options.commandsOptions.edit.editorMaximized}()).on("change",function(e){i.storage("editorMaximized",$(this).is(":checked")?1:-1)})),F.useFullscreen&&(F.useFullscreen=$('<input type="checkbox"/>').prop("checked",function(){var e=i.storage("useFullscreen");return e?e>0:"screen"===i.options.commandsOptions.fullscreen.mode}()).on("change",function(e){i.storage("useFullscreen",$(this).is(":checked")?1:-1)})),F.showHidden&&function(){var e,t,n=function(){var t,n=i.storage("hide"),a=[];n&&n.items&&$.each(n.items,function(e,t){a.push(i.escape(t))}),s.prop("disabled",!a.length)[a.length?"removeClass":"addClass"]("ui-state-disabled"),t=a.length?a.join("\n"):"",F.showHidden.attr("title",t),e&&F.showHidden.tooltip("option","content",t.replace(/\n/g,"<br>")).tooltip("close")},a=$('<input type="checkbox"/>').prop("checked",(t=i.storage("hide"),t&&t.show)).on("change",function(e){var t={};t[$(this).is(":checked")?"show":"hide"]=!0,i.exec("hide",void 0,t)}),o=$('<button class="ui-button ui-corner-all ui-widget"/>').append(i.i18n("reset")).on("click",function(){i.exec("hide",void 0,{reset:!0}),$(this).parent().find("input:first").prop("checked",!1),n()}),s=$().add(a).add(o);F.showHidden=$("<div/>").append(a,o),i.bind("hide",function(e){var t=e.data;t.opts&&(t.opts.show||t.opts.hide)||n()}),i.UA.Mobile&&$.fn.tooltip&&(e=!0,F.showHidden.tooltip({classes:{"ui-tooltip":"elfinder-ui-tooltip ui-widget-shadow"},tooltipClass:"elfinder-ui-tooltip ui-widget-shadow",track:!0}).css("user-select","none"),o.css("user-select","none")),n()}(),F.infoItems&&(F.infoItems=function(){var e=i.getCommand("info").items,t=[],n=i.storage("infohides")||i.arrayFlip(i.options.commandsOptions.info.hideItems,!0);return $.each(e,function(){var e=i.i18n(this);t.push('<span class="elfinder-preference-info-item"><label><input type="checkbox" value="'+this+'" '+(n[this]?"":"checked")+"/>"+e+"</label></span>")}),$(t.join(" ")).on("change","input",function(){var e=$(this).val(),t=$(this).is(":checked");t||n[e]?t&&n[e]&&delete n[e]:n[e]=!0,i.storage("infohides",n),i.trigger("infopref",{repaint:!0})})}()),F.hashChecker&&i.hashCheckers.length&&(F.hashChecker=function(){var e=[],t=i.arrayFlip(i.storage("hashchekcer")||i.options.commandsOptions.info.showHashAlgorisms,!0);return $.each(i.hashCheckers,function(){var n=i.i18n(this);e.push('<span class="elfinder-preference-hashchecker-item"><label><input type="checkbox" value="'+this+'" '+(t[this]?"checked":"")+"/>"+n+"</label></span>")}),$(e.join(" ")).on("change","input",function(){var e=$(this).val();$(this).is(":checked")?t[e]=!0:t[e]&&delete t[e],i.storage("hashchekcer",$.grep(i.hashCheckers,function(e){return t[e]}))})}()),F.autoFocusDialog&&(F.autoFocusDialog=$('<input type="checkbox"/>').prop("checked",function(){var e=i.storage("autoFocusDialog");return e?e>0:i.options.uiOptions.dialog.focusOnMouseOver}()).on("change",function(e){i.storage("autoFocusDialog",$(this).is(":checked")?1:-1)})),F.clearBrowserData&&(F.clearBrowserData=$("<button/>").text(i.i18n("reset")).button().on("click",function(e){e.preventDefault(),i.storage(),$("#"+i.id).elfinder("reload")})),$.each(C,function(e,n){var s,l;!0===n?l=1:n&&(s=$(),$.each(n,function(e,t){var n,a,o,r="";(n=F[t])&&(l=2,a=i.i18n(t),(o=$(n).filter('input[type="checkbox"]')).length||(o=$(n).find('input[type="checkbox"]')),1===o.length?(o.attr("id")||o.attr("id","elfinder-preference-"+t+"-checkbox"),a='<label for="'+o.attr("id")+'">'+a+"</label>"):o.length>1&&(r=" elfinder-preference-checkboxes"),s=s.add($('<dt class="elfinder-preference-'+t+r+'">'+a+"</dt>")).add($('<dd class="elfinder-preference-'+t+r+'"/>').append(n)))})),l&&(r.append(o[a](/\{id\}/g,e)[a](/\{title\}/,i.i18n(e))[a](/\{class\}/,t===e?"elfinder-focus":"")),2===l&&c.append($('<div id="'+i.namespace+"-preference-"+e+'" class="elfinder-preference-content"/>').hide().append($("<dl/>").append(s))))}),r.on("click","a",function(e){var t=$(e.target),n=t.attr("href");e.preventDefault(),e.stopPropagation(),r.children().removeClass(d),t.removeClass("ui-state-hover").parent().addClass(d),n.match(/all$/)?c.addClass("elfinder-preference-taball").children().show():(c.removeClass("elfinder-preference-taball").children().hide(),$(n).show())}).on("focus blur","a",function(e){$(this).parent().toggleClass("ui-state-focus","focusin"===e.type)}).on("mouseenter mouseleave","li",function(e){$(this).toggleClass("ui-state-hover","mouseenter"===e.type)}),c.find("a,input,select,button").addClass("elfinder-tabstop"),s.append(r,c),(e=n.fmDialog(s,{title:n.title,width:n.options.width||600,height:n.options.height||400,maxWidth:"window",maxHeight:"window",autoOpen:!1,destroyOnClose:!1,allowMinimize:!1,open:function(){t&&l(t),t=null},resize:function(){c.height(e.height()-r.outerHeight(!0)-(c.outerHeight(!0)-c.height())-5)}}).on("click",function(e){e.stopPropagation()}).css({overflow:"hidden"})).closest(".ui-dialog").css({overflow:"hidden"}).addClass("elfinder-bg-translucent"),t="all"),u&&(u.tab?l(u.tab):"cwd"===u._currentType&&l("workspace")),e.elfinderdialog("open"),$.Deferred().resolve()}},e});
//# sourceMappingURL=../sourcemaps/commands/preference.js.map
