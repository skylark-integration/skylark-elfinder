{"version":3,"sources":["commands/opennew.js"],"names":["define","elFinder","prototype","commands","opennew","fm","this","shortcuts","pattern","options","getstate","select","sel","files","length","mime","read","exec","hashes","file","loc","url","win","dfrd","$","Deferred","cnt","opts","window","location","pathname","useOriginQuery","match","search","substr","hash","open","setTimeout","focus","resolve","reject"],"mappings":";;;;;;;AAAAA,QACC,eACC,SAASC,GA0DV,OAnDAA,EAASC,UAAUC,SAASC,QAAU,WACrC,aACA,IAAIC,EAAKC,KAAKD,GAEdC,KAAKC,YACJC,SAAmD,mBAAhCH,EAAGI,QAAuB,gBAAkB,SAAW,IAAM,eAGjFH,KAAKI,SAAW,SAASC,GACxB,IAAIC,EAAMN,KAAKO,MAAMF,GAGrB,OAAe,IAFRC,EAAIE,QAGS,cAAhBF,EAAI,GAAGG,MAAwBH,EAAI,GAAGI,KAAM,GAC5C,GAGLV,KAAKW,KAAO,SAASC,GACpB,IAICC,EAAMC,EAAKC,EAAKC,EAJbC,EAAQC,EAAEC,WACbZ,EAAQP,KAAKO,MAAMK,GACnBQ,EAAQb,EAAMC,OACda,EAAQrB,KAAKG,QAId,OAAY,IAARiB,IAAcP,EAAON,EAAM,KAAqB,cAAdM,EAAKJ,MAC1CK,EAAMQ,OAAOC,SAEZR,EADGM,EAAKN,IACFM,EAAKN,IAELD,EAAIU,SAEPH,EAAKI,iBACHV,EAAIW,MAAM,MAEJZ,EAAIa,SACdZ,GAAO,IAAMD,EAAIa,OAAOC,OAAO,IAF/Bb,GAAOD,EAAIa,QAKbZ,GAAO,QAAUF,EAAKgB,KACtBb,EAAMM,OAAOQ,KAAKf,EAAK,UACvBgB,WAAW,WACVf,EAAIgB,SACF,KACIf,EAAKgB,WAELhB,EAAKiB,WAKRvC","file":"../../commands/opennew.js","sourcesContent":["define([\n\t\"../elFinder\"\n],function(elFinder){\n\t/**\n\t * @class  elFinder command \"opennew\"\n\t * Open folder in new window\n\t *\n\t * @author Naoki Sawada\n\t **/  \n\telFinder.prototype.commands.opennew = function() {\n\t\t\"use strict\";\n\t\tvar fm = this.fm;\n\n\t\tthis.shortcuts = [{\n\t\t\tpattern  : (typeof(fm.options.getFileCallback) === 'function'? 'shift+' : '') + 'ctrl+enter'\n\t\t}];\n\n\t\tthis.getstate = function(select) {\n\t\t\tvar sel = this.files(select),\n\t\t\t\tcnt = sel.length;\n\t\t\t\n\t\t\treturn cnt === 1 \n\t\t\t\t? (sel[0].mime === 'directory' && sel[0].read? 0 : -1) \n\t\t\t\t: -1;\n\t\t};\n\t\t\n\t\tthis.exec = function(hashes) {\n\t\t\tvar dfrd  = $.Deferred(),\n\t\t\t\tfiles = this.files(hashes),\n\t\t\t\tcnt   = files.length,\n\t\t\t\topts  = this.options,\n\t\t\t\tfile, loc, url, win;\n\n\t\t\t// open folder to new tab (window)\n\t\t\tif (cnt === 1 && (file = files[0]) && file.mime === 'directory') {\n\t\t\t\tloc = window.location;\n\t\t\t\tif (opts.url) {\n\t\t\t\t\turl = opts.url;\n\t\t\t\t} else {\n\t\t\t\t\turl = loc.pathname;\n\t\t\t\t}\n\t\t\t\tif (opts.useOriginQuery) {\n\t\t\t\t\tif (!url.match(/\\?/)) {\n\t\t\t\t\t\turl += loc.search;\n\t\t\t\t\t} else if (loc.search) {\n\t\t\t\t\t\turl += '&' + loc.search.substr(1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\turl += '#elf_' + file.hash;\n\t\t\t\twin = window.open(url, '_blank');\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\twin.focus();\n\t\t\t\t}, 1000);\n\t\t\t\treturn dfrd.resolve();\n\t\t\t} else {\n\t\t\t\treturn dfrd.reject();\n\t\t\t}\n\t\t};\n\t};\n\n\treturn elFinder;\n\n});"]}