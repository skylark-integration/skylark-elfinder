{"version":3,"sources":["extras/editors.default.js"],"names":["define","elFinder","mime2ext","getfile","window","location","search","match","useRequire","prototype","hasRequire","hasFlash","ActiveXObject","e","orientation","navigator","mimeTypes","ext2mime","bmp","dng","gif","jpeg","jpg","pdf","png","ppm","psd","pxd","svg","tiff","webp","xcf","sketch","ico","dds","emf","getExtention","mime","fm","arrayFlip","ext","changeImageType","src","toMime","dfd","$","Deferred","canvas","document","createElement","ctx","getContext","img","Image","on","width","height","drawImage","m","toDataURL","toLowerCase","resolve","reject","initImgTag","id","file","content","url","node","this","children","data","spnr","html","i18n","hide","appendTo","setup","attr","css","max-width","max-height","cursor","done","closest","find","prop","openUrl","hash","v","parent","p","ifm","pixlr","image","substr","replace","trigger","extention","protocol","remove","pixlrCallBack","_options","getFileCallback","reParam","opener","CKEDITOR","tools","callFunction","RegExp","length","convAbsUrl","destroy","close","info","name","iconImg","dataScheme","schemeContent","openMaximized","canMakeEmpty","integrate","title","link","mimes","opts","UA","ltIE8","Mobile","disabled","Object","assign","version","extraOptions","tuiImgEditOpts","iconsPath","baseUrl","theme","isSameOrigin","debug","init","load","base","loader","self","dfrd","cdns","options","ver","confObj","editor","quty","qutyTm","zoomTm","zoomMore","$base","bParent","tmpContainer","tmpDiv","iEditor","includeUI","loadImage","path","menu.normalIcon.path","menu.normalIcon.name","menu.activeIcon.path","menu.activeIcon.name","menu.disabledIcon.path","menu.disabledIcon.name","menu.hoverIcon.path","menu.hoverIcon.name","submenu.normalIcon.path","submenu.normalIcon.name","submenu.activeIcon.path","submenu.activeIcon.name","initMenu","menuBarPosition","cssMaxWidth","Math","max","cssMaxHeight","usageStatistics","get","zoom","mw","mh","c","w","parseInt","h","a","Number","per","text","round","resizeCanvasDimension","setTimeout","zup","zdown","removeData","storage","option","q","val","cancelAnimationFrame","requestAnimationFrame","toBlob","blob","next","formatSize","size","min","append","prependTo","keepEditor","clearTimeout","type","target","toggle","loadCss","tui","require","config","paths","fabric/dist/fabric.require","fabric","tui-code-snippet","tui-color-picker","tui-image-editor","ImageEditor","loadScript","loadType","getContent","quality","instance","format","save","deactivateAll","urlAsContent","single","call","mode","errtm","clPreventBack","res","off","dialog","addClass","launch","elfNode","getUI","uiToast","container","error","toast","msg","button","click","onHidden","timeout","myurl","href","toString","indexOf","encodeURIComponent","position","display","backgroundColor","border","top","right","editorObj","one","is","toggleMaximize","toFront","hasClass","empty","noContent","arrayBufferContent","IE","dum","liveMsg","orig","show","saveMimes","getType","extmime","mimesFlip","dfdGet","wnd","contentWindow","phase","dfdIni","postMessage","getContents","d","receive","ev","originalEvent","origin","source","state","doSave","arrayBufferToBase64","namespace","JSON","stringify","files","environment","lang","customIO","encodeURI","fail","err","initFail","pixo","apikey","editorOpts","qBase","onload","overflow","preventDefault","stopPropagation","fullscreen","bind","cancelEditing","output","onSave","arg","draw","_canvas","cv","onClose","removeClass","Pixo","Bridge","edit","style","imgBase64","ace","textarea","cdn","obj","editorBase","ta","taBase","mimeMode","text/x-php","application/x-php","text/html","application/xhtml+xml","text/javascript","application/javascript","text/css","text/x-c","text/x-csrc","text/x-chdr","text/x-c++","text/x-c++src","text/x-c++hdr","text/x-shellscript","application/x-csh","text/x-python","text/x-java","text/x-java-source","text/x-ruby","text/x-perl","application/x-perl","text/x-sql","text/xml","application/docbook+xml","application/xml","set","insertBefore","$blockScrolling","Infinity","setOptions","fontSize","wrap","loadModule","getModeForPath","prev","split","pop","enableBasicAutocompletion","enableSnippets","enableLiveAutocompletion","commands","addCommand","bindKey","win","mac","exec","doCancel","resize","session","getValue","setValue","focus","icons","primary","secondary","showSettingsMenu","end","value","ltIE10","codemirror","cmUrl","packages","main","map","codemirror/lib/codemirror","CodeMirror","spec","lineNumbers","lineWrapping","extraKeys","Ctrl-S","Ctrl-Q","Ctrl-W","fromTextArea","findModeByMIME","findModeByExtension","modeURL","setOption","autoLoadMode","getWrapperElement","padding","refresh","toTextArea","simplemde","exts","SimpleMDE","delta","outerHeight","_setHeight","areaH","ctrH","each","element","autofocus","ckeditor","ckeOpts","managerUrl","CKEDITOR_BASEPATH","getScript","dlg","reg","loc","test","startupFocus","fullPage","allowedContent","filebrowserBrowseUrl","toolbarCanCollapse","toolbarStartupExpanded","removePlugins","extraPlugins","instanceReady","definition","getElement","getData","status","ckeditor5","Symbol","ckeditor5Mode","prepare","dialogOpts","header","body","footer","box-sizing","_setupSelEncoding","editnode","l","cEditor","toolbar","language","create","then","isImage","insertImages","ckf","fileRepo","plugins","prevVars","ui","view","marginRight","marginLeft","f","urls","isEnabled","execute","ntf","i18","locale","t","showWarning","gf","getCommand","rever","hasVar","callback","folders","multiple","multi","commandMap","open","imgs","i","push","createUploadAdapter","uploder","setData","z-index","getMaximizeCss","zIndex","upload","cwd","added","async","default","parseError","progress","uploadTotal","total","uploaded","Promise","abort","BalloonEditor","InlineEditor","ClassicEditor","DecoupledEditor","tryRequire","elm","tinymce","mceOpts","uploadOpts","mceDlg","mceCv","hideMceDlg","mceW","activeEditor","windowManager","windows","getEl","showMceDlg","tVer","majorVersion","innerHeight","selector","image_advtab","init_instance_callback","execCommand","file_picker_callback","meta","revar","filetype","alt","images_upload_handler","blobInfo","success","failure","revert","unbind","clipdata","cmdCheck","preventGet","hideButtons","syncInterval","request","cmd","method","args[target]","args[lang]","args[cdata]","customData","key","zohourl","warning","timeOut","elfinderdialog","always","beforeclose","tm","$ifm","ab","chk","cnt","xhr","host","phash","preventFail","notify","hideCnt","pdir","dirs","change","changed","useTextAreaEvent","setSelectionRange","converter","mOpts","onlineConvert","maxSize","showLink","conv","Archive","7Z","BZ2","GZ","ZIP","Audio","MP3","OGG","WAV","WMA","AAC","AIFF","FLAC","M4A","MMF","OPUS","Document","DOC","DOCX","HTML","ODT","PDF","PPT","PPTX","RTF","SWF","TXT","eBook","AZW3","ePub","FB2","LIT","LRF","MOBI","PDB","PDF-eBook","TCR","Hash","Adler32","Apache-htpasswd","Blowfish","CRC32","CRC32B","Gost","Haval128","MD4","MD5","RIPEMD128","RIPEMD160","SHA1","SHA256","SHA384","SHA512","Snefru","Std-DES","Tiger128","Tiger128-calculator","Tiger128-converter","Tiger160","Tiger192","Whirlpool","BMP","EPS","GIF","EXR","ICO","JPG","PNG","SVG","TGA","TIFF","WBMP","WebP","Video","3G2","3GP","AVI","FLV","HLS","MKV","MOV","MP4","MPEG-1","MPEG-2","OGV","WebM","WMV","Android","Blackberry","DPG","iPad","iPhone","iPod","Nintendo-3DS","Nintendo-DS","PS3","Wii","Xbox","catExts","useTabs","fn","tabs","iOS","cl","idxs","allowZip","uploadMimeCheck","selfUrl","getExt","cat","con","dfdInit","api","conversions","getJSON","o","btns","category","b","convert","escape","ul","makeOption","k","n","btn","checked","nozip","description","pattern","ts","Date","cname","nl","prepend","beforeActivate","newPanel","tl","select","prog","_url","forExternalUrl","progressBar","fadeOut","setStatus","args[category]","args[convert]","args[options]","args[source]","args[filename]","splitFileExtention","args[mime]","checkRes","apires","code","errors","message","fadeIn","polling","jobid","args[jobid]","uri","extraData","contentSaveId","keys","t0","scrollTop","offset"],"mappings":";;;;;;;AAAAA,QACC,eACC,SAASC,GACV,aACA,IAiCCC,EA/BAC,EAAUC,OAAOC,SAASC,OAAOC,MAAM,oBACvCC,EAAaP,EAASQ,UAAUC,WAChCC,EAAW,WACV,IAAIA,EACJ,IACCA,IAAa,IAAKC,cAAc,iCAC/B,MAAOC,GACRF,UAA4C,IAAvBP,OAAOU,aAAgCC,WAAaA,UAAUC,UAAU,kCAE9F,OAAOL,EAPG,GASXM,GACCC,IAAK,iBACLC,IAAK,oBACLC,IAAK,YACLC,KAAM,aACNC,IAAK,aACLC,IAAK,kBACLC,IAAK,YACLC,IAAK,0BACLC,IAAK,4BACLC,IAAK,qBACLC,IAAK,gBACLC,KAAM,aACNC,KAAM,aACNC,IAAK,cACLC,OAAQ,uBACRC,IAAK,eACLC,IAAK,mBACLC,IAAK,4BAGNC,EAAe,SAASC,EAAMC,EAAIjB,GAC5BnB,IACJA,EAAWoC,EAAGC,UAAUtB,IAEzB,IAAIuB,EAAMtC,EAASmC,IAASC,EAAGtB,UAAUqB,GAUzC,OATKhB,EAKQ,QAARmB,IACHA,EAAM,QALK,SAARA,IACHA,EAAM,OAODA,GAERC,EAAkB,SAASC,EAAKC,GAC/B,IAAIC,EAAMC,EAAEC,WACZ,IACC,IAAIC,EAASC,SAASC,cAAc,UACnCC,EAAMH,EAAOI,WAAW,MACxBC,EAAM,IAAIC,MA6BX,OAbAD,EAAIV,IAAMA,EACVG,EAAEO,GAAKE,GAAG,OAAQ,WACjB,IACCP,EAAOQ,MAAQH,EAAIG,MACnBR,EAAOS,OAASJ,EAAII,OACpBN,EAAIO,UAAUL,EAAK,EAAG,KAjBlBM,EAFMX,EAAOY,UAAUhB,GAEfpC,MAAM,qCACVmD,EAAE,GAEF,IAECE,gBAAkBjB,EAAOiB,cACjChB,EAAIiB,QAAQd,EAAOY,UAAUhB,GAASI,GAEtCH,EAAIkB,SAWJ,MAAMjD,GACP+B,EAAIkB,SAvBE,IAECJ,IAuBNJ,GAAG,QAAS,WACdV,EAAIkB,WAEElB,EACN,MAAM/B,GACP,OAAO+B,EAAIkB,WAGbC,EAAa,SAASC,EAAIC,EAAMC,EAAS5B,GACxC,IAiBC6B,EAjBGC,EAAOvB,EAAEwB,MAAMC,SAAS,aAAaC,KAAK,MAAOnC,EAAa6B,EAAK5B,KAAMC,IAC5EkC,EAAO3B,EAAE,4DACP4B,KAAK,uCAAyCnC,EAAGoC,KAAK,cAAgB,2CACtEC,OACAC,SAASP,MACXQ,EAAQ,WACPT,EAAKU,KAAK,KAAMd,EAAG,QACjBc,KAAK,MAAOX,GAAOD,GACnBa,KAAKvB,OAAS,GAAIwB,YAAY,OAAQC,aAAa,OAAQC,OAAS,YACpEX,KAAK,UAAW,SAASY,GAKzB,OAJWf,EAAKgB,QAAQ,oBAAoBC,KAAK,oCAC5CC,KAAK,YAAaH,GAAMA,EAAM,cAAgB,YAAY,qBAC/Df,EAAKW,IAAI,UAAWI,EAAM,GAAK,OAC/BX,EAAKW,EAAM,OAAS,UACbf,KAKNF,EAAQ3D,MAAM,UAOlBsE,IANAvC,EAAGiD,QAAQtB,EAAKuB,MAAM,EAAO,SAASC,GACrCtB,EAAMsB,EACNrB,EAAKU,KAAK,OAAQZ,GAClBW,OAuOJ,OA1MiB,WACf,GAAKlE,GAAYP,OAAOsF,SAAWtF,OAAnC,CAGA,IAECuF,EAAGC,EAAKzB,EAAKC,EAAM5B,EAFhBqD,EAAQzF,OAAOC,SAASC,OAAOC,MAAM,qBACxCuF,EAAQ1F,OAAOC,SAASC,OAAOC,MAAM,qBAElCsF,IAGHD,GADAD,EAAIvF,OAAOsF,QACH7C,EAAE,IAAIgD,EAAM,GAAG,UAAUlB,OACjCP,EAAOuB,EAAE9C,EAAE,IAAIgD,EAAM,IAAItB,KAAK,YAAvBoB,GACuB,SAA1BG,EAAM,GAAGC,OAAO,EAAG,IAEtBvD,GADA2B,EAAM2B,EAAM,IACFE,QAAQ,eAAgB,MAC9B5B,EAAKG,KAAK,SAAW/B,GACxB4B,EAAKgB,QAAQ,cAAca,QAAQ,cAClCC,UAAW1D,EACXH,KAAOpB,EAASuB,KAGe,WAA7BpC,OAAOC,SAAS8F,WACnBhC,EAAMA,EAAI6B,QAAQ,SAAU,WAE7B5B,EAAKd,GAAG,aAAc,WACpBc,EAAKG,KAAK,UAAVH,EAAqB,KAErBU,KAAK,MAAOX,GACZI,KAAK,UAJPH,IAMAA,EAAKG,KAAK,UAAVH,EAAqB,GAEtBwB,EAAIK,QAAQ,WAAWG,WAuJ1BC,GAGIlG,GAEa,cADhBA,EAAUA,EAAQ,MAEjBF,EAASQ,UAAU6F,SAASC,gBAAkB,SAAStC,EAAM3B,GAClB,IACrCkE,EACHjG,EAFFH,OAAOqG,OAAOC,SAASC,MAAMC,cACxBJ,EAAU,IAAIK,OAAO,wCAA0C,MAClEtG,EAAQH,OAAOC,SAASC,OAAOC,MAAMiG,KACrBjG,EAAMuG,OAAS,EAAKvG,EAAM,GAAK,IAC3C+B,EAAGyE,WAAW9C,EAAKE,MACzB7B,EAAG0E,UACH5G,OAAO6G,YASRC,MACClD,GAAI,aACJmD,KAAM,mBACNC,QAAS,6BACTC,YAAY,EACZC,eAAe,EACfC,eAAe,EACfC,cAAc,EACdC,WACCC,MAAO,wBACPC,KAAM,0CAIRC,OAAS,aAAc,YAAa,YAAa,gBAAiB,kBAElEnD,KAAO,iEAEPI,MAAQ,SAASgD,EAAMvF,GAClBA,EAAGwF,GAAGC,OAASzF,EAAGwF,GAAGE,OACxB3D,KAAK4D,UAAW,GAEhB5D,KAAKwD,KAAOK,OAAOC,QAClBC,QAAS,UACPP,EAAKQ,aAAaC,oBACpBC,UAAYjG,EAAGkG,QAAU,WACzBC,WAEInG,EAAGoG,aAAarE,KAAKwD,KAAKU,aAC9BlE,KAAK4D,UAAW,EAChB3F,EAAGqG,MAAM,UAAW,8GAKvBC,KAAO,SAAS5E,EAAIC,EAAMC,EAAS5B,GAClC+B,KAAKE,KAAK,MAAOL,IAElB2E,KAAO,SAASC,GACf,IAuJCC,EAvJGC,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZ2G,EAAOpG,EAAEC,WACToG,EAAO5G,EAAG6G,QAAQD,KAClBE,EAAOJ,EAAKK,QAAQxB,KAAKO,QACzBQ,EAAO,SAASU,GACf,IAoECC,EAAMC,EAAQC,EAAQC,EApEnBC,EAAQ9G,EAAEiG,GACbc,EAAUD,EAAMjE,SAChBmC,EAAOmB,EAAKK,QAAQxB,KACpBU,EAAYV,EAAKU,UACjBsB,EAAehH,EAAE,4CAA4C+B,SAASgF,GACtEE,GACCjH,EAAE,2CAA2C+B,SAASiF,GACtDhH,EAAE,4CAA4C+B,SAASiF,IAExDE,EAAU,IAAIT,EAAOR,GACpBkB,WACCC,WACCC,KAAMP,EAAMpF,KAAK,OACjB4C,KAAM6B,EAAK/E,KAAKkD,MAEjBsB,MAAOP,OAAOC,OAAON,EAAKY,OACzB0B,uBAAwB5B,EAAY,aACpC6B,uBAAwB,SACxBC,uBAAwB9B,EAAY,aACpC+B,uBAAwB,SACxBC,yBAA0BhC,EAAY,aACtCiC,yBAA0B,SAC1BC,sBAAuBlC,EAAY,aACnCmC,sBAAuB,SACvBC,0BAA2BpC,EAAY,aACvCqC,0BAA2B,SAC3BC,0BAA2BtC,EAAY,aACvCuC,0BAA2B,WAE5BC,SAAU,SACVC,gBAAiB,UAElBC,YAAaC,KAAKC,IAAI,IAAKvB,EAAQrG,SACnC6H,aAAcF,KAAKC,IAAI,IAAKvB,EAAQpG,UAAYsG,EAAO,GAAGtG,SAAWsG,EAAO,GAAGtG,SAAW,IAC1F6H,iBAAiB,IAElBtI,EAAS4G,EAAMtE,KAAK,gBAAgBiG,IAAI,GACxCC,EAAO,SAAS9F,GACf,QAAiB,IAANA,EAAmB,CAC7B,IAIC+F,EAAIC,EAJDC,EAAI7I,EAAEE,GACT4I,EAAIC,SAASF,EAAE5G,KAAK,UACpB+G,EAAID,SAASF,EAAE5G,KAAK,WACpBgH,EAAIH,EAAIE,EAEC,IAANpG,GACH+F,EAAKG,EACLF,EAAKI,IAGLJ,GADAD,EAAKI,SAASF,EAAE3G,IAAI,cAAgBgH,OAAOtG,IACjCqG,EACNN,EAAKG,GAAKF,EAAKI,IAClBL,EAAKG,EACLF,EAAKI,IAGPG,EAAIC,KAAKf,KAAKgB,MAAMV,EAAKG,EAAI,KAAO,KACpC5B,EAAQoC,uBAAuB5I,MAAOiI,EAAIhI,OAAQiI,IAE9C/B,GACH0C,WAAW,WACV1C,GAAY6B,EAAK9F,IACf,MAIN4G,EAAMxJ,EAAE,6CAA6C0B,KAAK,MAAO,IACjE+H,EAAQzJ,EAAE,8CAA8C0B,KAAK,OAAQ,IACrEyH,EAAMnJ,EAAE,aAAakC,IAAI,QAAS,OAAOkH,KAAK,KAAKnH,KAAK,QAAS,QAAQP,KAAK,MAAO,GAGtFsF,EAAazD,SACbuD,EAAM4C,WAAW,OAAOhI,KAAK,OAAQyE,EAAK/E,KAAK5B,MAExB,eAAnB2G,EAAK/E,KAAK5B,MACbsH,EAAMpF,KAAK,UAAWjC,EAAGkK,QAAQ,eAAiBlK,EAAGmK,OAAO,eAC5DlD,EAAO1G,EAAE,yFACPiC,KAAK,MAAO,KACZA,KAAK,MAAO,OACZA,KAAK,QAAS,WACdxB,GAAG,SAAU,WACb,IAAIoJ,EAAInD,EAAKoD,MACbhD,EAAMpF,KAAK,UAAWmI,GACtBlD,GAAUoD,qBAAqBpD,GAC/BA,EAASqD,sBAAsB,WAC9B9J,EAAO+J,OAAO,SAASC,GACtBA,GAAQxD,EAAKyD,KAAK,QAAQf,KAAK,KAAO3J,EAAG2K,WAAWF,EAAKG,MAAQ,MAC/D,aAAchC,KAAKC,IAAID,KAAKiC,IAAIT,EAAG,KAAM,GAAK,SAGlDC,IAAIhD,EAAMpF,KAAK,YACjB1B,EAAE,wFACAuK,OACAvK,EAAE,UAAU4B,KAAKnC,EAAGoC,KAAK,WAAa,OAAQ6E,EAAM1G,EAAE,YAEtDwK,UAAU1D,EAAMjE,SAASsH,SACE,kBAAnBhE,EAAK/E,KAAK5B,MACpBsH,EAAMvE,QAAQ,cAAca,QAAQ,cACnCC,UAAW,MACX7D,KAAO,YACPiL,YAAY,IAIdzK,EAAE,2DACAuK,OACAd,EAAON,EAAKK,GAEZvH,KAAK,QAASxC,EAAGoC,KAAK,UACtBpB,GAAG,QAAS,cAAe,WAC3BiI,EAAK1I,EAAEwB,MAAME,KAAK,UAElBjB,GAAG,+BAAgC,OAAQ,SAASzC,GACpD6I,GAAW,EACXD,GAAU8D,aAAa9D,GACR,cAAX5I,EAAE2M,OACL/D,EAAS2C,WAAW,WACnB1C,GAAW,EACX6B,EAAK1I,EAAEhC,EAAE4M,QAAQlJ,KAAK,SACpB,QAGJ8I,UAAU1D,EAAMjE,SAASsH,QAG3BZ,WAAW,WACVnD,EAAKpF,QAAQkG,GACTR,IACHA,EAAKtD,QAAQ,UACb8D,EAAQzG,GAAG,oCAAqC,WAC/CiG,EAAKtD,QAAQ,aAIfsF,EAAK,OACH,KAIH5B,EAAMtE,KAAK,sCAAsC/B,GAAG,QAAS,mCAAoC,WAChGT,EAAEwB,MAAMe,QAAQ,yBAAyB5B,OAAO,QAAQ6B,KAAK,qCAAqCqI,WAEnG/D,EAAMrG,GAAG,QAAS,WACjBqG,EAAMtE,KAAK,qCAAqCV,UAqDnD,OAhDKqE,EAAKK,QAAQC,OA8CjBV,EAAKI,EAAKK,QAAQC,SA7ClBP,EAASlG,EAAEC,WACXR,EAAGqL,SACFzE,EAAK0E,IAAM,gDACX1E,EAAK0E,IAAM,qBAAqBxE,EAAI,0BAEjC9G,EAAG5B,YACNmN,QAAQC,QACPC,OACCC,6BAA+B9E,EAAK+E,OAAS,sBAC7CA,OAAW/E,EAAK+E,OAAS,cACzBC,mBAAqBhF,EAAK0E,IAAM,gDAChCO,mBAAqBjF,EAAK0E,IAAM,gDAChCQ,mBAAqBlF,EAAK0E,IAAM,qBAAqBxE,EAAI,2BAG3DyE,SAAS,oBAAqB,SAASQ,GACtCtF,EAAOlF,QAAQwK,MAGhB/L,EAAGgM,YACFpF,EAAK+E,OAAS,iBACd/E,EAAK0E,IAAM,oDACT,WACFtL,EAAGgM,YACFpF,EAAK0E,IAAM,oDACT,WACFtL,EAAGgM,YACFpF,EAAK0E,IAAM,qBAAqBxE,EAAI,4BAClC,WACFL,EAAOlF,QAAQzD,OAAOwN,IAAIS,eAE1BE,SAAU,UAGXA,SAAU,UAGXA,SAAU,QAGZxF,EAAO5D,KAAK,SAASmE,GACpBN,EAAKK,QAAQC,OAASA,EACtBV,EAAKU,MAKAL,GAERuF,WAAa,SAAS1F,GACrB,IAAIQ,EAASjF,KAAKiF,OACjBhH,EAAKgH,EAAOhH,GACZqH,EAAQ9G,EAAEiG,GACV2F,EAAU9E,EAAMpF,KAAK,WACtB,GAAI+E,EAAOoF,SAKV,MAJ2B,eAAvB/E,EAAMpF,KAAK,UACdkK,EAAUA,GAAWnM,EAAGkK,QAAQ,eAAiBlK,EAAGmK,OAAO,cAC3DgC,EAAUvD,KAAKC,IAAI,GAAKD,KAAKiC,IAAI,EAAGsB,EAAU,OAExCnF,EAAOoF,SAAS/K,WACtBgL,OAAQvM,EAAauH,EAAMpF,KAAK,QAASjC,GAAI,GAC7CmM,QAASA,KAIZG,KAAO,SAAS9F,GACf,IAGC7E,EAHG0F,EAAQ9G,EAAEiG,GACb2F,EAAU9E,EAAMpF,KAAK,WACrBiB,EAAOmE,EAAMpF,KAAK,QAEnBF,KAAKqK,SAASG,qBACS,IAAZJ,GACVpK,KAAK/B,GAAGkK,QAAQ,aAAciC,GAE3BjJ,IACHvB,EAAOI,KAAK/B,GAAG2B,KAAKuB,GACpBmE,EAAMpF,KAAK,OAAQN,EAAK5B,UAM1B6E,MACClD,GAAK,cACLmD,KAAO,eACPC,QAAU,8BACV0H,cAAc,EACdxH,eAAe,EACfyH,QAAQ,EACRvH,cAAc,EACdC,WACCC,MAAO,eACPC,KAAM,8BAIRC,OAAS,aAAc,YAAa,YAAa,iBAAkB,sBAEnEnD,KAAO,sDAEPI,MAAQ,SAASgD,EAAMvF,IA/cX,SAASuF,EAAMvF,GACtB3B,IAAY2B,EAAGwF,GAAGC,QACtB1D,KAAK4D,UAAW,KA8cL+G,KAAK3K,KAAMwD,EAAMvF,IAG7BsG,KAAO,SAAS5E,EAAIC,EAAME,EAAK7B,GAC9ByB,EAAWiL,KAAK3K,KAAML,EAAIC,EAAMA,EAAKiJ,KAAO,EAAG5K,EAAGyE,WAAW5C,GAAO,GAAI7B,IAGzEkM,WAAa,WACZ,OAAO3L,EAAEwB,MAAMC,SAAS,aAAaQ,KAAK,QAE3C+D,KAAO,SAASC,IArdL,SAASmG,EAAMnG,GAC1B,IAAI/H,WAAcA,UAAUC,UAAU,iCAAtC,CAKA,IAiGCkO,EAjGGlG,EAAO3E,KACV/B,EAAK+B,KAAK/B,GACV6M,EAAgB7M,EAAG8M,IAAI,QAAS,eAChChL,EAAOvB,EAAEiG,GAAMxE,SAAS,aACtBC,KAAK,UADA1B,GAEL0B,KAAK,YAAa,WAGlB,OAFA1B,EAAEzC,QAAQiP,IAAI,UAAUjL,EAAKU,KAAK,OAClCwK,EAAOC,SAASJ,GACT/K,IAEPd,GAAG,QAAS,WACZkM,MAEFF,EAASzM,EAAEiG,GAAM1D,QAAQ,cACzBqK,EAAUnN,EAAGoN,QACbC,EAAUrN,EAAGoN,MAAM,SACnBE,EAAY/M,EAAE,sDACdoB,EAAOI,KAAKJ,KAEZ4L,EAAQ,SAASA,GACZA,GACHD,EAAU3J,QAAQ,WAAWG,SAC7BhC,EAAKG,KAAK,UAAVH,EAAqB,GACrB9B,EAAGuN,MAAMA,KAETF,EAAQ/K,SAAS0K,EAAOlK,QAAQ,eAChC9C,EAAGwN,OACFb,KAAM,OACNc,IAAK,gDACLC,QACC/D,KAAM,QACNgE,MAAO,WACNL,EAAU3J,QAAQ,WAAWG,SAC7BhC,EAAKG,KAAK,UAAVH,EAAqB,KAGvB8L,SAAU,WACqB,IAA9BP,EAAQrL,WAAWwC,QAAgB6I,EAAQ/K,SAAStC,EAAGoN,YAGzDR,EAAQ9C,WAAWyD,EAAOM,QAG5BX,EAAS,WACR,IAAI9M,EAAM,qBAAqBuM,EAAK,QACnCmB,EAAQhQ,OAAOC,SAASgQ,KAAKC,WAAWtK,QAAQ,OAAQ,IACxD6B,KAEDqH,EAAQ9C,WAAWyD,EAAOM,MAC1BC,KAAkC,IAAxBA,EAAMG,QAAQ,KAAa,IAAM,KAAO,SAASnM,EAAKU,KAAK,MACrEpC,GAAO,oCACPA,GAAO,SAAS8N,mBAAmBJ,EAAM,YACzC1N,GAAO,WAAW8N,mBAAmBJ,GACrC1N,GAAO,UAAU8N,mBAAmBvM,EAAKkD,MACzCzE,GAAO,UAAU8N,mBAAmBpM,EAAKU,KAAK,SAE9C+C,EAAKnF,IAAMA,EACXmF,EAAK9C,KACJxB,MAAO,OACPC,OAAQX,EAAEzC,QAAQoD,SAAS,KAC3BiN,SAAU,QACVC,QAAS,QACTC,gBAAiB,cACjBC,OAAQ,OACRC,IAAK,EACLC,MAAO,GAIR9H,EAAK/C,QAAQ,WACZ7B,KAAM0E,EACNiI,eAAW,EACXrC,SAAUkB,EACV/H,KAAMA,IAGP+H,EACE9K,KAAK,KAAMV,EAAKU,KAAK,MAAM,UAC3BA,KAAK,MAAO+C,EAAKnF,KACjBqC,IAAI8C,EAAK9C,KACTiM,IAAI,OAAQ,WACZ9B,GAAS3B,aAAa2B,GACtB9C,WAAW,WACNwD,EAAUqB,GAAG,YAChBpB,EAAM,oCAEL,KACHP,EAAOC,SAASJ,GAChB7M,EAAG4O,eAAetB,GAAW,GAC7BtN,EAAG6O,QAAQvB,KAEXtM,GAAG,UAAW,WACdhB,EAAG4O,eAAetB,GAAW,KAE7BtM,GAAG,QAASuM,GACZjL,SAAS6K,EAAQ2B,SAAS,uBAAwB3B,EAAU,SAGhE5M,EAAEiG,GAAMxF,GAAG,aAAckM,GACzBA,QAxGA,CACC,IAAI9M,EAAM,6oBACVG,EAAEiG,GAAMuI,QAAQjE,OAAO,iBAAiB1K,EAAI,oGAAoGA,EAAI,kBAmd1IsM,KAAK3K,KAAM,SAAUyE,IAEhC8F,KAAO,SAAS9F,KAChB7B,MAAQ,SAAS6B,OAIjB5B,MACClD,GAAK,WACLmD,KAAO,WACPC,QAAU,8BACV2H,QAAQ,EACRuC,WAAW,EACXC,oBAAoB,EACpBhK,eAAe,EAEfC,cAAe,aAAc,YAAa,YAAa,gBAAiB,iBAAkB,aAAuC,aAAiC,4BAA6B,kBAAmB,0BAA2B,iBAAkB,eAAgB,oBAC/QC,WACCC,MAAO,WACPC,KAAM,oCAGRC,OAAS,aAAc,YAAa,YAAa,gBAAiB,iBAAkB,aAAc,oBAAqB,aAAc,cAAe,4BAA6B,kBAAmB,0BAA2B,iBAAkB,eAAgB,mBAAoB,4BACrRnD,KAAO,gEAEPI,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAG0J,IAAMlP,EAAGwF,GAAGE,UACrB3D,KAAK4D,UAAW,IAIlBW,KAAO,SAAS5E,EAAIC,EAAMwN,EAAKnP,GAC9B,IAsCCoP,EAAenI,EAtCZoI,EAAO,2BACV/L,EAAM/C,EAAEwB,MAAMM,OAEZrB,GAAG,OAAQ,WAEXsC,EAAIgM,SAEJtO,GAAG,QAAS,WACZkB,EAAK4B,SACLR,EAAIgM,SAENtI,EAASjF,KAAKiF,OACdD,EAAUC,EAAOD,QACjB7E,EAAO3B,EAAE,+DACP4B,KAAK,uCAAyCnC,EAAGoC,KAAK,cAAgB,2CACtEE,SAASgB,EAAIF,UACfmM,EAAYvP,EAAGC,UAAU8G,EAAQnC,KAAKM,cACtCsK,EAAU,SAASzP,GAClB,IAAIG,EAAMJ,EAAaC,EAAMC,GAC5ByP,EAAU9Q,EAASuB,GAgBpB,OAdK6G,EAAQ2I,UAAUD,GAEJ,SAARvP,IACVA,EAAM,OAFNA,EAAM,GAIFA,GAAQqP,EAAUE,KAEtBA,EAAU9Q,EADVuB,EAAM,OAENoD,EAAIR,QAAQ,cAAca,QAAQ,cACjCC,UAAW1D,EACXH,KAAO0P,EACPzE,YAAY,KAGP9K,GAERH,EAAO4B,EAAK5B,KAGRgH,EAAQ2I,YACZ3I,EAAQ2I,UAAY1P,EAAGC,UAAU8G,EAAQzB,OAAO,IAE5CyB,EAAQqI,UACZrI,EAAQqI,QAAU,SAAS9L,EAAKpB,EAAMP,GACrC,IAQCgO,EARGC,EAAMtM,EAAI0F,IAAI,GAAG6G,cACpBC,EAAQ,EACR7N,EAAO,KACP8N,EAASxP,EAAEC,WAAWqC,KAAK,WAC1BX,EAAK4B,SACLgM,EAAQ,EACRF,EAAII,YAAY/N,EAAMoN,KAIxBtN,KAAKwE,KAAO,WACX,OAAOvG,EAAGiQ,YAAYtO,EAAKuB,KAAM,eAAeL,KAAK,SAASqN,GAC7DjO,EAAOiO,KAITnO,KAAKoO,QAAU,SAAS5R,GACvB,IAAI6R,EAAK7R,EAAE8R,cAEPD,EAAGE,SAAWjB,GAAQe,EAAGG,SAAWX,IACvB,SAAZQ,EAAGnO,KACQ,IAAV6N,EACHC,EAAOxO,UACa,IAAVuO,GACVA,EAAQ,EACRxM,EAAIK,QAAQ,mBAERgM,GAA6B,YAAnBA,EAAOa,SACpBb,EAAOnO,OAAO,gBAGM,SAAZ4O,EAAGnO,KACb+E,EAAOyJ,SAEHd,GAA6B,YAAnBA,EAAOa,UACG,iBAAZJ,EAAGnO,KACb0N,EAAOpO,QAAQ,QAAUxB,EAAO,WAAaC,EAAG0Q,oBAAoBN,EAAGnO,OAEvE0N,EAAOnO,OAAO,mBAOnBO,KAAKmK,WAAa,WACjB,IAAIhB,EAAMd,EACV,GAAI0F,EAAQ,EAIX,OAHAH,GAA6B,YAAnBA,EAAOa,SAAyBb,EAAOnO,SACjDmO,EAAS,KACTA,EAASpP,EAAEC,WACG,IAAVsP,GACHA,EAAQ,EACRH,EAAOpO,QAAQ,QAAUxB,EAAO,WAAaC,EAAG0Q,oBAAoBzO,IACpEA,EAAO,KACA0N,IAEJrM,EAAIrB,KAAK,UACZlC,EAAOuD,EAAIrB,KAAK,QAChBiJ,EAAOsE,EAAQzP,KAEZqK,EAAI9G,EAAIrB,KAAK,cAChBiJ,GAAQ,IAAOd,EAAI,KAEpBwF,EAAII,YAAY,gCAAkC9E,EAAO,KAAMmE,GACxDM,MAMXrM,EAAIF,SAASX,IAAI,UAAW,GACrB+M,EAAQ7N,EAAK5B,MACpBqP,EAAUpI,EAAOoI,QAAU,IAAIrI,EAAQqI,QAAQ9L,EAAKpB,EAAMP,GAC1DpB,EAAEzC,QAAQkD,GAAG,WAAahB,EAAG2Q,UAAWvB,EAAQe,SAChDf,EAAQ7I,OAAO1D,KAAK,WACnB,IAAIqN,EAAIU,KAAKC,WACZC,SACAC,aACCC,KAAMhR,EAAGgR,KAAKtN,QAAQ,KAAM,KAC5BuN,UAAW3E,KAAQ,4BAGrBhJ,EAAId,KAAK,MAAO6M,EAAO,KAAO6B,UAAUhB,MACtCiB,KAAK,SAASC,GAChBA,GAAOpR,EAAGuN,MAAM6D,GAChBpK,EAAOqK,UAAW,IAID,eAAd1P,EAAK5B,MAAuC,eAAd4B,EAAK5B,OACtCuD,EAAIrB,KAAK,UAAWjC,EAAGkK,QAAQ,eAAiBlK,EAAGmK,OAAO,eAC1DlD,EAAO1G,EAAE,yFACPiC,KAAK,MAAO,KACZA,KAAK,MAAO,OACZA,KAAK,QAAS,WACdxB,GAAG,SAAU,WACb,IAAIoJ,EAAInD,EAAKoD,MACb/G,EAAIrB,KAAK,UAAWmI,KAEpBC,IAAI/G,EAAIrB,KAAK,YACf1B,EAAE,wFACAuK,OACAvK,EAAE,UAAU4B,KAAKnC,EAAGoC,KAAK,WAAa,OAAQ6E,EAAM1G,EAAE,YAEtDwK,UAAUzH,EAAIF,SAASsH,UAG3BnE,KAAO,SAASC,GACf,IAAIlG,EAAMC,EAAEC,WACXkG,EAAO3E,KAEPsF,GADKtF,KAAK/B,GACFO,EAAEiG,IAQX,OAPIE,EAAK2K,SACR/Q,EAAIkB,SAEJ6F,EAAMrG,GAAG,iBAAkB,WAC1BV,EAAIiB,QAAQmF,EAAK0I,WAGZ9O,GAER4L,WAAa,WACZ,OAAOnK,KAAKiF,OAAOoI,QAASrN,KAAKiF,OAAOoI,QAAQlD,kBAAe,GAEhEI,KAAO,SAAS9F,EAAM4I,GACrB,IAGCzN,EAHG0F,EAAQ9G,EAAEiG,GACb2F,EAAU9E,EAAMpF,KAAK,WACrBiB,EAAOmE,EAAMpF,KAAK,aAEI,IAAZkK,GACVpK,KAAK/B,GAAGkK,QAAQ,aAAciC,GAE3BjJ,GACHvB,EAAOI,KAAK/B,GAAG2B,KAAKuB,GACpBmE,EAAMpF,KAAK,OAAQN,EAAK5B,OAExBsH,EAAM4C,WAAW,SAInBtF,MAAQ,SAAS6B,EAAM4I,GACtB7O,EAAEiG,GAAMhE,KAAK,MAAO,IACpB4M,GAAW7O,EAAEzC,QAAQiP,IAAI,WAAahL,KAAK/B,GAAG2Q,UAAWvB,EAAQe,YAKlEvL,MACClD,GAAK,OACLmD,KAAO,cACPC,QAAU,8BACVC,YAAY,EACZC,eAAe,EACfyH,QAAQ,EACRvH,cAAc,EACdC,WACCC,MAAO,cACPC,KAAM,2CAIRC,OAAS,aAAc,YAAa,YAAa,gBAAiB,kBAElEnD,KAAO,sDAEPI,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAGC,OAAUF,EAAKQ,cAAiBR,EAAKQ,aAAauL,MAAS/L,EAAKQ,aAAauL,KAAKC,OAG3FxP,KAAKyP,WAAajM,EAAKQ,aAAauL,KAFpCvP,KAAK4D,UAAW,GAMlBW,KAAO,SAAS5E,EAAIC,EAAMC,EAAS5B,GAClCyB,EAAWiL,KAAK3K,KAAML,EAAIC,EAAMC,EAAS5B,IAG1CkM,WAAa,WACZ,OAAO3L,EAAEwB,MAAMC,SAAS,aAAaQ,KAAK,QAG3C+D,KAAO,SAASC,GACf,IAuGCiL,EAAOxK,EAAMC,EAAQzG,EAAQuG,EAvG1BN,EAAO3E,KACV/B,EAAK+B,KAAK/B,GACVqH,EAAQ9G,EAAEiG,GACV1E,EAAOuF,EAAMrF,SAAS,aACtBgL,EAAS3F,EAAMvE,QAAQ,cACvBqK,EAAUnN,EAAGoN,QACbzG,EAAOpG,EAAEC,WACT8M,EAAY/M,EAAE,4BACd+F,EAAO,SAASoL,GACf,IAAInM,EAEC+H,EAAU9I,OAqBd8I,EAAUhL,SAASgL,EAAUlK,WApB7BkK,EAAY/M,EAAE,wDAAwDkC,KACrE0L,SAAU,QACVI,IAAK,EACLC,MAAO,EACPvN,MAAO,OACPC,OAAQX,EAAEzC,QAAQoD,SAClByQ,SAAU,WACRtP,OAAOC,SAAS6K,EAAQ2B,SAAS,uBAAwB3B,EAAU,QAEtEA,EAAQnM,GAAG,UAAUhB,EAAG2Q,UAAW,SAASpS,EAAG0D,GAC9C1D,EAAEqT,iBACFrT,EAAEsT,kBACF5P,GAAQA,EAAK6P,YAAcxE,EAAUhL,SAA6B,OAApBL,EAAK6P,WAAqB3E,EAAU,UAEnFnN,EAAG+R,KAAK,UAAW,WAClB/K,GAAUA,EAAOgL,gBACjB1E,EAAUxJ,YAMZhC,EAAKd,GAAG,QAASkM,GAEjB3H,EAAOK,OAAOC,QACbqF,KAAM,QACN9H,OAAQkK,EAAUtE,IAAI,GACtBiJ,QAAS5F,OAAQ,OACjB6F,OAAQ,SAASC,GAEhB,IAAIpS,EAAOoS,EAAI3H,SAASU,KACvBhL,EAAMJ,EAAaC,EAAMC,GACzBoS,EAAO,SAASvQ,GACfC,EAAK4M,IAAI,aAAc,WACrB5M,EAAKG,KAAK,YAAcH,EAAKG,KAAK,UAAVH,EAAqB,KAE7CU,KAAK,cAAe,aACpBA,KAAK,MAAOX,IAEfA,EAAMsQ,EAAI9Q,YACXS,EAAKG,KAAK,UAAVH,UACO0E,EAAK6L,QACRvQ,EAAKG,KAAK,SAAW/B,EACxBC,EAAgB0B,EAAK6E,EAAK/E,KAAK5B,MAAM8C,KAAK,SAASiK,EAAKwF,GACnDA,IACH9L,EAAK6L,QAAU5R,EAAS6R,EACxBrL,EAAKtD,QAAQ,UACb8N,GAASA,EAAMnC,QAEhB8C,EAAKtF,KACHqE,KAAK,WACPnE,EAAOrJ,QAAQ,cACdC,UAAW1D,EACXH,KAAOA,IAERqS,EAAKvQ,KAGNuQ,EAAKvQ,IAGP0Q,QAAS,WACRvF,EAAOwF,YAAYxS,EAAG8M,IAAI,QAAS,gBACnC9M,EAAG4O,eAAetB,GAAW,GAC7BA,EAAUjL,OACVrC,EAAG6O,QAAQ7B,KAEVtG,EAAKK,QAAQyK,YAEhB9K,EAAK/C,QAAQ,WACZ7B,KAAM0E,EACNiI,UAAWgE,KACXrG,cAAU,EACV7G,KAAMA,IAGPyB,EAAS,IAAIyL,KAAKC,OAAOnN,GACzBoB,EAAKpF,QAAQyF,GACbK,EAAMrG,GAAG,aAAckM,GACnBwE,GACHA,KAGFxE,EAAS,WACRF,EAAOC,SAASjN,EAAG8M,IAAI,QAAS,gBAChC9M,EAAG4O,eAAetB,GAAW,GAC7BtN,EAAG6O,QAAQvB,GACXA,EAAUgC,OAAOrN,KAAK,UAAWyE,EAAK/E,KAAKuB,MAC3C8D,EAAO2L,KAAK7Q,EAAKkH,IAAI,IACrBlH,EAAKG,KAAK,UAAVH,EAAqB,IA0CvB,OAtCAA,EAAKG,KAAK,UAAVH,GAGuB,eAAnB4E,EAAK/E,KAAK5B,OACbkH,EAAO1G,EAAE,yFACPiC,KAAK,MAAO,KACZA,KAAK,MAAO,OACZA,KAAK,QAAS,WACdxB,GAAG,SAAU,WACb,IAAIoJ,EAAInD,EAAKoD,MACbnD,GAAUoD,qBAAqBpD,GAC/BA,EAASqD,sBAAsB,WAC1B9J,GACHA,EAAO+J,OAAO,SAASC,GACtBA,GAAQxD,EAAKyD,KAAK,QAAQf,KAAK,KAAO3J,EAAG2K,WAAWF,EAAKG,MAAQ,MAC/D,aAAchC,KAAKC,IAAID,KAAKiC,IAAIT,EAAG,KAAM,GAAK,SAInDC,IAAIrK,EAAGkK,QAAQ,eAAiBlK,EAAGmK,OAAO,eAC5CsH,EAAQlR,EAAE,wFACR8B,OACAyI,OACAvK,EAAE,UAAU4B,KAAKnC,EAAGoC,KAAK,WAAa,OAAQ6E,EAAM1G,EAAE,YAEtDwK,UAAU1D,EAAMjE,SAASsH,QAC3BrD,EAAMpF,KAAK,OAAQgF,IAIA,oBAATwL,KACVzS,EAAGgM,YAAY,0DAA2D,WACzE1F,EAAK4G,KACFjB,SAAU,SAEd3F,IACA4G,KAEMvG,GAGR2F,KAAO,SAAS9F,GACf,IAGC4D,EAFA/C,EAAQ9G,EAAEiG,GACV1E,EAAOuF,EAAMrF,SAAS,aAEnBwE,EAAK6L,SACJhL,EAAMpF,KAAK,UACdmI,EAAI/C,EAAMpF,KAAK,QAAQoI,QAClBtI,KAAK/B,GAAGkK,QAAQ,aAAcE,GAEpCtI,EAAKU,KAAK,MAAOgE,EAAK6L,QAAQhR,UATpBU,KASmCJ,KAAK5B,KAAMqK,EAAGxB,KAAKC,IAAID,KAAKiC,IAAIT,EAAG,KAAM,GAAK,SAAM,KACrD,UAAlCtI,EAAKU,KAAK,OAAOiB,OAAO,EAAG,IACrC3B,EAAKU,KAAK,MAv7BD,SAASV,EAAM/B,GAC1B,IACCe,EAAKL,EAAawB,EADf2Q,EAAQ9Q,EAAKU,KAAK,SAEtB,IAECV,EAAKU,KAAK,QAAS,IAEnB1B,EAAMgB,EAAKkH,IAAI,IAEfvI,EAASC,SAASC,cAAc,WACzBM,MAASH,EAAIG,MACpBR,EAAOS,OAASJ,EAAII,OAEpBY,EAAKU,KAAK,QAASoQ,GAEnBnS,EAAOI,WAAW,MAAMM,UAAUL,EAAK,EAAG,GAE1CmB,EAAOxB,EAAOY,UAAUtB,GACvB,MAAMxB,GACP0D,EAAOH,EAAKU,KAAK,OAElB,OAAOP,EAk6BY4Q,CAAU/Q,EAAMC,KAAKJ,KAAK5B,QAG7C4E,MAAQ,SAAS6B,EAAMQ,GACtBA,GAAUA,EAAOtC,aAMlBnC,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAGC,OAAUzF,EAAG6G,QAAQD,KAAKkM,MACnC/Q,KAAK4D,UAAW,IAIlBf,MACClD,GAAK,YACLmD,KAAO,aACPC,QAAU,8BAEXyB,KAAO,SAASwM,GACf,IAAIrM,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZ2G,EAAOpG,EAAEC,WACTwS,EAAOhT,EAAG6G,QAAQD,KAAKkM,IA4KxB,OARKpM,EAAKK,QAAQN,SACjBC,EAAKK,QAAQN,OAASlG,EAAEC,WACxBkG,EAAK1G,GAAGgM,YAAagH,EAAI,WAAa,WACrCtM,EAAKK,QAAQN,OAAOlF,gBAClB,GAAS0R,IAAKnV,OAAQ+G,KAAM,SAEhC6B,EAAKK,QAAQN,OAAO5D,KAzKX,WACP,IAAImE,EAAQkM,EAAYvG,EACxBwG,EAAK5S,EAAEwS,GACPK,EAASD,EAAG/P,SACZ4J,EAASoG,EAAOhQ,SAChB1B,EAAKqR,EAASrR,GAAK,OAGnB2R,GAFM3M,EAAK/E,KAAKkD,KAAKnB,QAAQ,qBAAsB,QAAQpC,eAG1DgS,aAAmB,MACnBC,oBAAyB,MACzBC,YAAmB,OACnBC,wBAA4B,OAC5BC,kBAAuB,aACvBC,yBAA4B,aAC5BC,WAAkB,MAClBC,WAAkB,QAClBC,cAAoB,QACpBC,cAAoB,QACpBC,aAAmB,QACnBC,gBAAsB,QACtBC,gBAAsB,QACtBC,qBAAyB,KACzBC,oBAAyB,KACzBC,gBAAsB,SACtBC,cAAoB,OACpBC,qBAAyB,OACzBC,cAAoB,OACpBC,cAAoB,OACpBC,qBAAyB,OACzBC,aAAmB,MACnBC,WAAkB,MAClBC,0BAA4B,MAC5BC,kBAAuB,QAIxB1B,EAAOlS,OAAOkS,EAAOlS,UAGrB4R,IAAItH,OAAOuJ,IAAI,WAAY/B,GAG3BE,EAAa3S,EAAE,YAAYmB,EAAG,wCAAwCiI,KAAKwJ,EAAG9I,OAAO2K,aAAa7B,EAAG9Q,QAGrG8Q,EAAGlR,KAAK,OAAO,IAGf+E,EAAS8L,IAAIH,KAAKjR,IAGXuT,gBAAkBC,EAAAA,EACzBlO,EAAOmO,YACNhP,MAAO,oBACPiP,SAAU,OACVC,MAAM,IAEPvC,IAAItH,OAAO8J,WAAW,mBAAoB,WAG5B,UADb3I,EAAOmG,IAAIvH,QAAQ,oBAAoBgK,eAAe,IAAM7O,EAAK/E,KAAKkD,MAAMA,OAEvEwO,EAAS3M,EAAK/E,KAAK5B,QACtB4M,EAAO0G,EAAS3M,EAAK/E,KAAK5B,OAI5BqT,EAAOoC,OAAOxT,SAAS,0BAA0B8I,OAAO,KAAOpE,EAAK/E,KAAK5B,KAAO,MAAQ4M,EAAK8I,MAAM,UAAUC,MAAQ,KACrH1O,EAAOmO,YACNxI,KAAM,YAAcA,IAEA,aAAjBhG,EAAK6J,SACRxD,EAAOrJ,QAAQ,YAGjBmP,IAAItH,OAAO8J,WAAW,yBAA0B,WAC/CxC,IAAIvH,QAAQ,0BACZvE,EAAOmO,YACNQ,2BAA2B,EAC3BC,gBAAgB,EAChBC,0BAA0B,MAG5B/C,IAAItH,OAAO8J,WAAW,wBAAyB,WAC9CxC,IAAIvH,QAAQ,yBAAyBjF,KAAKU,KAI3CA,EAAO8O,SAASC,YACflR,KAAO,WACPmR,SACCC,IAAM,SACNC,IAAM,aAEPC,KAAM,SAASnP,GACdN,EAAK+J,YAGPzJ,EAAO8O,SAASC,YACflR,KAAO,cACPmR,SACCC,IAAM,gBACNC,IAAM,uBAEPC,KAAM,SAASnP,GACdN,EAAK0P,cAIPpP,EAAOqP,SAGP9V,EAAE,sCAAsCkC,IAAI,QAAS,QACpDqI,OACAvK,EAAE,aAAa4B,KAAKuE,EAAK1G,GAAGoC,KAAK,aAChCsL,SACA1M,GAAG,QAAS,WACRmS,EAAGlR,KAAK,QACXkR,EAAGlJ,WAAW,OACdiJ,EAAW7Q,OACX8Q,EAAG9I,IAAIrD,EAAOsP,QAAQC,YAAYjH,OAAO3L,QAAQ,SACjDpD,EAAEwB,MAAM4H,KAAK,eAEbwJ,EAAGlR,KAAK,OAAO,GACfiR,EAAW5D,OACXtI,EAAOwP,SAASrD,EAAG9Q,OAAOgI,OAAQ,GAClCrD,EAAOyP,QACPlW,EAAEwB,MAAMI,KAAKuE,EAAK1G,GAAGoC,KAAK,iBAI5B0I,OACAvK,EAAE,uCACDmN,QACAgJ,OACCC,QAAS,eACTC,UAAW,wBAEZjN,MAAM,IAEN3I,GAAG,QAAS,WACZgG,EAAO6P,mBACPtW,EAAE,qBACAkC,IAAI,YAAa,OACjBM,KAAK,8BAA8BV,OAAOyU,MAC1C1T,SAASd,SAAS/B,EAAE,iBAGvBwK,UAAUqI,EAAO1I,QAGlBhE,EAAK/C,QAAQ,WACZ7B,KAAMiR,EACNtE,UAAWqE,IACX1G,SAAUpF,EACVzB,UAIDoB,EAAKpF,QAAQyF,KAYRL,GAERhC,MAAQ,SAASoO,EAAU3G,GAC1BA,GAAYA,EAAS1H,WAEtB4H,KAAO,SAASyG,EAAU3G,GACzBA,GAAY7L,EAAEwS,GAAU9Q,KAAK,SAAW8Q,EAASgE,MAAQ3K,EAASkK,QAAQC,aAE3EE,MAAQ,SAAS1D,EAAU3G,GAC1BA,GAAY7L,EAAEwS,GAAU9Q,KAAK,QAAUmK,EAASqK,SAEjDJ,OAAS,SAAStD,EAAU3G,EAAU7N,EAAG0D,GACxCmK,GAAYA,EAASiK,YAMtB9T,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAGwR,QAAWhX,EAAG6G,QAAQD,KAAKqQ,aACpClV,KAAK4D,UAAW,IAIlBf,MACClD,GAAK,aACLmD,KAAO,aACPC,QAAU,+BAEXyB,KAAO,SAASwM,GACf,IAAI/S,EAAK+B,KAAK/B,GACbkX,EAAQlX,EAAGyE,WAAWzE,EAAG6G,QAAQD,KAAKqQ,YACtCtQ,EAAOpG,EAAEC,WACTkG,EAAO3E,KA4HR,OArCK2E,EAAKK,QAAQN,SACjBC,EAAKK,QAAQN,OAASlG,EAAEC,WACpBtC,GACHqN,QAAQC,QACP2L,WACCtS,KAAM,aACN9G,SAAUmZ,EACVE,KAAM,mBAEPC,KACCJ,YACCK,4BAA6B,iBAIhC/L,SACC,aACA,qCACA,4BACE,SAASgM,GACX7Q,EAAKK,QAAQN,OAAOlF,QAAQgW,MAG7B7Q,EAAK1G,GAAGgM,YACPkL,EAAQ,sBACN,WACFxQ,EAAK1G,GAAGgM,YACPkL,EAAQ,8BACRA,EAAQ,qBACN,WACFxQ,EAAKK,QAAQN,OAAOlF,QAAQgW,gBAE1BtL,SAAU,QAEfvF,EAAK1G,GAAGqL,QAAQ6L,EAAQ,oBAEzBxQ,EAAKK,QAAQN,OAAO5D,KA1HX,SAAS0U,GAChB,IAECvQ,EAAQkM,EAAY3N,EA+BjBX,EAAMxD,EAAGuL,EAAM6K,EAjCfrE,EAAO5S,EAAEwS,GACZvM,EAAO2M,EAAG/P,SAIXoD,EAAKtF,OAAOsF,EAAKtF,UAGjBqE,GACCkS,aAAa,EACbC,cAAc,EACdC,WACCC,SAAU,WAAalR,EAAK+J,UAC5BoH,SAAU,WAAanR,EAAK0P,YAC5B0B,SAAU,WAAapR,EAAK0P,cAK9B1P,EAAK/C,QAAQ,WACZ7B,KAAMiR,EACNtE,UAAW8I,EACXnL,cAAU,EACV7G,KAAMA,IAIPyB,EAASuQ,EAAWQ,aAAahF,EAAUxN,GAG3CoB,EAAKpF,QAAQyF,GAIPpC,IACLA,EAAO2S,EAAWS,eAAetR,EAAK/E,KAAK5B,QAEtC6E,IAASxD,EAAIsF,EAAK/E,KAAKkD,KAAK5G,MAAM,mBACvC2G,EAAO2S,EAAWU,oBAAoB7W,EAAE,KAErCwD,IACH2S,EAAWW,QAAUha,EAAY,4BAA8BgZ,EAAQ,qBACvEvK,EAAO/H,EAAK+H,KACZ6K,EAAO5S,EAAK7E,KACZiH,EAAOmR,UAAU,OAAQX,GACzBD,EAAWa,aAAapR,EAAQ2F,GAEhCnG,EAAKgP,OAAOxT,SAAS,0BAA0B8I,OAAO,KAAO0M,GAAgB,QAAR7K,EAAgB,MAAQA,EAAO,IAAM,MAI3GuG,EAAa3S,EAAEyG,EAAOqR,qBAAqB5V,KAE1C6V,QAAS,EACThK,OAAQ,SAET6E,EAAGlR,KAAK,MAAM,GAGdiR,EAAWhS,OAAO,QAGlBX,EAAE,sCAAsCkC,IAAI,QAAS,QACpDqI,OACAvK,EAAE,aAAa4B,KAAKuE,EAAK1G,GAAGoC,KAAK,aAChCsL,SACA1M,GAAG,QAAS,WACRmS,EAAGlR,KAAK,OACXkR,EAAGlJ,WAAW,MACdiJ,EAAW7Q,OACX8Q,EAAG9I,IAAIrD,EAAOuP,YAAYjH,OAAO3L,QAAQ,SACzCpD,EAAEwB,MAAM4H,KAAK,gBAEbwJ,EAAGlR,KAAK,MAAM,GACdiR,EAAW5D,OACXtI,EAAOwP,SAASrD,EAAG9Q,OAAOgI,OAC1BrD,EAAOuR,UACPvR,EAAOyP,QACPlW,EAAEwB,MAAMI,KAAKuE,EAAK1G,GAAGoC,KAAK,iBAI5B2I,UAAUvE,EAAKkE,UAwCX/D,GAERhC,MAAQ,SAASoO,EAAU3G,GAC1BA,GAAYA,EAASoM,cAEtBlM,KAAO,SAASyG,EAAU3G,GACzBA,GAAY7L,EAAEwS,GAAU9Q,KAAK,QAAU8Q,EAASgE,MAAQ3K,EAASmK,aAElEE,MAAQ,SAAS1D,EAAU3G,GAC1BA,GAAY7L,EAAEwS,GAAU9Q,KAAK,OAASmK,EAASqK,SAEhDJ,OAAS,SAAStD,EAAU3G,EAAU7N,EAAG0D,GACxCmK,GAAYA,EAASmM,aAMtBhW,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAGwR,QAAWhX,EAAG6G,QAAQD,KAAK6R,YACpC1W,KAAK4D,UAAW,IAGlBf,MACClD,GAAK,YACLmD,KAAO,YACPC,QAAU,8BAEX4T,MAAS,MACTnS,KAAO,SAASwM,GACf,IAAIrM,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZwG,EAAOjG,EAAEwS,GAAU3P,SACnBuD,EAAOpG,EAAEC,WACTwS,EAAOhT,EAAG6G,QAAQD,KAAK6R,UAmExB,OAjBK/R,EAAKK,QAAQN,SACjBC,EAAKK,QAAQN,OAASlG,EAAEC,WACxBkG,EAAK1G,GAAGqL,QAAQ2H,EAAI,sBAChB9U,EACHqN,SACCyH,EAAI,qBACF,SAAS2F,GACXjS,EAAKK,QAAQN,OAAOlF,QAAQoX,KAG7BjS,EAAK1G,GAAGgM,YAAYgH,EAAI,qBAAsB,WAC7CtM,EAAKK,QAAQN,OAAOlF,QAAQoX,aACzB1M,SAAU,SAGhBvF,EAAKK,QAAQN,OAAO5D,KAhEX,SAAS8V,GAChB,IAEC3R,EAAQkM,EAAY3N,EAFjBgE,EAAK/C,EAAKtF,SACb0X,EAAQpS,EAAKqS,aAAY,GAAQtP,EAAI,GAItCwJ,EAAS+F,WAAa,SAAS5X,GAC9B,IAEC6X,EAFGxP,EAAIrI,GAAUsF,EAAKtF,SACtB8X,EAAO,EAQR,OANAxS,EAAKxE,SAAS,qCAAqCiX,KAAK,WACvDD,GAAQzY,EAAEwB,MAAM8W,aAAY,KAE7BE,EAAQxP,EAAIyP,EAAOJ,EACnB1F,EAAWhS,OAAO6X,GAClB/R,EAAOiQ,WAAWsB,UACXQ,GAIRvS,EAAKtF,OAAOqI,GAEZhE,GACC2T,QAASnG,EACToG,WAAW,GAIZzS,EAAK/C,QAAQ,WACZ7B,KAAMiR,EACNtE,UAAWkK,EACXvM,cAAU,EACV7G,KAAMA,IAIPyB,EAAS,IAAI2R,EAAUpT,GACvBoB,EAAKpF,QAAQyF,IAGbkM,EAAa3S,EAAEyG,EAAOiQ,WAAWoB,sBAGtB5V,IAAI,aAAc,QAC3BT,SAAS,sBAAsBS,IAAI,aAAc,QACnDsQ,EAAS+F,WAAWvP,KAqBf5C,GAERhC,MAAQ,SAASoO,EAAU3G,GAC1BA,GAAYA,EAASoM,aACrBpM,EAAW,MAEZE,KAAO,SAASyG,EAAU3G,GACzBA,IAAa2G,EAASgE,MAAQ3K,EAAS2K,UAExCN,MAAQ,SAAS1D,EAAU3G,GAC1BA,GAAYA,EAAS6K,WAAWR,SAEjCJ,OAAS,SAAStD,EAAU3G,EAAU7N,EAAG0D,GACxCmK,GAAY2G,EAAS+F,gBAKtBlU,MACClD,GAAK,WACLmD,KAAO,WACPC,QAAU,4BAEX4T,MAAS,MAAO,OAAQ,SACxBnW,MAAQ,SAASgD,EAAMvF,GAEjBA,EAAG6G,QAAQD,KAAKwS,UADPrX,KAILsX,WACJ9T,EAAKQ,eALIhE,KAMJsX,QAAUzT,OAAOC,UAAWN,EAAKQ,aAAaqT,cAClD7T,EAAKQ,aAAauT,aAPVvX,KAQHuX,WAAa/T,EAAKQ,aAAauT,cAR5BvX,KAEL4D,UAAW,GAWrBY,KAAO,SAASwM,GACf,IAAIrM,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZ2G,EAAOpG,EAAEC,WA4EV,OARKkG,EAAKK,QAAQN,SACjBC,EAAKK,QAAQN,OAASlG,EAAEC,WACxB1C,OAAOyb,kBAAoBvZ,EAAG6G,QAAQD,KAAKwS,SAAW,IACtD7Y,EAAEiZ,UAAUxZ,EAAG6G,QAAQD,KAAKwS,SAAW,eAAgB,WACtD1S,EAAKK,QAAQN,OAAOlF,aAGtBmF,EAAKK,QAAQN,OAAO5D,KA1EZ,WACN,IAMC0C,EANGiB,EAAOjG,EAAEwS,GAAU3P,SACtBqW,EAAMjT,EAAK1D,QAAQ,oBACnByG,EAAI/C,EAAKtF,SACTwY,EAAM,sBACNC,EAAMjT,EAAKK,QAAQuS,YAAcxb,OAAOC,SAASgQ,KAAKrK,QAAQ,OAAQ,IAKnEgW,EAAIE,KAAKD,GACZA,EAAMA,EAAIjW,QAAQgW,EAAK,cAEvBC,GAAO,oBAGRnT,EAAKtF,OAAOqI,GAGZhE,GACCsU,cAAe,EACfC,UAAU,EACVC,gBAAgB,EAChBC,qBAAuBL,EACvBM,oBAAoB,EACpBC,wBAAyBla,EAAGwF,GAAGE,OAC/ByU,cAAe,SACfC,aAAc,+BACdpZ,IACCqZ,cAAkB,SAAS9b,GAC1B,IAAIyI,EAASzI,EAAEyI,OACfA,EAAOqP,OAAO,OAAQ9M,GAEtBkQ,EAAI/K,IAAI,iBAAiB1O,EAAG2Q,UAAW,WACtC3J,EAAOtC,YACLgK,IAAI,WAAW1O,EAAG2Q,UAAW,WAC/BjK,EAAKH,KAAKwM,GAAUlQ,KAAK,SAASmE,GACjCN,EAAK0F,SAAWpF,MAIlBL,EAAKpF,QAAQhD,EAAEyI,WAMlBN,EAAK/C,QAAQ,WACZ7B,KAAMiR,EACNtE,UAAWrK,SACXgI,cAAU,EACV7G,KAAMA,IAIPnB,SAASV,QAAQqP,EAASrR,GAAIkE,OAAOC,OAAON,EAAMmB,EAAKK,QAAQsS,UAC/DjV,SAASpD,GAAG,mBAAoB,SAASzC,GACxC,IAAIkb,EAAMlb,EAAE0D,KAAKqY,WAAWtN,OAC5ByM,EAAIzY,GAAG,OAAQ,SAASzC,GACvByB,EAAGoN,QAAQtC,OAAOvK,EAAE,iCAAiCuK,OAAO/I,KAAKwY,aAAaha,KAE/EkZ,EAAIzY,GAAG,OAAQ,SAASzC,GACvBgC,EAAE,cAAcuK,OAAOvK,EAAE,iCAAiCuK,OAAO/I,KAAKwY,aAAaha,SAahFoG,GAERhC,MAAQ,SAASoO,EAAU3G,GAC1BA,GAAYA,EAAS1H,WAEtB4H,KAAO,SAASyG,EAAU3G,GACzBA,IAAa2G,EAASgE,MAAQ3K,EAASoO,YAExC/D,MAAQ,SAAS1D,EAAU3G,GAC1BA,GAAYA,EAASqK,SAEtBJ,OAAS,SAAStD,EAAU3G,EAAU7N,EAAG0D,GAEpCmK,GACqB,UAApBA,EAASqO,QACZrO,EAASiK,OAAO,OAAQ9V,EAAEwS,GAAU3P,SAASlC,aAOhD0D,MACClD,GAAK,YACLmD,KAAO,YACPC,QAAU,8BAEX4T,MAAQ,MAAO,OAAQ,SACvBvW,KAAO,4CACPI,MAAQ,SAASgD,EAAMvF,GACtB,IAAI+G,EAAUhF,KAET/B,EAAG6G,QAAQD,KAAK8T,WAAsC,mBAAlB5c,OAAO6c,QAA6C,iBAAbA,UAG/E5T,EAAQsS,WACJ9T,EAAKQ,eAEJR,EAAKQ,aAAa6U,gBACrB7T,EAAQ6T,cAAgBrV,EAAKQ,aAAa6U,eAE3C7T,EAAQsS,QAAUzT,OAAOC,UAAWN,EAAKQ,aAAa2U,eAClD3T,EAAQsS,QAAQ1M,OACnB5F,EAAQ6T,cAAgB7T,EAAQsS,QAAQ1M,YACjC5F,EAAQsS,QAAQ1M,MAEpBpH,EAAKQ,aAAauT,aACrBvS,EAAQuS,WAAa/T,EAAKQ,aAAauT,cAdzCvS,EAAQpB,UAAW,EAkBpB3F,EAAG+R,KAAK,UAAW,WAClBhL,EAAQC,OAAS,QAInB6T,QAAU,SAASrU,EAAMsU,EAAYnZ,GACpCpB,EAAEiG,GAAMtF,OAAOsF,EAAKQ,OAAOhH,GAAGoN,QAAQlM,SAAW,MAElDoF,KAAO,SAAS5E,EAAIC,EAAMM,EAAMjC,GAC/B,IAAIoB,EAAIa,EAAKhE,MAAM,qDAClB8c,EAAS,GACTC,EAAO,GACPC,EAAQ,GACTlZ,KAAKU,KACJxB,MAAO,OACPC,OAAQ,OACRga,aAAc,eAEX9Z,GACH2Z,EAAS3Z,EAAE,GACX4Z,EAAO5Z,EAAE,GACT6Z,EAAS7Z,EAAE,IAEX4Z,EAAO/Y,EAERF,KAAKE,KAAK,QACT8Y,OAAQA,EACRC,KAAMA,EACNC,OAAQA,IAETlZ,KAAKoZ,kBAAkBlZ,IAExBsE,KAAO,SAAS6U,GACf,IA4KI3U,EAvKE4U,EALF3U,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZ2G,EAAOpG,EAAEC,WACTmM,EAAOjG,EAAKK,QAAQ6T,eAAiB,qBACrC5J,GAEwB,QADnBqK,EAAIrb,EAAGgR,KAAK1P,cAAcoC,QAAQ,IAAK,MACrCD,OAAO,EAAG,IAAqB,UAAN4X,IAC9BA,EAAI,MAEEA,GAER/U,EAAO,SAASgV,GACf,IACC/V,EADGiB,EAAOjG,EAAE6a,GAAUhY,SAIvBoD,EAAKtF,OAAOlB,EAAGoN,QAAQlM,SAAW,KAGlCqE,EAAOK,OAAOC,QACb0V,SAAU,UAAW,IAAK,WAAY,aAAc,IAAK,OAAQ,SAAU,YAAa,gBAAiB,YAAa,IAAK,YAAa,IAAK,eAAgB,eAAgB,aAAc,SAAU,UAAW,IAAK,WAAY,OAAQ,cAAe,cAAe,aAAc,IAAK,OAAQ,QAClSC,SAAUxK,GACRtK,EAAKK,QAAQsS,SAGhB3S,EAAK/C,QAAQ,WACZ7B,KAAMsZ,EACN3M,UAAW6M,EACXlP,cAAU,EACV7G,KAAMA,IAGP+V,EACEG,OAAOL,EAAU7V,GACjBmW,KAAK,SAAS1U,GACd,IAEgB2U,EAASC,EAFrBC,EAAM7U,EAAO8O,SAAS9M,IAAI,YAC7B8S,EAAW9U,EAAO+U,QAAQ/S,IAAI,kBAC9BgT,MACGhV,EAAOiV,GAAGC,KAAKX,SAAqB,YAAT5O,GAA+B,uBAATA,GACpDpM,EAAE6a,GAAUtY,QAAQ,oBAAoBd,SAAS,qBAAqB8I,OAAOvK,EAAEyG,EAAOiV,GAAGC,KAAKX,QAAQrC,SAASzW,KAAK0Z,YAAY,OAAOC,WAAW,UAEtI,YAATzP,GACHpM,EAAE6a,GAAUtY,QAAQ,yBAAyBL,IAAI,WAAY,QAG1DoZ,IACHF,EAAU,SAASU,GAClB,OAAOA,GAAKA,EAAEtc,KAAK9B,MAAM,cAE1B2d,EAAe,SAASU,GAEvB,GADatV,EAAO8O,SAAS9M,IAAI,eACrBuT,UASZvV,EAAOwV,QAAQ,eAAiBjM,OAAQ+L,QATxC,CACC,IAAIG,EAAMzV,EAAO+U,QAAQ/S,IAAI,gBAC5B0T,EAAM1V,EAAO2V,OAAOC,EACrBH,EAAII,YAAYH,EAAI,oDACnBtX,MAAOsX,EAAI,0BACX/L,UAAW,eAOdkL,EAAIW,QAAU,WACb,IAAI/C,EAAMjT,EAAK1D,QAAQ,oBACtBga,EAAK9c,EAAG+c,WAAW,WACnBC,EAAQ,WACHhB,EAASiB,SACZxD,EAAI1M,IAAI,eAAgBiQ,GACxBF,EAAGI,SAAWlB,EAASkB,SACvBJ,EAAGjW,QAAQsW,QAAUnB,EAASmB,QAC9BL,EAAGjW,QAAQuW,SAAWpB,EAASqB,MAC/Brd,EAAGsd,WAAWC,KAAOvB,EAASuB,KAC9BvB,EAASiB,QAAS,IAGrBxD,EAAI9V,QAAQ,iBAAiB+K,IAAI,eAAgBsO,GACjDhB,EAASkB,SAAWJ,EAAGI,SACvBlB,EAASmB,QAAUL,EAAGjW,QAAQsW,QAC9BnB,EAASqB,MAAQP,EAAGjW,QAAQuW,SAC5BpB,EAASuB,KAAOvd,EAAGsd,WAAWC,KAC9BvB,EAASiB,QAAS,EAClBH,EAAGI,SAAW,SAASpM,GACtB,IAAI0M,KACiB,IAAjB1M,EAAMtM,QAAkC,cAAlBsM,EAAM,GAAG/Q,MAMnCC,EAAGoN,MAAM,OAAOzJ,QAAQ,eACxBpD,EAAE0Y,KAAKnI,EAAO,SAAS2M,EAAGpB,GACrBV,EAAQU,GACXmB,EAAKE,KAAK1d,EAAGyE,WAAW4X,EAAExa,MAE1BmF,EAAOwV,QAAQ,OAAQxc,EAAGyE,WAAW4X,EAAExa,QAGrC2b,EAAKhZ,QACRoX,EAAa4B,GAEd/D,EAAI9V,QAAQ,kBAhBX3D,EAAG0O,IAAI,OAAQ,WACd1O,EAAGsd,WAAWC,KAAO,YACnBR,WAAW,QAAQ5G,KAAKrF,EAAM,GAAG5N,OAgBtC4Z,EAAGjW,QAAQsW,SAAU,EACrBL,EAAGjW,QAAQuW,UAAW,EACtBpd,EAAGsd,WAAWC,KAAO,UACrBvd,EAAGwN,OACFb,KAAM,OACNc,IAAKzN,EAAGoC,KAAK,wBAKhB0Z,EAAS6B,oBAAsB,SAASlX,GACvC,OAAO,IAAImX,EAAQnX,IAEpBO,EAAO6W,QAAQtd,EAAE6a,GAAUnZ,KAAK,QAAQ+Y,MAExChb,EAAGoN,QAAQtC,OAAOvK,EAAE,uBACpBA,EAAE,wBAAwBkC,KACzBqb,UAAW9d,EAAG+d,iBAAiBC,OAAS,IAEzCrX,EAAKpF,QAAQyF,KAON,MAAE,SAASuG,GAClBvN,EAAGuN,MAAMA,MAGZqQ,EAAU,SAASnX,GAClB,IAAIwX,EAAS,SAAStc,EAAMJ,EAASC,GACpCxB,EAAGmW,KAAK,UAAWrF,OAAQnP,SAAQ,EAAS3B,EAAGke,MAAMhb,MACnDL,KAAK,SAASZ,GACVA,EAAKkc,OAASlc,EAAKkc,MAAM3Z,OAC5BxE,EAAG6B,IAAII,EAAKkc,MAAM,GAAGjb,MAAQkb,OAAO,IAAQvb,KAAK,SAAShB,GACzDN,GACC8c,QAAWre,EAAGyE,WAAW5C,OAExBsP,KAAK,WACP3P,EAAO,qBAGRA,EAAOxB,EAAGoC,KAAKH,EAAKsL,MAAOtL,EAAKsL,MAAQ,gBAGzC4D,KAAK,SAASC,GACd,IAAI7D,EAAQvN,EAAGse,WAAWlN,GAC1B5P,EAAOxB,EAAGoC,KAAKmL,EAAkB,cAAVA,EAAuB,WAAaA,EAAS,uBAEpEgR,SAAS,SAAStc,GAClBwE,EAAO+X,YAAcvc,EAAKwc,MAC1BhY,EAAOiY,SAAWzc,EAAKsc,YAG1Bxc,KAAKkc,OAAS,WACb,OAAO,IAAIU,QAAQ,SAASpd,EAASC,GAChCiF,EAAO9E,gBAAgBgd,SAAYlY,EAAO9E,MAAoC,mBAArB8E,EAAO9E,KAAK+Z,KACxEjV,EAAO9E,KAAK+Z,KAAK,SAAS/Z,GACzBsc,EAAOtc,EAAMJ,EAASC,KAGvByc,EAAOxX,EAAO9E,KAAMJ,EAASC,MAIhCO,KAAK6c,MAAQ,WACZ5e,EAAGoN,QAAQzJ,QAAQ,iBAuCtB,OAnCK+C,EAAKK,QAAQC,OAiCjBV,EAAKI,EAAKK,QAAQC,SAhClBP,EAASlG,EAAEC,WACXkG,EAAK1G,GAAGgM,YACPhM,EAAG6G,QAAQD,KAAK8T,UAAY,IAAM/N,EAAO,gBACvC,SAAS3F,GACNA,IACJA,EAASlJ,OAAO+gB,eAAiB/gB,OAAOghB,cAAgBhhB,OAAOihB,eAAiBjhB,OAAOkhB,iBAExE,OAAZhf,EAAGgR,KACNtK,EAAK1G,GAAGgM,YACPhM,EAAG6G,QAAQD,KAAK8T,UAAY,IAAM/N,EAAO,iBAAmBqE,EAAO,OACjE,SAASiC,GACXxM,EAAOlF,QAAQyF,KAEfiY,YAAY,EACZhT,SAAU,MACVsB,MAAO,SAAS0F,GACfjC,EAAO,KACPvK,EAAOlF,QAAQyF,MAIjBP,EAAOlF,QAAQyF,KAGhBiY,YAAY,EACZhT,SAAU,QAEXxF,EAAO5D,KAAK,SAASmE,GACpBN,EAAKK,QAAQC,OAASA,EACtBV,EAAKU,MAKAL,GAERuF,WAAa,WACZ,IAAIjK,EAAO1B,EAAEwB,MAAME,KAAK,QACxB,OAAOA,EAAK8Y,OAAS9Y,EAAK+Y,KAAO/Y,EAAKgZ,QAEvCtW,MAAQ,SAASyW,EAAUhP,GAC1BA,GAAYA,EAAS1H,WAEtB4H,KAAO,SAAS8O,EAAUhP,GACzB,IAAI8S,EAAM3e,EAAE6a,GACXnZ,EAAOid,EAAIjd,KAAK,QACbmK,IACHnK,EAAK+Y,KAAO5O,EAASoO,UACrB0E,EAAIjd,KAAK,OAAQA,KAGnBwU,MAAQ,SAAS2E,EAAUhP,GAC1B7L,EAAE6a,GAAUzX,QAAQ,YAKrBiB,MACClD,GAAK,UACLmD,KAAO,UACPC,QAAU,8BAEX4T,MAAS,MAAO,OAAQ,SACxBnW,MAAQ,SAASgD,EAAMvF,GAEjBA,EAAG6G,QAAQD,KAAKuY,SADPpd,KAILqd,WACJ7Z,EAAKQ,cALIhE,KAMJsd,WAAazZ,OAAOC,UAAWN,EAAKQ,aAAasZ,gBAN7Ctd,KAOJqd,QAAUxZ,OAAOC,UAAWN,EAAKQ,aAAaoZ,cAP1Cpd,KASJsd,eATItd,KAEL4D,UAAW,GAWrBY,KAAO,SAASwM,GACf,IAAIrM,EAAO3E,KACV/B,EAAO+B,KAAK/B,GACZ2G,EAAOpG,EAAEC,WA0MV,OATKkG,EAAKK,QAAQN,SACjBC,EAAKK,QAAQN,OAASlG,EAAEC,WACxBkG,EAAK1G,GAAGgM,YAAYhM,EAAG6G,QAAQD,KAAKuY,SAAWnf,EAAG6G,QAAQD,KAAKuY,QAAQlhB,MAAM,QAAS,GAAK,oBAAqB,WAC/GyI,EAAKK,QAAQN,OAAOlF,YAEpB0K,SAAU,SAGZvF,EAAKK,QAAQN,OAAO5D,KAxMZ,WACN,IAqBC0C,EAAM+Z,EAAQC,EArBX/Y,EAAOjG,EAAEwS,GAAUzD,OAAOlM,SAC7BqW,EAAMjT,EAAK1D,QAAQ,oBACnByG,EAAI/C,EAAKtF,SACT0X,EAAQpS,EAAKqS,aAAY,GAAQtP,EAEjCiW,EAAa,WACZ,IAAIC,EACAN,QAAQO,aAAaC,cAAcC,SACtCH,EAAON,QAAQO,aAAaC,cAAcC,QAAQ,GAClDN,EAAS/e,EAAEkf,EAAMA,EAAKI,aAAU,GAASxd,OACzCkd,EAAQhf,EAAE,oBAAoB8B,QAE9Bid,EAAS/e,EAAE,oBAAoB8B,QAIjCyd,EAAa,WACZP,GAASA,EAAMjQ,OACfgQ,GAAUA,EAAOhQ,QAElByQ,EAAOZ,QAAQa,aAIhBxZ,EAAKtF,OAAOqI,GAEZwJ,EAAS+F,WAAa,SAAS5X,GAC9B,GAAI6e,EAAO,EAAG,CACb,IAGChH,EAHGvS,EAAOjG,EAAEwB,MAAMqB,SAClBmG,EAAIrI,GAAUsF,EAAKyZ,cACnBjH,EAAO,EAERxS,EAAKzD,KAAK,6BAA6Bf,SAAS,gCAAgCiX,KAAK,WACpFD,GAAQzY,EAAEwB,MAAM8W,aAAY,KAE7BE,EAAQxP,EAAIyP,EAAOJ,EACnBpS,EAAKzD,KAAK,+BAA+B7B,OAAO6X,KAKlDxT,GACC2a,SAAU,IAAMnN,EAASrR,GACzB2U,QAAQ,EACR0F,QAAS,6PACTR,QAAS,kLACT4E,cAAc,EACdC,uBAAyB,SAASpZ,GAEjC+L,EAAS+F,WAAWvP,GAEpBkQ,EAAI/K,IAAI,iBAAiB1O,EAAG2Q,UAAW,WACtCwO,QAAQkB,YAAY,mBAAmB,EAAOtN,EAASrR,MACrDgN,IAAI,WAAW1O,EAAG2Q,UAAW,WAC/BjK,EAAKH,KAAKwM,GAAUlQ,KAAK,SAASmE,GACjCN,EAAK0F,SAAWpF,MAIlBL,EAAKpF,QAAQyF,IAEdsZ,qBAAuB,SAAUpD,EAAUnG,EAAOwJ,GACjD,IAAIzD,EAAK9c,EAAG+c,WAAW,WACtByD,EAAQ,WACHxE,EAASiB,SACZH,EAAGI,SAAWlB,EAASkB,SACvBJ,EAAGjW,QAAQsW,QAAUnB,EAASmB,QAC9BL,EAAGjW,QAAQuW,SAAWpB,EAASqB,MAC/Brd,EAAGsd,WAAWC,KAAOvB,EAASuB,KAC9BvB,EAASiB,QAAS,GAEnBxD,EAAI1M,IAAI,eAAgByT,GACxBV,KAED9D,KAiDD,OAhDAA,EAASkB,SAAWJ,EAAGI,SACvBlB,EAASmB,QAAUL,EAAGjW,QAAQsW,QAC9BnB,EAASqB,MAAQP,EAAGjW,QAAQuW,SAC5BpB,EAASuB,KAAOvd,EAAGsd,WAAWC,KAC9BvB,EAASiB,QAAS,EAClBH,EAAGI,SAAW,SAASvb,GACtB,IAAIE,EAAK+C,EAES,cAAdjD,EAAK5B,MAQT8B,EAAM7B,EAAGyE,WAAW9C,EAAKE,KAGzB+C,EAAOjD,EAAKkD,KAAO,KAAO7E,EAAG2K,WAAWhJ,EAAKiJ,MAAQ,IAGhC,QAAjB2V,EAAKE,UACRvD,EAASrb,GAAM8H,KAAM/E,EAAMQ,MAAOR,IAId,SAAjB2b,EAAKE,UACRvD,EAASrb,GAAM6e,IAAK9b,IAIA,SAAjB2b,EAAKE,UACRvD,EAASrb,GAEV4X,EAAI9V,QAAQ,kBA1BX3D,EAAG0O,IAAI,OAAQ,WACd1O,EAAGsd,WAAWC,KAAO,YACnBR,WAAW,QAAQ5G,KAAKxU,EAAKuB,OA0BlC4Z,EAAGjW,QAAQsW,SAAU,EACrBL,EAAGjW,QAAQuW,UAAW,EACtBpd,EAAGsd,WAAWC,KAAO,UAErBiC,IACA/F,EAAI9V,QAAQ,iBAAiB+K,IAAI,eAAgB8R,GACjDxgB,EAAGwN,OACFb,KAAM,OACNc,IAAKzN,EAAGoC,KAAK,uBAGP,GAERue,sBAAwB,SAAUC,EAAUC,EAASC,GACpD,IAAInf,EAAOif,EAASnW,OACnB2G,EAAM,SAAS7S,GACd,IAAIkb,EAAMlb,EAAE0D,KAAK+K,YACWyM,EAAI3K,SAAS,0BAA4B2K,EAAI3K,SAAS,8BACtD0Q,IACA/F,EAAI9V,QAAQ,iBAAiB+K,IAAI,eAAgBqS,GACjD/gB,EAAGghB,OAAO,eAAgB5P,KAGvD2P,EAAS,WACRtH,EAAI1M,IAAI,eAAgBgU,GACxBjB,KAEDmB,GAAW,EAGRtf,EAAKkD,OAERoc,OAAW,GAEZjhB,EAAG+R,KAAK,eAAgBX,GAAK+E,KAAK,SAAUvQ,OAAOC,QAClDiL,OAAQnP,GACRsf,SAAUA,GACRva,EAAKK,QAAQsY,iBAAa,EAASrf,EAAGke,MAAMhb,MAAML,KAAK,SAASZ,GAC9DA,EAAKkc,OAASlc,EAAKkc,MAAM3Z,OAC5BxE,EAAG6B,IAAII,EAAKkc,MAAM,GAAGjb,MAAQkb,OAAO,IAAQvb,KAAK,SAAShB,GACzDie,IACAe,EAAQ7gB,EAAGyE,WAAW5C,MACpBsP,KAAK,WACP2P,EAAQ9gB,EAAGoC,KAAK,sBAGjB0e,EAAQ9gB,EAAGoC,KAAKH,EAAKsL,MAAOtL,EAAKsL,MAAQ,gBAExC4D,KAAK,SAASC,GAChB,IAAI7D,EAAQvN,EAAGse,WAAWlN,GACtB7D,IACW,kBAAVA,EACHA,EAAQ,UACY,cAAVA,IACVA,EAAQ,aAGVuT,EAAQ9gB,EAAGoC,KAAKmL,GAAe,yBAM9BwS,GAAQ,IACXxa,EAAKrE,OAAS,QAIfwF,EAAK/C,QAAQ,WACZ7B,KAAMiR,EACNtE,UAAW0Q,QACX/S,cAAU,EACV7G,KAAMA,IAIP4Z,QAAQ7Y,KAAKV,OAAOC,OAAON,EAAMmB,EAAKK,QAAQqY,YAYzCzY,GAERhC,MAAQ,SAASoO,EAAU3G,GAC1BA,GAAY+S,QAAQkB,YAAY,mBAAmB,EAAOtN,EAASrR,KAEpE4K,KAAO,SAASyG,EAAU3G,GACzBA,GAAYA,EAASE,QAEtBmK,MAAQ,SAAS1D,EAAU3G,GAC1BA,GAAYA,EAASqK,SAEtBJ,OAAS,SAAStD,EAAU3G,EAAU7N,EAAG0D,GAExCmK,GAAY2G,EAAS+F,gBAItBlU,MACClD,GAAK,aACLmD,KAAO,cACPC,QAAU,6BACVoc,SAAW,aACXC,YAAY,EACZC,aAAa,EACbC,aAAe,KACfnc,cAAc,EACdC,WACCC,MAAO,kBACPC,KAAM,oCAGRC,OACC,qBACA,0EAEA,0CACA,kBACA,YACA,2BACA,oEACA,iDACA,+BACA,WACA,4BACA,gCACA,4EACA,yEACA,kDACA,mCAEDnD,KAAO,oEAEPI,MAAQ,SAASgD,EAAMvF,IAClBA,EAAGwF,GAAGE,QAAU1F,EAAGwF,GAAGC,SACzB1D,KAAK4D,UAAW,IAIlBkV,QAAU,SAASrU,EAAMsU,EAAYnZ,GACpC,IAAIwL,EAAU3G,EAAKQ,OAAOhH,GAAGoN,QAC7B7M,EAAEiG,GAAMtF,OAAOiM,EAAQjM,UACvB4Z,EAAW7Z,MAAQ2H,KAAKC,IAAIiS,EAAW7Z,OAAS,EAAqB,GAAlBkM,EAAQlM,UAG5DqF,KAAO,SAAS5E,EAAIC,EAAMwN,EAAKnP,GAC9B,IAOMiC,EAPFkR,EAAKpR,KACRuB,EAAM/C,EAAEwB,MAAMM,OACdgL,EAAUrN,EAAGoN,MAAM,SACnBlL,EAAO3B,EAAE,iEACP4B,KAAK,uCAAyCnC,EAAGoC,KAAK,cAAgB,2CACtEE,SAASgB,EAAIF,UAShB7C,EAAE4S,GAAIlR,KAAK,MAAOjC,EAAGshB,SACpBrf,MACCsf,IAAK,SACL1c,KAAMsO,EAAGnM,OAAOD,QAAQnC,KAAKsc,SAC7BM,OAAQ,OACRC,eAAgB9f,EAAKuB,KACrBwe,aAAe1hB,EAAGgR,KAClB2Q,eAdI1f,EAAO,GACX1B,EAAE0Y,KAAKjZ,EAAG4hB,WAAY,SAASC,EAAKxX,GACnCpI,GAAQ,IAAMiM,mBAAmB2T,GAAO,IAAM3T,mBAAmB7D,KAE3DpI,IAYR2P,gBAAiB,IACf/O,KAAK,SAASZ,GAChB,IAAIsD,EACAtD,EAAK6f,SACRvc,GACC9C,KACCvB,OAAQ,SAIViS,EAAGnM,OAAOrD,QAAQ,WACjB7B,KAAMqR,EACN1E,eAAW,EACXrC,SAAU9I,EACViC,KAAMA,IAGPjC,EAAId,KAAK,MAAOP,EAAK6f,SAASxS,OAAO7M,IAAI8C,EAAK9C,KAC1CR,EAAK8f,UACR1U,EAAQ/K,SAAS6Q,EAAGrQ,QAAQ,eAC5B9C,EAAGwN,OACFC,IAAKzN,EAAGoC,KAAKH,EAAK8f,SAClBpV,KAAM,UACNqV,QAAS,EACTpU,SAAU,WACqB,IAA9BP,EAAQrL,WAAWwC,QAAgB6I,EAAQ/K,SAAStC,EAAGoN,UAExDM,QACC/D,KAAM,eAKT1H,EAAKsL,OAASvN,EAAGuN,MAAMtL,EAAKsL,OAC5B4F,EAAG8O,eAAe,cAEjB9Q,KAAK,SAAS5D,GAChBA,GAASvN,EAAGuN,MAAMA,GAClB4F,EAAG8O,eAAe,aAChBC,OAAO,WACThgB,EAAK4B,aAGPyC,KAAO,aACP2F,WAAa,aACbI,KAAO,aAEP6V,YA7+Da,SAAS7e,GACtB,IA2BC8e,EA3BGC,EAAO9hB,EAAE+C,GACZhD,EAAMC,EAAEC,WAAW0hB,OAAO,WACzBG,EAAKtV,IAAI,OAAQxG,KAElB+b,EAAK,cACLC,EAAM,WACLH,EAAKtY,WAAW,WACf,IAAI1J,EACJ,IACCA,EAAMoG,KAAKqJ,cAAc9R,SAASgQ,KACjC,MAAMxP,GACP6B,EAAM,KAEHA,IAAQkiB,EACXhiB,EAAIiB,YACQihB,EAAM,EAClBD,IAEAjiB,EAAIkB,UAEH,MAEJ+E,EAAO,WACN6b,GAAMnX,aAAamX,GACnB9hB,EAAIiB,WAELihB,EAAM,GAKP,OAHAH,EAAK3T,IAAI,OAAQnI,GACjBjD,EAAIlD,IAAMkiB,EACVC,IACOjiB,GA+8DPqE,MAAQ,SAASwO,GACPpR,KAAK/B,GAAd,IACCyiB,EAAMliB,EAAE4S,GAAIlR,KAAK,OACE,YAAhBwgB,EAAIjS,SACPiS,EAAIjhB,YAMNoD,MACClD,GAAK,aACLmD,KAAO,WACPC,QAAU,yBACVoc,SAAW,aACXvO,KAAO,SAAShR,EAAMqF,GACrB,IAAIhH,EAAK+B,KACR4E,EAAOpG,EAAEC,WAiCV,OAhCAR,EAAGshB,SACFrf,MACCsf,IAAK,WACL1d,SAAU,aACV6e,KAAM/gB,EAAKuB,KACX0E,KAAMjG,EAAKghB,OAEZC,aAAa,EACbC,QAAU3X,KAAO,WAAYsX,IAAM,EAAGM,SAAU,KAC9CjgB,KAAK,SAASZ,GAChB,IAAI8gB,EACA9gB,EAAKkc,OAASlc,EAAKkc,MAAM3Z,SACxBvC,EAAKkc,MAAM,GAAGwE,QACbI,EAAO/iB,EAAG2B,KAAKM,EAAKkc,MAAM,GAAGwE,UAC1BI,EAAKC,OACVD,EAAKC,KAAO,EACZhjB,EAAGijB,QAASC,SAAWH,OAI1B/iB,EAAG0O,IAAI,eAAgB,WACtB1O,EAAGmW,KAAK,OAAQlU,EAAKkc,MAAM,GAAGjb,MAC9BlD,EAAG0O,IAAI,WAAY,WAClBzM,EAAKuL,OAASxN,EAAGwN,MAAMvL,EAAKuL,YAI/B7G,EAAKpF,YAEL4P,KAAK,SAAS5D,GACd5G,EAAKnF,OAAO+L,KAEN5G,IAGTrB,OAAS,mBACTiB,KAAO,aACP+F,KAAO,eAIP1H,MACClD,GAAK,WACLmD,KAAO,WACPse,kBAAmB,GAEpB5c,KAAO,SAASwM,GAEfhR,KAAK4B,QAAQ,WACZ7B,KAAMiR,EACNtE,eAAW,EACXrC,cAAU,EACV7G,UAEDwN,EAASqQ,mBAAqBrQ,EAASqQ,kBAAkB,EAAG,GAC5D7iB,EAAEwS,GAAUpP,QAAQ,SAAS2L,QAE9BhD,KAAO,eAIP1H,MACClD,GAAK,gBACLmD,KAAO,iBACPC,QAAU,8BACVoc,SAAW,gBACXC,YAAY,EACZC,aAAa,EACb3U,QAAQ,EACR4W,WAAW,EACXne,cAAc,EACdC,WACCC,MAAO,qBACPC,KAAM,+BAGRC,OAAS,KACTnD,KAAO,kDAEPI,MAAQ,SAASgD,EAAMvF,GACtB,IAAIsjB,EAAQ/d,EAAKQ,aAAawd,gBAAkBC,QAAQ,IAAIC,UAAS,GACjEH,EAAME,UACTzhB,KAAK6C,KAAK4e,QAA0B,QAAhBF,EAAME,SAE3BzhB,KAAKgT,IAAMnP,OAAOC,QACjBhE,IAAM,gDACN6hB,MACCC,SAAUC,QAASC,KAAO3jB,IAAI,MAAO4jB,MAASC,QAC9CC,OAAQC,OAAUC,KAAOhkB,IAAI,OAAQikB,OAAUC,OAAUC,OAAUC,MAAQpkB,IAAI,OAAQqkB,QAAWC,OAAUC,OAAUC,MAAQxkB,IAAI,QAClIykB,UAAWC,OAAUC,QAAWC,QAAWC,OAAUC,OAAUC,OAAUC,QAAWC,OAAUC,OAAUC,QACxGC,OAAQC,MAAQrlB,IAAI,OAAQslB,QAAWC,KAAOvlB,IAAI,OAAQwlB,OAAUC,OAAUC,QAAWC,OAAUb,OAASc,aAAa5lB,IAAI,OAAQ6lB,QACrIC,MAAOC,WAAeC,qBAAsBC,YAAeC,SAAYC,UAAaC,QAAWC,YAAcC,OAAUC,OAAUC,aAAgBC,aAAgBC,QAAWC,UAAaC,UAAaC,UAAaC,UAAaC,aAAcC,YAAeC,yBAA0BC,wBAAyBC,YAAeC,YAAeC,cAC9UxmB,OAAQymB,OAAUC,KAAOvnB,IAAI,MAAOwnB,OAAUC,OAAUC,OAAUC,OAAUC,OAAUC,OAAUC,OAAUC,MAAQ/nB,IAAI,OAAQgoB,QAAWC,SACzIC,OAAQC,SAAUC,SAAUC,OAAUC,OAAUC,KAAOvoB,IAAI,QAASwoB,OAAUC,OAAUC,OAAUC,UAAU3oB,IAAI,QAAS4oB,UAAU5oB,IAAI,QAASgkB,KAAOhkB,IAAI,OAAQ6oB,OAAUC,QAAWC,OAAUC,SAAW7jB,KAAK,wBAAwBnF,IAAI,OAAQipB,YAAc9jB,KAAK,wBAAwBnF,IAAI,OAAQkpB,KAAO/jB,KAAK,wBAAwBnF,IAAI,OAAQmpB,MAAQhkB,KAAK,wBAAwBnF,IAAI,OAAQopB,QAAUjkB,KAAK,wBAAwBnF,IAAI,OAAQqpB,MAAQlkB,KAAK,wBAAwBnF,IAAI,OAAQspB,gBAAgBnkB,KAAK,wBAAwBnF,IAAI,OAAQupB,eAAepkB,KAAK,wBAAwBnF,IAAI,OAAQwpB,KAAOrkB,KAAK,wBAAwBnF,IAAI,OAAQypB,KAAOtkB,KAAK,wBAAwBnF,IAAI,OAAQ0pB,MAAQvkB,KAAK,wBAAwBnF,IAAI,SAE7uB2pB,SACC7D,KAAM,OAEP3gB,KAAO,gLACPykB,WAAWvpB,EAAEwpB,GAAGC,MAAShqB,EAAGwF,GAAGykB,MAC7B3G,IAGJzI,QAAU,SAASrU,EAAMsU,EAAYnZ,GACpC,IAAIwL,EAAU3G,EAAKQ,OAAOhH,GAAGoN,QAC7B7M,EAAEiG,GAAMtF,OAAOiM,EAAQjM,UACvB4Z,EAAW7Z,MAAQ2H,KAAKC,IAAIiS,EAAW7Z,OAAS,EAAqB,GAAlBkM,EAAQlM,UAG5DqF,KAAO,SAAS5E,EAAIC,EAAMwN,EAAKnP,GAC9B,IAmVCkqB,EAAI9oB,EAnVD+R,EAAKpR,KACRgF,EAAUoM,EAAGnM,OAAOD,QACpBgO,EAAMhO,EAAQgO,IACd1H,EAAUrN,EAAGoN,MAAM,SACnB+c,KACAC,EAAWpqB,EAAGqqB,gBAAgB,kBAAmB1oB,EAAKghB,OACtD2H,EAAU/pB,EAAE,QAAQiE,OAAQ9D,SAAS3C,SAASgQ,KAAKrK,QAAQ,OAAQ,IAAM,GACzE6mB,EAAS,SAASC,EAAKC,GACtB,IAAIrhB,EACJ,OAAI2L,EAAI8U,QAAQW,GACRzV,EAAI8U,QAAQW,GAEhBzV,EAAI2O,KAAK8G,KAASphB,EAAI2L,EAAI2O,KAAK8G,GAAKC,KAC/BrhB,EAAElJ,KAAOuqB,GAAKnpB,cAEhBmpB,EAAInpB,eAEZ6T,EAAa,SAASqV,EAAK3nB,GAC1B,IAAIqI,EAAMwf,EAETA,OAD0B,IAAhB3jB,EAAQ4jB,IACR3qB,EAAGshB,SACZrf,MACCsf,IAAK,SACL1c,KAAM,gBACN2c,OAAQ,QAET5P,gBAAiB,IAGRrR,EAAEC,WAAWe,SAASopB,IAAK5jB,EAAQ4jB,MAE9CH,EAAMA,EAAIlpB,cACVopB,EAAQ7nB,KAAK,SAASZ,GACrB8E,EAAQ4jB,IAAM1oB,EAAK0oB,IACf5jB,EAAQ4jB,MACPH,EACHtf,EAAO,aAAesf,GAEtBtf,EAAO,GACPsf,EAAM,OAEFzjB,EAAQ6jB,cACZ7jB,EAAQ6jB,iBAEJ7jB,EAAQ6jB,YAAYJ,GAGlBjqB,EAAEC,WAAWe,QAAQwF,EAAQ6jB,YAAYJ,IAFzCjqB,EAAEsqB,QAAQ,8CAAgD3f,IAI7DrI,KAAK,SAASqN,GACjBnJ,EAAQ6jB,YAAYJ,GAAOta,EAC3B3P,EAAE0Y,KAAK/I,EAAG,SAASuN,EAAGqN,GACrBC,EAAKhW,EAAI+U,QAAS,WAAa,QAAQ,2BAA6BgB,EAAEE,UAAUhpB,SAAS,kBAAoB8oB,EAAE3f,QAAQxH,QAAQ,aAAcmnB,KAE9IjoB,GAAQA,UAKZkoB,EAAO,WACN,IAAIA,EAAOxqB,EAAE,UAAUS,GAAG,QAAS,SAAU,WAC3C,IAAIiqB,EAAI1qB,EAAEwB,MACTwD,EAAO0lB,EAAEhpB,KAAK,SAAW,KACzBuoB,EAAMS,EAAEnoB,QAAQ,2BAA2Bb,KAAK,SAChDwoB,EAAMQ,EAAEhpB,KAAK,SACM,IAAhB8E,EAAQ4jB,KACXA,GACCK,SAAUR,EACVU,QAAST,EACT5jB,QAAStB,MAGTvE,GAAG,SAAU,SAASzC,GACxB,IAAIqe,EAAIrc,EAAEhC,EAAE4M,QACX9H,EAAIuZ,EAAExZ,SACN6nB,EAAIrO,EAAE9Z,QAAQ,uCAAuCd,SAAS,gBAC9D8oB,EAAIG,EAAEhpB,KAAK,YACXkB,EAAuB,YAAnBE,EAAEpB,KAAK,QAAuB2a,EAAEjO,GAAG,YAAciO,EAAEvS,OACxD9L,EAAEsT,kBACE1O,KACoB,YAAnBE,EAAEpB,KAAK,UACVkB,EAAImG,SAASnG,IAEVE,EAAEpB,KAAK,aACA,IAAIsC,OAAOlB,EAAEpB,KAAK,YACnB2X,KAAKzW,KACboH,sBAAsB,WACrBvK,EAAGuN,MAAM,IAAMvN,EAAGmrB,OAAOhoB,GAAK,uBAAyBnD,EAAGmrB,OAAO9nB,EAAEpB,KAAK,YAAc,QAEvFkB,EAAI,QAIHA,EACH2nB,EAAElO,EAAExZ,SAASnB,KAAK,WAAakB,SAExB2nB,EAAEznB,EAAEpB,KAAK,WAEjBgpB,EAAEhpB,KAAK,OAAQ6oB,KAEhBM,EAAK7qB,EAAE,SAqCP8qB,EAAa,SAASP,GACrB,IAAI5L,EAAMnd,KACTkpB,EAAI1qB,EAAE,wEAAwES,GAAG,QAAS,WACzFqb,EAAEjR,WAEHiR,EAAI9b,EAAE,qDAAqD8B,OACxDyoB,EAAEjkB,SACLtG,EAAE0Y,KAAK6R,EAAEjkB,QAAS,SAASykB,EAAGnoB,GACvB,sBAANmoB,GAA6BjP,EAAEvR,OA5C1B,SAASygB,EAAGT,GACnB,IAICvlB,EAAMimB,EAAKtM,EAJR7C,EAAI9b,EAAE,QAAQ0B,KAAK,SAAUspB,GAAGtpB,KAAK,OAAQ6oB,EAAE5f,MAClDugB,EAAU,GACV9lB,EAAW,GACX+lB,GAAQ,EA8BT,OA5BIZ,EAAEa,aACLtP,EAAE7Z,KAAK,QAASxC,EAAGoC,KAAK0oB,EAAEa,cAEvBb,EAAEc,SACLvP,EAAEpa,KAAK,UAAW6oB,EAAEc,SAErBvP,EAAEvR,OAAOvK,EAAE,WAAWoJ,KAAK3J,EAAGoC,KAAKmpB,GAAK,QACzB,YAAXT,EAAE5f,OACD4f,EAAW,UAAMY,EAAe,2BAANH,IAAmCnB,MAChEqB,EAAU,WACNC,IACH/lB,EAAW,cAGZJ,GADAimB,EAAMzpB,KAAKC,SAAS,iBACTC,KAAK,aACXspB,IAAK,EACVC,EAAIvpB,KAAK,OAAQsD,IAElB8W,EAAEvR,OAAOvK,EAAE,sCAAsCkrB,EAAQ9lB,EAAS,QACxDmlB,EAAQ,MAClB5L,EAAM3e,EAAE,aAAauK,OAAOvK,EAAE,sBAAsBoJ,KAAK,cACzDpJ,EAAE0Y,KAAK6R,EAAQ,KAAG,SAASrN,EAAGta,GAC7B+b,EAAIpU,OAAOvK,EAAE,kBAAkB4C,EAAE,OAAOwG,KAAKxG,MAE9CkZ,EAAEvR,OAAOoU,IAET7C,EAAEvR,OAAOvK,EAAE,kCAEL8b,GAUuC3P,KAAKwS,EAAKoM,EAAGnoB,MAG3D+b,EAAIpU,OAAOmgB,EAAG5O,IAEfwP,GAAO,IAAIC,KACXrO,EAAI,EA+CL,OA7CK1W,EAAQpI,WACZoI,EAAQpI,SAAWiH,OAAOC,OAAO7F,EAAGC,UAAUD,EAAGtB,WAAYC,IAE9D4B,EAAE0Y,KAAKlE,EAAI2O,KAAM,SAAS9G,EAAGxT,GAC5B,IAAI2iB,EAAQnP,EAAEtb,cACbI,EAAK,+BAAiCqqB,EAAQF,EAC9C3gB,EAAO3K,EAAE,YAAcmB,EAAK,0DAA0DqqB,EAAM,OAAO9pB,KAAK,QAAS2a,GAElHrc,EAAE0Y,KAAK7P,EAAG,SAASmiB,EAAGT,GACrB,IAAIkB,EAAKT,EAAEjqB,cACVpB,EAAMqqB,EAAO3N,EAAG2O,GACZxkB,EAAQpI,SAASuB,KAEpB6G,EAAQpI,SAASuB,GADJ,UAAV6rB,GAA+B,UAAVA,GAA+B,UAAVA,EACrBA,EAAQ,MAAQC,EAEhB,4BAGtBhsB,EAAGqqB,gBAAgBtjB,EAAQpI,SAASuB,GAAMyB,EAAKghB,QAClDzX,EAAKJ,OAAOvK,EAAE,gEAAgEyrB,EAAG,OAAOhrB,GAAG,aAAc,SAASzC,EAAG0D,GACpH,IAAIid,EAAM3e,EAAEwB,MACPmd,EAAIld,SAAS,oCAAoCwC,QACrD6mB,EAAW3e,KAAKwS,EAAKjd,KAEpB6I,OAAOvK,EAAE,aAAaoJ,KAAK4hB,GAAGtpB,KAAK,OAAQspB,OAG5CrgB,EAAKlJ,WAAWwC,SACnB4mB,EAAGtgB,OAAOvK,EAAE,SAASuK,OAAOvK,EAAE,QAAQiC,KAAK,OAAQ8nB,EAAU,IAAM5oB,GAAIiI,KAAKiT,KAC5EmO,EAAKjgB,OAAOI,GACZif,EAAK4B,GAAStO,OAGZ1I,EAAI+U,QACPiB,EAAKkB,QAAQb,GAAIpB,MAChBkC,eAAgB,SAAS3tB,EAAG0d,GAC3B9G,EAAW8G,EAAGkQ,SAASlqB,KAAK,aAI9B1B,EAAE0Y,KAAKlE,EAAI2O,KAAM,SAAS9G,GACzB,IAAIwP,EAAKxP,EAAEtb,cACXypB,EAAKjgB,OAAOvK,EAAE,2CAA6C6rB,EAAK,OAAOthB,OAAOvK,EAAE,aAAaoJ,KAAKiT,IAAI9R,OAAOigB,EAAK/oB,SAAS,2BAA6BoqB,OAGnJrB,EA3ID,GA6IPsB,EAAS9rB,EAAEwB,MACT+I,OACAigB,EACChW,EAAI0O,SAAUljB,EAAEwU,EAAI1P,MAAQ,MAE/BnD,EAAO3B,EAAE,oEACP8B,OACAF,KAAK,uCAAyCnC,EAAGoC,KAAK,cAAgB,2CACtEE,SAAS+pB,EAAOjpB,UAClBkpB,EAAO/rB,EAAE,mDAAmD+B,SAASJ,GACrEqqB,EAAO,KAiBP5B,EAAM,SAASplB,GACdhF,EAAE4S,GAAIlR,KAAK,QAfPsqB,EACIhsB,EAAEC,WAAWe,QAAQgrB,IAE5BrqB,EAAKoN,OACEtP,EAAGwsB,eAAe7qB,EAAKuB,MAAQupB,YAAaH,IAAQzpB,KAAK,SAAShB,GACxE0qB,EAAO1qB,IACLsP,KAAK,SAAS5D,GAChBA,GAASvN,EAAGuN,MAAMA,GAClB4F,EAAG8O,eAAe,aAChBC,OAAO,WACThgB,EAAKG,WAKkBQ,KAAK,SAAShB,GACtCwqB,EAAOK,UACPC,GAAW/nB,KAAM,8BACjB5E,EAAGshB,SACFrf,MACCsf,IAAK,SACL1c,KAAM,gBACN2c,OAAQ,MACRoL,iBAAmBrnB,EAAKylB,SAAS1pB,cACjCurB,gBAAmBtnB,EAAK2lB,QAAQ5pB,cAChCwrB,gBAAmBlc,KAAKC,UAAUtL,EAAKsB,SACvCkmB,eAAmB/sB,EAAGyE,WAAW5C,GACjCmrB,iBAAmBhtB,EAAGitB,mBAAmBtrB,EAAKkD,MAAM,GAAK,IAAM0lB,EAAOhlB,EAAKylB,SAAUzlB,EAAK2lB,SAC1FgC,aAAmBvrB,EAAK5B,MAEzB6R,gBAAiB,IACf/O,KAAK,SAASZ,GAChBkrB,EAASlrB,EAAKmrB,OAAQ7nB,EAAKylB,SAAUzlB,EAAK2lB,WACxC/Z,KAAK,SAAS5D,GAChBA,GAASvN,EAAGuN,MAAMA,GAClB4F,EAAG8O,eAAe,iBAIrBkL,EAAW,SAASrgB,EAAK0d,EAAKC,GAC7B,IAAIhQ,EAAQrJ,KACRtE,GAAOA,EAAIpL,GAEM,YADpB+Y,EAAS3N,EAAI2N,QACF4S,MACVnrB,EAAKG,OACDyK,EAAIwgB,QAAUxgB,EAAIwgB,OAAO9oB,QAC5BjE,EAAE0Y,KAAKnM,EAAIwgB,OAAQ,SAAS7P,EAAGqN,GAC9BA,EAAEyC,SAAWnc,EAAIsM,KAAKoN,EAAEyC,WAG1BvtB,EAAGuN,MAAM6D,EAAI5M,OAAQ4M,EAAMqJ,EAAO7V,MAClCynB,EAAOmB,UACmB,cAAhB/S,EAAO4S,KACjBpP,EAAOnR,IAEP6f,EAAUlS,GACV3Q,WAAW,WACV2jB,EAAQ3gB,EAAIpL,KACV,OAGJ2L,EAAQ/K,SAAS6Q,EAAGrQ,QAAQ,eACxBgK,EAAIygB,SACPvtB,EAAGwN,OACFC,IAAKzN,EAAGoC,KAAK0K,EAAIygB,SACjB5gB,KAAM,QACNqV,QAAS,IACTpU,SAAU,WACqB,IAA9BP,EAAQrL,WAAWwC,QAAgB6I,EAAQ/K,SAAStC,EAAGoN,YAI1DpN,EAAGwN,OACFC,IAAKzN,EAAGoC,KAAK,mBACbuK,KAAM,QACNqV,QAAS,IACTpU,SAAU,WACqB,IAA9BP,EAAQrL,WAAWwC,QAAgB6I,EAAQ/K,SAAStC,EAAGoN,YAGzDlL,EAAKG,OACLgqB,EAAO/c,SAGTqd,EAAY,SAASlS,GACpBvY,EAAKoN,OAAOtN,SAAS,0BAA0B2H,KAAK8Q,EAAO7V,OAE5D6oB,EAAU,SAASC,GAClB1tB,EAAGshB,SACFrf,MACCsf,IAAK,SACL1c,KAAM,gBACN2c,OAAQ,MACRmM,cAAeD,GAEhB9b,gBAAiB,IACf/O,KAAK,SAASZ,GAChBkrB,EAASlrB,EAAKmrB,UACZjc,KAAK,SAAS5D,GAChBA,GAASvN,EAAGuN,MAAMA,GAClB4F,EAAG8O,eAAe,cAGpBhE,EAAS,SAASnR,GACjB,IAAImF,EAASnF,EAAImF,OAEhBpQ,GADKiL,EAAIpL,GACH,IACPQ,EAAKG,OACD4P,GAAUA,EAAOzN,SACpB2O,EAAG8O,eAAe,WAClB1hB,EAAE0Y,KAAKhH,EAAQ,SAASwL,EAAGqN,GACtBA,EAAE8C,MACL/rB,GAAOipB,EAAE8C,IAAM,QAGjB5tB,EAAGie,QACF9S,OAAQxJ,EAAKghB,MACb7R,OAAQjP,GACRqJ,KAAM,OACN2iB,WACCC,cAAe,iBAAmBhhB,EAAIpL,QAK1CiL,EAAO,WAER0f,EAAOjpB,SAASX,KAAKkP,SAAU,SAAS1E,SAAS,6BAC7C7L,EAAIO,EAAK5B,KAAK9B,MAAM,2BACvB0O,EAAOvL,EAAE,IAEN2T,EAAI+U,QACHK,EAAKxd,IACRoe,EAAKf,KAAK,SAAU,SAAUG,EAAKxd,KAGpCud,EAAKtkB,OAAOmoB,KAAKhZ,EAAI2O,MAAMlf,OAC3BjE,EAAE0Y,KAAKlE,EAAI2O,KAAM,SAAS9G,GACzB,GAAIA,EAAEtb,gBAAkBqL,EAMvB,OALAwI,EAAWyH,EAAG,WACbrc,EAAE0Y,KAAKlE,EAAI2O,KAAM,SAASsK,GACzBA,EAAG1sB,gBAAkBqL,GAAQwI,EAAW6Y,QAGnC,EAER9D,MAEIA,GACJ3pB,EAAE0Y,KAAKlE,EAAI2O,KAAM,SAAS9G,GACzBzH,EAAWyH,KAGbyP,EAAOjpB,SAAS6qB,UAAUlD,EAAK/oB,SAAS,2BAA6B2K,GAAMuhB,SAAS3f,OAGtFhI,KAAO,aACP2F,WAAa,aACbI,KAAO,aAEP3H,MAAQ,SAASwO,GACPpR,KAAK/B,GAAd,IACC2G,EAAOpG,EAAE4S,GAAIlR,KAAK,QACf0E,GAAyB,YAAjBA,EAAK6J,SAChB7J,EAAKnF","file":"../../extras/editors.default.js","sourcesContent":["define([\n\t\"../elFinder\"\n],function(elFinder) {\n\t\"use strict\";\n\tvar apps = {},\n\t\t// get query of getfile\n\t\tgetfile = window.location.search.match(/getfile=([a-z]+)/),\n\t\tuseRequire = elFinder.prototype.hasRequire,\n\t\thasFlash = (function() {\n\t\t\tvar hasFlash;\n\t\t\ttry {\n\t\t\t\thasFlash = !!(new ActiveXObject('ShockwaveFlash.ShockwaveFlash'));\n\t\t\t} catch (e) {\n\t\t\t\thasFlash = !!(typeof window.orientation === 'undefined' || (navigator && navigator.mimeTypes[\"application/x-shockwave-flash\"]));\n\t\t\t}\n\t\t\treturn hasFlash;\n\t\t})(),\n\t\text2mime = {\n\t\t\tbmp: 'image/x-ms-bmp',\n\t\t\tdng: 'image/x-adobe-dng',\n\t\t\tgif: 'image/gif',\n\t\t\tjpeg: 'image/jpeg',\n\t\t\tjpg: 'image/jpeg',\n\t\t\tpdf: 'application/pdf',\n\t\t\tpng: 'image/png',\n\t\t\tppm: 'image/x-portable-pixmap',\n\t\t\tpsd: 'image/vnd.adobe.photoshop',\n\t\t\tpxd: 'image/x-pixlr-data',\n\t\t\tsvg: 'image/svg+xml',\n\t\t\ttiff: 'image/tiff',\n\t\t\twebp: 'image/webp',\n\t\t\txcf: 'image/x-xcf',\n\t\t\tsketch: 'application/x-sketch',\n\t\t\tico: 'image/x-icon',\n\t\t\tdds: 'image/vnd-ms.dds',\n\t\t\temf: 'application/x-msmetafile'\n\t\t},\n\t\tmime2ext,\n\t\tgetExtention = function(mime, fm, jpeg) {\n\t\t\tif (!mime2ext) {\n\t\t\t\tmime2ext = fm.arrayFlip(ext2mime);\n\t\t\t}\n\t\t\tvar ext = mime2ext[mime] || fm.mimeTypes[mime];\n\t\t\tif (!jpeg) {\n\t\t\t\tif (ext === 'jpeg') {\n\t\t\t\t\text = 'jpg';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (ext === 'jpg') {\n\t\t\t\t\text = 'jpeg';\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ext;\n\t\t},\n\t\tchangeImageType = function(src, toMime) {\n\t\t\tvar dfd = $.Deferred();\n\t\t\ttry {\n\t\t\t\tvar canvas = document.createElement('canvas'),\n\t\t\t\t\tctx = canvas.getContext('2d'),\n\t\t\t\t\timg = new Image(),\n\t\t\t\t\tconv = function() {\n\t\t\t\t\t\tvar url = canvas.toDataURL(toMime),\n\t\t\t\t\t\t\tmime, m;\n\t\t\t\t\t\tif (m = url.match(/^data:([a-z0-9]+\\/[a-z0-9.+-]+)/i)) {\n\t\t\t\t\t\t\tmime = m[1];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmime = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (mime.toLowerCase() === toMime.toLowerCase()) {\n\t\t\t\t\t\t\tdfd.resolve(canvas.toDataURL(toMime), canvas);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\timg.src = src;\n\t\t\t\t$(img).on('load', function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcanvas.width = img.width;\n\t\t\t\t\t\tcanvas.height = img.height;\n\t\t\t\t\t\tctx.drawImage(img, 0, 0);\n\t\t\t\t\t\tconv();\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t}\n\t\t\t\t}).on('error', function () {\n\t\t\t\t\tdfd.reject();\n\t\t\t\t});\n\t\t\t\treturn dfd;\n\t\t\t} catch(e) {\n\t\t\t\treturn dfd.reject();\n\t\t\t}\n\t\t},\n\t\tinitImgTag = function(id, file, content, fm) {\n\t\t\tvar node = $(this).children('img:first').data('ext', getExtention(file.mime, fm)),\n\t\t\t\tspnr = $('<div class=\"elfinder-edit-spinner elfinder-edit-image\"/>')\n\t\t\t\t\t.html('<span class=\"elfinder-spinner-text\">' + fm.i18n('ntfloadimg') + '</span><span class=\"elfinder-spinner\"/>')\n\t\t\t\t\t.hide()\n\t\t\t\t\t.appendTo(this),\n\t\t\t\tsetup = function() {\n\t\t\t\t\tnode.attr('id', id+'-img')\n\t\t\t\t\t\t.attr('src', url || content)\n\t\t\t\t\t\t.css({'height':'', 'max-width':'100%', 'max-height':'100%', 'cursor':'pointer'})\n\t\t\t\t\t\t.data('loading', function(done) {\n\t\t\t\t\t\t\tvar btns = node.closest('.elfinder-dialog').find('button,.elfinder-titlebar-button');\n\t\t\t\t\t\t\tbtns.prop('disabled', !done)[done? 'removeClass' : 'addClass']('ui-state-disabled');\n\t\t\t\t\t\t\tnode.css('opacity', done? '' : '0.3');\n\t\t\t\t\t\t\tspnr[done? 'hide' : 'show']();\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\turl;\n\t\t\t\n\t\t\tif (!content.match(/^data:/)) {\n\t\t\t\tfm.openUrl(file.hash, false, function(v) {\n\t\t\t\t\turl = v;\n\t\t\t\t\tnode.attr('_src', content);\n\t\t\t\t\tsetup();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsetup();\n\t\t\t}\n\t\t},\n\t\timgBase64 = function(node, mime) {\n\t\t\tvar style = node.attr('style'),\n\t\t\t\timg, canvas, ctx, data;\n\t\t\ttry {\n\t\t\t\t// reset css for getting image size\n\t\t\t\tnode.attr('style', '');\n\t\t\t\t// img node\n\t\t\t\timg = node.get(0);\n\t\t\t\t// New Canvas\n\t\t\t\tcanvas = document.createElement('canvas');\n\t\t\t\tcanvas.width  = img.width;\n\t\t\t\tcanvas.height = img.height;\n\t\t\t\t// restore css\n\t\t\t\tnode.attr('style', style);\n\t\t\t\t// Draw Image\n\t\t\t\tcanvas.getContext('2d').drawImage(img, 0, 0);\n\t\t\t\t// To Base64\n\t\t\t\tdata = canvas.toDataURL(mime);\n\t\t\t} catch(e) {\n\t\t\t\tdata = node.attr('src');\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\t\tpixlrCallBack = function() {\n\t\t\tif (!hasFlash || window.parent === window) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pixlr = window.location.search.match(/[?&]pixlr=([^&]+)/),\n\t\t\t\timage = window.location.search.match(/[?&]image=([^&]+)/),\n\t\t\t\tp, ifm, url, node, ext;\n\t\t\tif (pixlr) {\n\t\t\t\t// case of redirected from pixlr.com\n\t\t\t\tp = window.parent;\n\t\t\t\tifm = p.$('#'+pixlr[1]+'iframe').hide();\n\t\t\t\tnode = p.$('#'+pixlr[1]).data('resizeoff')();\n\t\t\t\tif (image[1].substr(0, 4) === 'http') {\n\t\t\t\t\turl = image[1];\n\t\t\t\t\text = url.replace(/.+\\.([^.]+)$/, '$1');\n\t\t\t\t\tif (node.data('ext') !== ext) {\n\t\t\t\t\t\tnode.closest('.ui-dialog').trigger('changeType', {\n\t\t\t\t\t\t\textention: ext,\n\t\t\t\t\t\t\tmime : ext2mime[ext]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (window.location.protocol === 'https:') {\n\t\t\t\t\t\turl = url.replace(/^http:/, 'https:');\n\t\t\t\t\t}\n\t\t\t\t\tnode.on('load error', function() {\n\t\t\t\t\t\t\tnode.data('loading')(true);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('src', url)\n\t\t\t\t\t\t.data('loading')();\n\t\t\t\t} else {\n\t\t\t\t\tnode.data('loading')(true);\n\t\t\t\t}\n\t\t\t\tifm.trigger('destroy').remove();\n\t\t\t}\n\t\t},\n\t\tpixlrSetup = function(opts, fm) {\n\t\t\tif (!hasFlash || fm.UA.ltIE8) {\n\t\t\t\tthis.disabled = true;\n\t\t\t}\n\t\t},\n\t\tpixlrLoad = function(mode, base) {\n\t\t\tif (navigator && !navigator.mimeTypes[\"application/x-shockwave-flash\"]) {\n\t\t\t\tvar src = 'data:application/x-shockwave-flash;base64,Q1dTCJUCAAB42kxSTW/TQBB9Xjv1hkLamoIvEeJaQBUHjvQjVEUKImnkIK7BjTapi5u1dlfQ/gJ6KjdLCHHl9/CPyszaRexhdt/sm3kzs3uJ+A+QVsCTAEfillZ3DbQmAZmD3jZZOk1ms0k+/5wvld0d5cUKt71QMOv6Nx7De2bLUp/mJZbKfVTGFnoFq9zbMrdnd3jBAOrSKbMi5nF7GK5oX+RzhXlelqiMdtpdVQoXnHd6ZZ26oKsqPy3KwhXK4kub8ClsRS7s4gXONZGPjdEGyhhgMJ0qNzG6ohKWFrWARD9Jfgm8CxgEfe+6kdxtuINXqLuIGUSBFNm3ACKt1xEJGcbcqox8QGfMds3bOEuJhpM6QgQpxwSCtAHdmy0eXLQDYb8uMq0dNlHHjYDEIVHD1AeS2L8afuK7ROcTXjJmhXtec92r3R/f1SQfxPw6VFovqzvwoL1MIDc8lpv/cSh6q+1IkGv/hyAJ9iacP8Lz9zVdDmk2iXc/HL3mbZuJMXwQnp3UG42UiII4ZIlHeykOwjd0vO4TY/RhMD2ajQbDMdxZYZtv4d/QT5pHlbaTj5tMUvj+wizFIcG/AAAA//8DAFw0fxk=';\n\t\t\t\t$(base).empty().append('<object data=\"'+src+'\" type=\"application/x-shockwave-flash\" style=\"width:100%;height:100%\"><param name=\"movie\" value=\"'+src+'\"></object>');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar self = this,\n\t\t\t\tfm = this.fm,\n\t\t\t\tclPreventBack = fm.res('class', 'preventback'),\n\t\t\t\tnode = $(base).children('img:first')\n\t\t\t\t\t.data('loading')()\n\t\t\t\t\t.data('resizeoff', function() {\n\t\t\t\t\t\t$(window).off('resize.'+node.attr('id'));\n\t\t\t\t\t\tdialog.addClass(clPreventBack);\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t})\n\t\t\t\t\t.on('click', function() {\n\t\t\t\t\t\tlaunch();\n\t\t\t\t\t}),\n\t\t\t\tdialog = $(base).closest('.ui-dialog'),\n\t\t\t\telfNode = fm.getUI(),\n\t\t\t\tuiToast = fm.getUI('toast'),\n\t\t\t\tcontainer = $('<iframe class=\"ui-front\" allowtransparency=\"true\">'),\n\t\t\t\tfile = this.file,\n\t\t\t\ttimeout = 15,\n\t\t\t\terror = function(error) {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tcontainer.trigger('destroy').remove();\n\t\t\t\t\t\tnode.data('loading')(true);\n\t\t\t\t\t\tfm.error(error);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuiToast.appendTo(dialog.closest('.ui-dialog'));\n\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\tmode: 'info',\n\t\t\t\t\t\t\tmsg: 'Can not launch Pixlr yet. Waiting ' + timeout + ' seconds.',\n\t\t\t\t\t\t\tbutton: {\n\t\t\t\t\t\t\t\ttext: 'Abort',\n\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\tcontainer.trigger('destroy').remove();\n\t\t\t\t\t\t\t\t\tnode.data('loading')(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonHidden: function() {\n\t\t\t\t\t\t\t\tuiToast.children().length === 1 && uiToast.appendTo(fm.getUI());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\terrtm = setTimeout(error, timeout * 1000);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tlaunch = function() {\n\t\t\t\t\tvar src = 'https://pixlr.com/'+mode+'/?s=c',\n\t\t\t\t\t\tmyurl = window.location.href.toString().replace(/#.*$/, ''),\n\t\t\t\t\t\topts = {};\n\n\t\t\t\t\terrtm = setTimeout(error, timeout * 1000);\n\t\t\t\t\tmyurl += (myurl.indexOf('?') === -1? '?' : '&') + 'pixlr='+node.attr('id');\n\t\t\t\t\tsrc += '&referrer=elFinder&locktitle=true';\n\t\t\t\t\tsrc += '&exit='+encodeURIComponent(myurl+'&image=0');\n\t\t\t\t\tsrc += '&target='+encodeURIComponent(myurl);\n\t\t\t\t\tsrc += '&title='+encodeURIComponent(file.name);\n\t\t\t\t\tsrc += '&image='+encodeURIComponent(node.attr('_src'));\n\t\t\t\t\t\n\t\t\t\t\topts.src = src;\n\t\t\t\t\topts.css = {\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: $(window).height()+'px',\n\t\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\tborder: 'none',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tright: 0\n\t\t\t\t\t};\n\n\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\tnode: base,\n\t\t\t\t\t\teditorObj: void(0),\n\t\t\t\t\t\tinstance: container,\n\t\t\t\t\t\topts: opts\n\t\t\t\t\t});\n\n\t\t\t\t\tcontainer\n\t\t\t\t\t\t.attr('id', node.attr('id')+'iframe')\n\t\t\t\t\t\t.attr('src', opts.src)\n\t\t\t\t\t\t.css(opts.css)\n\t\t\t\t\t\t.one('load', function() {\n\t\t\t\t\t\t\terrtm && clearTimeout(errtm);\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tif (container.is(':hidden')) {\n\t\t\t\t\t\t\t\t\terror('Please disable your ad blocker.');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\tdialog.addClass(clPreventBack);\n\t\t\t\t\t\t\tfm.toggleMaximize(container, true);\n\t\t\t\t\t\t\tfm.toFront(container);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('destroy', function() {\n\t\t\t\t\t\t\tfm.toggleMaximize(container, false);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('error', error)\n\t\t\t\t\t\t.appendTo(elfNode.hasClass('elfinder-fullscreen')? elfNode : 'body');\n\t\t\t\t},\n\t\t\t\terrtm;\n\t\t\t$(base).on('saveAsFail', launch);\n\t\t\tlaunch();\n\t\t},\n\t\tiframeClose = function(ifm) {\n\t\t\tvar $ifm = $(ifm),\n\t\t\t\tdfd = $.Deferred().always(function() {\n\t\t\t\t\t$ifm.off('load', load);\n\t\t\t\t}),\n\t\t\t\tab = 'about:blank',\n\t\t\t\tchk = function() {\n\t\t\t\t\ttm = setTimeout(function() {\n\t\t\t\t\t\tvar src;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tsrc = base.contentWindow.location.href;\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tsrc = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (src === ab) {\n\t\t\t\t\t\t\tdfd.resolve();\n\t\t\t\t\t\t} else if (--cnt > 0){\n\t\t\t\t\t\t\tchk();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfd.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 500);\n\t\t\t\t},\n\t\t\t\tload = function() {\n\t\t\t\t\ttm && clearTimeout(tm);\n\t\t\t\t\tdfd.resolve();\n\t\t\t\t},\n\t\t\t\tcnt = 20, // 500ms * 20 = 10sec wait\n\t\t\t\ttm;\n\t\t\t$ifm.one('load', load);\n\t\t\tifm.src = ab;\n\t\t\tchk();\n\t\t\treturn dfd;\n\t\t};\n\t\n\t// check callback from pixlr\n\tpixlrCallBack();\n\t\n\t// check getfile callback function\n\tif (getfile) {\n\t\tgetfile = getfile[1];\n\t\tif (getfile === 'ckeditor') {\n\t\t\telFinder.prototype._options.getFileCallback = function(file, fm) {\n\t\t\t\twindow.opener.CKEDITOR.tools.callFunction((function() {\n\t\t\t\t\tvar reParam = new RegExp('(?:[\\?&]|&amp;)CKEditorFuncNum=([^&]+)', 'i'),\n\t\t\t\t\t\tmatch = window.location.search.match(reParam);\n\t\t\t\t\treturn (match && match.length > 1) ? match[1] : '';\n\t\t\t\t})(), fm.convAbsUrl(file.url));\n\t\t\t\tfm.destroy();\n\t\t\t\twindow.close();\n\t\t\t};\n\t\t}\n\t}\n\t\n\t// return editors Array\n\treturn [\n\t\t{\n\t\t\t// tui.image-editor - https://github.com/nhnent/tui.image-editor\n\t\t\tinfo : {\n\t\t\t\tid: 'tuiimgedit',\n\t\t\t\tname: 'TUI Image Editor',\n\t\t\t\ticonImg: 'img/editor-icons.png 0 -48',\n\t\t\t\tdataScheme: true,\n\t\t\t\tschemeContent: true,\n\t\t\t\topenMaximized: true,\n\t\t\t\tcanMakeEmpty: false,\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'TOAST UI Image Editor',\n\t\t\t\t\tlink: 'http://ui.toast.com/tui-image-editor/'\n\t\t\t\t}\n\t\t\t},\n\t\t\t// MIME types to accept\n\t\t\tmimes : ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml', 'image/x-ms-bmp'],\n\t\t\t// HTML of this editor\n\t\t\thtml : '<div class=\"elfinder-edit-imageeditor\"><canvas></canvas></div>',\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.ltIE8 || fm.UA.Mobile) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.opts = Object.assign({\n\t\t\t\t\t\tversion: 'v3.9.0'\n\t\t\t\t\t}, opts.extraOptions.tuiImgEditOpts || {}, {\n\t\t\t\t\t\ticonsPath : fm.baseUrl + 'img/tui-',\n\t\t\t\t\t\ttheme : {}\n\t\t\t\t\t});\n\t\t\t\t\tif (!fm.isSameOrigin(this.opts.iconsPath)) {\n\t\t\t\t\t\tthis.disabled = true;\n\t\t\t\t\t\tfm.debug('warning', 'Setting `commandOptions.edit.extraOptions.tuiImgEditOpts.iconsPath` MUST follow the same origin policy.');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, content, fm) {\n\t\t\t\tthis.data('url', content);\n\t\t\t},\n\t\t\tload : function(base) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tcdns = fm.options.cdns,\n\t\t\t\t\tver  = self.confObj.opts.version,\n\t\t\t\t\tinit = function(editor) {\n\t\t\t\t\t\tvar $base = $(base),\n\t\t\t\t\t\t\tbParent = $base.parent(),\n\t\t\t\t\t\t\topts = self.confObj.opts,\n\t\t\t\t\t\t\ticonsPath = opts.iconsPath,\n\t\t\t\t\t\t\ttmpContainer = $('<div class=\"tui-image-editor-container\">').appendTo(bParent),\n\t\t\t\t\t\t\ttmpDiv = [\n\t\t\t\t\t\t\t\t$('<div class=\"tui-image-editor-submenu\"/>').appendTo(tmpContainer),\n\t\t\t\t\t\t\t\t$('<div class=\"tui-image-editor-controls\"/>').appendTo(tmpContainer)\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tiEditor = new editor(base, {\n\t\t\t\t\t\t\t\tincludeUI: {\n\t\t\t\t\t\t\t\t\tloadImage: {\n\t\t\t\t\t\t\t\t\t\tpath: $base.data('url'),\n\t\t\t\t\t\t\t\t\t\tname: self.file.name\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttheme: Object.assign(opts.theme, {\n\t\t\t\t\t\t\t\t\t\t'menu.normalIcon.path': iconsPath + 'icon-d.svg',\n\t\t\t\t\t\t\t\t\t\t'menu.normalIcon.name': 'icon-d',\n\t\t\t\t\t\t\t\t\t\t'menu.activeIcon.path': iconsPath + 'icon-b.svg',\n\t\t\t\t\t\t\t\t\t\t'menu.activeIcon.name': 'icon-b',\n\t\t\t\t\t\t\t\t\t\t'menu.disabledIcon.path': iconsPath + 'icon-a.svg',\n\t\t\t\t\t\t\t\t\t\t'menu.disabledIcon.name': 'icon-a',\n\t\t\t\t\t\t\t\t\t\t'menu.hoverIcon.path': iconsPath + 'icon-c.svg',\n\t\t\t\t\t\t\t\t\t\t'menu.hoverIcon.name': 'icon-c',\n\t\t\t\t\t\t\t\t\t\t'submenu.normalIcon.path': iconsPath + 'icon-d.svg',\n\t\t\t\t\t\t\t\t\t\t'submenu.normalIcon.name': 'icon-d',\n\t\t\t\t\t\t\t\t\t\t'submenu.activeIcon.path': iconsPath + 'icon-c.svg',\n\t\t\t\t\t\t\t\t\t\t'submenu.activeIcon.name': 'icon-c'\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tinitMenu: 'filter',\n\t\t\t\t\t\t\t\t\tmenuBarPosition: 'bottom'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcssMaxWidth: Math.max(300, bParent.width()),\n\t\t\t\t\t\t\t\tcssMaxHeight: Math.max(200, bParent.height() - (tmpDiv[0].height() + tmpDiv[1].height() + 3 /*margin*/)),\n\t\t\t\t\t\t\t\tusageStatistics: false\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tcanvas = $base.find('canvas:first').get(0),\n\t\t\t\t\t\t\tzoom = function(v) {\n\t\t\t\t\t\t\t\tif (typeof v !== 'undefined') {\n\t\t\t\t\t\t\t\t\tvar c = $(canvas),\n\t\t\t\t\t\t\t\t\t\tw = parseInt(c.attr('width')),\n\t\t\t\t\t\t\t\t\t\th = parseInt(c.attr('height')),\n\t\t\t\t\t\t\t\t\t\ta = w / h,\n\t\t\t\t\t\t\t\t\t\tmw, mh;\n\t\t\t\t\t\t\t\t\tif (v === 0) {\n\t\t\t\t\t\t\t\t\t\tmw = w;\n\t\t\t\t\t\t\t\t\t\tmh = h;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tmw = parseInt(c.css('max-width')) + Number(v);\n\t\t\t\t\t\t\t\t\t\tmh = mw / a;\n\t\t\t\t\t\t\t\t\t\tif (mw > w && mh > h) {\n\t\t\t\t\t\t\t\t\t\t\tmw = w;\n\t\t\t\t\t\t\t\t\t\t\tmh = h;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tper.text(Math.round(mw / w * 100) + '%');\n\t\t\t\t\t\t\t\t\tiEditor.resizeCanvasDimension({width: mw, height: mh});\n\t\t\t\t\t\t\t\t\t// continually change more\n\t\t\t\t\t\t\t\t\tif (zoomMore) {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\tzoomMore && zoom(v);\n\t\t\t\t\t\t\t\t\t\t}, 50);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tzup = $('<span class=\"ui-icon ui-icon-plusthick\"/>').data('val', 10),\n\t\t\t\t\t\t\tzdown = $('<span class=\"ui-icon ui-icon-minusthick\"/>').data('val', -10),\n\t\t\t\t\t\t\tper = $('<button/>').css('width', '4em').text('%').attr('title', '100%').data('val', 0),\n\t\t\t\t\t\t\tquty, qutyTm, zoomTm, zoomMore;\n\n\t\t\t\t\t\ttmpContainer.remove();\n\t\t\t\t\t\t$base.removeData('url').data('mime', self.file.mime);\n\t\t\t\t\t\t// jpeg quality controls\n\t\t\t\t\t\tif (self.file.mime === 'image/jpeg') {\n\t\t\t\t\t\t\t$base.data('quality', fm.storage('jpgQuality') || fm.option('jpgQuality'));\n\t\t\t\t\t\t\tquty = $('<input type=\"number\" class=\"ui-corner-all elfinder-resize-quality elfinder-tabstop\"/>')\n\t\t\t\t\t\t\t\t.attr('min', '1')\n\t\t\t\t\t\t\t\t.attr('max', '100')\n\t\t\t\t\t\t\t\t.attr('title', '1 - 100')\n\t\t\t\t\t\t\t\t.on('change', function() {\n\t\t\t\t\t\t\t\t\tvar q = quty.val();\n\t\t\t\t\t\t\t\t\t$base.data('quality', q);\n\t\t\t\t\t\t\t\t\tqutyTm && cancelAnimationFrame(qutyTm);\n\t\t\t\t\t\t\t\t\tqutyTm = requestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t\t\tcanvas.toBlob(function(blob) {\n\t\t\t\t\t\t\t\t\t\t\tblob && quty.next('span').text(' (' + fm.formatSize(blob.size) + ')');\n\t\t\t\t\t\t\t\t\t\t}, 'image/jpeg', Math.max(Math.min(q, 100), 1) / 100);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.val($base.data('quality'));\n\t\t\t\t\t\t\t$('<div class=\"ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality\"/>')\n\t\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t\t$('<span>').html(fm.i18n('quality') + ' : '), quty, $('<span/>')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.prependTo($base.parent().next());\n\t\t\t\t\t\t} else if (self.file.mime === 'image/svg+xml') {\n\t\t\t\t\t\t\t$base.closest('.ui-dialog').trigger('changeType', {\n\t\t\t\t\t\t\t\textention: 'png',\n\t\t\t\t\t\t\t\tmime : 'image/png',\n\t\t\t\t\t\t\t\tkeepEditor: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// zoom scale controls\n\t\t\t\t\t\t$('<div class=\"ui-dialog-buttonset elfinder-edit-extras\"/>')\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\tzdown, per, zup\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('title', fm.i18n('scale'))\n\t\t\t\t\t\t\t.on('click', 'span,button', function() {\n\t\t\t\t\t\t\t\tzoom($(this).data('val'));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.on('mousedown mouseup mouseleave', 'span', function(e) {\n\t\t\t\t\t\t\t\tzoomMore = false;\n\t\t\t\t\t\t\t\tzoomTm && clearTimeout(zoomTm);\n\t\t\t\t\t\t\t\tif (e.type === 'mousedown') {\n\t\t\t\t\t\t\t\t\tzoomTm = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tzoomMore = true;\n\t\t\t\t\t\t\t\t\t\tzoom($(e.target).data('val'));\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.prependTo($base.parent().next());\n\n\t\t\t\t\t\t// wait canvas ready\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tdfrd.resolve(iEditor);\n\t\t\t\t\t\t\tif (quty) {\n\t\t\t\t\t\t\t\tquty.trigger('change');\n\t\t\t\t\t\t\t\tiEditor.on('redoStackChanged undoStackChanged', function() {\n\t\t\t\t\t\t\t\t\tquty.trigger('change');\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// show initial scale\n\t\t\t\t\t\t\tzoom(null);\n\t\t\t\t\t\t}, 100);\n\n\t\t\t\t\t\t// show color slider (maybe TUI-Image-Editor's bug)\n\t\t\t\t\t\t// see https://github.com/nhn/tui.image-editor/issues/153\n\t\t\t\t\t\t$base.find('.tui-colorpicker-palette-container').on('click', '.tui-colorpicker-palette-preview', function() {\n\t\t\t\t\t\t\t$(this).closest('.color-picker-control').height('auto').find('.tui-colorpicker-slider-container').toggle();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$base.on('click', function() {\n\t\t\t\t\t\t\t$base.find('.tui-colorpicker-slider-container').hide();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tloader;\n\n\t\t\t\tif (!self.confObj.editor) {\n\t\t\t\t\tloader = $.Deferred();\n\t\t\t\t\tfm.loadCss([\n\t\t\t\t\t\tcdns.tui + '/tui-color-picker/latest/tui-color-picker.css',\n\t\t\t\t\t\tcdns.tui + '/tui-image-editor/'+ver+'/tui-image-editor.css'\n\t\t\t\t\t]);\n\t\t\t\t\tif (fm.hasRequire) {\n\t\t\t\t\t\trequire.config({\n\t\t\t\t\t\t\tpaths : {\n\t\t\t\t\t\t\t\t'fabric/dist/fabric.require' : cdns.fabric + '/fabric.require.min', // for fabric < 2.0.1\n\t\t\t\t\t\t\t\t'fabric' : cdns.fabric + '/fabric.min', // for fabric >= 2.0.1\n\t\t\t\t\t\t\t\t'tui-code-snippet' : cdns.tui + '/tui.code-snippet/latest/tui-code-snippet.min',\n\t\t\t\t\t\t\t\t'tui-color-picker' : cdns.tui + '/tui-color-picker/latest/tui-color-picker.min',\n\t\t\t\t\t\t\t\t'tui-image-editor' : cdns.tui + '/tui-image-editor/'+ver+'/tui-image-editor.min'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\trequire(['tui-image-editor'], function(ImageEditor) {\n\t\t\t\t\t\t\tloader.resolve(ImageEditor);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfm.loadScript([\n\t\t\t\t\t\t\tcdns.fabric + '/fabric.min.js',\n\t\t\t\t\t\t\tcdns.tui + '/tui.code-snippet/latest/tui-code-snippet.min.js'\n\t\t\t\t\t\t], function() {\n\t\t\t\t\t\t\tfm.loadScript([\n\t\t\t\t\t\t\t\tcdns.tui + '/tui-color-picker/latest/tui-color-picker.min.js'\n\t\t\t\t\t\t\t], function() {\n\t\t\t\t\t\t\t\tfm.loadScript([\n\t\t\t\t\t\t\t\t\tcdns.tui + '/tui-image-editor/'+ver+'/tui-image-editor.min.js'\n\t\t\t\t\t\t\t\t], function() {\n\t\t\t\t\t\t\t\t\tloader.resolve(window.tui.ImageEditor);\n\t\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\t\tloadType: 'tag'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tloadType: 'tag'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tloadType: 'tag'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tloader.done(function(editor) {\n\t\t\t\t\t\tself.confObj.editor = editor;\n\t\t\t\t\t\tinit(editor);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tinit(self.confObj.editor);\n\t\t\t\t}\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tgetContent : function(base) {\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tfm = editor.fm,\n\t\t\t\t\t$base = $(base),\n\t\t\t\t\tquality = $base.data('quality');\n\t\t\t\tif (editor.instance) {\n\t\t\t\t\tif ($base.data('mime') === 'image/jpeg') {\n\t\t\t\t\t\tquality = quality || fm.storage('jpgQuality') || fm.option('jpgQuality');\n\t\t\t\t\t\tquality = Math.max(0.1, Math.min(1, quality / 100));\n\t\t\t\t\t}\n\t\t\t\t\treturn editor.instance.toDataURL({\n\t\t\t\t\t\tformat: getExtention($base.data('mime'), fm, true),\n\t\t\t\t\t\tquality: quality\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tsave : function(base) {\n\t\t\t\tvar $base = $(base),\n\t\t\t\t\tquality = $base.data('quality'),\n\t\t\t\t\thash = $base.data('hash'),\n\t\t\t\t\tfile;\n\t\t\t\tthis.instance.deactivateAll();\n\t\t\t\tif (typeof quality !== 'undefined') {\n\t\t\t\t\tthis.fm.storage('jpgQuality', quality);\n\t\t\t\t}\n\t\t\t\tif (hash) {\n\t\t\t\t\tfile = this.fm.file(hash);\n\t\t\t\t\t$base.data('mime', file.mime);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// Pixlr Editor\n\t\t\tinfo : {\n\t\t\t\tid : 'pixlreditor',\n\t\t\t\tname : 'Pixlr Editor',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -128',\n\t\t\t\turlAsContent: true,\n\t\t\t\tschemeContent: true,\n\t\t\t\tsingle: true,\n\t\t\t\tcanMakeEmpty: true,\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'PIXLR EDITOR',\n\t\t\t\t\tlink: 'https://pixlr.com/editor/'\n\t\t\t\t}\n\t\t\t},\n\t\t\t// MIME types to accept\n\t\t\tmimes : ['image/jpeg', 'image/png', 'image/gif', 'image/x-ms-bmp', 'image/x-pixlr-data'],\n\t\t\t// HTML of this editor\n\t\t\thtml : '<div class=\"elfinder-edit-imageeditor\"><img/></div>',\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tpixlrSetup.call(this, opts, fm);\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, url, fm) {\n\t\t\t\tinitImgTag.call(this, id, file, file.size > 0? fm.convAbsUrl(url) : '', fm);\n\t\t\t},\n\t\t\t// Get data uri scheme (this: this editors HTML node)\n\t\t\tgetContent : function() {\n\t\t\t\treturn $(this).children('img:first').attr('src');\n\t\t\t},\n\t\t\tload : function(base) {\n\t\t\t\tpixlrLoad.call(this, 'editor', base);\n\t\t\t},\n\t\t\tsave : function(base) {},\n\t\t\tclose : function(base) {}\n\t\t},\n\t\t{\n\t\t\t// Photopea advanced image editor\n\t\t\tinfo : {\n\t\t\t\tid : 'photopea',\n\t\t\t\tname : 'Photopea',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -160',\n\t\t\t\tsingle: true,\n\t\t\t\tnoContent: true,\n\t\t\t\tarrayBufferContent: true,\n\t\t\t\topenMaximized: true,\n\t\t\t\t// Disable file types that cannot be saved on Photopea.\n\t\t\t\tcanMakeEmpty: ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml', 'image/x-ms-bmp', 'image/tiff', /*'image/x-adobe-dng',*/ 'image/webp', /*'image/x-xcf',*/ 'image/vnd.adobe.photoshop', 'application/pdf', 'image/x-portable-pixmap', 'image/x-sketch', 'image/x-icon', 'image/vnd-ms.dds', /*'application/x-msmetafile'*/],\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'Photopea',\n\t\t\t\t\tlink: 'https://www.photopea.com/learn/'\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimes : ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml', 'image/x-ms-bmp', 'image/tiff', 'image/x-adobe-dng', 'image/webp', 'image/x-xcf', 'image/vnd.adobe.photoshop', 'application/pdf', 'image/x-portable-pixmap', 'image/x-sketch', 'image/x-icon', 'image/vnd-ms.dds', 'application/x-msmetafile'],\n\t\t\thtml : '<iframe style=\"width:100%;height:100%;border:none;\"></iframe>',\n\t\t\t// setup on elFinder bootup\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.IE || fm.UA.Mobile) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, dum, fm) {\n\t\t\t\tvar orig = 'https://www.photopea.com',\n\t\t\t\t\tifm = $(this).hide()\n\t\t\t\t\t\t//.css('box-sizing', 'border-box')\n\t\t\t\t\t\t.on('load', function() {\n\t\t\t\t\t\t\t//spnr.remove();\n\t\t\t\t\t\t\tifm.show();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('error', function() {\n\t\t\t\t\t\t\tspnr.remove();\n\t\t\t\t\t\t\tifm.show();\n\t\t\t\t\t\t}),\n\t\t\t\t\teditor = this.editor,\n\t\t\t\t\tconfObj = editor.confObj,\n\t\t\t\t\tspnr = $('<div class=\"elfinder-edit-spinner elfinder-edit-photopea\"/>')\n\t\t\t\t\t\t.html('<span class=\"elfinder-spinner-text\">' + fm.i18n('nowLoading') + '</span><span class=\"elfinder-spinner\"/>')\n\t\t\t\t\t\t.appendTo(ifm.parent()),\n\t\t\t\t\tsaveMimes = fm.arrayFlip(confObj.info.canMakeEmpty),\n\t\t\t\t\tgetType = function(mime) {\n\t\t\t\t\t\tvar ext = getExtention(mime, fm),\n\t\t\t\t\t\t\textmime = ext2mime[ext];\n\n\t\t\t\t\t\tif (!confObj.mimesFlip[extmime]) {\n\t\t\t\t\t\t\text = '';\n\t\t\t\t\t\t} else if (ext === 'jpeg') {\n\t\t\t\t\t\t\text = 'jpg';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!ext || !saveMimes[extmime]) {\n\t\t\t\t\t\t\text = 'psd';\n\t\t\t\t\t\t\textmime = ext2mime[ext];\n\t\t\t\t\t\t\tifm.closest('.ui-dialog').trigger('changeType', {\n\t\t\t\t\t\t\t\textention: ext,\n\t\t\t\t\t\t\t\tmime : extmime,\n\t\t\t\t\t\t\t\tkeepEditor: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn ext;\n\t\t\t\t\t},\n\t\t\t\t\tmime = file.mime,\n\t\t\t\t\tliveMsg, type, quty;\n\t\t\t\t\n\t\t\t\tif (!confObj.mimesFlip) {\n\t\t\t\t\tconfObj.mimesFlip = fm.arrayFlip(confObj.mimes, true);\n\t\t\t\t}\n\t\t\t\tif (!confObj.liveMsg) {\n\t\t\t\t\tconfObj.liveMsg = function(ifm, spnr, file) {\n\t\t\t\t\t\tvar wnd = ifm.get(0).contentWindow,\n\t\t\t\t\t\t\tphase = 0,\n\t\t\t\t\t\t\tdata = null,\n\t\t\t\t\t\t\tdfdIni = $.Deferred().done(function() {\n\t\t\t\t\t\t\t\tspnr.remove();\n\t\t\t\t\t\t\t\tphase = 1;\n\t\t\t\t\t\t\t\twnd.postMessage(data, orig);\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tdfdGet;\n\n\t\t\t\t\t\tthis.load = function() {\n\t\t\t\t\t\t\treturn fm.getContents(file.hash, 'arraybuffer').done(function(d) {\n\t\t\t\t\t\t\t\tdata = d;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.receive = function(e) {\n\t\t\t\t\t\t\tvar ev = e.originalEvent,\n\t\t\t\t\t\t\t\tstate;\n\t\t\t\t\t\t\tif (ev.origin === orig && ev.source === wnd) {\n\t\t\t\t\t\t\t\tif (ev.data === 'done') {\n\t\t\t\t\t\t\t\t\tif (phase === 0) {\n\t\t\t\t\t\t\t\t\t\tdfdIni.resolve();\n\t\t\t\t\t\t\t\t\t} else if (phase === 1) {\n\t\t\t\t\t\t\t\t\t\tphase = 2;\n\t\t\t\t\t\t\t\t\t\tifm.trigger('contentsloaded');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif (dfdGet && dfdGet.state() === 'pending') {\n\t\t\t\t\t\t\t\t\t\t\tdfdGet.reject('errDataEmpty');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (ev.data === 'Save') {\n\t\t\t\t\t\t\t\t\teditor.doSave();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (dfdGet && dfdGet.state() === 'pending') {\n\t\t\t\t\t\t\t\t\t\tif (typeof ev.data === 'object') {\n\t\t\t\t\t\t\t\t\t\t\tdfdGet.resolve('data:' + mime + ';base64,' + fm.arrayBufferToBase64(ev.data));\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdfdGet.reject('errDataEmpty');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.getContent = function() {\n\t\t\t\t\t\t\tvar type, q;\n\t\t\t\t\t\t\tif (phase > 1) {\n\t\t\t\t\t\t\t\tdfdGet && dfdGet.state() === 'pending' && dfdGet.reject();\n\t\t\t\t\t\t\t\tdfdGet = null;\n\t\t\t\t\t\t\t\tdfdGet = $.Deferred();\n\t\t\t\t\t\t\t\tif (phase === 2) {\n\t\t\t\t\t\t\t\t\tphase = 3;\n\t\t\t\t\t\t\t\t\tdfdGet.resolve('data:' + mime + ';base64,' + fm.arrayBufferToBase64(data));\n\t\t\t\t\t\t\t\t\tdata = null;\n\t\t\t\t\t\t\t\t\treturn dfdGet;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ifm.data('mime')) {\n\t\t\t\t\t\t\t\t\tmime = ifm.data('mime');\n\t\t\t\t\t\t\t\t\ttype = getType(mime);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (q = ifm.data('quality')) {\n\t\t\t\t\t\t\t\t\ttype += ':' + (q / 100);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twnd.postMessage('app.activeDocument.saveToOE(\"' + type + '\")', orig);\n\t\t\t\t\t\t\t\treturn dfdGet;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tifm.parent().css('padding', 0);\n\t\t\t\ttype = getType(file.mime);\n\t\t\t\tliveMsg = editor.liveMsg = new confObj.liveMsg(ifm, spnr, file);\n\t\t\t\t$(window).on('message.' + fm.namespace, liveMsg.receive);\n\t\t\t\tliveMsg.load().done(function() {\n\t\t\t\t\tvar d = JSON.stringify({\n\t\t\t\t\t\tfiles : [],\n\t\t\t\t\t\tenvironment : {\n\t\t\t\t\t\t\tlang: fm.lang.replace(/_/g, '-'),\n\t\t\t\t\t\t\tcustomIO: {\"save\": \"app.echoToOE(\\\"Save\\\");\"}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tifm.attr('src', orig + '/#' + encodeURI(d));\n\t\t\t\t}).fail(function(err) {\n\t\t\t\t\terr && fm.error(err);\n\t\t\t\t\teditor.initFail = true;\n\t\t\t\t});\n\n\t\t\t\t// jpeg quality controls\n\t\t\t\tif (file.mime === 'image/jpeg' || file.mime === 'image/webp') {\n\t\t\t\t\tifm.data('quality', fm.storage('jpgQuality') || fm.option('jpgQuality'));\n\t\t\t\t\tquty = $('<input type=\"number\" class=\"ui-corner-all elfinder-resize-quality elfinder-tabstop\"/>')\n\t\t\t\t\t\t.attr('min', '1')\n\t\t\t\t\t\t.attr('max', '100')\n\t\t\t\t\t\t.attr('title', '1 - 100')\n\t\t\t\t\t\t.on('change', function() {\n\t\t\t\t\t\t\tvar q = quty.val();\n\t\t\t\t\t\t\tifm.data('quality', q);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.val(ifm.data('quality'));\n\t\t\t\t\t$('<div class=\"ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality\"/>')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<span>').html(fm.i18n('quality') + ' : '), quty, $('<span/>')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.prependTo(ifm.parent().next());\n\t\t\t\t}\n\t\t\t},\n\t\t\tload : function(base) {\n\t\t\t\tvar dfd = $.Deferred(),\n\t\t\t\t\tself = this,\n\t\t\t\t\tfm = this.fm,\n\t\t\t\t\t$base = $(base);\n\t\t\t\tif (self.initFail) {\n\t\t\t\t\tdfd.reject();\n\t\t\t\t} else {\n\t\t\t\t\t$base.on('contentsloaded', function() {\n\t\t\t\t\t\tdfd.resolve(self.liveMsg);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn dfd;\n\t\t\t},\n\t\t\tgetContent : function() {\n\t\t\t\treturn this.editor.liveMsg? this.editor.liveMsg.getContent() : void(0);\n\t\t\t},\n\t\t\tsave : function(base, liveMsg) {\n\t\t\t\tvar $base = $(base),\n\t\t\t\t\tquality = $base.data('quality'),\n\t\t\t\t\thash = $base.data('hash'),\n\t\t\t\t\tfile;\n\t\t\t\tif (typeof quality !== 'undefined') {\n\t\t\t\t\tthis.fm.storage('jpgQuality', quality);\n\t\t\t\t}\n\t\t\t\tif (hash) {\n\t\t\t\t\tfile = this.fm.file(hash);\n\t\t\t\t\t$base.data('mime', file.mime);\n\t\t\t\t} else {\n\t\t\t\t\t$base.removeData('mime');\n\t\t\t\t}\n\t\t\t},\n\t\t\t// On dialog closed\n\t\t\tclose : function(base, liveMsg) {\n\t\t\t\t$(base).attr('src', '');\n\t\t\t\tliveMsg && $(window).off('message.' + this.fm.namespace, liveMsg.receive);\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// Pixo is cross-platform image editor\n\t\t\tinfo : {\n\t\t\t\tid : 'pixo',\n\t\t\t\tname : 'Pixo Editor',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -208',\n\t\t\t\tdataScheme: true,\n\t\t\t\tschemeContent: true,\n\t\t\t\tsingle: true,\n\t\t\t\tcanMakeEmpty: false,\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'Pixo Editor',\n\t\t\t\t\tlink: 'https://pixoeditor.com/privacy-policy/'\n\t\t\t\t}\n\t\t\t},\n\t\t\t// MIME types to accept\n\t\t\tmimes : ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml', 'image/x-ms-bmp'],\n\t\t\t// HTML of this editor\n\t\t\thtml : '<div class=\"elfinder-edit-imageeditor\"><img/></div>',\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.ltIE8 || !opts.extraOptions || !opts.extraOptions.pixo || !opts.extraOptions.pixo.apikey) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.editorOpts = opts.extraOptions.pixo;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, content, fm) {\n\t\t\t\tinitImgTag.call(this, id, file, content, fm);\n\t\t\t},\n\t\t\t// Get data uri scheme (this: this editors HTML node)\n\t\t\tgetContent : function() {\n\t\t\t\treturn $(this).children('img:first').attr('src');\n\t\t\t},\n\t\t\t// Launch Pixo editor when dialog open\n\t\t\tload : function(base) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm = this.fm,\n\t\t\t\t\t$base = $(base),\n\t\t\t\t\tnode = $base.children('img:first'),\n\t\t\t\t\tdialog = $base.closest('.ui-dialog'),\n\t\t\t\t\telfNode = fm.getUI(),\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tcontainer = $('#elfinder-pixo-container'),\n\t\t\t\t\tinit = function(onload) {\n\t\t\t\t\t\tvar opts;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tif (!container.length) {\n\t\t\t\t\t\t\tcontainer = $('<div id=\"elfinder-pixo-container\" class=\"ui-front\"/>').css({\n\t\t\t\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\theight: $(window).height(),\n\t\t\t\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t\t\t\t}).hide().appendTo(elfNode.hasClass('elfinder-fullscreen')? elfNode : 'body');\n\t\t\t\t\t\t\t// bind switch fullscreen event\n\t\t\t\t\t\t\telfNode.on('resize.'+fm.namespace, function(e, data) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tdata && data.fullscreen && container.appendTo(data.fullscreen === 'on'? elfNode : 'body');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfm.bind('destroy', function() {\n\t\t\t\t\t\t\t\teditor && editor.cancelEditing();\n\t\t\t\t\t\t\t\tcontainer.remove();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// always moves to last\n\t\t\t\t\t\t\tcontainer.appendTo(container.parent());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.on('click', launch);\n\t\t\t\t\t\t// Constructor options\n\t\t\t\t\t\topts = Object.assign({\n\t\t\t\t\t\t\ttype: 'child',\n\t\t\t\t\t\t\tparent: container.get(0),\n\t\t\t\t\t\t\toutput: {format: 'png'},\n\t\t\t\t\t\t\tonSave: function(arg) {\n\t\t\t\t\t\t\t\t// Check current file.hash, all callbacks are called on multiple instances\n\t\t\t\t\t\t\t\tvar mime = arg.toBlob().type,\n\t\t\t\t\t\t\t\t\text = getExtention(mime, fm),\n\t\t\t\t\t\t\t\t\tdraw = function(url) {\n\t\t\t\t\t\t\t\t\t\tnode.one('load error', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tnode.data('loading') && node.data('loading')(true);\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t.attr('crossorigin', 'anonymous')\n\t\t\t\t\t\t\t\t\t\t\t.attr('src', url);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\turl = arg.toDataURL();\n\t\t\t\t\t\t\t\tnode.data('loading')();\n\t\t\t\t\t\t\t\tdelete base._canvas;\n\t\t\t\t\t\t\t\tif (node.data('ext') !== ext) {\n\t\t\t\t\t\t\t\t\tchangeImageType(url, self.file.mime).done(function(res, cv) {\n\t\t\t\t\t\t\t\t\t\tif (cv) {\n\t\t\t\t\t\t\t\t\t\t\tbase._canvas = canvas = cv;\n\t\t\t\t\t\t\t\t\t\t\tquty.trigger('change');\n\t\t\t\t\t\t\t\t\t\t\tqBase && qBase.show();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdraw(res);\n\t\t\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\t\t\tdialog.trigger('changeType', {\n\t\t\t\t\t\t\t\t\t\t\textention: ext,\n\t\t\t\t\t\t\t\t\t\t\tmime : mime\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tdraw(url);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdraw(url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClose: function() {\n\t\t\t\t\t\t\t\tdialog.removeClass(fm.res('class', 'preventback'));\n\t\t\t\t\t\t\t\tfm.toggleMaximize(container, false);\n\t\t\t\t\t\t\t\tcontainer.hide();\n\t\t\t\t\t\t\t\tfm.toFront(dialog);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, self.confObj.editorOpts);\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: base,\n\t\t\t\t\t\t\teditorObj: Pixo,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// make editor instance\n\t\t\t\t\t\teditor = new Pixo.Bridge(opts);\n\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t\t$base.on('saveAsFail', launch);\n\t\t\t\t\t\tif (onload) {\n\t\t\t\t\t\t\tonload();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tlaunch = function() {\n\t\t\t\t\t\tdialog.addClass(fm.res('class', 'preventback'));\n\t\t\t\t\t\tfm.toggleMaximize(container, true);\n\t\t\t\t\t\tfm.toFront(container);\n\t\t\t\t\t\tcontainer.show().data('curhash', self.file.hash);\n\t\t\t\t\t\teditor.edit(node.get(0));\n\t\t\t\t\t\tnode.data('loading')(true);\n\t\t\t\t\t},\n\t\t\t\t\tqBase, quty, qutyTm, canvas, editor;\n\n\t\t\t\tnode.data('loading')();\n\n\t\t\t\t// jpeg quality controls\n\t\t\t\tif (self.file.mime === 'image/jpeg') {\n\t\t\t\t\tquty = $('<input type=\"number\" class=\"ui-corner-all elfinder-resize-quality elfinder-tabstop\"/>')\n\t\t\t\t\t\t.attr('min', '1')\n\t\t\t\t\t\t.attr('max', '100')\n\t\t\t\t\t\t.attr('title', '1 - 100')\n\t\t\t\t\t\t.on('change', function() {\n\t\t\t\t\t\t\tvar q = quty.val();\n\t\t\t\t\t\t\tqutyTm && cancelAnimationFrame(qutyTm);\n\t\t\t\t\t\t\tqutyTm = requestAnimationFrame(function() {\n\t\t\t\t\t\t\t\tif (canvas) {\n\t\t\t\t\t\t\t\t\tcanvas.toBlob(function(blob) {\n\t\t\t\t\t\t\t\t\t\tblob && quty.next('span').text(' (' + fm.formatSize(blob.size) + ')');\n\t\t\t\t\t\t\t\t\t}, 'image/jpeg', Math.max(Math.min(q, 100), 1) / 100);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.val(fm.storage('jpgQuality') || fm.option('jpgQuality'));\n\t\t\t\t\tqBase = $('<div class=\"ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality\"/>')\n\t\t\t\t\t\t.hide()\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<span>').html(fm.i18n('quality') + ' : '), quty, $('<span/>')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.prependTo($base.parent().next());\n\t\t\t\t\t$base.data('quty', quty);\n\t\t\t\t}\n\n\t\t\t\t// load script then init\n\t\t\t\tif (typeof Pixo === 'undefined') {\n\t\t\t\t\tfm.loadScript(['https://pixoeditor.com:8443/editor/scripts/bridge.m.js'], function() {\n\t\t\t\t\t\tinit(launch);\n\t\t\t\t\t}, {loadType: 'tag'});\n\t\t\t\t} else {\n\t\t\t\t\tinit();\n\t\t\t\t\tlaunch();\n\t\t\t\t}\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\t// Convert content url to data uri scheme to save content\n\t\t\tsave : function(base) {\n\t\t\t\tvar self = this,\n\t\t\t\t\t$base = $(base),\n\t\t\t\t\tnode = $base.children('img:first'),\n\t\t\t\t\tq;\n\t\t\t\tif (base._canvas) {\n\t\t\t\t\tif ($base.data('quty')) {\n\t\t\t\t\t\tq = $base.data('quty').val();\n\t\t\t\t\t\tq && this.fm.storage('jpgQuality', q);\n\t\t\t\t\t}\n\t\t\t\t\tnode.attr('src', base._canvas.toDataURL(self.file.mime, q? Math.max(Math.min(q, 100), 1) / 100 : void(0)));\n\t\t\t\t} else if (node.attr('src').substr(0, 5) !== 'data:') {\n\t\t\t\t\tnode.attr('src', imgBase64(node, this.file.mime));\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose : function(base, editor) {\n\t\t\t\teditor && editor.destroy();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// ACE Editor\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.ltIE8 || !fm.options.cdns.ace) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// `mimes` is not set for support everything kind of text file\n\t\t\tinfo : {\n\t\t\t\tid : 'aceeditor',\n\t\t\t\tname : 'ACE Editor',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -96'\n\t\t\t},\n\t\t\tload : function(textarea) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tcdn  = fm.options.cdns.ace,\n\t\t\t\t\tstart = function() {\n\t\t\t\t\t\tvar editor, editorBase, mode,\n\t\t\t\t\t\tta = $(textarea),\n\t\t\t\t\t\ttaBase = ta.parent(),\n\t\t\t\t\t\tdialog = taBase.parent(),\n\t\t\t\t\t\tid = textarea.id + '_ace',\n\t\t\t\t\t\text = self.file.name.replace(/^.+\\.([^.]+)|(.+)$/, '$1$2').toLowerCase(),\n\t\t\t\t\t\t// MIME/mode map\n\t\t\t\t\t\tmimeMode = {\n\t\t\t\t\t\t\t'text/x-php'\t\t\t  : 'php',\n\t\t\t\t\t\t\t'application/x-php'\t\t  : 'php',\n\t\t\t\t\t\t\t'text/html'\t\t\t\t  : 'html',\n\t\t\t\t\t\t\t'application/xhtml+xml'\t  : 'html',\n\t\t\t\t\t\t\t'text/javascript'\t\t  : 'javascript',\n\t\t\t\t\t\t\t'application/javascript'  : 'javascript',\n\t\t\t\t\t\t\t'text/css'\t\t\t\t  : 'css',\n\t\t\t\t\t\t\t'text/x-c'\t\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-csrc'\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-chdr'\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-c++'\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-c++src'\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-c++hdr'\t\t\t  : 'c_cpp',\n\t\t\t\t\t\t\t'text/x-shellscript'\t  : 'sh',\n\t\t\t\t\t\t\t'application/x-csh'\t\t  : 'sh',\n\t\t\t\t\t\t\t'text/x-python'\t\t\t  : 'python',\n\t\t\t\t\t\t\t'text/x-java'\t\t\t  : 'java',\n\t\t\t\t\t\t\t'text/x-java-source'\t  : 'java',\n\t\t\t\t\t\t\t'text/x-ruby'\t\t\t  : 'ruby',\n\t\t\t\t\t\t\t'text/x-perl'\t\t\t  : 'perl',\n\t\t\t\t\t\t\t'application/x-perl'\t  : 'perl',\n\t\t\t\t\t\t\t'text/x-sql'\t\t\t  : 'sql',\n\t\t\t\t\t\t\t'text/xml'\t\t\t\t  : 'xml',\n\t\t\t\t\t\t\t'application/docbook+xml' : 'xml',\n\t\t\t\t\t\t\t'application/xml'\t\t  : 'xml'\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\ttaBase.height(taBase.height());\n\n\t\t\t\t\t\t// set basePath of ace\n\t\t\t\t\t\tace.config.set('basePath', cdn);\n\n\t\t\t\t\t\t// Base node of Ace editor\n\t\t\t\t\t\teditorBase = $('<div id=\"'+id+'\" style=\"width:100%; height:100%;\"/>').text(ta.val()).insertBefore(ta.hide());\n\n\t\t\t\t\t\t// Editor flag\n\t\t\t\t\t\tta.data('ace', true);\n\n\t\t\t\t\t\t// Aceeditor instance\n\t\t\t\t\t\teditor = ace.edit(id);\n\n\t\t\t\t\t\t// Ace editor configure\n\t\t\t\t\t\teditor.$blockScrolling = Infinity;\n\t\t\t\t\t\teditor.setOptions({\n\t\t\t\t\t\t\ttheme: 'ace/theme/monokai',\n\t\t\t\t\t\t\tfontSize: '14px',\n\t\t\t\t\t\t\twrap: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tace.config.loadModule('ace/ext/modelist', function() {\n\t\t\t\t\t\t\t// detect mode\n\t\t\t\t\t\t\tmode = ace.require('ace/ext/modelist').getModeForPath('/' + self.file.name).name;\n\t\t\t\t\t\t\tif (mode === 'text') {\n\t\t\t\t\t\t\t\tif (mimeMode[self.file.mime]) {\n\t\t\t\t\t\t\t\t\tmode = mimeMode[self.file.mime];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// show MIME:mode in title bar\n\t\t\t\t\t\t\ttaBase.prev().children('.elfinder-dialog-title').append(' (' + self.file.mime + ' : ' + mode.split(/[\\/\\\\]/).pop() + ')');\n\t\t\t\t\t\t\teditor.setOptions({\n\t\t\t\t\t\t\t\tmode: 'ace/mode/' + mode\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (dfrd.state() === 'resolved') {\n\t\t\t\t\t\t\t\tdialog.trigger('resize');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tace.config.loadModule('ace/ext/language_tools', function() {\n\t\t\t\t\t\t\tace.require('ace/ext/language_tools');\n\t\t\t\t\t\t\teditor.setOptions({\n\t\t\t\t\t\t\t\tenableBasicAutocompletion: true,\n\t\t\t\t\t\t\t\tenableSnippets: true,\n\t\t\t\t\t\t\t\tenableLiveAutocompletion: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\tace.config.loadModule('ace/ext/settings_menu', function() {\n\t\t\t\t\t\t\tace.require('ace/ext/settings_menu').init(editor);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Short cuts\n\t\t\t\t\t\teditor.commands.addCommand({\n\t\t\t\t\t\t\tname : \"saveFile\",\n\t\t\t\t\t\t\tbindKey: {\n\t\t\t\t\t\t\t\twin : 'Ctrl-s',\n\t\t\t\t\t\t\t\tmac : 'Command-s'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\t\t\tself.doSave();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditor.commands.addCommand({\n\t\t\t\t\t\t\tname : \"closeEditor\",\n\t\t\t\t\t\t\tbindKey: {\n\t\t\t\t\t\t\t\twin : 'Ctrl-w|Ctrl-q',\n\t\t\t\t\t\t\t\tmac : 'Command-w|Command-q'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\t\t\tself.doCancel();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\teditor.resize();\n\n\t\t\t\t\t\t// TextArea button and Setting button\n\t\t\t\t\t\t$('<div class=\"ui-dialog-buttonset\"/>').css('float', 'left')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<button/>').html(self.fm.i18n('TextArea'))\n\t\t\t\t\t\t\t.button()\n\t\t\t\t\t\t\t.on('click', function(){\n\t\t\t\t\t\t\t\tif (ta.data('ace')) {\n\t\t\t\t\t\t\t\t\tta.removeData('ace');\n\t\t\t\t\t\t\t\t\teditorBase.hide();\n\t\t\t\t\t\t\t\t\tta.val(editor.session.getValue()).show().trigger('focus');\n\t\t\t\t\t\t\t\t\t$(this).text('AceEditor');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tta.data('ace', true);\n\t\t\t\t\t\t\t\t\teditorBase.show();\n\t\t\t\t\t\t\t\t\teditor.setValue(ta.hide().val(), -1);\n\t\t\t\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\t\t\t\t$(this).html(self.fm.i18n('TextArea'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<button>Ace editor setting</button>')\n\t\t\t\t\t\t\t.button({\n\t\t\t\t\t\t\t\ticons: {\n\t\t\t\t\t\t\t\t\tprimary: 'ui-icon-gear',\n\t\t\t\t\t\t\t\t\tsecondary: 'ui-icon-triangle-1-e'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: false\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.on('click', function(){\n\t\t\t\t\t\t\t\teditor.showSettingsMenu();\n\t\t\t\t\t\t\t\t$('#ace_settingsmenu')\n\t\t\t\t\t\t\t\t\t.css('font-size', '80%')\n\t\t\t\t\t\t\t\t\t.find('div[contains=\"setOptions\"]').hide().end()\n\t\t\t\t\t\t\t\t\t.parent().appendTo($('#elfinder'));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.prependTo(taBase.next());\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: textarea,\n\t\t\t\t\t\t\teditorObj: ace,\n\t\t\t\t\t\t\tinstance: editor,\n\t\t\t\t\t\t\topts: {}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t//dialog.trigger('resize');\n\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t};\n\n\t\t\t\t// check ace & start\n\t\t\t\tif (!self.confObj.loader) {\n\t\t\t\t\tself.confObj.loader = $.Deferred();\n\t\t\t\t\tself.fm.loadScript([ cdn+'/ace.js' ], function() {\n\t\t\t\t\t\tself.confObj.loader.resolve();\n\t\t\t\t\t}, void 0, {obj: window, name: 'ace'});\n\t\t\t\t}\n\t\t\t\tself.confObj.loader.done(start);\n\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tclose : function(textarea, instance) {\n\t\t\t\tinstance && instance.destroy();\n\t\t\t},\n\t\t\tsave : function(textarea, instance) {\n\t\t\t\tinstance && $(textarea).data('ace') && (textarea.value = instance.session.getValue());\n\t\t\t},\n\t\t\tfocus : function(textarea, instance) {\n\t\t\t\tinstance && $(textarea).data('ace') && instance.focus();\n\t\t\t},\n\t\t\tresize : function(textarea, instance, e, data) {\n\t\t\t\tinstance && instance.resize();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// CodeMirror\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.ltIE10 || !fm.options.cdns.codemirror) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// `mimes` is not set for support everything kind of text file\n\t\t\tinfo : {\n\t\t\t\tid : 'codemirror',\n\t\t\t\tname : 'CodeMirror',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -176'\n\t\t\t},\n\t\t\tload : function(textarea) {\n\t\t\t\tvar fm = this.fm,\n\t\t\t\t\tcmUrl = fm.convAbsUrl(fm.options.cdns.codemirror),\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tself = this,\n\t\t\t\t\tstart = function(CodeMirror) {\n\t\t\t\t\t\tvar ta   = $(textarea),\n\t\t\t\t\t\t\tbase = ta.parent(),\n\t\t\t\t\t\t\teditor, editorBase, opts;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\tbase.height(base.height());\n\t\t\t\t\t\t\n\t\t\t\t\t\t// CodeMirror configure options\n\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\t\t\textraKeys : {\n\t\t\t\t\t\t\t\t'Ctrl-S': function() { self.doSave(); },\n\t\t\t\t\t\t\t\t'Ctrl-Q': function() { self.doCancel(); },\n\t\t\t\t\t\t\t\t'Ctrl-W': function() { self.doCancel(); }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: textarea,\n\t\t\t\t\t\t\teditorObj: CodeMirror,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// CodeMirror configure\n\t\t\t\t\t\teditor = CodeMirror.fromTextArea(textarea, opts);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// return editor instance\n\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Auto mode set\n\t\t\t\t\t\tvar info, m, mode, spec;\n\t\t\t\t\t\tif (! info) {\n\t\t\t\t\t\t\tinfo = CodeMirror.findModeByMIME(self.file.mime);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (! info && (m = self.file.name.match(/.+\\.([^.]+)$/))) {\n\t\t\t\t\t\t\tinfo = CodeMirror.findModeByExtension(m[1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (info) {\n\t\t\t\t\t\t\tCodeMirror.modeURL = useRequire? 'codemirror/mode/%N/%N.min' : cmUrl + '/mode/%N/%N.min.js';\n\t\t\t\t\t\t\tmode = info.mode;\n\t\t\t\t\t\t\tspec = info.mime;\n\t\t\t\t\t\t\teditor.setOption('mode', spec);\n\t\t\t\t\t\t\tCodeMirror.autoLoadMode(editor, mode);\n\t\t\t\t\t\t\t// show MIME:mode in title bar\n\t\t\t\t\t\t\tbase.prev().children('.elfinder-dialog-title').append(' (' + spec + (mode != 'null'? ' : ' + mode : '') + ')');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// editor base node\n\t\t\t\t\t\teditorBase = $(editor.getWrapperElement()).css({\n\t\t\t\t\t\t\t// fix CSS conflict to SimpleMDE\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\tborder: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tta.data('cm', true);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// fit height to base\n\t\t\t\t\t\teditorBase.height('100%');\n\t\t\t\t\t\t\n\t\t\t\t\t\t// TextArea button and Setting button\n\t\t\t\t\t\t$('<div class=\"ui-dialog-buttonset\"/>').css('float', 'left')\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t$('<button/>').html(self.fm.i18n('TextArea'))\n\t\t\t\t\t\t\t.button()\n\t\t\t\t\t\t\t.on('click', function(){\n\t\t\t\t\t\t\t\tif (ta.data('cm')) {\n\t\t\t\t\t\t\t\t\tta.removeData('cm');\n\t\t\t\t\t\t\t\t\teditorBase.hide();\n\t\t\t\t\t\t\t\t\tta.val(editor.getValue()).show().trigger('focus');\n\t\t\t\t\t\t\t\t\t$(this).text('CodeMirror');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tta.data('cm', true);\n\t\t\t\t\t\t\t\t\teditorBase.show();\n\t\t\t\t\t\t\t\t\teditor.setValue(ta.hide().val());\n\t\t\t\t\t\t\t\t\teditor.refresh();\n\t\t\t\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\t\t\t\t$(this).html(self.fm.i18n('TextArea'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.prependTo(base.next());\n\t\t\t\t\t};\n\t\t\t\t// load script then start\n\t\t\t\tif (!self.confObj.loader) {\n\t\t\t\t\tself.confObj.loader = $.Deferred();\n\t\t\t\t\tif (useRequire) {\n\t\t\t\t\t\trequire.config({\n\t\t\t\t\t\t\tpackages: [{\n\t\t\t\t\t\t\t\tname: 'codemirror',\n\t\t\t\t\t\t\t\tlocation: cmUrl,\n\t\t\t\t\t\t\t\tmain: 'codemirror.min'\n\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t\tmap: {\n\t\t\t\t\t\t\t\t'codemirror': {\n\t\t\t\t\t\t\t\t\t'codemirror/lib/codemirror': 'codemirror'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\trequire([\n\t\t\t\t\t\t\t'codemirror',\n\t\t\t\t\t\t\t'codemirror/addon/mode/loadmode.min',\n\t\t\t\t\t\t\t'codemirror/mode/meta.min'\n\t\t\t\t\t\t], function(CodeMirror) {\n\t\t\t\t\t\t\tself.confObj.loader.resolve(CodeMirror);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.fm.loadScript([\n\t\t\t\t\t\t\tcmUrl + '/codemirror.min.js'\n\t\t\t\t\t\t], function() {\n\t\t\t\t\t\t\tself.fm.loadScript([\n\t\t\t\t\t\t\t\tcmUrl + '/addon/mode/loadmode.min.js',\n\t\t\t\t\t\t\t\tcmUrl + '/mode/meta.min.js'\n\t\t\t\t\t\t\t], function() {\n\t\t\t\t\t\t\t\tself.confObj.loader.resolve(CodeMirror);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, {loadType: 'tag'});\n\t\t\t\t\t}\n\t\t\t\t\tself.fm.loadCss(cmUrl + '/codemirror.css');\n\t\t\t\t}\n\t\t\t\tself.confObj.loader.done(start);\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tclose : function(textarea, instance) {\n\t\t\t\tinstance && instance.toTextArea();\n\t\t\t},\n\t\t\tsave : function(textarea, instance) {\n\t\t\t\tinstance && $(textarea).data('cm') && (textarea.value = instance.getValue());\n\t\t\t},\n\t\t\tfocus : function(textarea, instance) {\n\t\t\t\tinstance && $(textarea).data('cm') && instance.focus();\n\t\t\t},\n\t\t\tresize : function(textarea, instance, e, data) {\n\t\t\t\tinstance && instance.refresh();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// SimpleMDE\n\t\t\t// called on initialization of elFinder cmd edit (this: this editor's config object)\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.ltIE10 || !fm.options.cdns.simplemde) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tinfo : {\n\t\t\t\tid : 'simplemde',\n\t\t\t\tname : 'SimpleMDE',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -80'\n\t\t\t},\n\t\t\texts  : ['md'],\n\t\t\tload : function(textarea) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tbase = $(textarea).parent(),\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tcdn  = fm.options.cdns.simplemde,\n\t\t\t\t\tstart = function(SimpleMDE) {\n\t\t\t\t\t\tvar h\t = base.height(),\n\t\t\t\t\t\t\tdelta = base.outerHeight(true) - h + 14,\n\t\t\t\t\t\t\teditor, editorBase, opts;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// fit height function\n\t\t\t\t\t\ttextarea._setHeight = function(height) {\n\t\t\t\t\t\t\tvar h\t= height || base.height(),\n\t\t\t\t\t\t\t\tctrH = 0,\n\t\t\t\t\t\t\t\tareaH;\n\t\t\t\t\t\t\tbase.children('.editor-toolbar,.editor-statusbar').each(function() {\n\t\t\t\t\t\t\t\tctrH += $(this).outerHeight(true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tareaH = h - ctrH - delta;\n\t\t\t\t\t\t\teditorBase.height(areaH);\n\t\t\t\t\t\t\teditor.codemirror.refresh();\n\t\t\t\t\t\t\treturn areaH;\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\tbase.height(h);\n\t\t\t\t\t\t\n\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\telement: textarea,\n\t\t\t\t\t\t\tautofocus: true\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: textarea,\n\t\t\t\t\t\t\teditorObj: SimpleMDE,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// make editor\n\t\t\t\t\t\teditor = new SimpleMDE(opts);\n\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// editor base node\n\t\t\t\t\t\teditorBase = $(editor.codemirror.getWrapperElement());\n\t\t\t\t\t\t\n\t\t\t\t\t\t// fit height to base\n\t\t\t\t\t\teditorBase.css('min-height', '50px')\n\t\t\t\t\t\t\t.children('.CodeMirror-scroll').css('min-height', '50px');\n\t\t\t\t\t\ttextarea._setHeight(h);\n\t\t\t\t\t};\n\n\t\t\t\t// check SimpleMDE & start\n\t\t\t\tif (!self.confObj.loader) {\n\t\t\t\t\tself.confObj.loader = $.Deferred();\n\t\t\t\t\tself.fm.loadCss(cdn+'/simplemde.min.css');\n\t\t\t\t\tif (useRequire) {\n\t\t\t\t\t\trequire([\n\t\t\t\t\t\t\tcdn+'/simplemde.min.js'\n\t\t\t\t\t\t], function(SimpleMDE) {\n\t\t\t\t\t\t\tself.confObj.loader.resolve(SimpleMDE);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.fm.loadScript([cdn+'/simplemde.min.js'], function() {\n\t\t\t\t\t\t\tself.confObj.loader.resolve(SimpleMDE);\n\t\t\t\t\t\t}, {loadType: 'tag'});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.confObj.loader.done(start);\n\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tclose : function(textarea, instance) {\n\t\t\t\tinstance && instance.toTextArea();\n\t\t\t\tinstance = null;\n\t\t\t},\n\t\t\tsave : function(textarea, instance) {\n\t\t\t\tinstance && (textarea.value = instance.value());\n\t\t\t},\n\t\t\tfocus : function(textarea, instance) {\n\t\t\t\tinstance && instance.codemirror.focus();\n\t\t\t},\n\t\t\tresize : function(textarea, instance, e, data) {\n\t\t\t\tinstance && textarea._setHeight();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// CKEditor for html file\n\t\t\tinfo : {\n\t\t\t\tid : 'ckeditor',\n\t\t\t\tname : 'CKEditor',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 0'\n\t\t\t},\n\t\t\texts  : ['htm', 'html', 'xhtml'],\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tvar confObj = this;\n\t\t\t\tif (!fm.options.cdns.ckeditor) {\n\t\t\t\t\tconfObj.disabled = true;\n\t\t\t\t} else {\n\t\t\t\t\tconfObj.ckeOpts = {};\n\t\t\t\t\tif (opts.extraOptions) {\n\t\t\t\t\t\tconfObj.ckeOpts = Object.assign({}, opts.extraOptions.ckeditor || {});\n\t\t\t\t\t\tif (opts.extraOptions.managerUrl) {\n\t\t\t\t\t\t\tconfObj.managerUrl = opts.extraOptions.managerUrl;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tload : function(textarea) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tinit = function() {\n\t\t\t\t\t\tvar base = $(textarea).parent(),\n\t\t\t\t\t\t\tdlg = base.closest('.elfinder-dialog'),\n\t\t\t\t\t\t\th = base.height(),\n\t\t\t\t\t\t\treg = /([&?]getfile=)[^&]+/,\n\t\t\t\t\t\t\tloc = self.confObj.managerUrl || window.location.href.replace(/#.*$/, ''),\n\t\t\t\t\t\t\tname = 'ckeditor',\n\t\t\t\t\t\t\topts;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// make manager location\n\t\t\t\t\t\tif (reg.test(loc)) {\n\t\t\t\t\t\t\tloc = loc.replace(reg, '$1' + name);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tloc += '?getfile=' + name;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\tbase.height(h);\n\n\t\t\t\t\t\t// CKEditor configure options\n\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\tstartupFocus : true,\n\t\t\t\t\t\t\tfullPage: true,\n\t\t\t\t\t\t\tallowedContent: true,\n\t\t\t\t\t\t\tfilebrowserBrowseUrl : loc,\n\t\t\t\t\t\t\ttoolbarCanCollapse: true,\n\t\t\t\t\t\t\ttoolbarStartupExpanded: !fm.UA.Mobile,\n\t\t\t\t\t\t\tremovePlugins: 'resize',\n\t\t\t\t\t\t\textraPlugins: 'colorbutton,justify,docprops',\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t'instanceReady' : function(e) {\n\t\t\t\t\t\t\t\t\tvar editor = e.editor;\n\t\t\t\t\t\t\t\t\teditor.resize('100%', h);\n\t\t\t\t\t\t\t\t\t// re-build on dom move\n\t\t\t\t\t\t\t\t\tdlg.one('beforedommove.'+fm.namespace, function() {\n\t\t\t\t\t\t\t\t\t\teditor.destroy();\n\t\t\t\t\t\t\t\t\t}).one('dommove.'+fm.namespace, function() {\n\t\t\t\t\t\t\t\t\t\tself.load(textarea).done(function(editor) {\n\t\t\t\t\t\t\t\t\t\t\tself.instance = editor;\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t// return editor instance\n\t\t\t\t\t\t\t\t\tdfrd.resolve(e.editor);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: textarea,\n\t\t\t\t\t\t\teditorObj: CKEDITOR,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// CKEditor configure\n\t\t\t\t\t\tCKEDITOR.replace(textarea.id, Object.assign(opts, self.confObj.ckeOpts));\n\t\t\t\t\t\tCKEDITOR.on('dialogDefinition', function(e) {\n\t\t\t\t\t\t\tvar dlg = e.data.definition.dialog;\n\t\t\t\t\t\t\tdlg.on('show', function(e) {\n\t\t\t\t\t\t\t\tfm.getUI().append($('.cke_dialog_background_cover')).append(this.getElement().$);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdlg.on('hide', function(e) {\n\t\t\t\t\t\t\t\t$('body:first').append($('.cke_dialog_background_cover')).append(this.getElement().$);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\n\t\t\t\tif (!self.confObj.loader) {\n\t\t\t\t\tself.confObj.loader = $.Deferred();\n\t\t\t\t\twindow.CKEDITOR_BASEPATH = fm.options.cdns.ckeditor + '/';\n\t\t\t\t\t$.getScript(fm.options.cdns.ckeditor + '/ckeditor.js', function() {\n\t\t\t\t\t\tself.confObj.loader.resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tself.confObj.loader.done(init);\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tclose : function(textarea, instance) {\n\t\t\t\tinstance && instance.destroy();\n\t\t\t},\n\t\t\tsave : function(textarea, instance) {\n\t\t\t\tinstance && (textarea.value = instance.getData());\n\t\t\t},\n\t\t\tfocus : function(textarea, instance) {\n\t\t\t\tinstance && instance.focus();\n\t\t\t},\n\t\t\tresize : function(textarea, instance, e, data) {\n\t\t\t\tvar self;\n\t\t\t\tif (instance) {\n\t\t\t\t\tif (instance.status === 'ready') {\n\t\t\t\t\t\tinstance.resize('100%', $(textarea).parent().height());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// CKEditor5 balloon mode for html file\n\t\t\tinfo : {\n\t\t\t\tid : 'ckeditor5',\n\t\t\t\tname : 'CKEditor5',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -16'\n\t\t\t},\n\t\t\texts : ['htm', 'html', 'xhtml'],\n\t\t\thtml : '<div class=\"edit-editor-ckeditor5\"></div>',\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tvar confObj = this;\n\t\t\t\t// check cdn and ES6 support\n\t\t\t\tif (!fm.options.cdns.ckeditor5 || typeof window.Symbol !== 'function' || typeof Symbol() !== 'symbol') {\n\t\t\t\t\tconfObj.disabled = true;\n\t\t\t\t} else {\n\t\t\t\t\tconfObj.ckeOpts = {};\n\t\t\t\t\tif (opts.extraOptions) {\n\t\t\t\t\t\t// @deprecated option extraOptions.ckeditor5Mode\n\t\t\t\t\t\tif (opts.extraOptions.ckeditor5Mode) {\n\t\t\t\t\t\t\tconfObj.ckeditor5Mode = opts.extraOptions.ckeditor5Mode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfObj.ckeOpts = Object.assign({}, opts.extraOptions.ckeditor5 || {});\n\t\t\t\t\t\tif (confObj.ckeOpts.mode) {\n\t\t\t\t\t\t\tconfObj.ckeditor5Mode = confObj.ckeOpts.mode;\n\t\t\t\t\t\t\tdelete confObj.ckeOpts.mode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opts.extraOptions.managerUrl) {\n\t\t\t\t\t\t\tconfObj.managerUrl = opts.extraOptions.managerUrl;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfm.bind('destroy', function() {\n\t\t\t\t\tconfObj.editor = null;\n\t\t\t\t});\n\t\t\t},\n\t\t\t// Prepare on before show dialog\n\t\t\tprepare : function(base, dialogOpts, file) {\n\t\t\t\t$(base).height(base.editor.fm.getUI().height() - 100);\n\t\t\t},\n\t\t\tinit : function(id, file, data, fm) {\n\t\t\t\tvar m = data.match(/^([\\s\\S]*<body[^>]*>)([\\s\\S]+)(<\\/body>[\\s\\S]*)$/i),\n\t\t\t\t\theader = '',\n\t\t\t\t\tbody = '',\n\t\t\t\t\tfooter ='';\n\t\t\t\tthis.css({\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\theight: '100%',\n\t\t\t\t\t'box-sizing': 'border-box'\n\t\t\t\t});\n\t\t\t\tif (m) {\n\t\t\t\t\theader = m[1];\n\t\t\t\t\tbody = m[2];\n\t\t\t\t\tfooter = m[3];\n\t\t\t\t} else {\n\t\t\t\t\tbody = data;\n\t\t\t\t}\n\t\t\t\tthis.data('data', {\n\t\t\t\t\theader: header,\n\t\t\t\t\tbody: body,\n\t\t\t\t\tfooter: footer\n\t\t\t\t});\n\t\t\t\tthis._setupSelEncoding(data);\n\t\t\t},\n\t\t\tload : function(editnode) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tmode = self.confObj.ckeditor5Mode || 'decoupled-document',\n\t\t\t\t\tlang = (function() {\n\t\t\t\t\t\tvar l = fm.lang.toLowerCase().replace('_', '-');\n\t\t\t\t\t\tif (l.substr(0, 2) === 'zh' && l !== 'zh-cn') {\n\t\t\t\t\t\t\tl = 'zh';\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn l;\n\t\t\t\t\t})(),\n\t\t\t\t\tinit = function(cEditor) {\n\t\t\t\t\t\tvar base = $(editnode).parent(),\n\t\t\t\t\t\t\topts;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\tbase.height(fm.getUI().height() - 100);\n\n\t\t\t\t\t\t// CKEditor5 configure options\n\t\t\t\t\t\topts = Object.assign({\n\t\t\t\t\t\t\ttoolbar: [\"heading\", \"|\", \"fontSize\", \"fontFamily\", \"|\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"highlight\", \"|\", \"alignment\", \"|\", \"numberedList\", \"bulletedList\", \"blockQuote\", \"indent\", \"outdent\", \"|\", \"ckfinder\", \"link\", \"imageUpload\", \"insertTable\", \"mediaEmbed\", \"|\", \"undo\", \"redo\"],\n\t\t\t\t\t\t\tlanguage: lang\n\t\t\t\t\t\t}, self.confObj.ckeOpts);\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: editnode,\n\t\t\t\t\t\t\teditorObj: cEditor,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcEditor\n\t\t\t\t\t\t\t.create(editnode, opts)\n\t\t\t\t\t\t\t.then(function(editor) {\n\t\t\t\t\t\t\t\tvar ckf = editor.commands.get('ckfinder'),\n\t\t\t\t\t\t\t\t\tfileRepo = editor.plugins.get('FileRepository'),\n\t\t\t\t\t\t\t\t\tprevVars = {}, isImage, insertImages;\n\t\t\t\t\t\t\t\tif (editor.ui.view.toolbar && (mode === 'classic' || mode === 'decoupled-document')) {\n\t\t\t\t\t\t\t\t\t$(editnode).closest('.elfinder-dialog').children('.ui-widget-header').append($(editor.ui.view.toolbar.element).css({marginRight:'-1em',marginLeft:'-1em'}));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (mode === 'classic') {\n\t\t\t\t\t\t\t\t\t$(editnode).closest('.elfinder-edit-editor').css('overflow', 'auto');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Set up this elFinder instead of CKFinder\n\t\t\t\t\t\t\t\tif (ckf) {\n\t\t\t\t\t\t\t\t\tisImage = function(f) {\n\t\t\t\t\t\t\t\t\t\treturn f && f.mime.match(/^image\\//i);\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\tinsertImages = function(urls) {\n\t\t\t\t\t\t\t\t\t\tvar imgCmd = editor.commands.get('imageUpload');\n\t\t\t\t\t\t\t\t\t\tif (!imgCmd.isEnabled) {\n\t\t\t\t\t\t\t\t\t\t\tvar ntf = editor.plugins.get('Notification'),\n\t\t\t\t\t\t\t\t\t\t\t\ti18 = editor.locale.t;\n\t\t\t\t\t\t\t\t\t\t\tntf.showWarning(i18('Could not insert image at the current position.'), {\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: i18('Inserting image failed'),\n\t\t\t\t\t\t\t\t\t\t\t\tnamespace: 'ckfinder'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\teditor.execute('imageInsert', { source: urls });\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t// Take over ckfinder execute()\n\t\t\t\t\t\t\t\t\tckf.execute = function() {\n\t\t\t\t\t\t\t\t\t\tvar dlg = base.closest('.elfinder-dialog'),\n\t\t\t\t\t\t\t\t\t\t\tgf = fm.getCommand('getfile'),\n\t\t\t\t\t\t\t\t\t\t\trever = function() {\n\t\t\t\t\t\t\t\t\t\t\t\tif (prevVars.hasVar) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdlg.off('resize close', rever);\n\t\t\t\t\t\t\t\t\t\t\t\t\tgf.callback = prevVars.callback;\n\t\t\t\t\t\t\t\t\t\t\t\t\tgf.options.folders = prevVars.folders;\n\t\t\t\t\t\t\t\t\t\t\t\t\tgf.options.multiple = prevVars.multi;\n\t\t\t\t\t\t\t\t\t\t\t\t\tfm.commandMap.open = prevVars.open;\n\t\t\t\t\t\t\t\t\t\t\t\t\tprevVars.hasVar = false;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tdlg.trigger('togleminimize').one('resize close', rever);\n\t\t\t\t\t\t\t\t\t\tprevVars.callback = gf.callback;\n\t\t\t\t\t\t\t\t\t\tprevVars.folders = gf.options.folders;\n\t\t\t\t\t\t\t\t\t\tprevVars.multi = gf.options.multiple;\n\t\t\t\t\t\t\t\t\t\tprevVars.open = fm.commandMap.open;\n\t\t\t\t\t\t\t\t\t\tprevVars.hasVar = true;\n\t\t\t\t\t\t\t\t\t\tgf.callback = function(files) {\n\t\t\t\t\t\t\t\t\t\t\tvar imgs = [];\n\t\t\t\t\t\t\t\t\t\t\tif (files.length === 1 && files[0].mime === 'directory') {\n\t\t\t\t\t\t\t\t\t\t\t\tfm.one('open', function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfm.commandMap.open = 'getfile';\n\t\t\t\t\t\t\t\t\t\t\t\t}).getCommand('open').exec(files[0].hash);\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfm.getUI('cwd').trigger('unselectall');\n\t\t\t\t\t\t\t\t\t\t\t$.each(files, function(i, f) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (isImage(f)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\timgs.push(fm.convAbsUrl(f.url));\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\teditor.execute('link', fm.convAbsUrl(f.url));\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (imgs.length) {\n\t\t\t\t\t\t\t\t\t\t\t\tinsertImages(imgs);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdlg.trigger('togleminimize');\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tgf.options.folders = true;\n\t\t\t\t\t\t\t\t\t\tgf.options.multiple = true;\n\t\t\t\t\t\t\t\t\t\tfm.commandMap.open = 'getfile';\n\t\t\t\t\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\t\t\t\t\tmode: 'info',\n\t\t\t\t\t\t\t\t\t\t\tmsg: fm.i18n('dblclickToSelect')\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Set up image uploader\n\t\t\t\t\t\t\t\tfileRepo.createUploadAdapter = function(loader) {\n\t\t\t\t\t\t\t\t\treturn new uploder(loader);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\teditor.setData($(editnode).data('data').body);\n\t\t\t\t\t\t\t\t// move .ck-body to elFinder node for fullscreen mode\n\t\t\t\t\t\t\t\tfm.getUI().append($('body > div.ck-body'));\n\t\t\t\t\t\t\t\t$('div.ck-balloon-panel').css({\n\t\t\t\t\t\t\t\t\t'z-index': fm.getMaximizeCss().zIndex + 1\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t\t\t\t/*fm.log({\n\t\t\t\t\t\t\t\t\tdefaultConfig: cEditor.defaultConfig,\n\t\t\t\t\t\t\t\t\tplugins: cEditor.builtinPlugins.map(function(p) { return p.pluginName; }),\n\t\t\t\t\t\t\t\t\ttoolbars: Array.from(editor.ui.componentFactory.names())\n\t\t\t\t\t\t\t\t});*/\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t['catch'](function(error) { // ['cache'] instead .cache for fix error on ie8 \n\t\t\t\t\t\t\t\tfm.error(error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tuploder = function(loader) {\n\t\t\t\t\t\tvar upload = function(file, resolve, reject) {\n\t\t\t\t\t\t\tfm.exec('upload', {files: [file]}, void(0), fm.cwd().hash)\n\t\t\t\t\t\t\t\t.done(function(data){\n\t\t\t\t\t\t\t\t\tif (data.added && data.added.length) {\n\t\t\t\t\t\t\t\t\t\tfm.url(data.added[0].hash, { async: true }).done(function(url) {\n\t\t\t\t\t\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\t\t\t\t\t\t'default': fm.convAbsUrl(url)\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\t\t\t\treject('errFileNotFound');\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treject(fm.i18n(data.error? data.error : 'errUpload'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function(err) {\n\t\t\t\t\t\t\t\t\tvar error = fm.parseError(err);\n\t\t\t\t\t\t\t\t\treject(fm.i18n(error? (error === 'userabort'? 'errAbort' : error) : 'errUploadNoFiles'));\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.progress(function(data) {\n\t\t\t\t\t\t\t\t\tloader.uploadTotal = data.total;\n\t\t\t\t\t\t\t\t\tloader.uploaded = data.progress;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.upload = function() {\n\t\t\t\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\t\t\t\tif (loader.file instanceof Promise || (loader.file && typeof loader.file.then === 'function')) {\n\t\t\t\t\t\t\t\t\tloader.file.then(function(file) {\n\t\t\t\t\t\t\t\t\t\tupload(file, resolve, reject);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tupload(loader.file, resolve, reject);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.abort = function() {\n\t\t\t\t\t\t\tfm.getUI().trigger('uploadabort');\n\t\t\t\t\t\t};\n\t\t\t\t\t}, loader;\n\n\t\t\t\tif (!self.confObj.editor) {\n\t\t\t\t\tloader = $.Deferred();\n\t\t\t\t\tself.fm.loadScript([\n\t\t\t\t\t\tfm.options.cdns.ckeditor5 + '/' + mode + '/ckeditor.js'\n\t\t\t\t\t], function(editor) {\n\t\t\t\t\t\tif (!editor) {\n\t\t\t\t\t\t\teditor = window.BalloonEditor || window.InlineEditor || window.ClassicEditor || window.DecoupledEditor;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fm.lang !== 'en') {\n\t\t\t\t\t\t\tself.fm.loadScript([\n\t\t\t\t\t\t\t\tfm.options.cdns.ckeditor5 + '/' + mode + '/translations/' + lang + '.js'\n\t\t\t\t\t\t\t], function(obj) {\n\t\t\t\t\t\t\t\tloader.resolve(editor);\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\t\t\tloadType: 'tag',\n\t\t\t\t\t\t\t\terror: function(obj) {\n\t\t\t\t\t\t\t\t\tlang = 'en';\n\t\t\t\t\t\t\t\t\tloader.resolve(editor);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tloader.resolve(editor);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttryRequire: true,\n\t\t\t\t\t\tloadType: 'tag'\n\t\t\t\t\t});\n\t\t\t\t\tloader.done(function(editor) {\n\t\t\t\t\t\tself.confObj.editor = editor;\n\t\t\t\t\t\tinit(editor);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tinit(self.confObj.editor);\n\t\t\t\t}\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tgetContent : function() {\n\t\t\t\tvar data = $(this).data('data');\n\t\t\t\treturn data.header + data.body + data.footer;\n\t\t\t},\n\t\t\tclose : function(editnode, instance) {\n\t\t\t\tinstance && instance.destroy();\n\t\t\t},\n\t\t\tsave : function(editnode, instance) {\n\t\t\t\tvar elm = $(editnode),\n\t\t\t\t\tdata = elm.data('data');\n\t\t\t\tif (instance) {\n\t\t\t\t\tdata.body = instance.getData();\n\t\t\t\t\telm.data('data', data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfocus : function(editnode, instance) {\n\t\t\t\t$(editnode).trigger('focus');\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// TinyMCE for html file\n\t\t\tinfo : {\n\t\t\t\tid : 'tinymce',\n\t\t\t\tname : 'TinyMCE',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -64'\n\t\t\t},\n\t\t\texts  : ['htm', 'html', 'xhtml'],\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tvar confObj = this;\n\t\t\t\tif (!fm.options.cdns.tinymce) {\n\t\t\t\t\tconfObj.disabled = true;\n\t\t\t\t} else {\n\t\t\t\t\tconfObj.mceOpts = {};\n\t\t\t\t\tif (opts.extraOptions) {\n\t\t\t\t\t\tconfObj.uploadOpts = Object.assign({}, opts.extraOptions.uploadOpts || {});\n\t\t\t\t\t\tconfObj.mceOpts = Object.assign({}, opts.extraOptions.tinymce || {});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfObj.uploadOpts = {};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tload : function(textarea) {\n\t\t\t\tvar self = this,\n\t\t\t\t\tfm   = this.fm,\n\t\t\t\t\tdfrd = $.Deferred(),\n\t\t\t\t\tinit = function() {\n\t\t\t\t\t\tvar base = $(textarea).show().parent(),\n\t\t\t\t\t\t\tdlg = base.closest('.elfinder-dialog'),\n\t\t\t\t\t\t\th = base.height(),\n\t\t\t\t\t\t\tdelta = base.outerHeight(true) - h,\n\t\t\t\t\t\t\t// hide MCE dialog and modal block\n\t\t\t\t\t\t\thideMceDlg = function() {\n\t\t\t\t\t\t\t\tvar mceW;\n\t\t\t\t\t\t\t\tif (tinymce.activeEditor.windowManager.windows) {\n\t\t\t\t\t\t\t\t\tmceW = tinymce.activeEditor.windowManager.windows[0];\n\t\t\t\t\t\t\t\t\tmceDlg = $(mceW? mceW.getEl() : void(0)).hide();\n\t\t\t\t\t\t\t\t\tmceCv = $('#mce-modal-block').hide();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmceDlg = $('.tox-dialog-wrap').hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t// Show MCE dialog and modal block\n\t\t\t\t\t\t\tshowMceDlg = function() {\n\t\t\t\t\t\t\t\tmceCv && mceCv.show();\n\t\t\t\t\t\t\t\tmceDlg && mceDlg.show();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttVer = tinymce.majorVersion,\n\t\t\t\t\t\t\topts, mceDlg, mceCv;\n\n\t\t\t\t\t\t// set base height\n\t\t\t\t\t\tbase.height(h);\n\t\t\t\t\t\t// fit height function\n\t\t\t\t\t\ttextarea._setHeight = function(height) {\n\t\t\t\t\t\t\tif (tVer < 5) {\n\t\t\t\t\t\t\t\tvar base = $(this).parent(),\n\t\t\t\t\t\t\t\t\th = height || base.innerHeight(),\n\t\t\t\t\t\t\t\t\tctrH = 0,\n\t\t\t\t\t\t\t\t\tareaH;\n\t\t\t\t\t\t\t\tbase.find('.mce-container-body:first').children('.mce-top-part,.mce-statusbar').each(function() {\n\t\t\t\t\t\t\t\t\tctrH += $(this).outerHeight(true);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tareaH = h - ctrH - delta;\n\t\t\t\t\t\t\t\tbase.find('.mce-edit-area iframe:first').height(areaH);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// TinyMCE configure options\n\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\tselector: '#' + textarea.id,\n\t\t\t\t\t\t\tresize: false,\n\t\t\t\t\t\t\tplugins: 'print preview fullpage searchreplace autolink directionality visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern help',\n\t\t\t\t\t\t\ttoolbar: 'formatselect | bold italic strikethrough forecolor backcolor | link image media | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | removeformat',\n\t\t\t\t\t\t\timage_advtab: true,\n\t\t\t\t\t\t\tinit_instance_callback : function(editor) {\n\t\t\t\t\t\t\t\t// fit height on init\n\t\t\t\t\t\t\t\ttextarea._setHeight(h);\n\t\t\t\t\t\t\t\t// re-build on dom move\n\t\t\t\t\t\t\t\tdlg.one('beforedommove.'+fm.namespace, function() {\n\t\t\t\t\t\t\t\t\ttinymce.execCommand('mceRemoveEditor', false, textarea.id);\n\t\t\t\t\t\t\t\t}).one('dommove.'+fm.namespace, function() {\n\t\t\t\t\t\t\t\t\tself.load(textarea).done(function(editor) {\n\t\t\t\t\t\t\t\t\t\tself.instance = editor;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t// return editor instance\n\t\t\t\t\t\t\t\tdfrd.resolve(editor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfile_picker_callback : function (callback, value, meta) {\n\t\t\t\t\t\t\t\tvar gf = fm.getCommand('getfile'),\n\t\t\t\t\t\t\t\t\trevar = function() {\n\t\t\t\t\t\t\t\t\t\tif (prevVars.hasVar) {\n\t\t\t\t\t\t\t\t\t\t\tgf.callback = prevVars.callback;\n\t\t\t\t\t\t\t\t\t\t\tgf.options.folders = prevVars.folders;\n\t\t\t\t\t\t\t\t\t\t\tgf.options.multiple = prevVars.multi;\n\t\t\t\t\t\t\t\t\t\t\tfm.commandMap.open = prevVars.open;\n\t\t\t\t\t\t\t\t\t\t\tprevVars.hasVar = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdlg.off('resize close', revar);\n\t\t\t\t\t\t\t\t\t\tshowMceDlg();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprevVars = {};\n\t\t\t\t\t\t\t\tprevVars.callback = gf.callback;\n\t\t\t\t\t\t\t\tprevVars.folders = gf.options.folders;\n\t\t\t\t\t\t\t\tprevVars.multi = gf.options.multiple;\n\t\t\t\t\t\t\t\tprevVars.open = fm.commandMap.open;\n\t\t\t\t\t\t\t\tprevVars.hasVar = true;\n\t\t\t\t\t\t\t\tgf.callback = function(file) {\n\t\t\t\t\t\t\t\t\tvar url, info;\n\n\t\t\t\t\t\t\t\t\tif (file.mime === 'directory') {\n\t\t\t\t\t\t\t\t\t\tfm.one('open', function() {\n\t\t\t\t\t\t\t\t\t\t\tfm.commandMap.open = 'getfile';\n\t\t\t\t\t\t\t\t\t\t}).getCommand('open').exec(file.hash);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// URL normalization\n\t\t\t\t\t\t\t\t\turl = fm.convAbsUrl(file.url);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// Make file info\n\t\t\t\t\t\t\t\t\tinfo = file.name + ' (' + fm.formatSize(file.size) + ')';\n\n\t\t\t\t\t\t\t\t\t// Provide file and text for the link dialog\n\t\t\t\t\t\t\t\t\tif (meta.filetype == 'file') {\n\t\t\t\t\t\t\t\t\t\tcallback(url, {text: info, title: info});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Provide image and alt text for the image dialog\n\t\t\t\t\t\t\t\t\tif (meta.filetype == 'image') {\n\t\t\t\t\t\t\t\t\t\tcallback(url, {alt: info});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Provide alternative source and posted for the media dialog\n\t\t\t\t\t\t\t\t\tif (meta.filetype == 'media') {\n\t\t\t\t\t\t\t\t\t\tcallback(url);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdlg.trigger('togleminimize');\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tgf.options.folders = true;\n\t\t\t\t\t\t\t\tgf.options.multiple = false;\n\t\t\t\t\t\t\t\tfm.commandMap.open = 'getfile';\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\thideMceDlg();\n\t\t\t\t\t\t\t\tdlg.trigger('togleminimize').one('resize close', revar);\n\t\t\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\t\t\tmode: 'info',\n\t\t\t\t\t\t\t\t\tmsg: fm.i18n('dblclickToSelect')\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\timages_upload_handler : function (blobInfo, success, failure) {\n\t\t\t\t\t\t\t\tvar file = blobInfo.blob(),\n\t\t\t\t\t\t\t\t\terr = function(e) {\n\t\t\t\t\t\t\t\t\t\tvar dlg = e.data.dialog || {};\n\t\t                                if (dlg.hasClass('elfinder-dialog-error') || dlg.hasClass('elfinder-confirm-upload')) {\n\t\t                                    hideMceDlg();\n\t\t                                    dlg.trigger('togleminimize').one('resize close', revert);\n\t\t                                    fm.unbind('dialogopened', err);\n\t\t                                }\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\trevert = function() {\n\t\t\t\t\t\t\t\t\t\tdlg.off('resize close', revert);\n\t\t\t\t\t\t\t\t\t\tshowMceDlg();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tclipdata = true;\n\n\t\t\t\t\t\t\t\t// check file object\n\t\t\t\t\t\t\t\tif (file.name) {\n\t\t\t\t\t\t\t\t\t// file blob of client side file object\n\t\t\t\t\t\t\t\t\tclipdata = void(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfm.bind('dialogopened', err).exec('upload', Object.assign({\n\t\t\t\t\t\t\t\t\tfiles: [file],\n\t\t\t\t\t\t\t\t\tclipdata: clipdata // to get unique name on connector\n\t\t\t\t\t\t\t\t}, self.confObj.uploadOpts), void(0), fm.cwd().hash).done(function(data) {\n\t\t\t\t\t\t\t\t\tif (data.added && data.added.length) {\n\t\t\t\t\t\t\t\t\t\tfm.url(data.added[0].hash, { async: true }).done(function(url) {\n\t\t\t\t\t\t\t\t\t\t\tshowMceDlg();\n\t\t\t\t\t\t\t\t\t\t\tsuccess(fm.convAbsUrl(url));\n\t\t\t\t\t\t\t\t\t\t}).fail(function() {\n\t\t\t\t\t\t\t\t\t\t\tfailure(fm.i18n('errFileNotFound'));\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfailure(fm.i18n(data.error? data.error : 'errUpload'));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}).fail(function(err) {\n\t\t\t\t\t\t\t\t\tvar error = fm.parseError(err);\n\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\tif (error === 'errUnknownCmd') {\n\t\t\t\t\t\t\t\t\t\t\terror = 'errPerm';\n\t\t\t\t\t\t\t\t\t\t} else if (error === 'userabort') {\n\t\t\t\t\t\t\t\t\t\t\terror = 'errAbort';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfailure(fm.i18n(error? error : 'errUploadNoFiles'));\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// TinyMCE 5 supports \"height: 100%\"\n\t\t\t\t\t\tif (tVer >= 5) {\n\t\t\t\t\t\t\topts.height = '100%';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tself.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: textarea,\n\t\t\t\t\t\t\teditorObj: tinymce,\n\t\t\t\t\t\t\tinstance: void(0),\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// TinyMCE configure\n\t\t\t\t\t\ttinymce.init(Object.assign(opts, self.confObj.mceOpts));\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif (!self.confObj.loader) {\n\t\t\t\t\tself.confObj.loader = $.Deferred();\n\t\t\t\t\tself.fm.loadScript([fm.options.cdns.tinymce + (fm.options.cdns.tinymce.match(/\\.js/)? '' : '/tinymce.min.js')], function() {\n\t\t\t\t\t\tself.confObj.loader.resolve();\n\t\t\t\t\t}, {\n\t\t\t\t\t\tloadType: 'tag'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tself.confObj.loader.done(init);\n\t\t\t\treturn dfrd;\n\t\t\t},\n\t\t\tclose : function(textarea, instance) {\n\t\t\t\tinstance && tinymce.execCommand('mceRemoveEditor', false, textarea.id);\n\t\t\t},\n\t\t\tsave : function(textarea, instance) {\n\t\t\t\tinstance && instance.save();\n\t\t\t},\n\t\t\tfocus : function(textarea, instance) {\n\t\t\t\tinstance && instance.focus();\n\t\t\t},\n\t\t\tresize : function(textarea, instance, e, data) {\n\t\t\t\t// fit height to base node on dialog resize\n\t\t\t\tinstance && textarea._setHeight();\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tinfo : {\n\t\t\t\tid : 'zohoeditor',\n\t\t\t\tname : 'Zoho Editor',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -32',\n\t\t\t\tcmdCheck : 'ZohoOffice',\n\t\t\t\tpreventGet: true,\n\t\t\t\thideButtons: true,\n\t\t\t\tsyncInterval : 15000,\n\t\t\t\tcanMakeEmpty: true,\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'Zoho Office API',\n\t\t\t\t\tlink: 'https://www.zoho.com/officeapi/'\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimes : [\n\t\t\t\t'application/msword',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t\t\t//'application/pdf',\n\t\t\t\t'application/vnd.oasis.opendocument.text',\n\t\t\t\t'application/rtf',\n\t\t\t\t'text/html',\n\t\t\t\t'application/vnd.ms-excel',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t\t'application/vnd.oasis.opendocument.spreadsheet',\n\t\t\t\t'application/vnd.sun.xml.calc',\n\t\t\t\t'text/csv',\n\t\t\t\t'text/tab-separated-values',\n\t\t\t\t'application/vnd.ms-powerpoint',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.slideshow',\n\t\t\t\t'application/vnd.oasis.opendocument.presentation',\n\t\t\t\t'application/vnd.sun.xml.impress'\n\t\t\t],\n\t\t\thtml : '<iframe style=\"width:100%;max-height:100%;border:none;\"></iframe>',\n\t\t\t// setup on elFinder bootup\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tif (fm.UA.Mobile || fm.UA.ltIE8) {\n\t\t\t\t\tthis.disabled = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// Prepare on before show dialog\n\t\t\tprepare : function(base, dialogOpts, file) {\n\t\t\t\tvar elfNode = base.editor.fm.getUI();\n\t\t\t\t$(base).height(elfNode.height());\n\t\t\t\tdialogOpts.width = Math.max(dialogOpts.width || 0, elfNode.width() * 0.8);\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, dum, fm) {\n\t\t\t\tvar ta = this,\n\t\t\t\t\tifm = $(this).hide(),\n\t\t\t\t\tuiToast = fm.getUI('toast'),\n\t\t\t\t\tspnr = $('<div class=\"elfinder-edit-spinner elfinder-edit-zohoeditor\"/>')\n\t\t\t\t\t\t.html('<span class=\"elfinder-spinner-text\">' + fm.i18n('nowLoading') + '</span><span class=\"elfinder-spinner\"/>')\n\t\t\t\t\t\t.appendTo(ifm.parent()),\n\t\t\t\t\tcdata = function() {\n\t\t\t\t\t\tvar data = '';\n\t\t\t\t\t\t$.each(fm.customData, function(key, val) {\n\t\t\t\t\t\t\tdata += '&' + encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\t$(ta).data('xhr', fm.request({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcmd: 'editor',\n\t\t\t\t\t\tname: ta.editor.confObj.info.cmdCheck,\n\t\t\t\t\t\tmethod: 'init',\n\t\t\t\t\t\t'args[target]': file.hash,\n\t\t\t\t\t\t'args[lang]' : fm.lang,\n\t\t\t\t\t\t'args[cdata]' : cdata()\n\t\t\t\t\t},\n\t\t\t\t\tpreventDefault : true\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tvar opts;\n\t\t\t\t\tif (data.zohourl) {\n\t\t\t\t\t\topts = {\n\t\t\t\t\t\t\tcss: {\n\t\t\t\t\t\t\t\theight: '100%'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\t\t\tta.editor.trigger('Prepare', {\n\t\t\t\t\t\t\tnode: ta,\n\t\t\t\t\t\t\teditorObj: void(0),\n\t\t\t\t\t\t\tinstance: ifm,\n\t\t\t\t\t\t\topts: opts\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tifm.attr('src', data.zohourl).show().css(opts.css);\n\t\t\t\t\t\tif (data.warning) {\n\t\t\t\t\t\t\tuiToast.appendTo(ta.closest('.ui-dialog'));\n\t\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\t\tmsg: fm.i18n(data.warning),\n\t\t\t\t\t\t\t\tmode: 'warning',\n\t\t\t\t\t\t\t\ttimeOut: 0,\n\t\t\t\t\t\t\t\tonHidden: function() {\n\t\t\t\t\t\t\t\t\tuiToast.children().length === 1 && uiToast.appendTo(fm.getUI());\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbutton: {\n\t\t\t\t\t\t\t\t\ttext: 'btnYes'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata.error && fm.error(data.error);\n\t\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t\t}\n\t\t\t\t}).fail(function(error) {\n\t\t\t\t\terror && fm.error(error);\n\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t}).always(function() {\n\t\t\t\t\tspnr.remove();\n\t\t\t\t}));\n\t\t\t},\n\t\t\tload : function() {},\n\t\t\tgetContent : function() {},\n\t\t\tsave : function() {},\n\t\t\t// Before dialog close\n\t\t\tbeforeclose : iframeClose,\n\t\t\t// On dialog closed\n\t\t\tclose : function(ta) {\n\t\t\t\tvar fm = this.fm,\n\t\t\t\t\txhr = $(ta).data('xhr');\n\t\t\t\tif (xhr.state() === 'pending') {\n\t\t\t\t\txhr.reject();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t// Zip Archive with FlySystem\n\t\t\tinfo : {\n\t\t\t\tid : 'ziparchive',\n\t\t\t\tname : 'btnMount',\n\t\t\t\ticonImg : 'img/toolbar.png 0 -416',\n\t\t\t\tcmdCheck : 'ZipArchive',\n\t\t\t\tedit : function(file, editor) {\n\t\t\t\t\tvar fm = this,\n\t\t\t\t\t\tdfrd = $.Deferred();\n\t\t\t\t\tfm.request({\n\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\tcmd: 'netmount',\n\t\t\t\t\t\t\tprotocol: 'ziparchive',\n\t\t\t\t\t\t\thost: file.hash,\n\t\t\t\t\t\t\tpath: file.phash\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpreventFail: true,\n\t\t\t\t\t\tnotify : {type : 'netmount', cnt : 1, hideCnt : true}\n\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\tvar pdir;\n\t\t\t\t\t\tif (data.added && data.added.length) {\n\t\t\t\t\t\t\tif (data.added[0].phash) {\n\t\t\t\t\t\t\t\tif (pdir = fm.file(data.added[0].phash)) {\n\t\t\t\t\t\t\t\t\tif (! pdir.dirs) {\n\t\t\t\t\t\t\t\t\t\tpdir.dirs = 1;\n\t\t\t\t\t\t\t\t\t\tfm.change({ changed: [ pdir ] });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfm.one('netmountdone', function() {\n\t\t\t\t\t\t\t\tfm.exec('open', data.added[0].hash);\n\t\t\t\t\t\t\t\tfm.one('opendone', function() {\n\t\t\t\t\t\t\t\t\tdata.toast && fm.toast(data.toast);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdfrd.resolve();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error) {\n\t\t\t\t\t\tdfrd.reject(error);\n\t\t\t\t\t});\n\t\t\t\t\treturn dfrd;\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimes : ['application/zip'],\n\t\t\tload : function() {},\n\t\t\tsave : function(){}\n\t\t},\n\t\t{\n\t\t\t// Simple Text (basic textarea editor)\n\t\t\tinfo : {\n\t\t\t\tid : 'textarea',\n\t\t\t\tname : 'TextArea',\n\t\t\t\tuseTextAreaEvent : true\n\t\t\t},\n\t\t\tload : function(textarea) {\n\t\t\t\t// trigger event 'editEditorPrepare'\n\t\t\t\tthis.trigger('Prepare', {\n\t\t\t\t\tnode: textarea,\n\t\t\t\t\teditorObj: void(0),\n\t\t\t\t\tinstance: void(0),\n\t\t\t\t\topts: {}\n\t\t\t\t});\n\t\t\t\ttextarea.setSelectionRange && textarea.setSelectionRange(0, 0);\n\t\t\t\t$(textarea).trigger('focus').show();\n\t\t\t},\n\t\t\tsave : function(){}\n\t\t},\n\t\t{\n\t\t\t// File converter with online-convert.com\n\t\t\tinfo : {\n\t\t\t\tid : 'onlineconvert',\n\t\t\t\tname : 'Online Convert',\n\t\t\t\ticonImg : 'img/editor-icons.png 0 -144',\n\t\t\t\tcmdCheck : 'OnlineConvert',\n\t\t\t\tpreventGet: true,\n\t\t\t\thideButtons: true,\n\t\t\t\tsingle: true,\n\t\t\t\tconverter: true,\n\t\t\t\tcanMakeEmpty: false,\n\t\t\t\tintegrate: {\n\t\t\t\t\ttitle: 'ONLINE-CONVERT.COM',\n\t\t\t\t\tlink: 'https://online-convert.com'\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimes : ['*'],\n\t\t\thtml : '<div style=\"width:100%;max-height:100%;\"></div>',\n\t\t\t// setup on elFinder bootup\n\t\t\tsetup : function(opts, fm) {\n\t\t\t\tvar mOpts = opts.extraOptions.onlineConvert || {maxSize:100,showLink:true};\n\t\t\t\tif (mOpts.maxSize) {\n\t\t\t\t\tthis.info.maxSize = mOpts.maxSize * 1048576;\n\t\t\t\t}\n\t\t\t\tthis.set = Object.assign({\n\t\t\t\t\turl : 'https://%s.online-convert.com%s?external_url=',\n\t\t\t\t\tconv : {\n\t\t\t\t\t\tArchive: {'7Z':{}, 'BZ2':{ext:'bz'}, 'GZ':{}, 'ZIP':{}},\n\t\t\t\t\t\tAudio: {'MP3':{}, 'OGG':{ext:'oga'}, 'WAV':{}, 'WMA':{}, 'AAC':{}, 'AIFF':{ext:'aif'}, 'FLAC':{}, 'M4A':{}, 'MMF':{}, 'OPUS':{ext:'oga'}},\n\t\t\t\t\t\tDocument: {'DOC':{}, 'DOCX':{}, 'HTML':{}, 'ODT':{}, 'PDF':{}, 'PPT':{}, 'PPTX':{}, 'RTF':{}, 'SWF':{}, 'TXT':{}},\n\t\t\t\t\t\teBook: {'AZW3':{ext:'azw'}, 'ePub':{}, 'FB2':{ext:'xml'}, 'LIT':{}, 'LRF':{}, 'MOBI':{}, 'PDB':{}, 'PDF':{},'PDF-eBook':{ext:'pdf'}, 'TCR':{}},\n\t\t\t\t\t\tHash: {'Adler32':{},  'Apache-htpasswd':{}, 'Blowfish':{}, 'CRC32':{}, 'CRC32B':{}, 'Gost':{}, 'Haval128':{},'MD4':{}, 'MD5':{}, 'RIPEMD128':{}, 'RIPEMD160':{}, 'SHA1':{}, 'SHA256':{}, 'SHA384':{}, 'SHA512':{}, 'Snefru':{}, 'Std-DES':{}, 'Tiger128':{}, 'Tiger128-calculator':{}, 'Tiger128-converter':{}, 'Tiger160':{}, 'Tiger192':{}, 'Whirlpool':{}},\n\t\t\t\t\t\tImage: {'BMP':{}, 'EPS':{ext:'ai'}, 'GIF':{}, 'EXR':{}, 'ICO':{}, 'JPG':{}, 'PNG':{}, 'SVG':{}, 'TGA':{}, 'TIFF':{ext:'tif'}, 'WBMP':{}, 'WebP':{}},\n\t\t\t\t\t\tVideo: {'3G2':{}, '3GP':{}, 'AVI':{}, 'FLV':{}, 'HLS':{ext:'m3u8'}, 'MKV':{}, 'MOV':{}, 'MP4':{}, 'MPEG-1':{ext:'mpeg'}, 'MPEG-2':{ext:'mpeg'}, 'OGG':{ext:'ogv'}, 'OGV':{}, 'WebM':{}, 'WMV':{}, 'Android':{link:'/convert-video-for-%s',ext:'mp4'}, 'Blackberry':{link:'/convert-video-for-%s',ext:'mp4'}, 'DPG':{link:'/convert-video-for-%s',ext:'avi'}, 'iPad':{link:'/convert-video-for-%s',ext:'mp4'}, 'iPhone':{link:'/convert-video-for-%s',ext:'mp4'}, 'iPod':{link:'/convert-video-for-%s',ext:'mp4'}, 'Nintendo-3DS':{link:'/convert-video-for-%s',ext:'avi'}, 'Nintendo-DS':{link:'/convert-video-for-%s',ext:'avi'}, 'PS3':{link:'/convert-video-for-%s',ext:'mp4'}, 'Wii':{link:'/convert-video-for-%s',ext:'avi'}, 'Xbox':{link:'/convert-video-for-%s',ext:'wmv'}}\n\t\t\t\t\t},\n\t\t\t\t\tcatExts : {\n\t\t\t\t\t\tHash: 'txt'\n\t\t\t\t\t},\n\t\t\t\t\tlink : '<div class=\"elfinder-edit-onlineconvert-link\"><a href=\"https://www.online-convert.com\" target=\"_blank\"><span class=\"elfinder-button-icon\"></span>ONLINE-CONVERT.COM</a></div>',\n\t\t\t\t\tuseTabs : ($.fn.tabs && !fm.UA.iOS)? true : false // Can't work on iOS, I don't know why.\n\t\t\t\t}, mOpts);\n\t\t\t},\n\t\t\t// Prepare on before show dialog\n\t\t\tprepare : function(base, dialogOpts, file) {\n\t\t\t\tvar elfNode = base.editor.fm.getUI();\n\t\t\t\t$(base).height(elfNode.height());\n\t\t\t\tdialogOpts.width = Math.max(dialogOpts.width || 0, elfNode.width() * 0.8);\n\t\t\t},\n\t\t\t// Initialization of editing node (this: this editors HTML node)\n\t\t\tinit : function(id, file, dum, fm) {\n\t\t\t\tvar ta = this,\n\t\t\t\t\tconfObj = ta.editor.confObj,\n\t\t\t\t\tset = confObj.set,\n\t\t\t\t\tuiToast = fm.getUI('toast'),\n\t\t\t\t\tidxs = {},\n\t\t\t\t\tallowZip = fm.uploadMimeCheck('application/zip', file.phash),\n\t\t\t\t\tselfUrl = $('base').length? document.location.href.replace(/#.*$/, '') : '',\n\t\t\t\t\tgetExt = function(cat, con) {\n\t\t\t\t\t\tvar c;\n\t\t\t\t\t\tif (set.catExts[cat]) {\n\t\t\t\t\t\t\treturn set.catExts[cat];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (set.conv[cat] && (c = set.conv[cat][con])) {\n\t\t\t\t\t\t\treturn (c.ext || con).toLowerCase();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn con.toLowerCase();\n\t\t\t\t\t},\n\t\t\t\t\tsetOptions = function(cat, done) {\n\t\t\t\t\t\tvar type, dfdInit, dfd;\n\t\t\t\t\t\tif (typeof confObj.api === 'undefined') {\n\t\t\t\t\t\t\tdfdInit = fm.request({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tcmd: 'editor',\n\t\t\t\t\t\t\t\t\tname: 'OnlineConvert',\n\t\t\t\t\t\t\t\t\tmethod: 'init'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdfdInit = $.Deferred().resolve({api: confObj.api});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcat = cat.toLowerCase();\n\t\t\t\t\t\tdfdInit.done(function(data) {\n\t\t\t\t\t\t\tconfObj.api = data.api;\n\t\t\t\t\t\t\tif (confObj.api) {\n\t\t\t\t\t\t\t\tif (cat) {\n\t\t\t\t\t\t\t\t\ttype = '?category=' + cat;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttype = '';\n\t\t\t\t\t\t\t\t\tcat = 'all';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!confObj.conversions) {\n\t\t\t\t\t\t\t\t\tconfObj.conversions = {};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!confObj.conversions[cat]) {\n\t\t\t\t\t\t\t\t\tdfd = $.getJSON('https://api2.online-convert.com/conversions' + type);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdfd = $.Deferred().resolve(confObj.conversions[cat]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdfd.done(function(d) {\n\t\t\t\t\t\t\t\t\tconfObj.conversions[cat] = d;\n\t\t\t\t\t\t\t\t\t$.each(d, function(i, o) {\n\t\t\t\t\t\t\t\t\t\tbtns[set.useTabs? 'children' : 'find']('.onlineconvert-category-' + o.category).children('.onlineconvert-' + o.target).trigger('makeoption', o);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tdone && done();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tbtns = (function() {\n\t\t\t\t\t\tvar btns = $('<div/>').on('click', 'button', function() {\n\t\t\t\t\t\t\t\tvar b = $(this),\n\t\t\t\t\t\t\t\t\topts = b.data('opts') || null,\n\t\t\t\t\t\t\t\t\tcat = b.closest('.onlineconvert-category').data('cname'),\n\t\t\t\t\t\t\t\t\tcon = b.data('conv');\n\t\t\t\t\t\t\t\tif (confObj.api === true) {\n\t\t\t\t\t\t\t\t\tapi({\n\t\t\t\t\t\t\t\t\t\tcategory: cat,\n\t\t\t\t\t\t\t\t\t\tconvert: con,\n\t\t\t\t\t\t\t\t\t\toptions: opts\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).on('change', function(e) {\n\t\t\t\t\t\t\t\tvar t = $(e.target),\n\t\t\t\t\t\t\t\t\tp = t.parent(), \n\t\t\t\t\t\t\t\t\tb = t.closest('.elfinder-edit-onlineconvert-button').children('button:first'),\n\t\t\t\t\t\t\t\t\to = b.data('opts') || {},\n\t\t\t\t\t\t\t\t\tv = p.data('type') === 'boolean'? t.is(':checked') : t.val();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tif (v) {\n\t\t\t\t\t\t\t\t\tif (p.data('type') === 'integer') {\n\t\t\t\t\t\t\t\t\t\tv = parseInt(v);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (p.data('pattern')) {\n\t\t\t\t\t\t\t\t\t\tvar reg = new RegExp(p.data('pattern'));\n\t\t\t\t\t\t\t\t\t\tif (!reg.test(v)) {\n\t\t\t\t\t\t\t\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\t\t\t\t\t\t\t\tfm.error('\"' + fm.escape(v) + '\" is not match to \"/' + fm.escape(p.data('pattern')) + '/\"');\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tv = null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (v) {\n\t\t\t\t\t\t\t\t\to[t.parent().data('optkey')] = v;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdelete o[p.data('optkey')];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tb.data('opts', o);\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tul = $('<ul/>'),\n\t\t\t\t\t\t\toform = function(n, o) {\n\t\t\t\t\t\t\t\tvar f = $('<p/>').data('optkey', n).data('type', o.type),\n\t\t\t\t\t\t\t\t\tchecked = '',\n\t\t\t\t\t\t\t\t\tdisabled = '',\n\t\t\t\t\t\t\t\t\tnozip = false,\n\t\t\t\t\t\t\t\t\topts, btn, elm;\n\t\t\t\t\t\t\t\tif (o.description) {\n\t\t\t\t\t\t\t\t\tf.attr('title', fm.i18n(o.description));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (o.pattern) {\n\t\t\t\t\t\t\t\t\tf.data('pattern', o.pattern);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tf.append($('<span/>').text(fm.i18n(n) + ' : '));\n\t\t\t\t\t\t\t\tif (o.type === 'boolean') {\n\t\t\t\t\t\t\t\t\tif (o['default'] || (nozip = (n === 'allow_multiple_outputs' && !allowZip))) {\n\t\t\t\t\t\t\t\t\t\tchecked = ' checked';\n\t\t\t\t\t\t\t\t\t\tif (nozip) {\n\t\t\t\t\t\t\t\t\t\t\tdisabled = ' disabled';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbtn = this.children('button:first');\n\t\t\t\t\t\t\t\t\t\topts = btn.data('opts') || {};\n\t\t\t\t\t\t\t\t\t\topts[n] = true;\n\t\t\t\t\t\t\t\t\t\tbtn.data('opts', opts);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tf.append($('<input type=\"checkbox\" value=\"true\"'+checked+disabled+'/>'));\n\t\t\t\t\t\t\t\t} else if (o['enum']){\n\t\t\t\t\t\t\t\t\telm = $('<select/>').append($('<option value=\"\"/>').text('Select...'));\n\t\t\t\t\t\t\t\t\t$.each(o['enum'], function(i, v) {\n\t\t\t\t\t\t\t\t\t\telm.append($('<option value=\"'+v+'\"/>').text(v));\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tf.append(elm);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tf.append($('<input type=\"text\" value=\"\"/>'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn f;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmakeOption = function(o) {\n\t\t\t\t\t\t\t\tvar elm = this,\n\t\t\t\t\t\t\t\t\tb = $('<span class=\"elfinder-button-icon elfinder-button-icon-preference\"/>').on('click', function() {\n\t\t\t\t\t\t\t\t\t\tf.toggle();\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tf = $('<div class=\"elfinder-edit-onlinconvert-options\"/>').hide();\n\t\t\t\t\t\t\t\tif (o.options) {\n\t\t\t\t\t\t\t\t\t$.each(o.options, function(k, v) {\n\t\t\t\t\t\t\t\t\t\tk !== 'download_password' && f.append(oform.call(elm, k, v));\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telm.append(b, f);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tts = (+new Date()),\n\t\t\t\t\t\t\ti = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!confObj.ext2mime) {\n\t\t\t\t\t\t\tconfObj.ext2mime = Object.assign(fm.arrayFlip(fm.mimeTypes), ext2mime);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$.each(set.conv, function(t, c) {\n\t\t\t\t\t\t\tvar cname = t.toLowerCase(),\n\t\t\t\t\t\t\t\tid = 'elfinder-edit-onlineconvert-' + cname + ts,\n\t\t\t\t\t\t\t\ttype = $('<div id=\"' + id + '\" class=\"onlineconvert-category onlineconvert-category-'+cname+'\"/>').data('cname', t),\n\t\t\t\t\t\t\t\tcext;\n\t\t\t\t\t\t\t$.each(c, function(n, o) {\n\t\t\t\t\t\t\t\tvar nl = n.toLowerCase(),\n\t\t\t\t\t\t\t\t\text = getExt(t, n);\n\t\t\t\t\t\t\t\tif (!confObj.ext2mime[ext]) {\n\t\t\t\t\t\t\t\t\tif (cname === 'audio' || cname === 'image' || cname === 'video') {\n\t\t\t\t\t\t\t\t\t\tconfObj.ext2mime[ext] = cname + '/x-' + nl;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconfObj.ext2mime[ext] = 'application/octet-stream';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (fm.uploadMimeCheck(confObj.ext2mime[ext], file.phash)) {\n\t\t\t\t\t\t\t\t\ttype.append($('<div class=\"elfinder-edit-onlineconvert-button onlineconvert-'+nl+'\"/>').on('makeoption', function(e, data) {\n\t\t\t\t\t\t\t\t\t\tvar elm = $(this);\n\t\t\t\t\t\t\t\t\t\tif (!elm.children('.elfinder-button-icon-preference').length) {\n\t\t\t\t\t\t\t\t\t\t\tmakeOption.call(elm, data);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}).append($('<button/>').text(n).data('conv', n)));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (type.children().length) {\n\t\t\t\t\t\t\t\tul.append($('<li/>').append($('<a/>').attr('href', selfUrl + '#' + id).text(t)));\n\t\t\t\t\t\t\t\tbtns.append(type);\n\t\t\t\t\t\t\t\tidxs[cname] = i++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (set.useTabs) {\n\t\t\t\t\t\t\tbtns.prepend(ul).tabs({\n\t\t\t\t\t\t\t\tbeforeActivate: function(e, ui) {\n\t\t\t\t\t\t\t\t\tsetOptions(ui.newPanel.data('cname'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.each(set.conv, function(t) {\n\t\t\t\t\t\t\t\tvar tl = t.toLowerCase();\n\t\t\t\t\t\t\t\tbtns.append($('<fieldset class=\"onlineconvert-fieldset-' + tl + '\"/>').append($('<legend/>').text(t)).append(btns.children('.onlineconvert-category-' + tl)));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn btns;\n\t\t\t\t\t})(),\n\t\t\t\t\tselect = $(this)\n\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\tbtns,\n\t\t\t\t\t\t\t(set.showLink? $(set.link) : null)\n\t\t\t\t\t\t),\n\t\t\t\t\tspnr = $('<div class=\"elfinder-edit-spinner elfinder-edit-onlineconvert\"/>')\n\t\t\t\t\t\t.hide()\n\t\t\t\t\t\t.html('<span class=\"elfinder-spinner-text\">' + fm.i18n('nowLoading') + '</span><span class=\"elfinder-spinner\"/>')\n\t\t\t\t\t\t.appendTo(select.parent()),\n\t\t\t\t\tprog = $('<div class=\"elfinder-quicklook-info-progress\"/>').appendTo(spnr),\n\t\t\t\t\t_url = null,\n\t\t\t\t\turl = function() {\n\t\t\t\t\t\tvar onetime;\n\t\t\t\t\t\tif (_url) {\n\t\t\t\t\t\t\treturn $.Deferred().resolve(_url);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tspnr.show();\n\t\t\t\t\t\t\treturn fm.forExternalUrl(file.hash, { progressBar: prog }).done(function(url) {\n\t\t\t\t\t\t\t\t_url = url;\n\t\t\t\t\t\t\t}).fail(function(error) {\n\t\t\t\t\t\t\t\terror && fm.error(error);\n\t\t\t\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\tspnr.hide();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tapi = function(opts) {\n\t\t\t\t\t\t$(ta).data('dfrd', url().done(function(url) {\n\t\t\t\t\t\t\tselect.fadeOut();\n\t\t\t\t\t\t\tsetStatus({info: 'Start conversion request.'});\n\t\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tcmd: 'editor',\n\t\t\t\t\t\t\t\t\tname: 'OnlineConvert',\n\t\t\t\t\t\t\t\t\tmethod: 'api',\n\t\t\t\t\t\t\t\t\t'args[category]' : opts.category.toLowerCase(),\n\t\t\t\t\t\t\t\t\t'args[convert]'  : opts.convert.toLowerCase(),\n\t\t\t\t\t\t\t\t\t'args[options]'  : JSON.stringify(opts.options),\n\t\t\t\t\t\t\t\t\t'args[source]'   : fm.convAbsUrl(url),\n\t\t\t\t\t\t\t\t\t'args[filename]' : fm.splitFileExtention(file.name)[0] + '.' + getExt(opts.category, opts.convert),\n\t\t\t\t\t\t\t\t\t'args[mime]'     : file.mime\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\t\t\tcheckRes(data.apires, opts.category, opts.convert);\n\t\t\t\t\t\t\t}).fail(function(error) {\n\t\t\t\t\t\t\t\terror && fm.error(error);\n\t\t\t\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tcheckRes = function(res, cat, con) {\n\t\t\t\t\t\tvar status, err = [];\n\t\t\t\t\t\tif (res && res.id) {\n\t\t\t\t\t\t\tstatus = res.status;\n\t\t\t\t\t\t\tif (status.code === 'failed') {\n\t\t\t\t\t\t\t\tspnr.hide();\n\t\t\t\t\t\t\t\tif (res.errors && res.errors.length) {\n\t\t\t\t\t\t\t\t\t$.each(res.errors, function(i, o) {\n\t\t\t\t\t\t\t\t\t\to.message && err.push(o.message);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfm.error(err.length? err : status.info);\n\t\t\t\t\t\t\t\tselect.fadeIn();\n\t\t\t\t\t\t\t} else if (status.code === 'completed') {\n\t\t\t\t\t\t\t\tupload(res);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetStatus(status);\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tpolling(res.id);\n\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuiToast.appendTo(ta.closest('.ui-dialog'));\n\t\t\t\t\t\t\tif (res.message) {\n\t\t\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\t\t\tmsg: fm.i18n(res.message),\n\t\t\t\t\t\t\t\t\tmode: 'error',\n\t\t\t\t\t\t\t\t\ttimeOut: 5000,\n\t\t\t\t\t\t\t\t\tonHidden: function() {\n\t\t\t\t\t\t\t\t\t\tuiToast.children().length === 1 && uiToast.appendTo(fm.getUI());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfm.toast({\n\t\t\t\t\t\t\t\tmsg: fm.i18n('editorConvNoApi'),\n\t\t\t\t\t\t\t\tmode: 'error',\n\t\t\t\t\t\t\t\ttimeOut: 3000,\n\t\t\t\t\t\t\t\tonHidden: function() {\n\t\t\t\t\t\t\t\t\tuiToast.children().length === 1 && uiToast.appendTo(fm.getUI());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tspnr.hide();\n\t\t\t\t\t\t\tselect.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsetStatus = function(status) {\n\t\t\t\t\t\tspnr.show().children('.elfinder-spinner-text').text(status.info);\n\t\t\t\t\t},\n\t\t\t\t\tpolling = function(jobid) {\n\t\t\t\t\t\tfm.request({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tcmd: 'editor',\n\t\t\t\t\t\t\t\tname: 'OnlineConvert',\n\t\t\t\t\t\t\t\tmethod: 'api',\n\t\t\t\t\t\t\t\t'args[jobid]': jobid\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpreventDefault : true\n\t\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\t\tcheckRes(data.apires);\n\t\t\t\t\t\t}).fail(function(error) {\n\t\t\t\t\t\t\terror && fm.error(error);\n\t\t\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tupload = function(res) {\n\t\t\t\t\t\tvar output = res.output,\n\t\t\t\t\t\t\tid = res.id,\n\t\t\t\t\t\t\turl = '';\n\t\t\t\t\t\tspnr.hide();\n\t\t\t\t\t\tif (output && output.length) {\n\t\t\t\t\t\t\tta.elfinderdialog('destroy');\n\t\t\t\t\t\t\t$.each(output, function(i, o) {\n\t\t\t\t\t\t\t\tif (o.uri) {\n\t\t\t\t\t\t\t\t\turl += o.uri + '\\n';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfm.upload({\n\t\t\t\t\t\t\t\ttarget: file.phash,\n\t\t\t\t\t\t\t\tfiles: [url],\n\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\textraData: {\n\t\t\t\t\t\t\t\t\tcontentSaveId: 'OnlineConvert-' + res.id\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmode = 'document',\n\t\t\t\t\tcl, m;\n\t\t\t\tselect.parent().css({overflow: 'auto'}).addClass('overflow-scrolling-touch');\n\t\t\t\tif (m = file.mime.match(/^(audio|image|video)/)) {\n\t\t\t\t\tmode = m[1];\n\t\t\t\t}\n\t\t\t\tif (set.useTabs) {\n\t\t\t\t\tif (idxs[mode]) {\n\t\t\t\t\t\tbtns.tabs('option', 'active', idxs[mode]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcl = Object.keys(set.conv).length;\n\t\t\t\t\t$.each(set.conv, function(t) {\n\t\t\t\t\t\tif (t.toLowerCase() === mode) {\n\t\t\t\t\t\t\tsetOptions(t, function() {\n\t\t\t\t\t\t\t\t$.each(set.conv, function(t0) {\n\t\t\t\t\t\t\t\t\tt0.toLowerCase() !== mode && setOptions(t0);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcl--;\n\t\t\t\t\t});\n\t\t\t\t\tif (!cl) {\n\t\t\t\t\t\t$.each(set.conv, function(t) {\n\t\t\t\t\t\t\tsetOptions(t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tselect.parent().scrollTop(btns.children('.onlineconvert-fieldset-' + mode).offset().top);\n\t\t\t\t}\n\t\t\t},\n\t\t\tload : function() {},\n\t\t\tgetContent : function() {},\n\t\t\tsave : function() {},\n\t\t\t// On dialog closed\n\t\t\tclose : function(ta) {\n\t\t\t\tvar fm = this.fm,\n\t\t\t\t\tdfrd = $(ta).data('dfrd');\n\t\t\t\tif (dfrd && dfrd.state() === 'pending') {\n\t\t\t\t\tdfrd.reject();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t];\n});\n"]}