{"version":3,"sources":["ui/navbar.js"],"names":["define","$","fn","elfindernavbar","fm","opts","this","not","each","delta","deltaW","handle","swipeHandle","autoHide","setWidth","navdock","nav","hide","addClass","wz","css","parent","children","append","ltr","direction","setWzRect","cwd","getUI","wzRect","data","cwdOffset","offset","Object","assign","cwdEdge","left","width","setDelta","Math","round","outerHeight","height","outerWidth","innerWidth","one","set","bind","navdockH","length","trigger","cssloaded","UA","Touch","storage","navbar","autoHideUA","grep","v","uiAutoHide","push","stop","duration","init","appendTo","remove","on","e","mode","type","handleW","max","step","complete","resources","blink","originalEvent","_preventSwipeX","Mobile","resizable","handles","minWidth","maxWidth","resize","ui","size","$this","tm","preventDefault","stopPropagation","cancelAnimationFrame","requestAnimationFrame","Opera","scrollLeft","top","parseInt","scrollTop","scrollRight","right","window","namespace"],"mappings":"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","file":"../../ui/navbar.js","sourcesContent":["define([\n\t\"skylark-jquery\"\n],function($) {\n\t/**\n\t * @class elfindernav - elFinder container for diretories tree and places\n\t *\n\t * @author Dmitry (dio) Levashov\n\t **/\n\t$.fn.elfindernavbar = function(fm, opts) {\n\t\t\"use strict\";\n\t\tthis.not('.elfinder-navbar').each(function() {\n\t\t\tvar nav    = $(this).hide().addClass('ui-state-default elfinder-navbar'),\n\t\t\t\tparent = nav.css('overflow', 'hidden').parent(),\n\t\t\t\twz     = parent.children('.elfinder-workzone').append(nav),\n\t\t\t\tltr    = fm.direction == 'ltr',\n\t\t\t\tdelta, deltaW, handle, swipeHandle, autoHide, setWidth, navdock,\n\t\t\t\tsetWzRect = function() {\n\t\t\t\t\tvar cwd = fm.getUI('cwd'),\n\t\t\t\t\t\twz  = fm.getUI('workzone'),\n\t\t\t\t\t\twzRect = wz.data('rectangle'),\n\t\t\t\t\t\tcwdOffset = cwd.offset();\n\t\t\t\t\twz.data('rectangle', Object.assign(wzRect, { cwdEdge: (fm.direction === 'ltr')? cwdOffset.left : cwdOffset.left + cwd.width() }));\n\t\t\t\t},\n\t\t\t\tsetDelta = function() {\n\t\t\t\t\tnav.css('overflow', 'hidden');\n\t\t\t\t\tdelta  = Math.round(nav.outerHeight() - nav.height());\n\t\t\t\t\tdeltaW = Math.round(navdock.outerWidth() - navdock.innerWidth());\n\t\t\t\t\tnav.css('overflow', 'auto');\n\t\t\t\t};\n\n\t\t\tfm.one('init', function() {\n\t\t\t\tnavdock = fm.getUI('navdock');\n\t\t\t\tvar set = function() {\n\t\t\t\t\t\tsetDelta();\n\t\t\t\t\t\tfm.bind('wzresize', function() {\n\t\t\t\t\t\t\tvar navdockH = 0;\n\t\t\t\t\t\t\tnavdock.width(nav.outerWidth() - deltaW);\n\t\t\t\t\t\t\tif (navdock.children().length > 1) {\n\t\t\t\t\t\t\t\tnavdockH = navdock.outerHeight(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnav.height(wz.height() - navdockH - delta);\n\t\t\t\t\t\t}).trigger('wzresize');\n\t\t\t\t\t};\n\t\t\t\tif (fm.cssloaded) {\n\t\t\t\t\tset();\n\t\t\t\t} else {\n\t\t\t\t\tfm.one('cssloaded', set);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.one('opendone',function() {\n\t\t\t\thandle && handle.trigger('resize');\n\t\t\t\tnav.css('overflow', 'auto');\n\t\t\t}).bind('themechange', setDelta);\n\t\t\t\n\t\t\tif (fm.UA.Touch) {\n\t\t\t\tautoHide = fm.storage('autoHide') || {};\n\t\t\t\tif (typeof autoHide.navbar === 'undefined') {\n\t\t\t\t\tautoHide.navbar = (opts.autoHideUA && opts.autoHideUA.length > 0 && $.grep(opts.autoHideUA, function(v){ return fm.UA[v]? true : false; }).length);\n\t\t\t\t\tfm.storage('autoHide', autoHide);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (autoHide.navbar) {\n\t\t\t\t\tfm.one('init', function() {\n\t\t\t\t\t\tif (nav.children().length) {\n\t\t\t\t\t\t\tfm.uiAutoHide.push(function(){ nav.stop(true, true).trigger('navhide', { duration: 'slow', init: true }); });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfm.bind('load', function() {\n\t\t\t\t\tif (nav.children().length) {\n\t\t\t\t\t\tswipeHandle = $('<div class=\"elfinder-navbar-swipe-handle\"/>').hide().appendTo(wz);\n\t\t\t\t\t\tif (swipeHandle.css('pointer-events') !== 'none') {\n\t\t\t\t\t\t\tswipeHandle.remove();\n\t\t\t\t\t\t\tswipeHandle = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tnav.on('navshow navhide', function(e, data) {\n\t\t\t\t\tvar mode     = (e.type === 'navshow')? 'show' : 'hide',\n\t\t\t\t\t\tduration = (data && data.duration)? data.duration : 'fast',\n\t\t\t\t\t\thandleW = (data && data.handleW)? data.handleW : Math.max(50, fm.getUI().width() / 10);\n\t\t\t\t\tnav.stop(true, true)[mode]({\n\t\t\t\t\t\tduration: duration,\n\t\t\t\t\t\tstep    : function() {\n\t\t\t\t\t\t\tfm.trigger('wzresize');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t\tif (swipeHandle) {\n\t\t\t\t\t\t\t\tif (mode === 'show') {\n\t\t\t\t\t\t\t\t\tswipeHandle.stop(true, true).hide();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tswipeHandle.width(handleW? handleW : '');\n\t\t\t\t\t\t\t\t\tfm.resources.blink(swipeHandle, 'slowonce');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfm.trigger('navbar'+ mode);\n\t\t\t\t\t\t\tdata.init && fm.trigger('uiautohide');\n\t\t\t\t\t\t\tsetWzRect();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tautoHide.navbar = (mode !== 'show');\n\t\t\t\t\tfm.storage('autoHide', Object.assign(fm.storage('autoHide'), {navbar: autoHide.navbar}));\n\t\t\t\t}).on('touchstart', function(e) {\n\t\t\t\t\tif ($(this)['scroll' + (fm.direction === 'ltr'? 'Right' : 'Left')]() > 5) {\n\t\t\t\t\t\te.originalEvent._preventSwipeX = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif (! fm.UA.Mobile) {\n\t\t\t\thandle = nav.resizable({\n\t\t\t\t\t\thandles : ltr ? 'e' : 'w',\n\t\t\t\t\t\tminWidth : opts.minWidth || 150,\n\t\t\t\t\t\tmaxWidth : opts.maxWidth || 500,\n\t\t\t\t\t\tresize : function() {\n\t\t\t\t\t\t\tfm.trigger('wzresize');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstop : function(e, ui) {\n\t\t\t\t\t\t\tfm.storage('navbarWidth', ui.size.width);\n\t\t\t\t\t\t\tsetWzRect();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.on('resize scroll', function(e) {\n\t\t\t\t\t\tvar $this = $(this),\n\t\t\t\t\t\t\ttm = $this.data('posinit');\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tif (! ltr && e.type === 'resize') {\n\t\t\t\t\t\t\tnav.css('left', 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttm && cancelAnimationFrame(tm);\n\t\t\t\t\t\t$this.data('posinit', requestAnimationFrame(function() {\n\t\t\t\t\t\t\tvar offset = (fm.UA.Opera && nav.scrollLeft())? 20 : 2;\n\t\t\t\t\t\t\thandle.css('top', 0).css({\n\t\t\t\t\t\t\t\ttop  : parseInt(nav.scrollTop())+'px',\n\t\t\t\t\t\t\t\tleft : ltr ? 'auto' : parseInt(nav.scrollRight() -  offset) * -1,\n\t\t\t\t\t\t\t\tright: ltr ? parseInt(nav.scrollLeft() - offset) * -1 : 'auto'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (e.type === 'resize') {\n\t\t\t\t\t\t\t\tfm.getUI('cwd').trigger('resize');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t})\n\t\t\t\t\t.children('.ui-resizable-handle').addClass('ui-front');\n\t\t\t}\n\n\t\t\tif (setWidth = fm.storage('navbarWidth')) {\n\t\t\t\tnav.width(setWidth);\n\t\t\t} else {\n\t\t\t\tif (fm.UA.Mobile) {\n\t\t\t\t\tfm.one(fm.cssloaded? 'init' : 'cssloaded', function() {\n\t\t\t\t\t\tvar set = function() {\n\t\t\t\t\t\t\tsetWidth = nav.parent().width() / 2;\n\t\t\t\t\t\t\tif (nav.data('defWidth') > setWidth) {\n\t\t\t\t\t\t\t\tnav.width(setWidth);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnav.width(nav.data('defWidth'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnav.data('width', nav.width());\n\t\t\t\t\t\t\tfm.trigger('wzresize');\n\t\t\t\t\t\t};\n\t\t\t\t\t\tnav.data('defWidth', nav.width());\n\t\t\t\t\t\t$(window).on('resize.' + fm.namespace, set);\n\t\t\t\t\t\tset();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\t\t\n\t\treturn this;\n\t};\n\n});"]}